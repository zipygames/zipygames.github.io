var cr={plugins_:{},behaviors:{}};"function"!=typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"==typeof"test".__proto__?function(t){return t.__proto__}:function(t){return t.constructor.prototype}),function(){function t(t,e){this.x=t,this.y=e,cr.seal(this)}function e(t,e,i,s){this.set(t,e,i,s),cr.seal(this)}function i(){this.tlx=0,this.tly=0,this.trx=0,this.try_=0,this.brx=0,this.bry=0,this.blx=0,this.bly=0,cr.seal(this)}cr.logexport=function(t){window.console&&window.console.log&&window.console.log(t)},cr.logerror=function(t){window.console&&window.console.error&&window.console.error(t)},cr.seal=function(t){return t},cr.freeze=function(t){return t},cr.is_undefined=function(t){return void 0===t},cr.is_number=function(t){return"number"==typeof t},cr.is_string=function(t){return"string"==typeof t},cr.isPOT=function(t){return t>0&&!(t-1&t)},cr.nextHighestPowerOfTwo=function(t){--t;for(var e=1;e<32;e<<=1)t|=t>>e;return t+1},cr.abs=function(t){return t<0?-t:t},cr.max=function(t,e){return t>e?t:e},cr.min=function(t,e){return t<e?t:e},cr.PI=Math.PI,cr.round=function(t){return t+.5|0},cr.floor=function(t){return t>=0?0|t:(0|t)-1},cr.ceil=function(t){var e=0|t;return e===t?e:e+1},t.prototype.offset=function(t,e){return this.x+=t,this.y+=e,this},t.prototype.mul=function(t,e){return this.x*=t,this.y*=e,this},cr.vector2=t,cr.segments_intersect=function(t,e,i,s,n,r,o,a){var h,c,l,u,p,d,f,g;if(t<i?(c=t,h=i):(c=i,h=t),n<o?(d=n,p=o):(d=o,p=n),h<d||c>p)return!1;if(e<s?(u=e,l=s):(u=s,l=e),r<a?(g=r,f=a):(g=a,f=r),l<g||u>f)return!1;var m=n-t+o-i,y=r-e+a-s,_=i-t,v=s-e,b=o-n,w=a-r,x=cr.abs(v*b-w*_),S=b*y-w*m;if(cr.abs(S)>x)return!1;var T=_*y-v*m;return cr.abs(T)<=x},e.prototype.set=function(t,e,i,s){this.left=t,this.top=e,this.right=i,this.bottom=s},e.prototype.copy=function(t){this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom},e.prototype.width=function(){return this.right-this.left},e.prototype.height=function(){return this.bottom-this.top},e.prototype.offset=function(t,e){return this.left+=t,this.top+=e,this.right+=t,this.bottom+=e,this},e.prototype.normalize=function(){var t=0;this.left>this.right&&(t=this.left,this.left=this.right,this.right=t),this.top>this.bottom&&(t=this.top,this.top=this.bottom,this.bottom=t)},e.prototype.intersects_rect=function(t){return!(t.right<this.left||t.bottom<this.top||t.left>this.right||t.top>this.bottom)},e.prototype.intersects_rect_off=function(t,e,i){return!(t.right+e<this.left||t.bottom+i<this.top||t.left+e>this.right||t.top+i>this.bottom)},e.prototype.contains_pt=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},e.prototype.equals=function(t){return this.left===t.left&&this.top===t.top&&this.right===t.right&&this.bottom===t.bottom},cr.rect=e,i.prototype.set_from_rect=function(t){this.tlx=t.left,this.tly=t.top,this.trx=t.right,this.try_=t.top,this.brx=t.right,this.bry=t.bottom,this.blx=t.left,this.bly=t.bottom},i.prototype.set_from_rotated_rect=function(t,e){if(0===e)this.set_from_rect(t);else{var i=Math.sin(e),s=Math.cos(e),n=t.left*i,r=t.top*i,o=t.right*i,a=t.bottom*i,h=t.left*s,c=t.top*s,l=t.right*s,u=t.bottom*s;this.tlx=h-r,this.tly=c+n,this.trx=l-r,this.try_=c+o,this.brx=l-a,this.bry=u+o,this.blx=h-a,this.bly=u+n}},i.prototype.offset=function(t,e){return this.tlx+=t,this.tly+=e,this.trx+=t,this.try_+=e,this.brx+=t,this.bry+=e,this.blx+=t,this.bly+=e,this};var s=0,n=0;function r(t,e,i,r){t<e?i<r?(s=t<i?t:i,n=e>r?e:r):(s=t<r?t:r,n=e>i?e:i):i<r?(s=e<i?e:i,n=t>r?t:r):(s=e<r?e:r,n=t>i?t:i)}i.prototype.bounding_box=function(t){r(this.tlx,this.trx,this.brx,this.blx),t.left=s,t.right=n,r(this.tly,this.try_,this.bry,this.bly),t.top=s,t.bottom=n},i.prototype.contains_pt=function(t,e){var i,s,n,r=this.tlx,o=this.tly,a=this.trx-r,h=this.try_-o,c=this.brx-r,l=this.bry-o,u=t-r,p=e-o,d=c*c+l*l,f=c*u+l*p,g=1/((i=a*a+h*h)*d-(s=a*c+h*l)*s),m=(d*(n=a*u+h*p)-s*f)*g,y=(i*f-s*n)*g;return m>=0&&y>0&&m+y<1||(y=((i=(a=this.blx-r)*a+(h=this.bly-o)*h)*f-(s=a*c+h*l)*(n=a*u+h*p))*(g=1/(i*d-s*s)),(m=(d*n-s*f)*g)>=0&&y>0&&m+y<1)},i.prototype.at=function(t,e){if(e)switch(t){case 0:case 4:default:return this.tlx;case 1:return this.trx;case 2:return this.brx;case 3:return this.blx}else switch(t){case 0:case 4:default:return this.tly;case 1:return this.try_;case 2:return this.bry;case 3:return this.bly}},i.prototype.midX=function(){return(this.tlx+this.trx+this.brx+this.blx)/4},i.prototype.midY=function(){return(this.tly+this.try_+this.bry+this.bly)/4},i.prototype.intersects_segment=function(t,e,i,s){if(this.contains_pt(t,e)||this.contains_pt(i,s))return!0;var n,r,o,a,h;for(h=0;h<4;h++)if(n=this.at(h,!0),r=this.at(h,!1),o=this.at(h+1,!0),a=this.at(h+1,!1),cr.segments_intersect(t,e,i,s,n,r,o,a))return!0;return!1},i.prototype.intersects_quad=function(t){var e,i,s,n,r,o,a,h,c,l,u=t.midX(),p=t.midY();if(this.contains_pt(u,p))return!0;if(u=this.midX(),p=this.midY(),t.contains_pt(u,p))return!0;for(c=0;c<4;c++)for(l=0;l<4;l++)if(e=this.at(c,!0),i=this.at(c,!1),s=this.at(c+1,!0),n=this.at(c+1,!1),r=t.at(l,!0),o=t.at(l,!1),a=t.at(l+1,!0),h=t.at(l+1,!1),cr.segments_intersect(e,i,s,n,r,o,a,h))return!0;return!1},cr.quad=i,cr.RGB=function(t,e,i){return Math.max(Math.min(t,255),0)|Math.max(Math.min(e,255),0)<<8|Math.max(Math.min(i,255),0)<<16},cr.GetRValue=function(t){return 255&t},cr.GetGValue=function(t){return(65280&t)>>8},cr.GetBValue=function(t){return(16711680&t)>>16},cr.shallowCopy=function(t,e,i){var s;for(s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);return t},cr.arrayRemove=function(t,e){var i,s;if(!((e=cr.floor(e))<0||e>=t.length)){for(i=e,s=t.length-1;i<s;i++)t[i]=t[i+1];cr.truncateArray(t,s)}},cr.truncateArray=function(t,e){t.length=e},cr.clearArray=function(t){cr.truncateArray(t,0)},cr.shallowAssignArray=function(t,e){var i,s;for(cr.clearArray(t),i=0,s=e.length;i<s;++i)t[i]=e[i]},cr.appendArray=function(t,e){t.push.apply(t,e)},cr.fastIndexOf=function(t,e){var i,s;for(i=0,s=t.length;i<s;++i)if(t[i]===e)return i;return-1},cr.arrayFindRemove=function(t,e){var i=cr.fastIndexOf(t,e);-1!==i&&cr.arrayRemove(t,i)},cr.clamp=function(t,e,i){return t<e?e:t>i?i:t},cr.to_radians=function(t){return t/(180/cr.PI)},cr.to_degrees=function(t){return t*(180/cr.PI)},cr.clamp_angle_degrees=function(t){return(t%=360)<0&&(t+=360),t},cr.clamp_angle=function(t){return(t%=2*cr.PI)<0&&(t+=2*cr.PI),t},cr.to_clamped_degrees=function(t){return cr.clamp_angle_degrees(cr.to_degrees(t))},cr.to_clamped_radians=function(t){return cr.clamp_angle(cr.to_radians(t))},cr.angleTo=function(t,e,i,s){var n=i-t,r=s-e;return Math.atan2(r,n)},cr.angleDiff=function(t,e){if(t===e)return 0;var i=Math.sin(t),s=Math.cos(t),n=i*Math.sin(e)+s*Math.cos(e);return n>=1?0:n<=-1?cr.PI:Math.acos(n)},cr.angleRotate=function(t,e,i){var s=Math.sin(t),n=Math.cos(t),r=Math.sin(e),o=Math.cos(e);return Math.acos(s*r+n*o)>i?n*r-s*o>0?cr.clamp_angle(t+i):cr.clamp_angle(t-i):cr.clamp_angle(e)},cr.angleClockwise=function(t,e){var i=Math.sin(t);return Math.cos(t)*Math.sin(e)-i*Math.cos(e)<=0},cr.rotatePtAround=function(t,e,i,s,n,r){if(0===i)return r?t:e;var o=Math.sin(i),a=Math.cos(i),h=(t-=s)*o;return t=t*a-(e-=n)*o,e=e*a+h,t+=s,e+=n,r?t:e},cr.distanceTo=function(t,e,i,s){var n=i-t,r=s-e;return Math.sqrt(n*n+r*r)},cr.xor=function(t,e){return!t!=!e},cr.lerp=function(t,e,i){return t+(e-t)*i},cr.unlerp=function(t,e,i){return t===e?0:(i-t)/(e-t)},cr.anglelerp=function(t,e,i){var s=cr.angleDiff(t,e);return cr.angleClockwise(e,t)?t+s*i:t-s*i},cr.qarp=function(t,e,i,s){return cr.lerp(cr.lerp(t,e,s),cr.lerp(e,i,s),s)},cr.cubic=function(t,e,i,s,n){return cr.lerp(cr.qarp(t,e,i,n),cr.qarp(e,i,s,n),n)},cr.cosp=function(t,e,i){return(t+e+(t-e)*Math.cos(i*Math.PI))/2},cr.hasAnyOwnProperty=function(t){var e;for(e in t)if(t.hasOwnProperty(e))return!0;return!1},cr.wipe=function(t){var e;for(e in t)t.hasOwnProperty(e)&&delete t[e]};var o=+new Date;cr.performance_now=function(){if(void 0!==window.performance){var t=window.performance;if(void 0!==t.now)return t.now();if(void 0!==t.webkitNow)return t.webkitNow();if(void 0!==t.mozNow)return t.mozNow();if(void 0!==t.msNow)return t.msNow()}return Date.now()-o};var a=!1,h=!1,c=!1;void 0!==window&&(a=!(/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent))&&/safari/i.test(navigator.userAgent),h=/(iphone|ipod|ipad)/i.test(navigator.userAgent),c=window.c2ejecta);var l=!a&&!c&&!h&&"undefined"!=typeof Set&&void 0!==Set.prototype.forEach;function u(){this.s=null,this.items=null,this.item_count=0,l&&(this.s=new Set),this.values_cache=[],this.cache_valid=!0,cr.seal(this)}u.prototype.contains=function(t){return!this.isEmpty()&&(l?this.s.has(t):this.items&&this.items.hasOwnProperty(t))},u.prototype.add=function(t){if(l)this.s.has(t)||(this.s.add(t),this.cache_valid=!1);else{var e=t.toString(),i=this.items;i?i.hasOwnProperty(e)||(i[e]=t,this.item_count++,this.cache_valid=!1):(this.items={},this.items[e]=t,this.item_count=1,this.cache_valid=!1)}},u.prototype.remove=function(t){if(!this.isEmpty())if(l)this.s.has(t)&&(this.s.delete(t),this.cache_valid=!1);else if(this.items){var e=t.toString(),i=this.items;i.hasOwnProperty(e)&&(delete i[e],this.item_count--,this.cache_valid=!1)}},u.prototype.clear=function(){this.isEmpty()||(l?this.s.clear():(this.items=null,this.item_count=0),cr.clearArray(this.values_cache),this.cache_valid=!0)},u.prototype.isEmpty=function(){return 0===this.count()},u.prototype.count=function(){return l?this.s.size:this.item_count};var p=null,d=0;function f(t){p[d++]=t}u.prototype.update_cache=function(){if(!this.cache_valid){if(l)cr.clearArray(this.values_cache),p=this.values_cache,d=0,this.s.forEach(f),p=null,d=0;else{var t=this.values_cache;cr.clearArray(t);var e,i=0,s=this.items;if(s)for(e in s)s.hasOwnProperty(e)&&(t[i++]=s[e])}this.cache_valid=!0}},u.prototype.valuesRef=function(){return this.update_cache(),this.values_cache},cr.ObjectSet=u;var g=new cr.ObjectSet;function m(){this.c=0,this.y=0,this.t=0,this.sum=0,cr.seal(this)}function y(t){this.pts_cache=[],this.bboxLeft=0,this.bboxTop=0,this.bboxRight=0,this.bboxBottom=0,this.convexpolys=null,this.set_pts(t),cr.seal(this)}function _(t,e){this.cellwidth=t,this.cellheight=e,this.cells={}}function v(t,e){this.cellwidth=t,this.cellheight=e,this.cells={}}cr.removeArrayDuplicates=function(t){var e,i;for(e=0,i=t.length;e<i;++e)g.add(t[e]);cr.shallowAssignArray(t,g.valuesRef()),g.clear()},cr.arrayRemoveAllFromObjectSet=function(t,e){l?cr.arrayRemoveAll_set(t,e.s):cr.arrayRemoveAll_arr(t,e.valuesRef())},cr.arrayRemoveAll_set=function(t,e){var i,s,n,r;for(i=0,s=0,n=t.length;i<n;++i)r=t[i],e.has(r)||(t[s++]=r);cr.truncateArray(t,s)},cr.arrayRemoveAll_arr=function(t,e){var i,s,n,r;for(i=0,s=0,n=t.length;i<n;++i)r=t[i],-1===cr.fastIndexOf(e,r)&&(t[s++]=r);cr.truncateArray(t,s)},m.prototype.add=function(t){this.y=t-this.c,this.t=this.sum+this.y,this.c=this.t-this.sum-this.y,this.sum=this.t},m.prototype.reset=function(){this.c=0,this.y=0,this.t=0,this.sum=0},cr.KahanAdder=m,cr.regexp_escape=function(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},y.prototype.set_pts=function(t){this.pts_array=t,this.pts_count=t.length/2,this.pts_cache.length=t.length,this.cache_width=-1,this.cache_height=-1,this.cache_angle=0},y.prototype.is_empty=function(){return!this.pts_array.length},y.prototype.update_bbox=function(){for(var t,e,i,s=this.pts_cache,n=s[0],r=n,o=s[1],a=o,h=1,c=this.pts_count;h<c;++h)(t=s[i=2*h])<n&&(n=t),t>r&&(r=t),(e=s[i+1])<o&&(o=e),e>a&&(a=e);this.bboxLeft=n,this.bboxRight=r,this.bboxTop=o,this.bboxBottom=a},y.prototype.set_from_rect=function(t,e,i){this.pts_cache.length=8,this.pts_count=4;var s=this.pts_cache;s[0]=t.left-e,s[1]=t.top-i,s[2]=t.right-e,s[3]=t.top-i,s[4]=t.right-e,s[5]=t.bottom-i,s[6]=t.left-e,s[7]=t.bottom-i,this.cache_width=t.right-t.left,this.cache_height=t.bottom-t.top,this.update_bbox()},y.prototype.set_from_quad=function(t,e,i,s,n){this.pts_cache.length=8,this.pts_count=4;var r=this.pts_cache;r[0]=t.tlx-e,r[1]=t.tly-i,r[2]=t.trx-e,r[3]=t.try_-i,r[4]=t.brx-e,r[5]=t.bry-i,r[6]=t.blx-e,r[7]=t.bly-i,this.cache_width=s,this.cache_height=n,this.update_bbox()},y.prototype.set_from_poly=function(t){this.pts_count=t.pts_count,cr.shallowAssignArray(this.pts_cache,t.pts_cache),this.bboxLeft=t.bboxLeft,this.bboxTop=t.bboxTop,this.bboxRight=t.bboxRight,this.bboxBottom=t.bboxBottom},y.prototype.cache_poly=function(t,e,i){if(this.cache_width!==t||this.cache_height!==e||this.cache_angle!==i){var s,n,r,o,a,h;this.cache_width=t,this.cache_height=e,this.cache_angle=i;var c=0,l=1,u=this.pts_array,p=this.pts_cache;for(0!==i&&(c=Math.sin(i),l=Math.cos(i)),s=0,o=this.pts_count;s<o;s++)r=(n=2*s)+1,a=u[n]*t,h=u[r]*e,p[n]=a*l-h*c,p[r]=h*l+a*c;this.update_bbox()}},y.prototype.contains_pt=function(t,e){var i=this.pts_cache;if(t===i[0]&&e===i[1])return!0;var s,n,r,o,a,h,c,l=this.pts_count,u=this.bboxLeft-110,p=this.bboxTop-101,d=this.bboxRight+131,f=this.bboxBottom+120,g=0,m=0;for(s=0;s<l;s++)r=(s+1)%l*2,o=i[n=2*s],a=i[n+1],h=i[r],c=i[r+1],cr.segments_intersect(u,p,t,e,o,a,h,c)&&g++,cr.segments_intersect(d,f,t,e,o,a,h,c)&&m++;return g%2==1||m%2==1},y.prototype.intersects_poly=function(t,e,i){var s,n,r,o,a,h,c,l,u,p,d,f,g,m,y,_,v=t.pts_cache,b=this.pts_cache;if(this.contains_pt(v[0]+e,v[1]+i))return!0;if(t.contains_pt(b[0]-e,b[1]-i))return!0;for(s=0,o=this.pts_count;s<o;s++)for(r=(s+1)%o*2,u=b[n=2*s],p=b[n+1],d=b[r],f=b[r+1],a=0,l=t.pts_count;a<l;a++)if(c=(a+1)%l*2,g=v[h=2*a]+e,m=v[h+1]+i,y=v[c]+e,_=v[c+1]+i,cr.segments_intersect(u,p,d,f,g,m,y,_))return!0;return!1},y.prototype.intersects_segment=function(t,e,i,s,n,r){var o,a,h,c,l,u,p,d,f=this.pts_cache;if(this.contains_pt(i-t,s-e))return!0;for(o=0,a=this.pts_count;o<a;o++)if(c=(o+1)%a*2,l=f[h=2*o]+t,u=f[h+1]+e,p=f[c]+t,d=f[c+1]+e,cr.segments_intersect(i,s,n,r,l,u,p,d))return!0;return!1},y.prototype.mirror=function(t){var e,i,s;for(e=0,i=this.pts_count;e<i;++e)s=2*e,this.pts_cache[s]=2*t-this.pts_cache[s]},y.prototype.flip=function(t){var e,i,s;for(e=0,i=this.pts_count;e<i;++e)s=2*e+1,this.pts_cache[s]=2*t-this.pts_cache[s]},y.prototype.diag=function(){var t,e,i,s,n;for(t=0,e=this.pts_count;t<e;++t)s=(i=2*t)+1,n=this.pts_cache[i],this.pts_cache[i]=this.pts_cache[s],this.pts_cache[s]=n},cr.CollisionPoly=y,_.prototype.totalCellCount=0,_.prototype.getCell=function(t,e,i){var s,n=this.cells[t];return n?(s=n[e])||(i?(s=w(this,t,e),this.cells[t][e]=s,s):null):i?(s=w(this,t,e),this.cells[t]={},this.cells[t][e]=s,s):null},_.prototype.XToCell=function(t){return cr.floor(t/this.cellwidth)},_.prototype.YToCell=function(t){return cr.floor(t/this.cellheight)},_.prototype.update=function(t,e,i){var s,n,r,o,a;if(e)for(s=e.left,n=e.right;s<=n;++s)for(r=e.top,o=e.bottom;r<=o;++r)i&&i.contains_pt(s,r)||(a=this.getCell(s,r,!1))&&(a.remove(t),a.isEmpty()&&(x(a),this.cells[s][r]=null));if(i)for(s=i.left,n=i.right;s<=n;++s)for(r=i.top,o=i.bottom;r<=o;++r)e&&e.contains_pt(s,r)||this.getCell(s,r,!0).insert(t)},_.prototype.queryRange=function(t,e){var i,s,n,r,o,a;for(i=this.XToCell(t.left),n=this.YToCell(t.top),s=this.XToCell(t.right),o=this.YToCell(t.bottom);i<=s;++i)for(r=n;r<=o;++r)(a=this.getCell(i,r,!1))&&a.dump(e)},cr.SparseGrid=_,v.prototype.totalCellCount=0,v.prototype.getCell=function(t,e,i){var s,n=this.cells[t];return n?(s=n[e])||(i?(s=C(this,t,e),this.cells[t][e]=s,s):null):i?(s=C(this,t,e),this.cells[t]={},this.cells[t][e]=s,s):null},v.prototype.XToCell=function(t){return cr.floor(t/this.cellwidth)},v.prototype.YToCell=function(t){return cr.floor(t/this.cellheight)},v.prototype.update=function(t,e,i){var s,n,r,o,a;if(e)for(s=e.left,n=e.right;s<=n;++s)for(r=e.top,o=e.bottom;r<=o;++r)i&&i.contains_pt(s,r)||(a=this.getCell(s,r,!1))&&(a.remove(t),a.isEmpty()&&(O(a),this.cells[s][r]=null));if(i)for(s=i.left,n=i.right;s<=n;++s)for(r=i.top,o=i.bottom;r<=o;++r)e&&e.contains_pt(s,r)||this.getCell(s,r,!0).insert(t)},v.prototype.queryRange=function(t,e,i,s,n){var r,o,a,h,c,l;for(r=this.XToCell(t),a=this.YToCell(e),o=this.XToCell(i),c=this.YToCell(s);r<=o;++r)for(h=a;h<=c;++h)(l=this.getCell(r,h,!1))&&l.dump(n)},v.prototype.markRangeChanged=function(t){var e,i,s,n,r,o;for(e=t.left,s=t.top,i=t.right,r=t.bottom;e<=i;++e)for(n=s;n<=r;++n)(o=this.getCell(e,n,!1))&&(o.is_sorted=!1)},cr.RenderGrid=v;var b=[];function w(t,e,i){var s;return _.prototype.totalCellCount++,b.length?((s=b.pop()).grid=t,s.x=e,s.y=i,s):new cr.GridCell(t,e,i)}function x(t){_.prototype.totalCellCount--,t.objects.clear(),b.length<1e3&&b.push(t)}function S(t,e,i){this.grid=t,this.x=e,this.y=i,this.objects=new cr.ObjectSet}S.prototype.isEmpty=function(){return this.objects.isEmpty()},S.prototype.insert=function(t){this.objects.add(t)},S.prototype.remove=function(t){this.objects.remove(t)},S.prototype.dump=function(t){cr.appendArray(t,this.objects.valuesRef())},cr.GridCell=S;var T=[];function C(t,e,i){var s;return v.prototype.totalCellCount++,T.length?((s=T.pop()).grid=t,s.x=e,s.y=i,s):new cr.RenderCell(t,e,i)}function O(t){v.prototype.totalCellCount--,t.reset(),T.length<1e3&&T.push(t)}function k(t,e,i){this.grid=t,this.x=e,this.y=i,this.objects=[],this.is_sorted=!0,this.pending_removal=new cr.ObjectSet,this.any_pending_removal=!1}function A(t,e){return t.zindex-e.zindex}k.prototype.isEmpty=function(){return!this.objects.length||!(this.objects.length>this.pending_removal.count())&&(this.flush_pending(),!0)},k.prototype.insert=function(t){if(this.pending_removal.contains(t))return this.pending_removal.remove(t),void(this.pending_removal.isEmpty()&&(this.any_pending_removal=!1));this.objects.length?(this.objects[this.objects.length-1].get_zindex()>t.get_zindex()&&(this.is_sorted=!1),this.objects.push(t)):(this.objects.push(t),this.is_sorted=!0)},k.prototype.remove=function(t){this.pending_removal.add(t),this.any_pending_removal=!0,this.pending_removal.count()>=30&&this.flush_pending()},k.prototype.flush_pending=function(){this.any_pending_removal&&(this.pending_removal.count()!==this.objects.length?(cr.arrayRemoveAllFromObjectSet(this.objects,this.pending_removal),this.pending_removal.clear(),this.any_pending_removal=!1):this.reset())},k.prototype.ensure_sorted=function(){this.is_sorted||(this.objects.sort(A),this.is_sorted=!0)},k.prototype.reset=function(){cr.clearArray(this.objects),this.is_sorted=!0,this.pending_removal.clear(),this.any_pending_removal=!1},k.prototype.dump=function(t){this.flush_pending(),this.ensure_sorted(),this.objects.length&&t.push(this.objects)},cr.RenderCell=k;var E=["lighter","xor","copy","destination-over","source-in","destination-in","source-out","destination-out","source-atop","destination-atop"];cr.effectToCompositeOp=function(t){return t<=0||t>=11?"source-over":E[t-1]},cr.setGLBlend=function(t,e,i){if(i)switch(t.srcBlend=i.ONE,t.destBlend=i.ONE_MINUS_SRC_ALPHA,e){case 1:t.srcBlend=i.ONE,t.destBlend=i.ONE;break;case 2:break;case 3:t.srcBlend=i.ONE,t.destBlend=i.ZERO;break;case 4:t.srcBlend=i.ONE_MINUS_DST_ALPHA,t.destBlend=i.ONE;break;case 5:t.srcBlend=i.DST_ALPHA,t.destBlend=i.ZERO;break;case 6:t.srcBlend=i.ZERO,t.destBlend=i.SRC_ALPHA;break;case 7:t.srcBlend=i.ONE_MINUS_DST_ALPHA,t.destBlend=i.ZERO;break;case 8:t.srcBlend=i.ZERO,t.destBlend=i.ONE_MINUS_SRC_ALPHA;break;case 9:t.srcBlend=i.DST_ALPHA,t.destBlend=i.ONE_MINUS_SRC_ALPHA;break;case 10:t.srcBlend=i.ONE_MINUS_DST_ALPHA,t.destBlend=i.SRC_ALPHA}},cr.round6dp=function(t){return Math.round(1e6*t)/1e6},cr.equals_nocase=function(t,e){return"string"==typeof t&&"string"==typeof e&&(t.length===e.length&&(t===e||t.toLowerCase()===e.toLowerCase()))},cr.isCanvasInputEvent=function(t){var e=t.target;return!e||(e===document||e===window||(!(!document||!document.body||e!==document.body)||!!cr.equals_nocase(e.tagName,"canvas")))}}();var MatrixArray="undefined"!=typeof Float32Array?Float32Array:Array,glMatrixArrayType=MatrixArray,vec3={},mat3={},mat4={},quat4={};vec3.create=function(t){var e=new MatrixArray(3);return t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2]),e},vec3.set=function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},vec3.add=function(t,e,i){return i&&t!==i?(i[0]=t[0]+e[0],i[1]=t[1]+e[1],i[2]=t[2]+e[2],i):(t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t)},vec3.subtract=function(t,e,i){return i&&t!==i?(i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2],i):(t[0]-=e[0],t[1]-=e[1],t[2]-=e[2],t)},vec3.negate=function(t,e){return e||(e=t),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},vec3.scale=function(t,e,i){return i&&t!==i?(i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i):(t[0]*=e,t[1]*=e,t[2]*=e,t)},vec3.normalize=function(t,e){e||(e=t);var i=t[0],s=t[1],n=t[2],r=Math.sqrt(i*i+s*s+n*n);return r?1===r?(e[0]=i,e[1]=s,e[2]=n,e):(r=1/r,e[0]=i*r,e[1]=s*r,e[2]=n*r,e):(e[0]=0,e[1]=0,e[2]=0,e)},vec3.cross=function(t,e,i){i||(i=t);var s=t[0],n=t[1],r=(t=t[2],e[0]),o=e[1];e=e[2];return i[0]=n*e-t*o,i[1]=t*r-s*e,i[2]=s*o-n*r,i},vec3.length=function(t){var e=t[0],i=t[1];t=t[2];return Math.sqrt(e*e+i*i+t*t)},vec3.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},vec3.direction=function(t,e,i){i||(i=t);var s=t[0]-e[0],n=t[1]-e[1];t=t[2]-e[2];return(e=Math.sqrt(s*s+n*n+t*t))?(e=1/e,i[0]=s*e,i[1]=n*e,i[2]=t*e,i):(i[0]=0,i[1]=0,i[2]=0,i)},vec3.lerp=function(t,e,i,s){return s||(s=t),s[0]=t[0]+i*(e[0]-t[0]),s[1]=t[1]+i*(e[1]-t[1]),s[2]=t[2]+i*(e[2]-t[2]),s},vec3.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+"]"},mat3.create=function(t){var e=new MatrixArray(9);return t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8]),e},mat3.set=function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},mat3.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},mat3.transpose=function(t,e){if(!e||t===e){var i=t[1],s=t[2],n=t[5];return t[1]=t[3],t[2]=t[6],t[3]=i,t[5]=t[7],t[6]=s,t[7]=n,t}return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],e},mat3.toMat4=function(t,e){return e||(e=mat4.create()),e[15]=1,e[14]=0,e[13]=0,e[12]=0,e[11]=0,e[10]=t[8],e[9]=t[7],e[8]=t[6],e[7]=0,e[6]=t[5],e[5]=t[4],e[4]=t[3],e[3]=0,e[2]=t[2],e[1]=t[1],e[0]=t[0],e},mat3.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+"]"},mat4.create=function(t){var e=new MatrixArray(16);return t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e},mat4.set=function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},mat4.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},mat4.transpose=function(t,e){if(!e||t===e){var i=t[1],s=t[2],n=t[3],r=t[6],o=t[7],a=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=i,t[6]=t[9],t[7]=t[13],t[8]=s,t[9]=r,t[11]=t[14],t[12]=n,t[13]=o,t[14]=a,t}return e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e},mat4.determinant=function(t){var e=t[0],i=t[1],s=t[2],n=t[3],r=t[4],o=t[5],a=t[6],h=t[7],c=t[8],l=t[9],u=t[10],p=t[11],d=t[12],f=t[13],g=t[14];return d*l*a*n-c*f*a*n-d*o*u*n+r*f*u*n+c*o*g*n-r*l*g*n-d*l*s*h+c*f*s*h+d*i*u*h-e*f*u*h-c*i*g*h+e*l*g*h+d*o*s*p-r*f*s*p-d*i*a*p+e*f*a*p+r*i*g*p-e*o*g*p-c*o*s*(t=t[15])+r*l*s*t+c*i*a*t-e*l*a*t-r*i*u*t+e*o*u*t},mat4.inverse=function(t,e){e||(e=t);var i=t[0],s=t[1],n=t[2],r=t[3],o=t[4],a=t[5],h=t[6],c=t[7],l=t[8],u=t[9],p=t[10],d=t[11],f=t[12],g=t[13],m=t[14],y=t[15],_=i*a-s*o,v=i*h-n*o,b=i*c-r*o,w=s*h-n*a,x=s*c-r*a,S=n*c-r*h,T=l*g-u*f,C=l*m-p*f,O=l*y-d*f,k=u*m-p*g,A=u*y-d*g,E=p*y-d*m,I=1/(_*E-v*A+b*k+w*O-x*C+S*T);return e[0]=(a*E-h*A+c*k)*I,e[1]=(-s*E+n*A-r*k)*I,e[2]=(g*S-m*x+y*w)*I,e[3]=(-u*S+p*x-d*w)*I,e[4]=(-o*E+h*O-c*C)*I,e[5]=(i*E-n*O+r*C)*I,e[6]=(-f*S+m*b-y*v)*I,e[7]=(l*S-p*b+d*v)*I,e[8]=(o*A-a*O+c*T)*I,e[9]=(-i*A+s*O-r*T)*I,e[10]=(f*x-g*b+y*_)*I,e[11]=(-l*x+u*b-d*_)*I,e[12]=(-o*k+a*C-h*T)*I,e[13]=(i*k-s*C+n*T)*I,e[14]=(-f*w+g*v-m*_)*I,e[15]=(l*w-u*v+p*_)*I,e},mat4.toRotationMat=function(t,e){return e||(e=mat4.create()),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},mat4.toMat3=function(t,e){return e||(e=mat3.create()),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},mat4.toInverseMat3=function(t,e){var i=t[0],s=t[1],n=t[2],r=t[4],o=t[5],a=t[6],h=t[8],c=t[9],l=t[10],u=l*o-a*c,p=-l*r+a*h,d=c*r-o*h,f=i*u+s*p+n*d;return f?(f=1/f,e||(e=mat3.create()),e[0]=u*f,e[1]=(-l*s+n*c)*f,e[2]=(a*s-n*o)*f,e[3]=p*f,e[4]=(l*i-n*h)*f,e[5]=(-a*i+n*r)*f,e[6]=d*f,e[7]=(-c*i+s*h)*f,e[8]=(o*i-s*r)*f,e):null},mat4.multiply=function(t,e,i){i||(i=t);var s=t[0],n=t[1],r=t[2],o=t[3],a=t[4],h=t[5],c=t[6],l=t[7],u=t[8],p=t[9],d=t[10],f=t[11],g=t[12],m=t[13],y=t[14],_=(t=t[15],e[0]),v=e[1],b=e[2],w=e[3],x=e[4],S=e[5],T=e[6],C=e[7],O=e[8],k=e[9],A=e[10],E=e[11],I=e[12],P=e[13],M=e[14];e=e[15];return i[0]=_*s+v*a+b*u+w*g,i[1]=_*n+v*h+b*p+w*m,i[2]=_*r+v*c+b*d+w*y,i[3]=_*o+v*l+b*f+w*t,i[4]=x*s+S*a+T*u+C*g,i[5]=x*n+S*h+T*p+C*m,i[6]=x*r+S*c+T*d+C*y,i[7]=x*o+S*l+T*f+C*t,i[8]=O*s+k*a+A*u+E*g,i[9]=O*n+k*h+A*p+E*m,i[10]=O*r+k*c+A*d+E*y,i[11]=O*o+k*l+A*f+E*t,i[12]=I*s+P*a+M*u+e*g,i[13]=I*n+P*h+M*p+e*m,i[14]=I*r+P*c+M*d+e*y,i[15]=I*o+P*l+M*f+e*t,i},mat4.multiplyVec3=function(t,e,i){i||(i=e);var s=e[0],n=e[1];e=e[2];return i[0]=t[0]*s+t[4]*n+t[8]*e+t[12],i[1]=t[1]*s+t[5]*n+t[9]*e+t[13],i[2]=t[2]*s+t[6]*n+t[10]*e+t[14],i},mat4.multiplyVec4=function(t,e,i){i||(i=e);var s=e[0],n=e[1],r=e[2];e=e[3];return i[0]=t[0]*s+t[4]*n+t[8]*r+t[12]*e,i[1]=t[1]*s+t[5]*n+t[9]*r+t[13]*e,i[2]=t[2]*s+t[6]*n+t[10]*r+t[14]*e,i[3]=t[3]*s+t[7]*n+t[11]*r+t[15]*e,i},mat4.translate=function(t,e,i){var s,n,r,o,a,h,c,l,u,p,d,f,g=e[0],m=e[1];e=e[2];return i&&t!==i?(s=t[0],n=t[1],r=t[2],o=t[3],a=t[4],h=t[5],c=t[6],l=t[7],u=t[8],p=t[9],d=t[10],f=t[11],i[0]=s,i[1]=n,i[2]=r,i[3]=o,i[4]=a,i[5]=h,i[6]=c,i[7]=l,i[8]=u,i[9]=p,i[10]=d,i[11]=f,i[12]=s*g+a*m+u*e+t[12],i[13]=n*g+h*m+p*e+t[13],i[14]=r*g+c*m+d*e+t[14],i[15]=o*g+l*m+f*e+t[15],i):(t[12]=t[0]*g+t[4]*m+t[8]*e+t[12],t[13]=t[1]*g+t[5]*m+t[9]*e+t[13],t[14]=t[2]*g+t[6]*m+t[10]*e+t[14],t[15]=t[3]*g+t[7]*m+t[11]*e+t[15],t)},mat4.scale=function(t,e,i){var s=e[0],n=e[1];e=e[2];return i&&t!==i?(i[0]=t[0]*s,i[1]=t[1]*s,i[2]=t[2]*s,i[3]=t[3]*s,i[4]=t[4]*n,i[5]=t[5]*n,i[6]=t[6]*n,i[7]=t[7]*n,i[8]=t[8]*e,i[9]=t[9]*e,i[10]=t[10]*e,i[11]=t[11]*e,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i):(t[0]*=s,t[1]*=s,t[2]*=s,t[3]*=s,t[4]*=n,t[5]*=n,t[6]*=n,t[7]*=n,t[8]*=e,t[9]*=e,t[10]*=e,t[11]*=e,t)},mat4.rotate=function(t,e,i,s){var n,r,o,a,h,c,l,u,p,d,f,g,m,y,_,v,b,w,x,S,T=i[0],C=i[1],O=(i=i[2],Math.sqrt(T*T+C*C+i*i));return O?(1!==O&&(T*=O=1/O,C*=O,i*=O),n=Math.sin(e),o=1-(r=Math.cos(e)),e=t[0],O=t[1],a=t[2],h=t[3],c=t[4],l=t[5],u=t[6],p=t[7],d=t[8],f=t[9],g=t[10],m=t[11],y=T*T*o+r,_=C*T*o+i*n,v=i*T*o-C*n,b=T*C*o-i*n,w=C*C*o+r,x=i*C*o+T*n,S=T*i*o+C*n,T=C*i*o-T*n,C=i*i*o+r,s?t!==s&&(s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]):s=t,s[0]=e*y+c*_+d*v,s[1]=O*y+l*_+f*v,s[2]=a*y+u*_+g*v,s[3]=h*y+p*_+m*v,s[4]=e*b+c*w+d*x,s[5]=O*b+l*w+f*x,s[6]=a*b+u*w+g*x,s[7]=h*b+p*w+m*x,s[8]=e*S+c*T+d*C,s[9]=O*S+l*T+f*C,s[10]=a*S+u*T+g*C,s[11]=h*S+p*T+m*C,s):null},mat4.rotateX=function(t,e,i){var s=Math.sin(e),n=(e=Math.cos(e),t[4]),r=t[5],o=t[6],a=t[7],h=t[8],c=t[9],l=t[10],u=t[11];return i?t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[4]=n*e+h*s,i[5]=r*e+c*s,i[6]=o*e+l*s,i[7]=a*e+u*s,i[8]=n*-s+h*e,i[9]=r*-s+c*e,i[10]=o*-s+l*e,i[11]=a*-s+u*e,i},mat4.rotateY=function(t,e,i){var s=Math.sin(e),n=(e=Math.cos(e),t[0]),r=t[1],o=t[2],a=t[3],h=t[8],c=t[9],l=t[10],u=t[11];return i?t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[0]=n*e+h*-s,i[1]=r*e+c*-s,i[2]=o*e+l*-s,i[3]=a*e+u*-s,i[8]=n*s+h*e,i[9]=r*s+c*e,i[10]=o*s+l*e,i[11]=a*s+u*e,i},mat4.rotateZ=function(t,e,i){var s=Math.sin(e),n=(e=Math.cos(e),t[0]),r=t[1],o=t[2],a=t[3],h=t[4],c=t[5],l=t[6],u=t[7];return i?t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]):i=t,i[0]=n*e+h*s,i[1]=r*e+c*s,i[2]=o*e+l*s,i[3]=a*e+u*s,i[4]=n*-s+h*e,i[5]=r*-s+c*e,i[6]=o*-s+l*e,i[7]=a*-s+u*e,i},mat4.frustum=function(t,e,i,s,n,r,o){o||(o=mat4.create());var a=e-t,h=s-i,c=r-n;return o[0]=2*n/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*n/h,o[6]=0,o[7]=0,o[8]=(e+t)/a,o[9]=(s+i)/h,o[10]=-(r+n)/c,o[11]=-1,o[12]=0,o[13]=0,o[14]=-r*n*2/c,o[15]=0,o},mat4.perspective=function(t,e,i,s,n){return e*=t=i*Math.tan(t*Math.PI/360),mat4.frustum(-e,e,-t,t,i,s,n)},mat4.ortho=function(t,e,i,s,n,r,o){o||(o=mat4.create());var a=e-t,h=s-i,c=r-n;return o[0]=2/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/h,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/c,o[11]=0,o[12]=-(t+e)/a,o[13]=-(s+i)/h,o[14]=-(r+n)/c,o[15]=1,o},mat4.lookAt=function(t,e,i,s){s||(s=mat4.create());var n,r,o,a,h,c,l,u,p=t[0],d=t[1];t=t[2];return r=i[0],o=i[1],n=i[2],i=e[1],c=e[2],p===e[0]&&d===i&&t===c?mat4.identity(s):(i=p-e[0],c=d-e[1],l=t-e[2],e=o*(l*=u=1/Math.sqrt(i*i+c*c+l*l))-n*(c*=u),n=n*(i*=u)-r*l,r=r*c-o*i,(u=Math.sqrt(e*e+n*n+r*r))?(e*=u=1/u,n*=u,r*=u):r=n=e=0,o=c*r-l*n,a=l*e-i*r,h=i*n-c*e,(u=Math.sqrt(o*o+a*a+h*h))?(o*=u=1/u,a*=u,h*=u):h=a=o=0,s[0]=e,s[1]=o,s[2]=i,s[3]=0,s[4]=n,s[5]=a,s[6]=c,s[7]=0,s[8]=r,s[9]=h,s[10]=l,s[11]=0,s[12]=-(e*p+n*d+r*t),s[13]=-(o*p+a*d+h*t),s[14]=-(i*p+c*d+l*t),s[15]=1,s)},mat4.fromRotationTranslation=function(t,e,i){i||(i=mat4.create());var s=t[0],n=t[1],r=t[2],o=t[3],a=s+s,h=n+n,c=r+r,l=(t=s*a,s*h);s*=c;var u=n*h;return n*=c,r*=c,a*=o,h*=o,o*=c,i[0]=1-(u+r),i[1]=l+o,i[2]=s-h,i[3]=0,i[4]=l-o,i[5]=1-(t+r),i[6]=n+a,i[7]=0,i[8]=s+h,i[9]=n-a,i[10]=1-(t+u),i[11]=0,i[12]=e[0],i[13]=e[1],i[14]=e[2],i[15]=1,i},mat4.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+"]"},quat4.create=function(t){var e=new MatrixArray(4);return t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]),e},quat4.set=function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},quat4.calculateW=function(t,e){var i=t[0],s=t[1],n=t[2];return e&&t!==e?(e[0]=i,e[1]=s,e[2]=n,e[3]=-Math.sqrt(Math.abs(1-i*i-s*s-n*n)),e):(t[3]=-Math.sqrt(Math.abs(1-i*i-s*s-n*n)),t)},quat4.inverse=function(t,e){return e&&t!==e?(e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e):(t[0]*=-1,t[1]*=-1,t[2]*=-1,t)},quat4.length=function(t){var e=t[0],i=t[1],s=t[2];t=t[3];return Math.sqrt(e*e+i*i+s*s+t*t)},quat4.normalize=function(t,e){e||(e=t);var i=t[0],s=t[1],n=t[2],r=t[3],o=Math.sqrt(i*i+s*s+n*n+r*r);return 0===o?(e[0]=0,e[1]=0,e[2]=0,e[3]=0,e):(o=1/o,e[0]=i*o,e[1]=s*o,e[2]=n*o,e[3]=r*o,e)},quat4.multiply=function(t,e,i){i||(i=t);var s=t[0],n=t[1],r=t[2],o=(t=t[3],e[0]),a=e[1],h=e[2];e=e[3];return i[0]=s*e+t*o+n*h-r*a,i[1]=n*e+t*a+r*o-s*h,i[2]=r*e+t*h+s*a-n*o,i[3]=t*e-s*o-n*a-r*h,i},quat4.multiplyVec3=function(t,e,i){i||(i=e);var s=e[0],n=e[1],r=e[2],o=(e=t[0],t[1]),a=t[2],h=(t=t[3])*s+o*r-a*n,c=t*n+a*s-e*r,l=t*r+e*n-o*s;s=-e*s-o*n-a*r;return i[0]=h*t+s*-e+c*-a-l*-o,i[1]=c*t+s*-o+l*-e-h*-a,i[2]=l*t+s*-a+h*-o-c*-e,i},quat4.toMat3=function(t,e){e||(e=mat3.create());var i=t[0],s=t[1],n=t[2],r=t[3],o=i+i,a=s+s,h=n+n,c=i*o,l=i*a;i*=h;var u=s*a;return s*=h,n*=h,o*=r,a*=r,r*=h,e[0]=1-(u+n),e[1]=l+r,e[2]=i-a,e[3]=l-r,e[4]=1-(c+n),e[5]=s+o,e[6]=i+a,e[7]=s-o,e[8]=1-(c+u),e},quat4.toMat4=function(t,e){e||(e=mat4.create());var i=t[0],s=t[1],n=t[2],r=t[3],o=i+i,a=s+s,h=n+n,c=i*o,l=i*a;i*=h;var u=s*a;return s*=h,n*=h,o*=r,a*=r,r*=h,e[0]=1-(u+n),e[1]=l+r,e[2]=i-a,e[3]=0,e[4]=l-r,e[5]=1-(c+n),e[6]=s+o,e[7]=0,e[8]=i+a,e[9]=s-o,e[10]=1-(c+u),e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},quat4.slerp=function(t,e,i,s){s||(s=t);var n,r,o=t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3];return Math.abs(o)>=1?(s!==t&&(s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3]),s):(n=Math.acos(o),r=Math.sqrt(1-o*o),Math.abs(r)<.001?(s[0]=.5*t[0]+.5*e[0],s[1]=.5*t[1]+.5*e[1],s[2]=.5*t[2]+.5*e[2],s[3]=.5*t[3]+.5*e[3],s):(o=Math.sin((1-i)*n)/r,i=Math.sin(i*n)/r,s[0]=t[0]*o+e[0]*i,s[1]=t[1]*o+e[1]*i,s[2]=t[2]*o+e[2]*i,s[3]=t[3]*o+e[3]*i,s))},quat4.str=function(t){return"["+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+"]"},function(){var t=8e3,e=mat4.create();function i(t,e,i){this.isIE=/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent),this.width=0,this.height=0,this.enableFrontToBack=!!i,this.isEarlyZPass=!1,this.isBatchInEarlyZPass=!1,this.currentZ=0,this.zNear=1,this.zFar=1e3,this.zIncrement=(this.zFar-this.zNear)/32768,this.zA=this.zFar/(this.zFar-this.zNear),this.zB=this.zFar*this.zNear/(this.zNear-this.zFar),this.kzA=65536*this.zA,this.kzB=65536*this.zB,this.cam=vec3.create([0,0,100]),this.look=vec3.create([0,0,0]),this.up=vec3.create([0,1,0]),this.worldScale=vec3.create([1,1,1]),this.enable_mipmaps=!0,this.matP=mat4.create(),this.matMV=mat4.create(),this.lastMV=mat4.create(),this.currentMV=mat4.create(),this.gl=t,this.version=0===this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2")?2:1,this.initState()}function s(t,e,i){this.gl=t,this.shaderProgram=e,this.name=i,this.locAPos=t.getAttribLocation(e,"aPos"),this.locATex=t.getAttribLocation(e,"aTex"),this.locMatP=t.getUniformLocation(e,"matP"),this.locMatMV=t.getUniformLocation(e,"matMV"),this.locOpacity=t.getUniformLocation(e,"opacity"),this.locColorFill=t.getUniformLocation(e,"colorFill"),this.locSamplerFront=t.getUniformLocation(e,"samplerFront"),this.locSamplerBack=t.getUniformLocation(e,"samplerBack"),this.locDestStart=t.getUniformLocation(e,"destStart"),this.locDestEnd=t.getUniformLocation(e,"destEnd"),this.locSeconds=t.getUniformLocation(e,"seconds"),this.locPixelWidth=t.getUniformLocation(e,"pixelWidth"),this.locPixelHeight=t.getUniformLocation(e,"pixelHeight"),this.locLayerScale=t.getUniformLocation(e,"layerScale"),this.locLayerAngle=t.getUniformLocation(e,"layerAngle"),this.locViewOrigin=t.getUniformLocation(e,"viewOrigin"),this.locScrollPos=t.getUniformLocation(e,"scrollPos"),this.hasAnyOptionalUniforms=!!(this.locPixelWidth||this.locPixelHeight||this.locSeconds||this.locSamplerBack||this.locDestStart||this.locDestEnd||this.locLayerScale||this.locLayerAngle||this.locViewOrigin||this.locScrollPos),this.lpPixelWidth=-999,this.lpPixelHeight=-999,this.lpOpacity=1,this.lpDestStartX=0,this.lpDestStartY=0,this.lpDestEndX=1,this.lpDestEndY=1,this.lpLayerScale=1,this.lpLayerAngle=0,this.lpViewOriginX=0,this.lpViewOriginY=0,this.lpScrollPosX=0,this.lpScrollPosY=0,this.lpSeconds=0,this.lastCustomParams=[],this.lpMatMV=mat4.create(),this.locOpacity&&t.uniform1f(this.locOpacity,1),this.locColorFill&&t.uniform4f(this.locColorFill,1,1,1,1),this.locSamplerFront&&t.uniform1i(this.locSamplerFront,0),this.locSamplerBack&&t.uniform1i(this.locSamplerBack,1),this.locDestStart&&t.uniform2f(this.locDestStart,0,0),this.locDestEnd&&t.uniform2f(this.locDestEnd,1,1),this.locLayerScale&&t.uniform1f(this.locLayerScale,1),this.locLayerAngle&&t.uniform1f(this.locLayerAngle,0),this.locViewOrigin&&t.uniform2f(this.locViewOrigin,0,0),this.locScrollPos&&t.uniform2f(this.locScrollPos,0,0),this.locSeconds&&t.uniform1f(this.locSeconds,0),this.hasCurrentMatMV=!1}function n(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function r(t,e){this.type=t,this.glwrap=e,this.gl=e.gl,this.opacityParam=0,this.startIndex=0,this.indexCount=0,this.texParam=null,this.mat4param=null,this.shaderParams=[],cr.seal(this)}i.prototype.initState=function(){var e,i=this.gl;for(this.lastOpacity=1,this.lastTexture0=null,this.lastTexture1=null,this.currentOpacity=1,i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),i.disable(i.CULL_FACE),i.disable(i.STENCIL_TEST),i.disable(i.DITHER),this.enableFrontToBack?(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL)):i.disable(i.DEPTH_TEST),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),this.lastSrcBlend=i.ONE,this.lastDestBlend=i.ONE_MINUS_SRC_ALPHA,this.vertexData=new Float32Array(t*(this.enableFrontToBack?3:2)),this.texcoordData=new Float32Array(16e3),this.pointData=new Float32Array(32e3),this.pointBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.pointBuffer),i.bufferData(i.ARRAY_BUFFER,this.pointData.byteLength,i.DYNAMIC_DRAW),this.vertexBuffers=new Array(4),this.texcoordBuffers=new Array(4),e=0;e<4;e++)this.vertexBuffers[e]=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffers[e]),i.bufferData(i.ARRAY_BUFFER,this.vertexData.byteLength,i.DYNAMIC_DRAW),this.texcoordBuffers[e]=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.texcoordBuffers[e]),i.bufferData(i.ARRAY_BUFFER,this.texcoordData.byteLength,i.DYNAMIC_DRAW);this.curBuffer=0,this.indexBuffer=i.createBuffer(),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var s=new Uint16Array(12e3);e=0;for(var n,r,o=0;e<12e3;)s[e++]=o,s[e++]=o+1,s[e++]=o+2,s[e++]=o,s[e++]=o+2,s[e++]=o+3,o+=4;i.bufferData(i.ELEMENT_ARRAY_BUFFER,s,i.STATIC_DRAW),this.vertexPtr=0,this.texPtr=0,this.pointPtr=0,this.shaderPrograms=[],n=["varying mediump vec2 vTex;","uniform lowp float opacity;","uniform lowp sampler2D samplerFront;","void main(void) {","\tgl_FragColor = texture2D(samplerFront, vTex);","\tgl_FragColor *= opacity;","}"].join("\n"),r=this.enableFrontToBack?["attribute highp vec3 aPos;","attribute mediump vec2 aTex;","varying mediump vec2 vTex;","uniform highp mat4 matP;","uniform highp mat4 matMV;","void main(void) {","\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, aPos.z, 1.0);","\tvTex = aTex;","}"].join("\n"):["attribute highp vec2 aPos;","attribute mediump vec2 aTex;","varying mediump vec2 vTex;","uniform highp mat4 matP;","uniform highp mat4 matMV;","void main(void) {","\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);","\tvTex = aTex;","}"].join("\n");var a=this.createShaderProgram({src:n},r,"<default>");this.shaderPrograms.push(a),n=["uniform mediump sampler2D samplerFront;","varying lowp float opacity;","void main(void) {","\tgl_FragColor = texture2D(samplerFront, gl_PointCoord);","\tgl_FragColor *= opacity;","}"].join("\n");var h=["attribute vec4 aPos;","varying float opacity;","uniform mat4 matP;","uniform mat4 matMV;","void main(void) {","\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);","\tgl_PointSize = aPos.z;","\topacity = aPos.w;","}"].join("\n");a=this.createShaderProgram({src:n},h,"<point>"),this.shaderPrograms.push(a),n=["varying mediump vec2 vTex;","uniform lowp sampler2D samplerFront;","void main(void) {","\tif (texture2D(samplerFront, vTex).a < 1.0)","\t\tdiscard;","}"].join("\n");a=this.createShaderProgram({src:n},r,"<earlyz>");this.shaderPrograms.push(a),n=["uniform lowp vec4 colorFill;","void main(void) {","\tgl_FragColor = colorFill;","}"].join("\n");a=this.createShaderProgram({src:n},r,"<fill>");for(var c in this.shaderPrograms.push(a),cr.shaders)cr.shaders.hasOwnProperty(c)&&this.shaderPrograms.push(this.createShaderProgram(cr.shaders[c],r,c));i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,null),this.batch=[],this.batchPtr=0,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1,this.lastProgram=-1,this.currentProgram=-1,this.currentShader=null,this.fbo=i.createFramebuffer(),this.renderToTex=null,this.depthBuffer=null,this.attachedDepthBuffer=!1,this.enableFrontToBack&&(this.depthBuffer=i.createRenderbuffer()),this.tmpVec3=vec3.create([0,0,0]);var l=i.getParameter(i.ALIASED_POINT_SIZE_RANGE);this.minPointSize=l[0],this.maxPointSize=l[1],this.maxPointSize>2048&&(this.maxPointSize=2048),this.switchProgram(0),cr.seal(this)},s.prototype.updateMatMV=function(t){n(this.lpMatMV,t)||(mat4.set(t,this.lpMatMV),this.gl.uniformMatrix4fv(this.locMatMV,!1,t))},i.prototype.createShaderProgram=function(t,e,i){var n=this.gl,r=n.createShader(n.FRAGMENT_SHADER);if(n.shaderSource(r,t.src),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS)){var o=n.getShaderInfoLog(r);throw n.deleteShader(r),new Error("error compiling fragment shader: "+o)}var a=n.createShader(n.VERTEX_SHADER);if(n.shaderSource(a,e),n.compileShader(a),!n.getShaderParameter(a,n.COMPILE_STATUS)){o=n.getShaderInfoLog(a);throw n.deleteShader(r),n.deleteShader(a),new Error("error compiling vertex shader: "+o)}var h=n.createProgram();if(n.attachShader(h,r),n.attachShader(h,a),n.linkProgram(h),!n.getProgramParameter(h,n.LINK_STATUS)){o=n.getProgramInfoLog(h);throw n.deleteShader(r),n.deleteShader(a),n.deleteProgram(h),new Error("error linking shader program: "+o)}n.useProgram(h),n.deleteShader(r),n.deleteShader(a);var c,l,u=new s(n,h,i);for(u.extendBoxHorizontal=t.extendBoxHorizontal||0,u.extendBoxVertical=t.extendBoxVertical||0,u.crossSampling=!!t.crossSampling,u.preservesOpaqueness=!!t.preservesOpaqueness,u.animated=!!t.animated,u.parameters=t.parameters||[],c=0,l=u.parameters.length;c<l;c++)u.parameters[c][1]=n.getUniformLocation(h,u.parameters[c][0]),u.lastCustomParams.push(0),n.uniform1f(u.parameters[c][1],0);return cr.seal(u),u},i.prototype.getShaderIndex=function(t){var e,i;for(e=0,i=this.shaderPrograms.length;e<i;e++)if(this.shaderPrograms[e].name===t)return e;return-1},i.prototype.project=function(t,e,i){var s=this.matMV,n=this.matP,r=[0,0,0,0,0,0,0,0];r[0]=s[0]*t+s[4]*e+s[12],r[1]=s[1]*t+s[5]*e+s[13],r[2]=s[2]*t+s[6]*e+s[14],r[3]=s[3]*t+s[7]*e+s[15],r[4]=n[0]*r[0]+n[4]*r[1]+n[8]*r[2]+n[12]*r[3],r[5]=n[1]*r[0]+n[5]*r[1]+n[9]*r[2]+n[13]*r[3],r[6]=n[2]*r[0]+n[6]*r[1]+n[10]*r[2]+n[14]*r[3],r[7]=-r[2],0!==r[7]&&(r[7]=1/r[7],r[4]*=r[7],r[5]*=r[7],r[6]*=r[7],i[0]=(.5*r[4]+.5)*this.width,i[1]=(.5*r[5]+.5)*this.height)},i.prototype.setSize=function(t,e,i){if(this.width!==t||this.height!==e||i){this.endBatch();var s,n,r,o=this.gl;if(this.width=t,this.height=e,o.viewport(0,0,t,e),mat4.lookAt(this.cam,this.look,this.up,this.matMV),this.enableFrontToBack)mat4.ortho(-t/2,t/2,e/2,-e/2,this.zNear,this.zFar,this.matP),this.worldScale[0]=1,this.worldScale[1]=1;else{mat4.perspective(45,t/e,this.zNear,this.zFar,this.matP);var a=[0,0],h=[0,0];this.project(0,0,a),this.project(1,1,h),this.worldScale[0]=1/(h[0]-a[0]),this.worldScale[1]=-1/(h[1]-a[1])}for(s=0,n=this.shaderPrograms.length;s<n;s++)(r=this.shaderPrograms[s]).hasCurrentMatMV=!1,r.locMatP&&(o.useProgram(r.shaderProgram),o.uniformMatrix4fv(r.locMatP,!1,this.matP));o.useProgram(this.shaderPrograms[this.lastProgram].shaderProgram),o.bindTexture(o.TEXTURE_2D,null),o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,null),o.activeTexture(o.TEXTURE0),this.lastTexture0=null,this.lastTexture1=null,this.depthBuffer&&(o.bindFramebuffer(o.FRAMEBUFFER,this.fbo),o.bindRenderbuffer(o.RENDERBUFFER,this.depthBuffer),o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_COMPONENT16,this.width,this.height),this.attachedDepthBuffer||(o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,this.depthBuffer),this.attachedDepthBuffer=!0),o.bindRenderbuffer(o.RENDERBUFFER,null),o.bindFramebuffer(o.FRAMEBUFFER,null),this.renderToTex=null)}},i.prototype.resetModelView=function(){mat4.lookAt(this.cam,this.look,this.up,this.matMV),mat4.scale(this.matMV,this.worldScale)},i.prototype.translate=function(t,e){0===t&&0===e||(this.tmpVec3[0]=t,this.tmpVec3[1]=e,this.tmpVec3[2]=0,mat4.translate(this.matMV,this.tmpVec3))},i.prototype.scale=function(t,e){1===t&&1===e||(this.tmpVec3[0]=t,this.tmpVec3[1]=e,this.tmpVec3[2]=1,mat4.scale(this.matMV,this.tmpVec3))},i.prototype.rotateZ=function(t){0!==t&&mat4.rotateZ(this.matMV,t)},i.prototype.updateModelView=function(){if(!n(this.lastMV,this.matMV)){var t=this.pushBatch();t.type=5,t.mat4param?mat4.set(this.matMV,t.mat4param):t.mat4param=mat4.create(this.matMV),mat4.set(this.matMV,this.lastMV),this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},i.prototype.setEarlyZIndex=function(t){this.enableFrontToBack&&(t>32760&&(t=32760),this.currentZ=this.cam[2]-this.zNear-t*this.zIncrement)},r.prototype.doSetEarlyZPass=function(){var t=this.gl,e=this.glwrap;0!==this.startIndex?(t.depthMask(!0),t.colorMask(!1,!1,!1,!1),t.disable(t.BLEND),t.bindFramebuffer(t.FRAMEBUFFER,e.fbo),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0),t.clear(t.DEPTH_BUFFER_BIT),t.bindFramebuffer(t.FRAMEBUFFER,null),e.isBatchInEarlyZPass=!0):(t.depthMask(!1),t.colorMask(!0,!0,!0,!0),t.enable(t.BLEND),e.isBatchInEarlyZPass=!1)},r.prototype.doSetTexture=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texParam)},r.prototype.doSetTexture1=function(){var t=this.gl;t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this.texParam),t.activeTexture(t.TEXTURE0)},r.prototype.doSetOpacity=function(){var t=this.opacityParam,e=this.glwrap;e.currentOpacity=t;var i=e.currentShader;i.locOpacity&&i.lpOpacity!==t&&(i.lpOpacity=t,this.gl.uniform1f(i.locOpacity,t))},r.prototype.doQuad=function(){this.gl.drawElements(this.gl.TRIANGLES,this.indexCount,this.gl.UNSIGNED_SHORT,this.startIndex)},r.prototype.doSetBlend=function(){this.gl.blendFunc(this.startIndex,this.indexCount)},r.prototype.doUpdateModelView=function(){var t,e,i,s=this.glwrap.shaderPrograms,n=this.glwrap.currentProgram;for(t=0,e=s.length;t<e;t++)i=s[t],t===n&&i.locMatMV?(i.updateMatMV(this.mat4param),i.hasCurrentMatMV=!0):i.hasCurrentMatMV=!1;mat4.set(this.mat4param,this.glwrap.currentMV)},r.prototype.doRenderToTexture=function(){var t=this.gl,e=this.glwrap;this.texParam?(e.lastTexture1===this.texParam&&(t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,null),e.lastTexture1=null,t.activeTexture(t.TEXTURE0)),t.bindFramebuffer(t.FRAMEBUFFER,e.fbo),e.isBatchInEarlyZPass||t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texParam,0)):(e.enableFrontToBack||t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0),t.bindFramebuffer(t.FRAMEBUFFER,null))},r.prototype.doClear=function(){var t=this.gl,e=this.startIndex;0===e?(t.clearColor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),t.clear(t.COLOR_BUFFER_BIT)):1===e?(t.enable(t.SCISSOR_TEST),t.scissor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.disable(t.SCISSOR_TEST)):t.clear(t.DEPTH_BUFFER_BIT)},r.prototype.doSetDepthTestEnabled=function(){var t=this.gl;0!==this.startIndex?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST)},r.prototype.doPoints=function(){var t=this.gl,e=this.glwrap;e.enableFrontToBack&&t.disable(t.DEPTH_TEST);var i=e.shaderPrograms[1];t.useProgram(i.shaderProgram),!i.hasCurrentMatMV&&i.locMatMV&&(i.updateMatMV(e.currentMV),i.hasCurrentMatMV=!0),t.enableVertexAttribArray(i.locAPos),t.bindBuffer(t.ARRAY_BUFFER,e.pointBuffer),t.vertexAttribPointer(i.locAPos,4,t.FLOAT,!1,0,0),t.drawArrays(t.POINTS,this.startIndex/4,this.indexCount),i=e.currentShader,t.useProgram(i.shaderProgram),i.locAPos>=0&&(t.enableVertexAttribArray(i.locAPos),t.bindBuffer(t.ARRAY_BUFFER,e.vertexBuffers[e.curBuffer]),t.vertexAttribPointer(i.locAPos,e.enableFrontToBack?3:2,t.FLOAT,!1,0,0)),i.locATex>=0&&(t.enableVertexAttribArray(i.locATex),t.bindBuffer(t.ARRAY_BUFFER,e.texcoordBuffers[e.curBuffer]),t.vertexAttribPointer(i.locATex,2,t.FLOAT,!1,0,0)),e.enableFrontToBack&&t.enable(t.DEPTH_TEST)},r.prototype.doSetProgram=function(){var t=this.gl,e=this.glwrap,i=e.shaderPrograms[this.startIndex];e.currentProgram=this.startIndex,e.currentShader=i,t.useProgram(i.shaderProgram),!i.hasCurrentMatMV&&i.locMatMV&&(i.updateMatMV(e.currentMV),i.hasCurrentMatMV=!0),i.locOpacity&&i.lpOpacity!==e.currentOpacity&&(i.lpOpacity=e.currentOpacity,t.uniform1f(i.locOpacity,e.currentOpacity)),i.locAPos>=0&&(t.enableVertexAttribArray(i.locAPos),t.bindBuffer(t.ARRAY_BUFFER,e.vertexBuffers[e.curBuffer]),t.vertexAttribPointer(i.locAPos,e.enableFrontToBack?3:2,t.FLOAT,!1,0,0)),i.locATex>=0&&(t.enableVertexAttribArray(i.locATex),t.bindBuffer(t.ARRAY_BUFFER,e.texcoordBuffers[e.curBuffer]),t.vertexAttribPointer(i.locATex,2,t.FLOAT,!1,0,0))},r.prototype.doSetColor=function(){var t=this.glwrap.currentShader,e=this.mat4param;this.gl.uniform4f(t.locColorFill,e[0],e[1],e[2],e[3])},r.prototype.doSetProgramParameters=function(){var t,e,i=this.glwrap.currentShader,s=this.gl,n=this.mat4param;i.locSamplerBack&&this.glwrap.lastTexture1!==this.texParam&&(s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,this.texParam),this.glwrap.lastTexture1=this.texParam,s.activeTexture(s.TEXTURE0));var r,o=n[0];if(i.locPixelWidth&&o!==i.lpPixelWidth&&(i.lpPixelWidth=o,s.uniform1f(i.locPixelWidth,o)),o=n[1],i.locPixelHeight&&o!==i.lpPixelHeight&&(i.lpPixelHeight=o,s.uniform1f(i.locPixelHeight,o)),o=n[2],r=n[3],!i.locDestStart||o===i.lpDestStartX&&r===i.lpDestStartY||(i.lpDestStartX=o,i.lpDestStartY=r,s.uniform2f(i.locDestStart,o,r)),o=n[4],r=n[5],!i.locDestEnd||o===i.lpDestEndX&&r===i.lpDestEndY||(i.lpDestEndX=o,i.lpDestEndY=r,s.uniform2f(i.locDestEnd,o,r)),o=n[6],i.locLayerScale&&o!==i.lpLayerScale&&(i.lpLayerScale=o,s.uniform1f(i.locLayerScale,o)),o=n[7],i.locLayerAngle&&o!==i.lpLayerAngle&&(i.lpLayerAngle=o,s.uniform1f(i.locLayerAngle,o)),o=n[8],r=n[9],!i.locViewOrigin||o===i.lpViewOriginX&&r===i.lpViewOriginY||(i.lpViewOriginX=o,i.lpViewOriginY=r,s.uniform2f(i.locViewOrigin,o,r)),o=n[10],r=n[11],!i.locScrollPos||o===i.lpScrollPosX&&r===i.lpScrollPosY||(i.lpScrollPosX=o,i.lpScrollPosY=r,s.uniform2f(i.locScrollPos,o,r)),o=n[12],i.locSeconds&&o!==i.lpSeconds&&(i.lpSeconds=o,s.uniform1f(i.locSeconds,o)),i.parameters.length)for(t=0,e=i.parameters.length;t<e;t++)(o=this.shaderParams[t])!==i.lastCustomParams[t]&&(i.lastCustomParams[t]=o,s.uniform1f(i.parameters[t][1],o))},i.prototype.pushBatch=function(){return this.batchPtr===this.batch.length&&this.batch.push(new r(0,this)),this.batch[this.batchPtr++]},i.prototype.endBatch=function(){if(0!==this.batchPtr&&!this.gl.isContextLost()){var t,e,i,s=this.gl;if(this.pointPtr>0&&(s.bindBuffer(s.ARRAY_BUFFER,this.pointBuffer),s.bufferSubData(s.ARRAY_BUFFER,0,this.pointData.subarray(0,this.pointPtr)),n&&n.locAPos>=0&&"<point>"===n.name&&s.vertexAttribPointer(n.locAPos,4,s.FLOAT,!1,0,0)),this.vertexPtr>0){var n=this.currentShader;s.bindBuffer(s.ARRAY_BUFFER,this.vertexBuffers[this.curBuffer]),s.bufferSubData(s.ARRAY_BUFFER,0,this.vertexData.subarray(0,this.vertexPtr)),n&&n.locAPos>=0&&"<point>"!==n.name&&s.vertexAttribPointer(n.locAPos,this.enableFrontToBack?3:2,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,this.texcoordBuffers[this.curBuffer]),s.bufferSubData(s.ARRAY_BUFFER,0,this.texcoordData.subarray(0,this.texPtr)),n&&n.locATex>=0&&"<point>"!==n.name&&s.vertexAttribPointer(n.locATex,2,s.FLOAT,!1,0,0)}for(t=0,e=this.batchPtr;t<e;t++)switch((i=this.batch[t]).type){case 1:i.doQuad();break;case 2:i.doSetTexture();break;case 3:i.doSetOpacity();break;case 4:i.doSetBlend();break;case 5:i.doUpdateModelView();break;case 6:i.doRenderToTexture();break;case 7:i.doClear();break;case 8:i.doPoints();break;case 9:i.doSetProgram();break;case 10:i.doSetProgramParameters();break;case 11:i.doSetTexture1();break;case 12:i.doSetColor();break;case 13:i.doSetDepthTestEnabled();break;case 14:i.doSetEarlyZPass()}this.batchPtr=0,this.vertexPtr=0,this.texPtr=0,this.pointPtr=0,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1,this.isBatchInEarlyZPass=!1,this.curBuffer++,this.curBuffer>=4&&(this.curBuffer=0)}},i.prototype.setOpacity=function(t){if(t!==this.lastOpacity&&!this.isEarlyZPass){var e=this.pushBatch();e.type=3,e.opacityParam=t,this.lastOpacity=t,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},i.prototype.setTexture=function(t){if(t!==this.lastTexture0){var e=this.pushBatch();e.type=2,e.texParam=t,this.lastTexture0=t,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},i.prototype.setBlend=function(t,e){if((t!==this.lastSrcBlend||e!==this.lastDestBlend)&&!this.isEarlyZPass){var i=this.pushBatch();i.type=4,i.startIndex=t,i.indexCount=e,this.lastSrcBlend=t,this.lastDestBlend=e,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},i.prototype.isPremultipliedAlphaBlend=function(){return this.lastSrcBlend===this.gl.ONE&&this.lastDestBlend===this.gl.ONE_MINUS_SRC_ALPHA},i.prototype.setAlphaBlend=function(){this.setBlend(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)},i.prototype.setNoPremultiplyAlphaBlend=function(){this.setBlend(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)};var o=15992;i.prototype.quad=function(t,e,i,s,n,r,a,h){this.vertexPtr>=o&&this.endBatch();var c=this.vertexPtr,l=this.texPtr,u=this.vertexData,p=this.texcoordData,d=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var f=this.pushBatch();f.type=1,f.startIndex=this.enableFrontToBack?c:c/2*3,f.indexCount=6,this.hasQuadBatchTop=!0,this.hasPointBatchTop=!1}this.enableFrontToBack?(u[c++]=t,u[c++]=e,u[c++]=d,u[c++]=i,u[c++]=s,u[c++]=d,u[c++]=n,u[c++]=r,u[c++]=d,u[c++]=a,u[c++]=h,u[c++]=d):(u[c++]=t,u[c++]=e,u[c++]=i,u[c++]=s,u[c++]=n,u[c++]=r,u[c++]=a,u[c++]=h),p[l++]=0,p[l++]=0,p[l++]=1,p[l++]=0,p[l++]=1,p[l++]=1,p[l++]=0,p[l++]=1,this.vertexPtr=c,this.texPtr=l},i.prototype.quadTex=function(t,e,i,s,n,r,a,h,c){this.vertexPtr>=o&&this.endBatch();var l=this.vertexPtr,u=this.texPtr,p=this.vertexData,d=this.texcoordData,f=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var g=this.pushBatch();g.type=1,g.startIndex=this.enableFrontToBack?l:l/2*3,g.indexCount=6,this.hasQuadBatchTop=!0,this.hasPointBatchTop=!1}var m=c.left,y=c.top,_=c.right,v=c.bottom;this.enableFrontToBack?(p[l++]=t,p[l++]=e,p[l++]=f,p[l++]=i,p[l++]=s,p[l++]=f,p[l++]=n,p[l++]=r,p[l++]=f,p[l++]=a,p[l++]=h,p[l++]=f):(p[l++]=t,p[l++]=e,p[l++]=i,p[l++]=s,p[l++]=n,p[l++]=r,p[l++]=a,p[l++]=h),d[u++]=m,d[u++]=y,d[u++]=_,d[u++]=y,d[u++]=_,d[u++]=v,d[u++]=m,d[u++]=v,this.vertexPtr=l,this.texPtr=u},i.prototype.quadTexUV=function(t,e,i,s,n,r,a,h,c,l,u,p,d,f,g,m){this.vertexPtr>=o&&this.endBatch();var y=this.vertexPtr,_=this.texPtr,v=this.vertexData,b=this.texcoordData,w=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var x=this.pushBatch();x.type=1,x.startIndex=this.enableFrontToBack?y:y/2*3,x.indexCount=6,this.hasQuadBatchTop=!0,this.hasPointBatchTop=!1}this.enableFrontToBack?(v[y++]=t,v[y++]=e,v[y++]=w,v[y++]=i,v[y++]=s,v[y++]=w,v[y++]=n,v[y++]=r,v[y++]=w,v[y++]=a,v[y++]=h,v[y++]=w):(v[y++]=t,v[y++]=e,v[y++]=i,v[y++]=s,v[y++]=n,v[y++]=r,v[y++]=a,v[y++]=h),b[_++]=c,b[_++]=l,b[_++]=u,b[_++]=p,b[_++]=d,b[_++]=f,b[_++]=g,b[_++]=m,this.vertexPtr=y,this.texPtr=_},i.prototype.convexPoly=function(t){var e,i,s,n,r,o,a,h,c=t.length/2-2,l=c-1,u=t[0],p=t[1];for(e=0;e<c;e+=2)s=t[(i=2*e)+2],n=t[i+3],r=t[i+4],o=t[i+5],e===l?this.quad(u,p,s,n,r,o,r,o):(a=t[i+6],h=t[i+7],this.quad(u,p,s,n,r,o,a,h))};i.prototype.point=function(t,e,i,s){this.pointPtr>=7996&&this.endBatch();var n=this.pointPtr,r=this.pointData;if(this.hasPointBatchTop)this.batch[this.batchPtr-1].indexCount++;else{var o=this.pushBatch();o.type=8,o.startIndex=n,o.indexCount=1,this.hasPointBatchTop=!0,this.hasQuadBatchTop=!1}r[n++]=t,r[n++]=e,r[n++]=i,r[n++]=s,this.pointPtr=n},i.prototype.switchProgram=function(t){if(this.lastProgram!==t){var e=this.shaderPrograms[t];if(!e){if(0===this.lastProgram)return;t=0,e=this.shaderPrograms[0]}var i=this.pushBatch();i.type=9,i.startIndex=t,this.lastProgram=t,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},i.prototype.programUsesDest=function(t){var e=this.shaderPrograms[t];return!(!e.locDestStart&&!e.locDestEnd)},i.prototype.programUsesCrossSampling=function(t){var e=this.shaderPrograms[t];return!!(e.locDestStart||e.locDestEnd||e.crossSampling)},i.prototype.programPreservesOpaqueness=function(t){return this.shaderPrograms[t].preservesOpaqueness},i.prototype.programExtendsBox=function(t){var e=this.shaderPrograms[t];return 0!==e.extendBoxHorizontal||0!==e.extendBoxVertical},i.prototype.getProgramBoxExtendHorizontal=function(t){return this.shaderPrograms[t].extendBoxHorizontal},i.prototype.getProgramBoxExtendVertical=function(t){return this.shaderPrograms[t].extendBoxVertical},i.prototype.getProgramParameterType=function(t,e){return this.shaderPrograms[t].parameters[e][2]},i.prototype.programIsAnimated=function(t){return this.shaderPrograms[t].animated},i.prototype.setProgramParameters=function(t,e,i,s,n,r,o,a,h,c,l,u,p,d,f){var g,m,y,_,v,b=this.shaderPrograms[this.lastProgram];if(b.hasAnyOptionalUniforms||f.length){if((y=this.pushBatch()).type=10,y.mat4param?mat4.set(this.matMV,y.mat4param):y.mat4param=mat4.create(),(_=y.mat4param)[0]=e,_[1]=i,_[2]=s,_[3]=n,_[4]=r,_[5]=o,_[6]=a,_[7]=h,_[8]=c,_[9]=l,_[10]=u,_[11]=p,_[12]=d,b.locSamplerBack?y.texParam=t:y.texParam=null,f.length)for((v=y.shaderParams).length=f.length,g=0,m=f.length;g<m;g++)v[g]=f[g];this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},i.prototype.clear=function(t,e,i,s){var n=this.pushBatch();n.type=7,n.startIndex=0,n.mat4param||(n.mat4param=mat4.create()),n.mat4param[0]=t,n.mat4param[1]=e,n.mat4param[2]=i,n.mat4param[3]=s,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1},i.prototype.clearRect=function(t,e,i,s){if(!(i<0||s<0)){var n=this.pushBatch();n.type=7,n.startIndex=1,n.mat4param||(n.mat4param=mat4.create()),n.mat4param[0]=t,n.mat4param[1]=e,n.mat4param[2]=i,n.mat4param[3]=s,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},i.prototype.clearDepth=function(){var t=this.pushBatch();t.type=7,t.startIndex=2,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1},i.prototype.setEarlyZPass=function(t){if(this.enableFrontToBack&&(t=!!t,this.isEarlyZPass!==t)){var e=this.pushBatch();e.type=14,e.startIndex=t?1:0,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1,this.isEarlyZPass=t,this.renderToTex=null,this.isEarlyZPass?this.switchProgram(2):this.switchProgram(0)}},i.prototype.setDepthTestEnabled=function(t){if(this.enableFrontToBack){var e=this.pushBatch();e.type=13,e.startIndex=t?1:0,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},i.prototype.fullscreenQuad=function(){mat4.set(this.lastMV,e),this.resetModelView(),this.updateModelView();var t=this.width/2,i=this.height/2;this.quad(-t,i,t,i,t,-i,-t,-i),mat4.set(e,this.matMV),this.updateModelView()},i.prototype.setColorFillMode=function(t,e,i,s){this.switchProgram(3);var n=this.pushBatch();n.type=12,n.mat4param||(n.mat4param=mat4.create()),n.mat4param[0]=t,n.mat4param[1]=e,n.mat4param[2]=i,n.mat4param[3]=s,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1},i.prototype.setTextureFillMode=function(){this.switchProgram(0)},i.prototype.restoreEarlyZMode=function(){this.switchProgram(2)},i.prototype.present=function(){this.endBatch(),this.gl.flush()};var a=[],h={};i.prototype.contextLost=function(){cr.clearArray(a),h={}};i.prototype.loadTexture=function(t,e,i,s,n,r){e=!!e,i=!!i;var o=t.src+","+e+","+i+(e?","+n:""),c=null;if(void 0!==t.src&&h.hasOwnProperty(o))return(c=h[o]).c2refcount++,c;this.endBatch();var l=this.gl,u=cr.isPOT(t.width)&&cr.isPOT(t.height);c=l.createTexture(),l.bindTexture(l.TEXTURE_2D,c),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);var p=l.RGBA,d=l.RGBA,f=l.UNSIGNED_BYTE;if(s&&!this.isIE)switch(s){case 1:p=l.RGB,d=l.RGB;break;case 2:f=l.UNSIGNED_SHORT_4_4_4_4;break;case 3:f=l.UNSIGNED_SHORT_5_5_5_1;break;case 4:p=l.RGB,d=l.RGB,f=l.UNSIGNED_SHORT_5_6_5}if(1===this.version&&!u&&e){var g=document.createElement("canvas");g.width=cr.nextHighestPowerOfTwo(t.width),g.height=cr.nextHighestPowerOfTwo(t.height);var m=g.getContext("2d");void 0!==m.imageSmoothingEnabled?m.imageSmoothingEnabled=i:(m.webkitImageSmoothingEnabled=i,m.mozImageSmoothingEnabled=i,m.msImageSmoothingEnabled=i),m.drawImage(t,0,0,t.width,t.height,0,0,g.width,g.height),l.texImage2D(l.TEXTURE_2D,0,p,d,f,g)}else l.texImage2D(l.TEXTURE_2D,0,p,d,f,t);return e?"repeat-x"===n?(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE)):"repeat-y"===n?(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT)):(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT)):(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE)),i?(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),(u||this.version>=2)&&this.enable_mipmaps&&!r?(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR_MIPMAP_LINEAR),l.generateMipmap(l.TEXTURE_2D)):l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR)):(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST)),l.bindTexture(l.TEXTURE_2D,null),this.lastTexture0=null,c.c2width=t.width,c.c2height=t.height,c.c2refcount=1,c.c2texkey=o,a.push(c),h[o]=c,c},i.prototype.createEmptyTexture=function(t,e,i,s,n){this.endBatch();var r=this.gl;this.isIE&&(s=!1);var o=r.createTexture();return r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t,e,0,r.RGBA,s?r.UNSIGNED_SHORT_4_4_4_4:r.UNSIGNED_BYTE,null),n?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,i?r.LINEAR:r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,i?r.LINEAR:r.NEAREST),r.bindTexture(r.TEXTURE_2D,null),this.lastTexture0=null,o.c2width=t,o.c2height=e,a.push(o),o},i.prototype.videoToTexture=function(t,e,i){this.endBatch();var s=this.gl;this.isIE&&(i=!1),s.bindTexture(s.TEXTURE_2D,e),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);try{s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,i?s.UNSIGNED_SHORT_4_4_4_4:s.UNSIGNED_BYTE,t)}catch(t){console&&console.error&&console.error("Error updating WebGL texture: ",t)}s.bindTexture(s.TEXTURE_2D,null),this.lastTexture0=null},i.prototype.deleteTexture=function(t){t&&(void 0!==t.c2refcount&&t.c2refcount>1?t.c2refcount--:(this.endBatch(),t===this.lastTexture0&&(this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.lastTexture0=null),t===this.lastTexture1&&(this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.activeTexture(this.gl.TEXTURE0),this.lastTexture1=null),cr.arrayFindRemove(a,t),void 0!==t.c2texkey&&delete h[t.c2texkey],this.gl.deleteTexture(t)))},i.prototype.estimateVRAM=function(){var t,e,i,s=this.width*this.height*4*2;for(t=0,e=a.length;t<e;t++)s+=(i=a[t]).c2width*i.c2height*4;return s},i.prototype.textureCount=function(){return a.length},i.prototype.setRenderingToTexture=function(t){if(t!==this.renderToTex){var e=this.pushBatch();e.type=6,e.texParam=t,this.renderToTex=t,this.hasQuadBatchTop=!1,this.hasPointBatchTop=!1}},cr.GLWrap=i}(),function(){var t=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;function e(t){if(t&&(t.getContext||t.dc)&&!t.c2runtime){t.c2runtime=this;var e=this;this.isCrosswalk=/crosswalk/i.test(navigator.userAgent)||/xwalk/i.test(navigator.userAgent)||!(void 0===window.c2isCrosswalk||!window.c2isCrosswalk),this.isCordova=this.isCrosswalk||void 0!==window.device&&(void 0!==window.device.cordova||void 0!==window.device.phonegap)||void 0!==window.c2iscordova&&window.c2iscordova,this.isPhoneGap=this.isCordova,this.isDirectCanvas=!!t.dc,this.isAppMobi=void 0!==window.AppMobi||this.isDirectCanvas,this.isCocoonJs=!!window.c2cocoonjs,this.isEjecta=!!window.c2ejecta,this.isCocoonJs&&(CocoonJS.App.onSuspended.addEventListener(function(){e.setSuspended(!0)}),CocoonJS.App.onActivated.addEventListener(function(){e.setSuspended(!1)})),this.isEjecta&&(document.addEventListener("pagehide",function(){e.setSuspended(!0)}),document.addEventListener("pageshow",function(){e.setSuspended(!1)}),document.addEventListener("resize",function(){e.setSize(window.innerWidth,window.innerHeight)})),this.isDomFree=this.isDirectCanvas||this.isCocoonJs||this.isEjecta,this.isMicrosoftEdge=/edge\//i.test(navigator.userAgent),this.isIE=(/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)||/iemobile/i.test(navigator.userAgent))&&!this.isMicrosoftEdge,this.isTizen=/tizen/i.test(navigator.userAgent),this.isAndroid=/android/i.test(navigator.userAgent)&&!this.isTizen&&!this.isIE&&!this.isMicrosoftEdge,this.isiPhone=(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge,this.isiPad=/ipad/i.test(navigator.userAgent),this.isiOS=this.isiPhone||this.isiPad||this.isEjecta,this.isiPhoneiOS6=this.isiPhone&&/os\s6/i.test(navigator.userAgent),this.isChrome=(/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge,this.isAmazonWebApp=/amazonwebappplatform/i.test(navigator.userAgent),this.isFirefox=/firefox/i.test(navigator.userAgent),this.isSafari=/safari/i.test(navigator.userAgent)&&!this.isChrome&&!this.isIE&&!this.isMicrosoftEdge,this.isWindows=/windows/i.test(navigator.userAgent),this.isNWjs=void 0!==window.c2nodewebkit||void 0!==window.c2nwjs||/nodewebkit/i.test(navigator.userAgent)||/nwjs/i.test(navigator.userAgent),this.isNodeWebkit=this.isNWjs,this.isArcade=void 0!==window.is_scirra_arcade,this.isWindows8App=!(void 0===window.c2isWindows8||!window.c2isWindows8),this.isWindows8Capable=!(void 0===window.c2isWindows8Capable||!window.c2isWindows8Capable),this.isWindowsPhone8=!(void 0===window.c2isWindowsPhone8||!window.c2isWindowsPhone8),this.isWindowsPhone81=!(void 0===window.c2isWindowsPhone81||!window.c2isWindowsPhone81),this.isWindows10=!!window.cr_windows10,this.isWinJS=this.isWindows8App||this.isWindows8Capable||this.isWindowsPhone81||this.isWindows10,this.isBlackberry10=!(void 0===window.c2isBlackberry10||!window.c2isBlackberry10),this.isAndroidStockBrowser=this.isAndroid&&!this.isChrome&&!this.isCrosswalk&&!this.isFirefox&&!this.isAmazonWebApp&&!this.isDomFree,this.devicePixelRatio=1,this.isMobile=this.isCordova||this.isCrosswalk||this.isAppMobi||this.isCocoonJs||this.isAndroid||this.isiOS||this.isWindowsPhone8||this.isWindowsPhone81||this.isBlackberry10||this.isTizen||this.isEjecta,this.isMobile||(this.isMobile=/(blackberry|bb10|playbook|palm|symbian|nokia|windows\s+ce|phone|mobile|tablet|kindle|silk)/i.test(navigator.userAgent)),this.isWKWebView=!!(this.isiOS&&this.isCordova&&window.webkit),"undefined"==typeof cr_is_preview||this.isNWjs||"?nw"!==window.location.search&&!/nodewebkit/i.test(navigator.userAgent)&&!/nwjs/i.test(navigator.userAgent)||(this.isNWjs=!0),this.isDebug="undefined"!=typeof cr_is_preview&&window.location.search.indexOf("debug")>-1,this.canvas=t,this.canvasdiv=document.getElementById("c2canvasdiv"),this.gl=null,this.glwrap=null,this.glUnmaskedRenderer="(unavailable)",this.enableFrontToBack=!1,this.earlyz_index=0,this.ctx=null,this.firstInFullscreen=!1,this.oldWidth=0,this.oldHeight=0,this.canvas.oncontextmenu=function(t){return t.preventDefault&&t.preventDefault(),!1},this.canvas.onselectstart=function(t){return t.preventDefault&&t.preventDefault(),!1},this.canvas.ontouchstart=function(t){return t.preventDefault&&t.preventDefault(),!1},this.isDirectCanvas&&(window.c2runtime=this),this.isNWjs&&(window.ondragover=function(t){return t.preventDefault(),!1},window.ondrop=function(t){return t.preventDefault(),!1},window.nwgui&&window.nwgui.App.clearCache&&window.nwgui.App.clearCache()),this.isAndroidStockBrowser&&"undefined"!=typeof jQuery&&jQuery("canvas").parents("*").css("overflow","visible"),this.width=t.width,this.height=t.height,this.draw_width=this.width,this.draw_height=this.height,this.cssWidth=this.width,this.cssHeight=this.height,this.lastWindowWidth=window.innerWidth,this.lastWindowHeight=window.innerHeight,this.forceCanvasAlpha=!1,this.redraw=!0,this.isSuspended=!1,Date.now||(Date.now=function(){return+new Date}),this.plugins=[],this.types={},this.types_by_index=[],this.behaviors=[],this.layouts={},this.layouts_by_index=[],this.eventsheets={},this.eventsheets_by_index=[],this.wait_for_textures=[],this.triggers_to_postinit=[],this.all_global_vars=[],this.all_local_vars=[],this.solidBehavior=null,this.jumpthruBehavior=null,this.shadowcasterBehavior=null,this.deathRow={},this.hasPendingInstances=!1,this.isInClearDeathRow=!1,this.isInOnDestroy=0,this.isRunningEvents=!1,this.isEndingLayout=!1,this.createRow=[],this.isLoadingState=!1,this.saveToSlot="",this.loadFromSlot="",this.loadFromJson=null,this.lastSaveJson="",this.signalledContinuousPreview=!1,this.suspendDrawing=!1,this.fireOnCreateAfterLoad=[],this.dt=0,this.dt1=0,this.minimumFramerate=30,this.logictime=0,this.cpuutilisation=0,this.timescale=1,this.kahanTime=new cr.KahanAdder,this.wallTime=new cr.KahanAdder,this.last_tick_time=0,this.fps=0,this.last_fps_time=0,this.tickcount=0,this.tickcount_nosave=0,this.execcount=0,this.framecount=0,this.objectcount=0,this.changelayout=null,this.destroycallbacks=[],this.event_stack=[],this.event_stack_index=-1,this.localvar_stack=[[]],this.localvar_stack_index=0,this.trigger_depth=0,this.pushEventStack(null),this.loop_stack=[],this.loop_stack_index=-1,this.next_uid=0,this.next_puid=0,this.layout_first_tick=!0,this.family_count=0,this.suspend_events=[],this.raf_id=-1,this.timeout_id=-1,this.isloading=!0,this.loadingprogress=0,this.isNodeFullscreen=!1,this.stackLocalCount=0,this.audioInstance=null,this.had_a_click=!1,this.isInUserInputEvent=!1,this.objects_to_pretick=new cr.ObjectSet,this.objects_to_tick=new cr.ObjectSet,this.objects_to_tick2=new cr.ObjectSet,this.registered_collisions=[],this.temp_poly=new cr.CollisionPoly([]),this.temp_poly2=new cr.CollisionPoly([]),this.allGroups=[],this.groups_by_name={},this.cndsBySid={},this.actsBySid={},this.varsBySid={},this.blocksBySid={},this.running_layout=null,this.layer_canvas=null,this.layer_ctx=null,this.layer_tex=null,this.layout_tex=null,this.layout_canvas=null,this.layout_ctx=null,this.is_WebGL_context_lost=!1,this.uses_background_blending=!1,this.fx_tex=[null,null],this.fullscreen_scaling=0,this.files_subfolder="",this.objectsByUid={},this.loaderlogos=null,this.snapshotCanvas=null,this.snapshotData="",this.objectRefTable=[],this.requestProjectData()}}e.prototype.requestProjectData=function(){var t=this;if(this.isWKWebView)this.fetchLocalFileViaCordovaAsText("data.js",function(e){t.loadProject(JSON.parse(e))},function(t){alert("Error fetching data.js")});else{var e;e=this.isWindowsPhone8?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;var i="data.js";(this.isWindows8App||this.isWindowsPhone8||this.isWindowsPhone81||this.isWindows10)&&(i="data.json"),e.open("GET",i,!0);var s=!1;if(!this.isDomFree&&"response"in e&&"responseType"in e)try{e.responseType="json",s="json"===e.responseType}catch(t){s=!1}if(!s&&"responseType"in e)try{e.responseType="text"}catch(t){}if("overrideMimeType"in e)try{e.overrideMimeType("application/json; charset=utf-8")}catch(t){}this.isWindowsPhone8?e.onreadystatechange=function(){4===e.readyState&&t.loadProject(JSON.parse(e.responseText))}:(e.onload=function(){if(s)t.loadProject(e.response);else if(t.isEjecta){var i=e.responseText;i=i.substr(i.indexOf("{")),t.loadProject(JSON.parse(i))}else t.loadProject(JSON.parse(e.responseText))},e.onerror=function(t){cr.logerror("Error requesting "+i+":"),cr.logerror(t)}),e.send()}},e.prototype.initRendererAndLoader=function(){var t,e,i,s,n,r,o,a,h,c,l,u=this;this.isRetina=(!this.isDomFree||this.isEjecta||this.isCordova)&&this.useHighDpi&&!this.isAndroidStockBrowser,0===this.fullscreen_mode&&this.isiOS&&(this.isRetina=!1),this.devicePixelRatio=this.isRetina&&(window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||window.msDevicePixelRatio)||1,"object"==typeof window.StatusBar&&window.StatusBar.hide(),this.ClearDeathRow(),this.fullscreen_mode>0&&this.setSize(window.innerWidth,window.innerHeight,!0),this.canvas.addEventListener("webglcontextlost",function(t){t.preventDefault(),u.onContextLost(),cr.logexport("[Construct 2] WebGL context lost"),window.cr_setSuspended(!0)},!1),this.canvas.addEventListener("webglcontextrestored",function(t){u.glwrap.initState(),u.glwrap.setSize(u.glwrap.width,u.glwrap.height,!0),u.layer_tex=null,u.layout_tex=null,u.fx_tex[0]=null,u.fx_tex[1]=null,u.onContextRestored(),u.redraw=!0,cr.logexport("[Construct 2] WebGL context restored"),window.cr_setSuspended(!1)},!1);try{this.enableWebGL&&(this.isCocoonJs||this.isEjecta||!this.isDomFree)&&(l={alpha:!0,depth:!1,antialias:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0},this.isAndroid||(this.gl=this.canvas.getContext("webgl2",l)),this.gl||(this.gl=this.canvas.getContext("webgl",l)||this.canvas.getContext("experimental-webgl",l)))}catch(t){}if(this.gl){this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2");var p=this.gl.getExtension("WEBGL_debug_renderer_info");if(p){var d=this.gl.getParameter(p.UNMASKED_VENDOR_WEBGL),f=this.gl.getParameter(p.UNMASKED_RENDERER_WEBGL);this.glUnmaskedRenderer=f+" ["+d+"]"}for(this.enableFrontToBack&&(this.glUnmaskedRenderer+=" [front-to-back enabled]"),this.isDomFree||(this.overlay_canvas=document.createElement("canvas"),jQuery(this.overlay_canvas).appendTo(this.canvas.parentNode),this.overlay_canvas.oncontextmenu=function(t){return!1},this.overlay_canvas.onselectstart=function(t){return!1},this.overlay_canvas.width=Math.round(this.cssWidth*this.devicePixelRatio),this.overlay_canvas.height=Math.round(this.cssHeight*this.devicePixelRatio),jQuery(this.overlay_canvas).css({width:this.cssWidth+"px",height:this.cssHeight+"px"}),this.positionOverlayCanvas(),this.overlay_ctx=this.overlay_canvas.getContext("2d")),this.glwrap=new cr.GLWrap(this.gl,this.isMobile,this.enableFrontToBack),this.glwrap.setSize(this.canvas.width,this.canvas.height),this.glwrap.enable_mipmaps=0!==this.downscalingQuality,this.ctx=null,t=0,e=this.types_by_index.length;t<e;t++)for(i=0,s=(o=this.types_by_index[t]).effect_types.length;i<s;i++)(a=o.effect_types[i]).shaderindex=this.glwrap.getShaderIndex(a.id),a.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(a.shaderindex),this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(a.shaderindex);for(t=0,e=this.layouts_by_index.length;t<e;t++){for(i=0,s=(h=this.layouts_by_index[t]).effect_types.length;i<s;i++)(a=h.effect_types[i]).shaderindex=this.glwrap.getShaderIndex(a.id),a.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(a.shaderindex);for(h.updateActiveEffects(),i=0,s=h.layers.length;i<s;i++){for(n=0,r=(c=h.layers[i]).effect_types.length;n<r;n++)(a=c.effect_types[n]).shaderindex=this.glwrap.getShaderIndex(a.id),a.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(a.shaderindex),this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(a.shaderindex);c.updateActiveEffects()}}}else{if(this.fullscreen_mode>0&&this.isDirectCanvas){this.canvas=null,document.oncontextmenu=function(t){return!1},document.onselectstart=function(t){return!1},this.ctx=AppMobi.canvas.getContext("2d");try{this.ctx.samplingMode=this.linearSampling?"smooth":"sharp",this.ctx.globalScale=1,this.ctx.HTML5CompatibilityMode=!0,this.ctx.imageSmoothingEnabled=this.linearSampling}catch(t){}0!==this.width&&0!==this.height&&(this.ctx.width=this.width,this.ctx.height=this.height)}this.ctx||(this.isCocoonJs?(l={antialias:!!this.linearSampling,alpha:!0},this.ctx=this.canvas.getContext("2d",l)):(l={alpha:!0},this.ctx=this.canvas.getContext("2d",l)),this.setCtxImageSmoothingEnabled(this.ctx,this.linearSampling)),this.overlay_canvas=null,this.overlay_ctx=null}if(this.tickFunc=function(t){u.tick(!1,t)},window==window.top||this.isDomFree||this.isWinJS||this.isWindowsPhone8||(document.addEventListener("mousedown",function(){window.focus()},!0),document.addEventListener("touchstart",function(){window.focus()},!0)),"undefined"!=typeof cr_is_preview&&(this.isCocoonJs&&console.log("[Construct 2] In preview-over-wifi via CocoonJS mode"),window.location.search.indexOf("continuous")>-1&&(cr.logexport("Reloading for continuous preview"),this.loadFromSlot="__c2_continuouspreview",this.suspendDrawing=!0),this.pauseOnBlur&&!this.isMobile&&(jQuery(window).focus(function(){u.setSuspended(!1)}),jQuery(window).blur(function(){var t=window.parent;t&&t.document.hasFocus()||u.setSuspended(!0)}))),window.addEventListener("blur",function(){u.onWindowBlur()}),!this.isDomFree){var g=function(t){if(cr.isCanvasInputEvent(t)&&document.activeElement&&document.activeElement!==document.getElementsByTagName("body")[0]&&document.activeElement.blur)try{document.activeElement.blur()}catch(t){}};"undefined"!=typeof PointerEvent?document.addEventListener("pointerdown",g):window.navigator.msPointerEnabled?document.addEventListener("MSPointerDown",g):document.addEventListener("touchstart",g),document.addEventListener("mousedown",g)}0===this.fullscreen_mode&&this.isRetina&&this.devicePixelRatio>1&&this.setSize(this.original_width,this.original_height,!0),this.tryLockOrientation(),this.getready(),this.go(),this.extra={},cr.seal(this)};e.prototype.setSize=function(t,e,i){var s=0,n=0,r=0,o=0,a=0;if(this.lastWindowWidth!==t||this.lastWindowHeight!==e||i){this.lastWindowWidth=t,this.lastWindowHeight=e;var h,c,l=this.fullscreen_mode,u=(document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen||this.isNodeFullscreen)&&!this.isCordova;if(u||0!==this.fullscreen_mode||i){u&&(l=this.fullscreen_scaling);var p=this.devicePixelRatio;l>=4?(5===l&&1!==p&&(t+=1,e+=1),(c=t/e)>(h=this.original_width/this.original_height)?(r=e*h,5===l?((a=r*p/this.original_width)>1?a=Math.floor(a):a<1&&(a=1/Math.ceil(1/a)),s=(t-(r=this.original_width*a/p))/2,n=(e-(o=this.original_height*a/p))/2,t=r,e=o):(s=(t-r)/2,t=r)):(o=t/h,5===l?((a=o*p/this.original_height)>1?a=Math.floor(a):a<1&&(a=1/Math.ceil(1/a)),s=(t-(r=this.original_width*a/p))/2,n=(e-(o=this.original_height*a/p))/2,t=r,e=o):(n=(e-o)/2,e=o))):u&&0===l&&(s=Math.floor((t-this.original_width)/2),n=Math.floor((e-this.original_height)/2),t=this.original_width,e=this.original_height),l<2&&(this.aspect_scale=p),this.cssWidth=Math.round(t),this.cssHeight=Math.round(e),this.width=Math.round(t*p),this.height=Math.round(e*p),this.redraw=!0,this.wantFullscreenScalingQuality||this.width<this.original_width&&this.height<this.original_height||1===l?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):(this.draw_width=this.original_width,this.draw_height=this.original_height,this.fullscreenScalingQuality=!1,2===l?(h=this.original_width/this.original_height,(c=this.lastWindowWidth/this.lastWindowHeight)<h?this.draw_width=this.draw_height*c:c>h&&(this.draw_height=this.draw_width/c)):3===l&&(h=this.original_width/this.original_height,(c=this.lastWindowWidth/this.lastWindowHeight)>h?this.draw_width=this.draw_height*c:c<h&&(this.draw_height=this.draw_width/c))),this.canvasdiv&&!this.isDomFree&&(jQuery(this.canvasdiv).css({width:Math.round(t)+"px",height:Math.round(e)+"px","margin-left":Math.floor(s)+"px","margin-top":Math.floor(n)+"px"}),"undefined"!=typeof cr_is_preview&&jQuery("#borderwrap").css({width:Math.round(t)+"px",height:Math.round(e)+"px"})),this.canvas&&(this.canvas.width=Math.round(t*p),this.canvas.height=Math.round(e*p),this.isEjecta?(this.canvas.style.left=Math.floor(s)+"px",this.canvas.style.top=Math.floor(n)+"px",this.canvas.style.width=Math.round(t)+"px",this.canvas.style.height=Math.round(e)+"px"):this.isRetina&&!this.isDomFree&&(this.canvas.style.width=Math.round(t)+"px",this.canvas.style.height=Math.round(e)+"px")),this.overlay_canvas&&(this.overlay_canvas.width=Math.round(t*p),this.overlay_canvas.height=Math.round(e*p),this.overlay_canvas.style.width=this.cssWidth+"px",this.overlay_canvas.style.height=this.cssHeight+"px"),this.glwrap&&this.glwrap.setSize(Math.round(t*p),Math.round(e*p)),this.isDirectCanvas&&this.ctx&&(this.ctx.width=Math.round(t),this.ctx.height=Math.round(e)),this.ctx&&this.setCtxImageSmoothingEnabled(this.ctx,this.linearSampling),this.tryLockOrientation(),this.isiPhone&&!this.isCordova&&window.scrollTo(0,0)}}},e.prototype.tryLockOrientation=function(){if(this.autoLockOrientation&&0!==this.orientations){var t="portrait";2===this.orientations&&(t="landscape");try{screen.orientation&&screen.orientation.lock?screen.orientation.lock(t).catch(function(){}):screen.lockOrientation?screen.lockOrientation(t):screen.webkitLockOrientation?screen.webkitLockOrientation(t):screen.mozLockOrientation?screen.mozLockOrientation(t):screen.msLockOrientation&&screen.msLockOrientation(t)}catch(t){console&&console.warn&&console.warn("Failed to lock orientation: ",t)}}},e.prototype.onContextLost=function(){var t,e,i;for(this.glwrap.contextLost(),this.is_WebGL_context_lost=!0,t=0,e=this.types_by_index.length;t<e;t++)(i=this.types_by_index[t]).onLostWebGLContext&&i.onLostWebGLContext()},e.prototype.onContextRestored=function(){var t,e,i;for(this.is_WebGL_context_lost=!1,t=0,e=this.types_by_index.length;t<e;t++)(i=this.types_by_index[t]).onRestoreWebGLContext&&i.onRestoreWebGLContext()},e.prototype.positionOverlayCanvas=function(){if(!this.isDomFree){var t=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement||this.isNodeFullscreen)&&!this.isCordova?jQuery(this.canvas).offset():jQuery(this.canvas).position();t.position="absolute",jQuery(this.overlay_canvas).css(t)}};var i=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame;e.prototype.setSuspended=function(t){var e,s;if(t&&!this.isSuspended)for(cr.logexport("[Construct 2] Suspending"),this.isSuspended=!0,-1!==this.raf_id&&i&&i(this.raf_id),-1!==this.timeout_id&&clearTimeout(this.timeout_id),e=0,s=this.suspend_events.length;e<s;e++)this.suspend_events[e](!0);else if(!t&&this.isSuspended){for(cr.logexport("[Construct 2] Resuming"),this.isSuspended=!1,this.last_tick_time=cr.performance_now(),this.last_fps_time=cr.performance_now(),this.framecount=0,this.logictime=0,e=0,s=this.suspend_events.length;e<s;e++)this.suspend_events[e](!1);this.tick(!1)}},e.prototype.addSuspendCallback=function(t){this.suspend_events.push(t)},e.prototype.GetObjectReference=function(t){return this.objectRefTable[t]},e.prototype.loadProject=function(t){t&&t.project||cr.logerror("Project model unavailable");var e,i,s,n,r,o,a,h,c,l,u,p,d,f=t.project;if(this.name=f[0],this.first_layout=f[1],this.fullscreen_mode=f[12],this.fullscreen_mode_set=f[12],this.original_width=f[10],this.original_height=f[11],this.parallax_x_origin=this.original_width/2,this.parallax_y_origin=this.original_height/2,this.isDomFree&&!this.isEjecta&&(f[12]>=4||0===f[12])&&(cr.logexport("[Construct 2] Letterbox scale fullscreen modes are not supported on this platform - falling back to 'Scale outer'"),this.fullscreen_mode=3,this.fullscreen_mode_set=3),this.uses_loader_layout=f[18],this.loaderstyle=f[19],0===this.loaderstyle){var g=new Image;g.crossOrigin="anonymous",this.setImageSrc(g,"loading-logo.png"),this.loaderlogos={logo:g}}else if(4===this.loaderstyle){var m=new Image;m.src="";var y=new Image;y.src="";var _=new Image;_.src="";var v=new Image;v.src="";var b=new Image;b.src="";var w=new Image;w.src="";var x=new Image;x.src="";var S=new Image;S.src="";var T=new Image;T.src="";var C=new Image;C.src="";var O=new Image;O.src="";var k=new Image;k.src="",this.loaderlogos={logo:[m,y,_,v],powered:[b,w,x,S],website:[T,C,O,k]}}for(this.next_uid=f[21],this.objectRefTable=cr.getObjectRefTable(),this.system=new cr.system_object(this),e=0,i=f[2].length;e<i;e++)a=f[2][e],u=this.GetObjectReference(a[0]),cr.add_common_aces(a,u.prototype),(p=new u(this)).singleglobal=a[1],p.is_world=a[2],p.is_rotatable=a[5],p.must_predraw=a[9],p.onCreate&&p.onCreate(),cr.seal(p),this.plugins.push(p);for(this.objectRefTable=cr.getObjectRefTable(),e=0,i=f[3].length;e<i;e++){for(a=f[3][e],d=this.GetObjectReference(a[1]),p=null,s=0,n=this.plugins.length;s<n;s++)if(this.plugins[s]instanceof d){p=this.plugins[s];break}var A=new p.Type(p);for(A.name=a[0],A.is_family=a[2],A.instvar_sids=a[3].slice(0),A.vars_count=a[3].length,A.behs_count=a[4],A.fx_count=a[5],A.sid=a[11],A.is_family?(A.members=[],A.family_index=this.family_count++,A.families=null):(A.members=null,A.family_index=-1,A.families=[]),A.family_var_map=null,A.family_beh_map=null,A.family_fx_map=null,A.is_contained=!1,A.container=null,a[6]?(A.texture_file=a[6][0],A.texture_filesize=a[6][1],A.texture_pixelformat=a[6][2]):(A.texture_file=null,A.texture_filesize=0,A.texture_pixelformat=0),a[7]?A.animations=a[7]:A.animations=null,A.index=e,A.instances=[],A.deadCache=[],A.solstack=[new cr.selection(A)],A.cur_sol=0,A.default_instance=null,A.default_layerindex=0,A.stale_iids=!0,A.updateIIDs=cr.type_updateIIDs,A.getFirstPicked=cr.type_getFirstPicked,A.getPairedInstance=cr.type_getPairedInstance,A.getCurrentSol=cr.type_getCurrentSol,A.pushCleanSol=cr.type_pushCleanSol,A.pushCopySol=cr.type_pushCopySol,A.popSol=cr.type_popSol,A.getBehaviorByName=cr.type_getBehaviorByName,A.getBehaviorIndexByName=cr.type_getBehaviorIndexByName,A.getEffectIndexByName=cr.type_getEffectIndexByName,A.applySolToContainer=cr.type_applySolToContainer,A.getInstanceByIID=cr.type_getInstanceByIID,A.collision_grid=new cr.SparseGrid(this.original_width,this.original_height),A.any_cell_changed=!0,A.any_instance_parallaxed=!1,A.extra={},A.toString=cr.type_toString,A.behaviors=[],s=0,n=a[8].length;s<n;s++){h=a[8][s];var E=this.GetObjectReference(h[1]),I=null;for(r=0,o=this.behaviors.length;r<o;r++)if(this.behaviors[r]instanceof E){I=this.behaviors[r];break}I||((I=new E(this)).my_types=[],I.my_instances=new cr.ObjectSet,I.onCreate&&I.onCreate(),cr.seal(I),this.behaviors.push(I),cr.behaviors.solid&&I instanceof cr.behaviors.solid&&(this.solidBehavior=I),cr.behaviors.jumpthru&&I instanceof cr.behaviors.jumpthru&&(this.jumpthruBehavior=I),cr.behaviors.shadowcaster&&I instanceof cr.behaviors.shadowcaster&&(this.shadowcasterBehavior=I)),-1===I.my_types.indexOf(A)&&I.my_types.push(A);var P=new I.Type(I,A);P.name=h[0],P.sid=h[2],P.onCreate(),cr.seal(P),A.behaviors.push(P)}for(A.global=a[9],A.isOnLoaderLayout=a[10],A.effect_types=[],s=0,n=a[12].length;s<n;s++)A.effect_types.push({id:a[12][s][0],name:a[12][s][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:s});if(A.tile_poly_data=a[13],this.uses_loader_layout&&!A.is_family&&!A.isOnLoaderLayout&&p.is_world||(A.onCreate(),cr.seal(A)),A.name&&(this.types[A.name]=A),this.types_by_index.push(A),p.singleglobal){var M=new p.Instance(A);M.uid=this.next_uid++,M.puid=this.next_puid++,M.iid=0,M.get_iid=cr.inst_get_iid,M.toString=cr.inst_toString,M.properties=a[14],M.onCreate(),cr.seal(M),A.instances.push(M),this.objectsByUid[M.uid.toString()]=M}}for(e=0,i=f[4].length;e<i;e++){var F,L=f[4][e],D=this.types_by_index[L[0]];for(s=1,n=L.length;s<n;s++)(F=this.types_by_index[L[s]]).families.push(D),D.members.push(F)}for(e=0,i=f[28].length;e<i;e++){var R=f[28][e],B=[];for(s=0,n=R.length;s<n;s++)B.push(this.types_by_index[R[s]]);for(s=0,n=B.length;s<n;s++)B[s].is_contained=!0,B[s].container=B}if(this.family_count>0)for(e=0,i=this.types_by_index.length;e<i;e++)if(!(c=this.types_by_index[e]).is_family&&c.families.length){c.family_var_map=new Array(this.family_count),c.family_beh_map=new Array(this.family_count),c.family_fx_map=new Array(this.family_count);var j=[],N=0,V=0,X=0;for(s=0,n=c.families.length;s<n;s++)for(l=c.families[s],c.family_var_map[l.family_index]=N,N+=l.vars_count,c.family_beh_map[l.family_index]=V,V+=l.behs_count,c.family_fx_map[l.family_index]=X,X+=l.fx_count,r=0,o=l.effect_types.length;r<o;r++)j.push(cr.shallowCopy({},l.effect_types[r]));for(c.effect_types=j.concat(c.effect_types),s=0,n=c.effect_types.length;s<n;s++)c.effect_types[s].index=s}for(e=0,i=f[5].length;e<i;e++){a=f[5][e];var G=new cr.layout(this,a);cr.seal(G),this.layouts[G.name]=G,this.layouts_by_index.push(G)}for(e=0,i=f[6].length;e<i;e++){a=f[6][e];var W=new cr.eventsheet(this,a);cr.seal(W),this.eventsheets[W.name]=W,this.eventsheets_by_index.push(W)}for(e=0,i=this.eventsheets_by_index.length;e<i;e++)this.eventsheets_by_index[e].postInit();for(e=0,i=this.eventsheets_by_index.length;e<i;e++)this.eventsheets_by_index[e].updateDeepIncludes();for(e=0,i=this.triggers_to_postinit.length;e<i;e++)this.triggers_to_postinit[e].postInit();cr.clearArray(this.triggers_to_postinit),this.audio_to_preload=f[7],this.files_subfolder=f[8],this.pixel_rounding=f[9],this.aspect_scale=1,this.enableWebGL=f[13],this.linearSampling=f[14],this.clearBackground=f[15],this.versionstr=f[16],this.useHighDpi=f[17],this.orientations=f[20],this.autoLockOrientation=this.orientations>0,this.pauseOnBlur=f[22],this.wantFullscreenScalingQuality=f[23],this.fullscreenScalingQuality=this.wantFullscreenScalingQuality,this.downscalingQuality=f[24],this.preloadSounds=f[25],this.projectName=f[26],this.enableFrontToBack=f[27]&&!this.isIE,this.start_time=Date.now(),cr.clearArray(this.objectRefTable),this.initRendererAndLoader()};var s=!1,n=0,r=[];e.prototype.queueImageLoad=function(t,e){var i=this,s=function(){n--,i.maybeLoadNextImages()};t.addEventListener("load",s),t.addEventListener("error",s),r.push([t,e]),this.maybeLoadNextImages()},e.prototype.maybeLoadNextImages=function(){for(var t;r.length&&n<100;)n++,t=r.shift(),this.setImageSrc(t[0],t[1])},e.prototype.waitForImageLoad=function(t,e){t.cocoonLazyLoad=!0,t.onerror=function(e){t.c2error=!0,s=!0,console&&console.error&&console.error("Error loading image '"+t.src+"': ",e)},this.isEjecta?t.src=e:t.src||("undefined"!=typeof XAPKReader?XAPKReader.get(e,function(e){t.src=e},function(i){t.c2error=!0,s=!0,console&&console.error&&console.error("Error extracting image '"+e+"' from expansion file: ",i)}):(t.crossOrigin="anonymous",this.queueImageLoad(t,e))),this.wait_for_textures.push(t)},e.prototype.findWaitingTexture=function(t){var e,i;for(e=0,i=this.wait_for_textures.length;e<i;e++)if(this.wait_for_textures[e].cr_src===t)return this.wait_for_textures[e];return null};var o=0,a=!1;e.prototype.getready=function(){this.audioInstance&&(o=this.audioInstance.setPreloadList(this.audio_to_preload))},e.prototype.areAllTexturesAndSoundsLoaded=function(){var t,e,i,s=o,n=0,r=0,h=!0;for(t=0,e=this.wait_for_textures.length;t<e;t++){var c=(i=this.wait_for_textures[t]).cr_filesize;(!c||c<=0)&&(c=5e4),s+=c,i.src&&(i.complete||i.loaded)&&!i.c2error?n+=c:h=!1}return h&&this.preloadSounds&&this.audioInstance&&(a||(this.audioInstance.startPreloads(),a=!0),n+=r=this.audioInstance.getPreloadedSize(),r<o&&(h=!1)),this.progress=0==s?1:n/s,h};var h=!1;e.prototype.go=function(){if(this.ctx||this.glwrap){var e=this.ctx||this.overlay_ctx;this.overlay_canvas&&this.positionOverlayCanvas();var i=window.innerWidth,n=window.innerHeight;this.lastWindowWidth===i&&this.lastWindowHeight===n||this.setSize(i,n),this.progress=0,this.last_progress=-1;var r=this;if(this.areAllTexturesAndSoundsLoaded()&&(4!==this.loaderstyle||h))this.go_loading_finished();else{var o=Date.now()-this.start_time;if(e){var a=this.width,c=this.height,l=this.devicePixelRatio;if(this.loaderstyle<3&&(this.isCocoonJs||o>=500&&this.last_progress!=this.progress)){e.clearRect(0,0,a,c);var u,p=a/2,d=c/2,f=0===this.loaderstyle&&this.loaderlogos.logo.complete,g=40*l,m=0,y=80*l;if(f){var _=this.loaderlogos.logo;g=(y=_.width*l)/2,m=(u=_.height*l)/2,e.drawImage(_,cr.floor(p-g),cr.floor(d-m),y,u)}if(this.loaderstyle<=1)d+=m+(f?12*l:0),p-=g,p=cr.floor(p)+.5,d=cr.floor(d)+.5,e.fillStyle=s?"red":"DodgerBlue",e.fillRect(p,d,Math.floor(y*this.progress),6*l),e.strokeStyle="black",e.strokeRect(p,d,y,6*l),e.strokeStyle="white",e.strokeRect(p-1*l,d-1*l,y+2*l,8*l);else if(2===this.loaderstyle){e.font=this.isEjecta?"12pt ArialMT":"12pt Arial",e.fillStyle=s?"#f00":"#999",e.textBaseLine="middle";var v=Math.round(100*this.progress)+"%",b=e.measureText?e.measureText(v):null,w=b?b.width:0;e.fillText(v,p-w/2,d)}this.last_progress=this.progress}else if(4===this.loaderstyle)return this.draw_c2_splash_loader(e),void(t?t(function(){r.go()}):setTimeout(function(){r.go()},16))}setTimeout(function(){r.go()},this.isCocoonJs?10:100)}}};var c=-1,l="undefined"==typeof cr_is_preview?200:0,u=!0,p=!1,d=0,f=0,g="undefined"==typeof cr_is_preview?3e3:0,m=null,y=null,_=0;function v(t,e){return e<=128?t[3]:e<=256?t[2]:e<=512?t[1]:t[0]}e.prototype.draw_c2_splash_loader=function(t){if(!h){for(var e=Math.ceil(this.width),i=Math.ceil(this.height),n=(this.devicePixelRatio,this.loaderlogos.logo),r=this.loaderlogos.powered,o=this.loaderlogos.website,a=0;a<4;++a)if(!n[a].complete||!r[a].complete||!o[a].complete)return;0===_&&(c=Date.now());var b,w,x=Date.now(),S=!1,T=t;u||p?(t.clearRect(0,0,e,i),function(t,e){m&&m.width===t&&m.height===e||((m=document.createElement("canvas")).width=t,m.height=e,y=m.getContext("2d"))}(e,i),T=y,S=!0,u&&1===_&&(c=Date.now())):t.globalAlpha=1,T.fillStyle="#333333",T.fillRect(0,0,e,i),this.cssHeight>256?(w=.25*(b=cr.clamp(.22*i,105,.6*e)),T.drawImage(v(r,b),.5*e-b/2,.2*i-w/2,b,w),w=b=Math.min(.395*i,.95*e),T.drawImage(v(n,b),.5*e-b/2,.485*i-w/2,b,w),w=.25*(b=cr.clamp(.22*i,105,.6*e)),T.drawImage(v(o,b),.5*e-b/2,.868*i-w/2,b,w),T.fillStyle="#3C3C3C",b=e,w=Math.max(.005*i,2),T.fillRect(0,.8*i-w/2,b,w),T.fillStyle=s?"red":"#E0FF65",b=e*this.progress,T.fillRect(.5*e-b/2,.8*i-w/2,b,w)):(w=b=.55*i,T.drawImage(v(n,b),.5*e-b/2,.45*i-w/2,b,w),T.fillStyle="#3C3C3C",b=e,w=Math.max(.005*i,2),T.fillRect(0,.85*i-w/2,b,w),T.fillStyle=s?"red":"#E0FF65",b=e*this.progress,T.fillRect(.5*e-b/2,.85*i-w/2,b,w)),S&&(u?t.globalAlpha=0===_?0:Math.min((x-c)/300,1):p&&(t.globalAlpha=Math.max(1-(x-f)/300,0)),t.drawImage(m,0,0,e,i)),u&&x-c>=300&&_>=2&&(u=!1,d=x),!u&&x-d>=g&&!p&&this.progress>=1&&(p=!0,f=x),(p&&x-f>=300+l||"undefined"!=typeof cr_is_preview&&this.progress>=1&&Date.now()-c<500)&&(h=!0,u=!1,p=!1,m=null,y=null,this.loaderlogos=null),++_}},e.prototype.go_loading_finished=function(){var t,e,i;if(this.overlay_canvas&&(this.canvas.parentNode.removeChild(this.overlay_canvas),this.overlay_ctx=null,this.overlay_canvas=null),this.start_time=Date.now(),this.last_fps_time=cr.performance_now(),this.uses_loader_layout)for(t=0,e=this.types_by_index.length;t<e;t++)(i=this.types_by_index[t]).is_family||i.isOnLoaderLayout||!i.plugin.is_world||(i.onCreate(),cr.seal(i));else this.isloading=!1;for(t=0,e=this.layouts_by_index.length;t<e;t++)this.layouts_by_index[t].createGlobalNonWorlds();if(this.fullscreen_mode>=2){var s=this.original_width/this.original_height,n=this.width/this.height;2!==this.fullscreen_mode&&n>s||2===this.fullscreen_mode&&n<s?this.aspect_scale=this.height/this.original_height:this.aspect_scale=this.width/this.original_width}for(this.first_layout?this.layouts[this.first_layout].startRunning():this.layouts_by_index[0].startRunning(),this.uses_loader_layout||(this.loadingprogress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null),window.C2_RegisterSW&&window.C2_RegisterSW()),navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide(),t=0,e=this.types_by_index.length;t<e;t++)(i=this.types_by_index[t]).onAppBegin&&i.onAppBegin();document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?window.cr_setSuspended(!0):this.tick(!1),this.isDirectCanvas&&AppMobi.webview.execute("onGameReady();")},e.prototype.tick=function(e,i,s){if(this.running_layout){var n=cr.performance_now(),r=n;if(s||!this.isSuspended||e){e||(t?this.raf_id=t(this.tickFunc):this.timeout_id=setTimeout(this.tickFunc,this.isMobile?1:16));var o=i||n,a=this.fullscreen_mode,h=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement)&&!this.isCordova;if((h||this.isNodeFullscreen)&&this.fullscreen_scaling>0&&(a=this.fullscreen_scaling),a>0){var c=window.innerWidth,l=window.innerHeight;this.lastWindowWidth===c&&this.lastWindowHeight===l||this.setSize(c,l)}if(this.isDomFree||(h?this.firstInFullscreen||(this.firstInFullscreen=!0):this.firstInFullscreen?(this.firstInFullscreen=!1,0===this.fullscreen_mode&&this.setSize(Math.round(this.oldWidth/this.devicePixelRatio),Math.round(this.oldHeight/this.devicePixelRatio),!0)):(this.oldWidth=this.width,this.oldHeight=this.height)),this.isloading){var u=this.areAllTexturesAndSoundsLoaded();this.loadingprogress=this.progress,u&&(this.isloading=!1,this.progress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null),window.C2_RegisterSW&&window.C2_RegisterSW())}this.logic(o),!this.redraw&&!this.isCocoonJs||this.is_WebGL_context_lost||this.suspendDrawing||e||(this.redraw=!1,this.glwrap?this.drawGL():this.draw(),this.snapshotCanvas&&(this.canvas&&this.canvas.toDataURL&&(this.snapshotData=this.canvas.toDataURL(this.snapshotCanvas[0],this.snapshotCanvas[1]),window.cr_onSnapshot&&window.cr_onSnapshot(this.snapshotData),this.trigger(cr.system_object.prototype.cnds.OnCanvasSnapshot,null)),this.snapshotCanvas=null)),this.hit_breakpoint||(this.tickcount++,this.tickcount_nosave++,this.execcount++,this.framecount++),this.logictime+=cr.performance_now()-r}}},e.prototype.logic=function(t){var e,i,s,n,r,o,a,h;t-this.last_fps_time>=1e3&&(this.last_fps_time+=1e3,t-this.last_fps_time>=1e3&&(this.last_fps_time=t),this.fps=this.framecount,this.framecount=0,this.cpuutilisation=this.logictime,this.logictime=0);var c=0;if(0!==this.last_tick_time){var l=t-this.last_tick_time;l<0&&(l=0),c=l/1e3,this.dt1=c,this.dt1>.5?this.dt1=0:this.dt1>1/this.minimumFramerate&&(this.dt1=1/this.minimumFramerate)}this.last_tick_time=t,this.dt=this.dt1*this.timescale,this.kahanTime.add(this.dt),this.wallTime.add(c);var u=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement||this.isNodeFullscreen)&&!this.isCordova;if(this.fullscreen_mode>=2||u&&this.fullscreen_scaling>0){var p=this.original_width/this.original_height,d=this.width/this.height,f=this.fullscreen_mode;u&&this.fullscreen_scaling>0&&(f=this.fullscreen_scaling),this.aspect_scale=2!==f&&d>p||2===f&&d<p?this.height/this.original_height:this.width/this.original_width,this.running_layout&&(this.running_layout.scrollToX(this.running_layout.scrollX),this.running_layout.scrollToY(this.running_layout.scrollY))}else this.aspect_scale=this.isRetina?this.devicePixelRatio:1;this.ClearDeathRow(),this.isInOnDestroy++,this.system.runWaits(),this.isInOnDestroy--,this.ClearDeathRow(),this.isInOnDestroy++;var g=this.objects_to_pretick.valuesRef();for(e=0,i=g.length;e<i;e++)g[e].pretick();for(e=0,i=this.types_by_index.length;e<i;e++)if(!(a=this.types_by_index[e]).is_family&&(a.behaviors.length||a.families.length))for(s=0,n=a.instances.length;s<n;s++)for(r=0,o=(m=a.instances[s]).behavior_insts.length;r<o;r++)m.behavior_insts[r].tick();for(e=0,i=this.types_by_index.length;e<i;e++)if(!(a=this.types_by_index[e]).is_family&&(a.behaviors.length||a.families.length))for(s=0,n=a.instances.length;s<n;s++)for(r=0,o=(m=a.instances[s]).behavior_insts.length;r<o;r++)(h=m.behavior_insts[r]).posttick&&h.posttick();for(e=0,i=(g=this.objects_to_tick.valuesRef()).length;e<i;e++)g[e].tick();for(this.isInOnDestroy--,this.handleSaveLoad(),e=0;this.changelayout&&e++<10;)this.doChangeLayout(this.changelayout);for(e=0,i=this.eventsheets_by_index.length;e<i;e++)this.eventsheets_by_index[e].hasRun=!1;for(this.running_layout.event_sheet&&this.running_layout.event_sheet.run(),cr.clearArray(this.registered_collisions),this.layout_first_tick=!1,this.isInOnDestroy++,e=0,i=this.types_by_index.length;e<i;e++)if(!(a=this.types_by_index[e]).is_family&&(a.behaviors.length||a.families.length))for(s=0,n=a.instances.length;s<n;s++){var m;for(r=0,o=(m=a.instances[s]).behavior_insts.length;r<o;r++)(h=m.behavior_insts[r]).tick2&&h.tick2()}for(e=0,i=(g=this.objects_to_tick2.valuesRef()).length;e<i;e++)g[e].tick2();this.isInOnDestroy--},e.prototype.onWindowBlur=function(){var t,e,i,s,n,r,o,a,h;for(t=0,e=this.types_by_index.length;t<e;t++)if(!(o=this.types_by_index[t]).is_family)for(i=0,s=o.instances.length;i<s;i++)if((a=o.instances[i]).onWindowBlur&&a.onWindowBlur(),a.behavior_insts)for(n=0,r=a.behavior_insts.length;n<r;n++)(h=a.behavior_insts[n]).onWindowBlur&&h.onWindowBlur()},e.prototype.doChangeLayout=function(t){var e,i,s,n=this.running_layout;if(this.running_layout.stopRunning(),this.glwrap)for(e=0,i=this.types_by_index.length;e<i;e++)(s=this.types_by_index[e]).is_family||!s.unloadTextures||s.global&&0!==s.instances.length||-1!==t.initial_types.indexOf(s)||s.unloadTextures();n==t&&cr.clearArray(this.system.waits),cr.clearArray(this.registered_collisions),this.runLayoutChangeMethods(!0),t.startRunning(),this.runLayoutChangeMethods(!1),this.redraw=!0,this.layout_first_tick=!0,this.ClearDeathRow()},e.prototype.runLayoutChangeMethods=function(t){var e,i,s,n,r,o,a,h,c,l;for(e=0,i=this.behaviors.length;e<i;e++)s=this.behaviors[e],t?s.onBeforeLayoutChange&&s.onBeforeLayoutChange():s.onLayoutChange&&s.onLayoutChange();for(e=0,i=this.types_by_index.length;e<i;e++)if((n=this.types_by_index[e]).global||n.plugin.singleglobal)for(r=0,o=n.instances.length;r<o;r++)if(a=n.instances[r],t?a.onBeforeLayoutChange&&a.onBeforeLayoutChange():a.onLayoutChange&&a.onLayoutChange(),a.behavior_insts)for(h=0,c=a.behavior_insts.length;h<c;h++)l=a.behavior_insts[h],t?l.onBeforeLayoutChange&&l.onBeforeLayoutChange():l.onLayoutChange&&l.onLayoutChange()},e.prototype.pretickMe=function(t){this.objects_to_pretick.add(t)},e.prototype.unpretickMe=function(t){this.objects_to_pretick.remove(t)},e.prototype.tickMe=function(t){this.objects_to_tick.add(t)},e.prototype.untickMe=function(t){this.objects_to_tick.remove(t)},e.prototype.tick2Me=function(t){this.objects_to_tick2.add(t)},e.prototype.untick2Me=function(t){this.objects_to_tick2.remove(t)},e.prototype.getDt=function(t){return t&&-1!==t.my_timescale?this.dt1*t.my_timescale:this.dt},e.prototype.draw=function(){this.running_layout.draw(this.ctx),this.isDirectCanvas&&this.ctx.present()},e.prototype.drawGL=function(){this.enableFrontToBack&&(this.earlyz_index=1,this.running_layout.drawGL_earlyZPass(this.glwrap)),this.running_layout.drawGL(this.glwrap),this.glwrap.present()},e.prototype.addDestroyCallback=function(t){t&&this.destroycallbacks.push(t)},e.prototype.removeDestroyCallback=function(t){cr.arrayFindRemove(this.destroycallbacks,t)},e.prototype.getObjectByUID=function(t){var e=t.toString();return this.objectsByUid.hasOwnProperty(e)?this.objectsByUid[e]:null};var b=[];e.prototype.DestroyInstance=function(t){var e,i,s=t.type.name,n=null;if(this.deathRow.hasOwnProperty(s)){if((n=this.deathRow[s]).contains(t))return}else n=b.length?b.pop():new cr.ObjectSet,this.deathRow[s]=n;if(n.add(t),this.hasPendingInstances=!0,t.is_contained)for(e=0,i=t.siblings.length;e<i;e++)this.DestroyInstance(t.siblings[e]);this.isInClearDeathRow&&n.values_cache.push(t),this.isEndingLayout||(this.isInOnDestroy++,this.trigger(Object.getPrototypeOf(t.type.plugin).cnds.OnDestroyed,t),this.isInOnDestroy--)},e.prototype.ClearDeathRow=function(){if(this.hasPendingInstances){var t,e,i,s,n,r;for(this.isInClearDeathRow=!0,i=0,n=this.createRow.length;i<n;++i)for((e=(t=this.createRow[i]).type).instances.push(t),s=0,r=e.families.length;s<r;++s)e.families[s].instances.push(t),e.families[s].stale_iids=!0;cr.clearArray(this.createRow),this.IterateDeathRow(),cr.wipe(this.deathRow),this.isInClearDeathRow=!1,this.hasPendingInstances=!1}},e.prototype.IterateDeathRow=function(){for(var t in this.deathRow)this.deathRow.hasOwnProperty(t)&&this.ClearDeathRowForType(this.deathRow[t])},e.prototype.ClearDeathRowForType=function(t){var e,i,s,n,r,o,a,h,c=t.valuesRef(),l=c[0].type;for(cr.arrayRemoveAllFromObjectSet(l.instances,t),l.stale_iids=!0,0===l.instances.length&&(l.any_instance_parallaxed=!1),e=0,i=l.families.length;e<i;++e)o=l.families[e],cr.arrayRemoveAllFromObjectSet(o.instances,t),o.stale_iids=!0;for(e=0,i=this.system.waits.length;e<i;++e)if((r=this.system.waits[e]).sols.hasOwnProperty(l.index)&&cr.arrayRemoveAllFromObjectSet(r.sols[l.index].insts,t),!l.is_family)for(s=0,n=l.families.length;s<n;++s)o=l.families[s],r.sols.hasOwnProperty(o.index)&&cr.arrayRemoveAllFromObjectSet(r.sols[o.index].insts,t);var u,p=c[0].layer;if(p){if(p.useRenderCells)for(e=0,i=(a=p.instances).length;e<i;++e)h=a[e],t.contains(h)&&(h.update_bbox(),p.render_grid.update(h,h.rendercells,null),h.rendercells.set(0,0,-1,-1));cr.arrayRemoveAllFromObjectSet(p.instances,t),p.setZIndicesStaleFrom(0)}for(e=0;e<c.length;++e)this.ClearDeathRowForSingleInstance(c[e],l);(u=t).clear(),b.push(u),this.redraw=!0},e.prototype.ClearDeathRowForSingleInstance=function(t,e){var i,s,n;for(i=0,s=this.destroycallbacks.length;i<s;++i)this.destroycallbacks[i](t);t.collcells&&e.collision_grid.update(t,t.collcells,null);var r=t.layer;if(r&&r.removeFromInstanceList(t,!0),t.behavior_insts)for(i=0,s=t.behavior_insts.length;i<s;++i)(n=t.behavior_insts[i]).onDestroy&&n.onDestroy(),n.behavior.my_instances.remove(t);this.objects_to_pretick.remove(t),this.objects_to_tick.remove(t),this.objects_to_tick2.remove(t),t.onDestroy&&t.onDestroy(),this.objectsByUid.hasOwnProperty(t.uid.toString())&&delete this.objectsByUid[t.uid.toString()],this.objectcount--,e.deadCache.length<100&&e.deadCache.push(t)},e.prototype.createInstance=function(t,e,i,s){if(t.is_family){var n=cr.floor(Math.random()*t.members.length);return this.createInstance(t.members[n],e,i,s)}return t.default_instance?this.createInstanceFromInit(t.default_instance,e,!1,i,s,!1):null};var w=[];e.prototype.createInstanceFromInit=function(t,e,i,s,n,r){var o,a,h,c,l;if(!t)return null;var u=this.types_by_index[t[1]],p=u.plugin.is_world;if(this.isloading&&p&&!u.isOnLoaderLayout)return null;if(p&&!this.glwrap&&11===t[0][11])return null;var d,f=e;for(p||(e=null),u.deadCache.length?((d=u.deadCache.pop()).recycled=!0,u.plugin.Instance.call(d,u)):(d=new u.plugin.Instance(u)).recycled=!1,!i||r||this.objectsByUid.hasOwnProperty(t[2].toString())?d.uid=this.next_uid++:d.uid=t[2],this.objectsByUid[d.uid.toString()]=d,d.puid=this.next_puid++,d.iid=u.instances.length,o=0,a=this.createRow.length;o<a;++o)this.createRow[o].type===u&&d.iid++;d.get_iid=cr.inst_get_iid,d.toString=cr.inst_toString;var g,m=t[3];if(d.recycled)cr.wipe(d.extra);else{if(d.extra={},"undefined"!=typeof cr_is_preview)for(d.instance_var_names=[],d.instance_var_names.length=m.length,o=0,a=m.length;o<a;o++)d.instance_var_names[o]=m[o][1];d.instance_vars=[],d.instance_vars.length=m.length}for(o=0,a=m.length;o<a;o++)d.instance_vars[o]=m[o][0];if(p){var y=t[0];if(d.x=cr.is_undefined(s)?y[0]:s,d.y=cr.is_undefined(n)?y[1]:n,d.z=y[2],d.width=y[3],d.height=y[4],d.depth=y[5],d.angle=y[6],d.opacity=y[7],d.hotspotX=y[8],d.hotspotY=y[9],d.blend_mode=y[10],l=y[11],!this.glwrap&&u.effect_types.length&&(d.blend_mode=l),d.compositeOp=cr.effectToCompositeOp(d.blend_mode),this.gl&&cr.setGLBlend(d,d.blend_mode,this.gl),d.recycled){for(o=0,a=y[12].length;o<a;o++)for(h=0,c=y[12][o].length;h<c;h++)d.effect_params[o][h]=y[12][o][h];d.bbox.set(0,0,0,0),d.collcells.set(0,0,-1,-1),d.rendercells.set(0,0,-1,-1),d.bquad.set_from_rect(d.bbox),cr.clearArray(d.bbox_changed_callbacks)}else{for(d.effect_params=y[12].slice(0),o=0,a=d.effect_params.length;o<a;o++)d.effect_params[o]=y[12][o].slice(0);d.active_effect_types=[],d.active_effect_flags=[],d.active_effect_flags.length=u.effect_types.length,d.bbox=new cr.rect(0,0,0,0),d.collcells=new cr.rect(0,0,-1,-1),d.rendercells=new cr.rect(0,0,-1,-1),d.bquad=new cr.quad,d.bbox_changed_callbacks=[],d.set_bbox_changed=cr.set_bbox_changed,d.add_bbox_changed_callback=cr.add_bbox_changed_callback,d.contains_pt=cr.inst_contains_pt,d.update_bbox=cr.update_bbox,d.update_render_cell=cr.update_render_cell,d.update_collision_cell=cr.update_collision_cell,d.get_zindex=cr.inst_get_zindex}for(d.tilemap_exists=!1,d.tilemap_width=0,d.tilemap_height=0,d.tilemap_data=null,14===y.length&&(d.tilemap_exists=!0,d.tilemap_width=y[13][0],d.tilemap_height=y[13][1],d.tilemap_data=y[13][2]),o=0,a=u.effect_types.length;o<a;o++)d.active_effect_flags[o]=!0;d.shaders_preserve_opaqueness=!0,d.updateActiveEffects=cr.inst_updateActiveEffects,d.updateActiveEffects(),d.uses_shaders=!!d.active_effect_types.length,d.bbox_changed=!0,d.cell_changed=!0,u.any_cell_changed=!0,d.visible=!0,d.my_timescale=-1,d.layer=e,d.zindex=e.instances.length,d.earlyz_index=0,void 0===d.collision_poly&&(d.collision_poly=null),d.collisionsEnabled=!0,this.redraw=!0}for(cr.clearArray(w),o=0,a=u.families.length;o<a;o++)w.push.apply(w,u.families[o].behaviors);if(w.push.apply(w,u.behaviors),d.recycled)for(o=0,a=w.length;o<a;o++){var _=w[o];for((v=d.behavior_insts[o]).recycled=!0,_.behavior.Instance.call(v,_,d),h=0,c=(g=t[4][o]).length;h<c;h++)v.properties[h]=g[h];v.onCreate(),_.behavior.my_instances.add(d)}else for(d.behavior_insts=[],o=0,a=w.length;o<a;o++){var v;(v=new(_=w[o]).behavior.Instance(_,d)).recycled=!1,v.properties=t[4][o].slice(0),v.onCreate(),cr.seal(v),d.behavior_insts.push(v),_.behavior.my_instances.add(d)}if(g=t[5],d.recycled)for(o=0,a=g.length;o<a;o++)d.properties[o]=g[o];else d.properties=g.slice(0);if(this.createRow.push(d),this.hasPendingInstances=!0,e&&(e.appendToInstanceList(d,!0),1===e.parallaxX&&1===e.parallaxY||(u.any_instance_parallaxed=!0)),this.objectcount++,u.is_contained){if(d.is_contained=!0,d.recycled?cr.clearArray(d.siblings):d.siblings=[],!i&&!r){for(o=0,a=u.container.length;o<a;o++)if(u.container[o]!==u){if(!u.container[o].default_instance)return null;d.siblings.push(this.createInstanceFromInit(u.container[o].default_instance,f,!1,p?d.x:s,p?d.y:n,!0))}for(o=0,a=d.siblings.length;o<a;o++)for(d.siblings[o].siblings.push(d),h=0;h<a;h++)o!==h&&d.siblings[o].siblings.push(d.siblings[h])}}else d.is_contained=!1,d.siblings=null;for(d.onCreate(),d.recycled||cr.seal(d),o=0,a=d.behavior_insts.length;o<a;o++)d.behavior_insts[o].postCreate&&d.behavior_insts[o].postCreate();return d},e.prototype.getLayerByName=function(t){var e,i;for(e=0,i=this.running_layout.layers.length;e<i;e++){var s=this.running_layout.layers[e];if(cr.equals_nocase(s.name,t))return s}return null},e.prototype.getLayerByNumber=function(t){return(t=cr.floor(t))<0&&(t=0),t>=this.running_layout.layers.length&&(t=this.running_layout.layers.length-1),this.running_layout.layers[t]},e.prototype.getLayer=function(t){return cr.is_number(t)?this.getLayerByNumber(t):this.getLayerByName(t.toString())},e.prototype.clearSol=function(t){var e,i;for(e=0,i=t.length;e<i;e++)t[e].getCurrentSol().select_all=!0},e.prototype.pushCleanSol=function(t){var e,i;for(e=0,i=t.length;e<i;e++)t[e].pushCleanSol()},e.prototype.pushCopySol=function(t){var e,i;for(e=0,i=t.length;e<i;e++)t[e].pushCopySol()},e.prototype.popSol=function(t){var e,i;for(e=0,i=t.length;e<i;e++)t[e].popSol()},e.prototype.updateAllCells=function(t){if(t.any_cell_changed){var e,i,s=t.instances;for(e=0,i=s.length;e<i;++e)s[e].update_collision_cell();var n=this.createRow;for(e=0,i=n.length;e<i;++e)n[e].type===t&&n[e].update_collision_cell();t.any_cell_changed=!1}},e.prototype.getCollisionCandidates=function(t,e,i,s){var n,r,o,a=!!t&&(1!==t.parallaxX||1!==t.parallaxY);if(e.is_family)for(n=0,r=e.members.length;n<r;++n)o=e.members[n],a||o.any_instance_parallaxed?cr.appendArray(s,o.instances):(this.updateAllCells(o),o.collision_grid.queryRange(i,s));else a||e.any_instance_parallaxed?cr.appendArray(s,e.instances):(this.updateAllCells(e),e.collision_grid.queryRange(i,s))},e.prototype.getTypesCollisionCandidates=function(t,e,i,s){var n,r;for(n=0,r=e.length;n<r;++n)this.getCollisionCandidates(t,e[n],i,s)},e.prototype.getSolidCollisionCandidates=function(t,e,i){var s=this.getSolidBehavior();if(!s)return null;this.getTypesCollisionCandidates(t,s.my_types,e,i)},e.prototype.getJumpthruCollisionCandidates=function(t,e,i){var s=this.getJumpthruBehavior();if(!s)return null;this.getTypesCollisionCandidates(t,s.my_types,e,i)},e.prototype.testAndSelectCanvasPointOverlap=function(t,e,i,s){var n,r,o,a,h,c,l,u=t.getCurrentSol(),p=this.getCurrentEventStack().current_event.orblock;if(u.select_all)for(s||(u.select_all=!1,cr.clearArray(u.instances)),n=0,a=t.instances.length;n<a;n++)if((o=t.instances[n]).update_bbox(),h=o.layer.canvasToLayer(e,i,!0),c=o.layer.canvasToLayer(e,i,!1),o.contains_pt(h,c)){if(s)return!1;u.instances.push(o)}else p&&u.else_instances.push(o);else{for(r=0,n=0,a=(l=p?u.else_instances:u.instances).length;n<a;n++)if((o=l[n]).update_bbox(),h=o.layer.canvasToLayer(e,i,!0),c=o.layer.canvasToLayer(e,i,!1),o.contains_pt(h,c)){if(s)return!1;p?u.instances.push(o):(u.instances[r]=u.instances[n],r++)}s||(l.length=r)}return t.applySolToContainer(),!!s||u.hasObjects()},e.prototype.testOverlap=function(t,e){if(!(t&&e&&t!==e&&t.collisionsEnabled&&e.collisionsEnabled))return!1;t.update_bbox(),e.update_bbox();var i,s,n,r,o,a,h,c,l,u,p=t.layer,d=e.layer;if(p!==d&&(p.parallaxX!==d.parallaxX||d.parallaxY!=d.parallaxY||p.scale!==d.scale||p.angle!==d.angle||p.zoomRate!==d.zoomRate)){for(h=t.collision_poly&&!t.collision_poly.is_empty(),c=e.collision_poly&&!e.collision_poly.is_empty(),h?(t.collision_poly.cache_poly(t.width,t.height,t.angle),this.temp_poly.set_from_poly(t.collision_poly)):this.temp_poly.set_from_quad(t.bquad,t.x,t.y,t.width,t.height),l=this.temp_poly,c?(e.collision_poly.cache_poly(e.width,e.height,e.angle),this.temp_poly2.set_from_poly(e.collision_poly)):this.temp_poly2.set_from_quad(e.bquad,e.x,e.y,e.width,e.height),u=this.temp_poly2,i=0,s=l.pts_count;i<s;i++)r=(n=2*i)+1,o=l.pts_cache[n],a=l.pts_cache[r],l.pts_cache[n]=p.layerToCanvas(o+t.x,a+t.y,!0),l.pts_cache[r]=p.layerToCanvas(o+t.x,a+t.y,!1);for(l.update_bbox(),i=0,s=u.pts_count;i<s;i++)r=(n=2*i)+1,o=u.pts_cache[n],a=u.pts_cache[r],u.pts_cache[n]=d.layerToCanvas(o+e.x,a+e.y,!0),u.pts_cache[r]=d.layerToCanvas(o+e.x,a+e.y,!1);return u.update_bbox(),l.intersects_poly(u,0,0)}return!!t.bbox.intersects_rect(e.bbox)&&(!!t.bquad.intersects_quad(e.bquad)&&((!t.tilemap_exists||!e.tilemap_exists)&&(t.tilemap_exists?this.testTilemapOverlap(t,e):e.tilemap_exists?this.testTilemapOverlap(e,t):(h=t.collision_poly&&!t.collision_poly.is_empty(),c=e.collision_poly&&!e.collision_poly.is_empty(),!h&&!c||(h?(t.collision_poly.cache_poly(t.width,t.height,t.angle),l=t.collision_poly):(this.temp_poly.set_from_quad(t.bquad,t.x,t.y,t.width,t.height),l=this.temp_poly),c?(e.collision_poly.cache_poly(e.width,e.height,e.angle),u=e.collision_poly):(this.temp_poly.set_from_quad(e.bquad,e.x,e.y,e.width,e.height),u=this.temp_poly),l.intersects_poly(u,e.x-t.x,e.y-t.y))))))};var x=new cr.quad,S=new cr.rect(0,0,0,0),T=[];e.prototype.testTilemapOverlap=function(t,e){var i,s,n,r,o=e.bbox,a=t.x,h=t.y;t.getCollisionRectCandidates(o,T);var c=T,l=e.collision_poly&&!e.collision_poly.is_empty();for(i=0,s=c.length;i<s;++i)if(r=(n=c[i]).rc,o.intersects_rect_off(r,a,h)&&(x.set_from_rect(r),x.offset(a,h),x.intersects_quad(e.bquad)))if(l){if(e.collision_poly.cache_poly(e.width,e.height,e.angle),n.poly){if(n.poly.intersects_poly(e.collision_poly,e.x-(a+r.left),e.y-(h+r.top)))return cr.clearArray(T),!0}else if(this.temp_poly.set_from_quad(x,0,0,r.right-r.left,r.bottom-r.top),this.temp_poly.intersects_poly(e.collision_poly,e.x,e.y))return cr.clearArray(T),!0}else{if(!n.poly)return cr.clearArray(T),!0;if(this.temp_poly.set_from_quad(e.bquad,0,0,e.width,e.height),n.poly.intersects_poly(this.temp_poly,-(a+r.left),-(h+r.top)))return cr.clearArray(T),!0}return cr.clearArray(T),!1},e.prototype.testRectOverlap=function(t,e){if(!e||!e.collisionsEnabled)return!1;e.update_bbox();e.layer;if(!e.bbox.intersects_rect(t))return!1;if(e.tilemap_exists){e.getCollisionRectCandidates(t,T);var i,s,n,r,o=T,a=e.x,h=e.y;for(i=0,s=o.length;i<s;++i)if(r=(n=o[i]).rc,t.intersects_rect_off(r,a,h)){if(!n.poly)return cr.clearArray(T),!0;if(this.temp_poly.set_from_rect(t,0,0),n.poly.intersects_poly(this.temp_poly,-(a+r.left),-(h+r.top)))return cr.clearArray(T),!0}return cr.clearArray(T),!1}return x.set_from_rect(t),!!e.bquad.intersects_quad(x)&&(!(e.collision_poly&&!e.collision_poly.is_empty())||(e.collision_poly.cache_poly(e.width,e.height,e.angle),x.offset(-t.left,-t.top),this.temp_poly.set_from_quad(x,0,0,1,1),e.collision_poly.intersects_poly(this.temp_poly,t.left-e.x,t.top-e.y)))},e.prototype.testSegmentOverlap=function(t,e,i,s,n){if(!n||!n.collisionsEnabled)return!1;n.update_bbox();n.layer;if(S.set(cr.min(t,i),cr.min(e,s),cr.max(t,i),cr.max(e,s)),!n.bbox.intersects_rect(S))return!1;if(n.tilemap_exists){n.getCollisionRectCandidates(S,T);var r,o,a,h,c=T,l=n.x,u=n.y;for(r=0,o=c.length;r<o;++r)if(h=(a=c[r]).rc,S.intersects_rect_off(h,l,u)&&(x.set_from_rect(h),x.offset(l,u),x.intersects_segment(t,e,i,s))){if(!a.poly)return cr.clearArray(T),!0;if(a.poly.intersects_segment(l+h.left,u+h.top,t,e,i,s))return cr.clearArray(T),!0}return cr.clearArray(T),!1}return!!n.bquad.intersects_segment(t,e,i,s)&&(!(n.collision_poly&&!n.collision_poly.is_empty())||(n.collision_poly.cache_poly(n.width,n.height,n.angle),n.collision_poly.intersects_segment(n.x,n.y,t,e,i,s)))},e.prototype.typeHasBehavior=function(t,e){if(!e)return!1;var i,s,n,r,o;for(i=0,s=t.behaviors.length;i<s;i++)if(t.behaviors[i].behavior instanceof e)return!0;if(!t.is_family)for(i=0,s=t.families.length;i<s;i++)for(n=0,r=(o=t.families[i]).behaviors.length;n<r;n++)if(o.behaviors[n].behavior instanceof e)return!0;return!1},e.prototype.typeHasNoSaveBehavior=function(t){return this.typeHasBehavior(t,cr.behaviors.NoSave)},e.prototype.typeHasPersistBehavior=function(t){return this.typeHasBehavior(t,cr.behaviors.Persist)},e.prototype.getSolidBehavior=function(){return this.solidBehavior},e.prototype.getJumpthruBehavior=function(){return this.jumpthruBehavior};var C=[];e.prototype.testOverlapSolid=function(t){var e,i,s;for(t.update_bbox(),this.getSolidCollisionCandidates(t.layer,t.bbox,C),e=0,i=C.length;e<i;++e)if((s=C[e]).extra.solidEnabled&&this.testOverlap(t,s))return cr.clearArray(C),s;return cr.clearArray(C),null},e.prototype.testRectOverlapSolid=function(t){var e,i,s;for(this.getSolidCollisionCandidates(null,t,C),e=0,i=C.length;e<i;++e)if((s=C[e]).extra.solidEnabled&&this.testRectOverlap(t,s))return cr.clearArray(C),s;return cr.clearArray(C),null};var O=[];e.prototype.testOverlapJumpThru=function(t,e){var i,s,n,r=null;for(e&&(r=O,cr.clearArray(r)),t.update_bbox(),this.getJumpthruCollisionCandidates(t.layer,t.bbox,C),i=0,s=C.length;i<s;++i)if((n=C[i]).extra.jumpthruEnabled&&this.testOverlap(t,n)){if(!e)return cr.clearArray(C),n;r.push(n)}return cr.clearArray(C),r},e.prototype.pushOutSolid=function(t,e,i,s,n,r){var o,a=s||50,h=t.x,c=t.y,l=null,u=null;for(o=0;o<a;o++)if(t.x=h+e*o,t.y=c+i*o,t.set_bbox_changed(),!this.testOverlap(t,l)&&((l=this.testOverlapSolid(t))&&(u=l),!l&&(n&&(l=r?this.testOverlap(t,r)?r:null:this.testOverlapJumpThru(t))&&(u=l),!l)))return u&&this.pushInFractional(t,e,i,u,16),!0;return t.x=h,t.y=c,t.set_bbox_changed(),!1},e.prototype.pushOutSolidAxis=function(t,e,i,s){s=s||50;var n,r,o,a=t.x,h=t.y,c=null,l=null;for(n=0;n<s;++n)for(r=0;r<2;++r)if(o=2*r-1,t.x=a+e*n*o,t.y=h+i*n*o,t.set_bbox_changed(),!this.testOverlap(t,c)){if(!(c=this.testOverlapSolid(t)))return l&&this.pushInFractional(t,e*o,i*o,l,16),!0;l=c}return t.x=a,t.y=h,t.set_bbox_changed(),!1},e.prototype.pushOut=function(t,e,i,s,n){var r,o=s||50,a=t.x,h=t.y;for(r=0;r<o;r++)if(t.x=a+e*r,t.y=h+i*r,t.set_bbox_changed(),!this.testOverlap(t,n))return!0;return t.x=a,t.y=h,t.set_bbox_changed(),!1},e.prototype.pushInFractional=function(t,e,i,s,n){for(var r,o=2,a=!1,h=!1,c=t.x,l=t.y;o<=n;)r=1/o,o*=2,t.x+=e*r*(a?1:-1),t.y+=i*r*(a?1:-1),t.set_bbox_changed(),this.testOverlap(t,s)?(a=!0,h=!0):(a=!1,h=!1,c=t.x,l=t.y);h&&(t.x=c,t.y=l,t.set_bbox_changed())},e.prototype.pushOutSolidNearest=function(t,e){var i=cr.is_undefined(e)?100:e,s=0,n=t.x,r=t.y,o=0,a=0,h=0,c=this.testOverlapSolid(t);if(!c)return!0;for(;s<=i;){switch(o){case 0:a=0,h=-1,s++;break;case 1:a=1,h=-1;break;case 2:a=1,h=0;break;case 3:a=1,h=1;break;case 4:a=0,h=1;break;case 5:a=-1,h=1;break;case 6:a=-1,h=0;break;case 7:a=-1,h=-1}if(o=(o+1)%8,t.x=cr.floor(n+a*s),t.y=cr.floor(r+h*s),t.set_bbox_changed(),!this.testOverlap(t,c)&&!(c=this.testOverlapSolid(t)))return!0}return t.x=n,t.y=r,t.set_bbox_changed(),!1},e.prototype.registerCollision=function(t,e){t.collisionsEnabled&&e.collisionsEnabled&&this.registered_collisions.push([t,e])},e.prototype.addRegisteredCollisionCandidates=function(t,e,i){var s,n,r,o;for(s=0,n=this.registered_collisions.length;s<n;++s){if((r=this.registered_collisions[s])[0]===t)o=r[1];else{if(r[1]!==t)continue;o=r[0]}if(e.is_family){if(-1===e.members.indexOf(e))continue}else if(o.type!==e)continue;-1===i.indexOf(o)&&i.push(o)}},e.prototype.checkRegisteredCollision=function(t,e){var i,s,n;for(i=0,s=this.registered_collisions.length;i<s;i++)if((n=this.registered_collisions[i])[0]===t&&n[1]===e||n[0]===e&&n[1]===t)return!0;return!1},e.prototype.calculateSolidBounceAngle=function(t,e,i,s){var n=t.x,r=t.y,o=cr.max(10,cr.distanceTo(e,i,n,r)),a=cr.angleTo(e,i,n,r),h=s||this.testOverlapSolid(t);if(!h)return cr.clamp_angle(a+cr.PI);var c,l,u,p,d=h,f=cr.to_radians(5);for(c=1;c<36;c++)if(l=a-c*f,t.x=e+Math.cos(l)*o,t.y=i+Math.sin(l)*o,t.set_bbox_changed(),!this.testOverlap(t,d)&&!(d=s?null:this.testOverlapSolid(t))){u=l;break}36===c&&(u=cr.clamp_angle(a+cr.PI));d=h;for(c=1;c<36;c++)if(l=a+c*f,t.x=e+Math.cos(l)*o,t.y=i+Math.sin(l)*o,t.set_bbox_changed(),!this.testOverlap(t,d)&&!(d=s?null:this.testOverlapSolid(t))){p=l;break}if(36===c&&(p=cr.clamp_angle(a+cr.PI)),t.x=n,t.y=r,t.set_bbox_changed(),p===u)return p;var g,m=cr.angleDiff(p,u)/2;g=cr.angleClockwise(p,u)?cr.clamp_angle(u+m+cr.PI):cr.clamp_angle(p+m);var y=Math.cos(a),_=Math.sin(a),v=Math.cos(g),b=Math.sin(g),w=y*v+_*b,x=y-2*w*v,S=_-2*w*b;return cr.angleTo(0,0,x,S)};var k=-1;function A(){try{return!!window.indexedDB}catch(t){return!1}}function E(t){t.target.result.createObjectStore("saves",{keyPath:"slot"})}function I(){cr.logexport("Reloading for continuous preview"),window.c2cocoonjs?CocoonJS.App.reload():window.location.search.indexOf("continuous")>-1?window.location.reload(!0):window.location=window.location+"?continuous"}function P(t){var e,i={};for(e in t)if(t.hasOwnProperty(e)){if(t[e]instanceof cr.ObjectSet)continue;if(t[e]&&void 0!==t[e].c2userdata)continue;if("spriteCreatedDestroyCallback"===e)continue;i[e]=t[e]}return i}e.prototype.trigger=function(t,e,i){if(!this.running_layout)return!1;var s=this.running_layout.event_sheet;if(!s)return!1;var n,r,o,a=!1;k++;var h=s.deep_includes;for(r=0,o=h.length;r<o;++r)n=this.triggerOnSheet(t,e,h[r],i),a=a||n;return n=this.triggerOnSheet(t,e,s,i),k--,a=a||n},e.prototype.triggerOnSheet=function(t,e,i,s){var n,r,o,a,h=!1;if(e)for(o=this.triggerOnSheetForTypeName(t,e,e.type.name,i,s),h=h||o,n=0,r=(a=e.type.families).length;n<r;++n)o=this.triggerOnSheetForTypeName(t,e,a[n].name,i,s),h=h||o;else o=this.triggerOnSheetForTypeName(t,e,"system",i,s),h=h||o;return h},e.prototype.triggerOnSheetForTypeName=function(t,e,i,s,n){var r,o,a,h,c=!1,l=!1,u=void 0!==n,p=(u?s.fasttriggers:s.triggers)[i];if(!p)return c;var d,f=null;for(r=0,o=p.length;r<o;++r)if(p[r].method==t){f=p[r].evs;break}if(!f)return c;if(!(d=u?f[n]:f))return null;for(r=0,o=d.length;r<o;r++)a=d[r][0],h=d[r][1],l=this.executeSingleTrigger(e,i,a,h),c=c||l;return c},e.prototype.executeSingleTrigger=function(t,e,i,s){var n,r,o=!1;this.trigger_depth++;var a=this.getCurrentEventStack().current_event;a&&this.pushCleanSol(a.solModifiersIncludingParents);var h=this.trigger_depth>1;this.pushCleanSol(i.solModifiersIncludingParents),h&&this.pushLocalVarStack();var c=this.pushEventStack(i);if(c.current_event=i,t){var l=this.types[e].getCurrentSol();l.select_all=!1,cr.clearArray(l.instances),l.instances[0]=t,this.types[e].applySolToContainer()}var u=!0;if(i.parent){for(var p=c.temp_parents_arr,d=i.parent;d;)p.push(d),d=d.parent;for(p.reverse(),n=0,r=p.length;n<r;n++)if(!p[n].run_pretrigger()){u=!1;break}}return u&&(this.execcount++,i.orblock?i.run_orblocktrigger(s):i.run(),o=o||c.last_event_true),this.popEventStack(),h&&this.popLocalVarStack(),this.popSol(i.solModifiersIncludingParents),a&&this.popSol(a.solModifiersIncludingParents),this.hasPendingInstances&&0===this.isInOnDestroy&&0===k&&!this.isRunningEvents&&this.ClearDeathRow(),this.trigger_depth--,o},e.prototype.getCurrentCondition=function(){var t=this.getCurrentEventStack();return t.current_event.conditions[t.cndindex]},e.prototype.getCurrentConditionObjectType=function(){return this.getCurrentCondition().type},e.prototype.isCurrentConditionFirst=function(){return 0===this.getCurrentEventStack().cndindex},e.prototype.getCurrentAction=function(){var t=this.getCurrentEventStack();return t.current_event.actions[t.actindex]},e.prototype.pushLocalVarStack=function(){this.localvar_stack_index++,this.localvar_stack_index>=this.localvar_stack.length&&this.localvar_stack.push([])},e.prototype.popLocalVarStack=function(){this.localvar_stack_index--},e.prototype.getCurrentLocalVarStack=function(){return this.localvar_stack[this.localvar_stack_index]},e.prototype.pushEventStack=function(t){this.event_stack_index++,this.event_stack_index>=this.event_stack.length&&this.event_stack.push(new cr.eventStackFrame);var e=this.getCurrentEventStack();return e.reset(t),e},e.prototype.popEventStack=function(){this.event_stack_index--},e.prototype.getCurrentEventStack=function(){return this.event_stack[this.event_stack_index]},e.prototype.pushLoopStack=function(t){this.loop_stack_index++,this.loop_stack_index>=this.loop_stack.length&&this.loop_stack.push(cr.seal({name:t,index:0,stopped:!1}));var e=this.getCurrentLoop();return e.name=t,e.index=0,e.stopped=!1,e},e.prototype.popLoopStack=function(){this.loop_stack_index--},e.prototype.getCurrentLoop=function(){return this.loop_stack[this.loop_stack_index]},e.prototype.getEventVariableByName=function(t,e){for(var i,s,n,r,o,a;e;){for(i=0,s=e.subevents.length;i<s;i++)if((a=e.subevents[i])instanceof cr.eventvariable&&cr.equals_nocase(t,a.name))return a;e=e.parent}for(i=0,s=this.eventsheets_by_index.length;i<s;i++)for(n=0,r=(o=this.eventsheets_by_index[i]).events.length;n<r;n++)if((a=o.events[n])instanceof cr.eventvariable&&cr.equals_nocase(t,a.name))return a;return null},e.prototype.getLayoutBySid=function(t){var e,i;for(e=0,i=this.layouts_by_index.length;e<i;e++)if(this.layouts_by_index[e].sid===t)return this.layouts_by_index[e];return null},e.prototype.getObjectTypeBySid=function(t){var e,i;for(e=0,i=this.types_by_index.length;e<i;e++)if(this.types_by_index[e].sid===t)return this.types_by_index[e];return null},e.prototype.getGroupBySid=function(t){var e,i;for(e=0,i=this.allGroups.length;e<i;e++)if(this.allGroups[e].sid===t)return this.allGroups[e];return null},e.prototype.doCanvasSnapshot=function(t,e){this.snapshotCanvas=[t,e],this.redraw=!0},e.prototype.signalContinuousPreview=function(){this.signalledContinuousPreview=!0},e.prototype.handleSaveLoad=function(){var t=this,e=this.saveToSlot,i=this.lastSaveJson,s=this.loadFromSlot,n=!1;if(this.signalledContinuousPreview&&(n=!0,e="__c2_continuouspreview",this.signalledContinuousPreview=!1),e.length){if(this.ClearDeathRow(),i=this.saveToJSONString(),A()&&!this.isCocoonJs)!function(t,e,i,s){try{var n=indexedDB.open("_C2SaveStates");n.onupgradeneeded=E,n.onerror=s,n.onsuccess=function(n){var r=n.target.result;r.onerror=s,r.transaction(["saves"],"readwrite").objectStore("saves").put({slot:t,data:e}).onsuccess=i}}catch(t){s(t)}}(e,i,function(){cr.logexport("Saved state to IndexedDB storage ("+i.length+" bytes)"),t.lastSaveJson=i,t.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),t.lastSaveJson="",i="",n&&I()},function(s){try{localStorage.setItem("__c2save_"+e,i),cr.logexport("Saved state to WebStorage ("+i.length+" bytes)"),t.lastSaveJson=i,t.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),t.lastSaveJson="",i="",n&&I()}catch(e){cr.logexport("Failed to save game state: "+s+"; "+e),t.trigger(cr.system_object.prototype.cnds.OnSaveFailed,null)}});else try{localStorage.setItem("__c2save_"+e,i),cr.logexport("Saved state to WebStorage ("+i.length+" bytes)"),t.lastSaveJson=i,this.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),t.lastSaveJson="",i="",n&&I()}catch(e){cr.logexport("Error saving to WebStorage: "+e),t.trigger(cr.system_object.prototype.cnds.OnSaveFailed,null)}this.saveToSlot="",this.loadFromSlot="",this.loadFromJson=null}if(s.length){if(A()&&!this.isCocoonJs)!function(t,e,i){try{var s=indexedDB.open("_C2SaveStates");s.onupgradeneeded=E,s.onerror=i,s.onsuccess=function(s){var n=s.target.result;n.onerror=i;var r=n.transaction(["saves"]).objectStore("saves").get(t);r.onsuccess=function(t){r.result?e(r.result.data):e(null)}}}catch(t){i(t)}}(s,function(e){e?(t.loadFromJson=e,cr.logexport("Loaded state from IndexedDB storage ("+t.loadFromJson.length+" bytes)")):(t.loadFromJson=localStorage.getItem("__c2save_"+s)||"",cr.logexport("Loaded state from WebStorage ("+t.loadFromJson.length+" bytes)")),t.suspendDrawing=!1,t.loadFromJson||(t.loadFromJson=null,t.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))},function(e){t.loadFromJson=localStorage.getItem("__c2save_"+s)||"",cr.logexport("Loaded state from WebStorage ("+t.loadFromJson.length+" bytes)"),t.suspendDrawing=!1,t.loadFromJson||(t.loadFromJson=null,t.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))});else{try{this.loadFromJson=localStorage.getItem("__c2save_"+s)||"",cr.logexport("Loaded state from WebStorage ("+this.loadFromJson.length+" bytes)")}catch(t){this.loadFromJson=null}this.suspendDrawing=!1,t.loadFromJson||(t.loadFromJson=null,t.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))}this.loadFromSlot="",this.saveToSlot=""}null!==this.loadFromJson&&(this.ClearDeathRow(),this.loadFromJSONString(this.loadFromJson)?(this.lastSaveJson=this.loadFromJson,this.trigger(cr.system_object.prototype.cnds.OnLoadComplete,null),this.lastSaveJson=""):t.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null),this.loadFromJson=null)},e.prototype.saveToJSONString=function(){var t,e,i,s,n,r,o,a,h,c,l,u,p={c2save:!0,version:1,rt:{time:this.kahanTime.sum,walltime:this.wallTime.sum,timescale:this.timescale,tickcount:this.tickcount,execcount:this.execcount,next_uid:this.next_uid,running_layout:this.running_layout.sid,start_time_offset:Date.now()-this.start_time},types:{},layouts:{},events:{groups:{},cnds:{},acts:{},vars:{}}};for(t=0,e=this.types_by_index.length;t<e;t++)if(!(n=this.types_by_index[t]).is_family&&!this.typeHasNoSaveBehavior(n)){for(o={instances:[]},cr.hasAnyOwnProperty(n.extra)&&(o.ex=P(n.extra)),i=0,s=n.instances.length;i<s;i++)o.instances.push(this.saveInstanceToJSON(n.instances[i]));p.types[n.sid.toString()]=o}for(t=0,e=this.layouts_by_index.length;t<e;t++)r=this.layouts_by_index[t],p.layouts[r.sid.toString()]=r.saveToJSON();var d=p.events.groups;for(t=0,e=this.allGroups.length;t<e;t++)d[(a=this.allGroups[t]).sid.toString()]=this.groups_by_name[a.group_name].group_active;var f=p.events.cnds;for(u in this.cndsBySid)this.cndsBySid.hasOwnProperty(u)&&(h=this.cndsBySid[u],cr.hasAnyOwnProperty(h.extra)&&(f[u]={ex:P(h.extra)}));var g=p.events.acts;for(u in this.actsBySid)this.actsBySid.hasOwnProperty(u)&&(c=this.actsBySid[u],cr.hasAnyOwnProperty(c.extra)&&(g[u]={ex:P(c.extra)}));var m=p.events.vars;for(u in this.varsBySid)this.varsBySid.hasOwnProperty(u)&&((l=this.varsBySid[u]).is_constant||l.parent&&!l.is_static||(m[u]=l.data));return p.system=this.system.saveToJSON(),JSON.stringify(p)},e.prototype.refreshUidMap=function(){var t,e,i,s,n,r;for(this.objectsByUid={},t=0,e=this.types_by_index.length;t<e;t++)if(!(i=this.types_by_index[t]).is_family)for(s=0,n=i.instances.length;s<n;s++)r=i.instances[s],this.objectsByUid[r.uid.toString()]=r},e.prototype.loadFromJSONString=function(t){var e;try{e=JSON.parse(t)}catch(t){return!1}if(!e.c2save)return!1;if(e.version>1)return!1;this.isLoadingState=!0;var i=e.rt;this.kahanTime.reset(),this.kahanTime.sum=i.time,this.wallTime.reset(),this.wallTime.sum=i.walltime||0,this.timescale=i.timescale,this.tickcount=i.tickcount,this.execcount=i.execcount,this.start_time=Date.now()-i.start_time_offset;var s,n,r,o,a,h,c,l,u,p,d,f,g,m,y,_,v,b=i.running_layout;if(b!==this.running_layout.sid){var w=this.getLayoutBySid(b);if(!w)return;this.doChangeLayout(w)}var x=e.types;for(c in x)if(x.hasOwnProperty(c)){if(!(l=this.getObjectTypeBySid(parseInt(c,10)))||l.is_family||this.typeHasNoSaveBehavior(l))continue;for(x[c].ex?l.extra=x[c].ex:cr.wipe(l.extra),u=l.instances,p=x[c].instances,s=0,n=cr.min(u.length,p.length);s<n;s++)this.loadInstanceFromJSON(u[s],p[s]);for(s=p.length,n=u.length;s<n;s++)this.DestroyInstance(u[s]);for(s=u.length,n=p.length;s<n;s++)m=null,l.plugin.is_world&&!(m=this.running_layout.getLayerBySid(p[s].w.l))||(d=this.createInstanceFromInit(l.default_instance,m,!1,0,0,!0),this.loadInstanceFromJSON(d,p[s]));l.stale_iids=!0}this.ClearDeathRow(),this.refreshUidMap();var S=e.layouts;for(c in S)if(S.hasOwnProperty(c)){if(!(g=this.getLayoutBySid(parseInt(c,10))))continue;g.loadFromJSON(S[c])}var T=e.events.groups;for(c in T)T.hasOwnProperty(c)&&(y=this.getGroupBySid(parseInt(c,10)))&&this.groups_by_name[y.group_name]&&this.groups_by_name[y.group_name].setGroupActive(T[c]);var C=e.events.cnds;for(c in this.cndsBySid)this.cndsBySid.hasOwnProperty(c)&&(C.hasOwnProperty(c)?this.cndsBySid[c].extra=C[c].ex:this.cndsBySid[c].extra={});var O=e.events.acts;for(c in this.actsBySid)this.actsBySid.hasOwnProperty(c)&&(O.hasOwnProperty(c)?this.actsBySid[c].extra=O[c].ex:this.actsBySid[c].extra={});var k=e.events.vars;for(c in k)k.hasOwnProperty(c)&&this.varsBySid.hasOwnProperty(c)&&(this.varsBySid[c].data=k[c]);for(this.next_uid=i.next_uid,this.isLoadingState=!1,s=0,n=this.fireOnCreateAfterLoad.length;s<n;++s)d=this.fireOnCreateAfterLoad[s],this.trigger(Object.getPrototypeOf(d.type.plugin).cnds.OnCreated,d);for(cr.clearArray(this.fireOnCreateAfterLoad),this.system.loadFromJSON(e.system),s=0,n=this.types_by_index.length;s<n;s++)if(!(l=this.types_by_index[s]).is_family&&!this.typeHasNoSaveBehavior(l))for(r=0,o=l.instances.length;r<o;r++){if(d=l.instances[r],l.is_contained)for(_=d.get_iid(),cr.clearArray(d.siblings),a=0,h=l.container.length;a<h;a++)l!==(v=l.container[a])&&d.siblings.push(v.instances[_]);if(d.afterLoad&&d.afterLoad(),d.behavior_insts)for(a=0,h=d.behavior_insts.length;a<h;a++)(f=d.behavior_insts[a]).afterLoad&&f.afterLoad()}return this.redraw=!0,!0},e.prototype.saveInstanceToJSON=function(t,e){var i,s,n,r,o,a=t.type,h=a.plugin,c={};if(e?c.c2=!0:c.uid=t.uid,cr.hasAnyOwnProperty(t.extra)&&(c.ex=P(t.extra)),t.instance_vars&&t.instance_vars.length)for(c.ivs={},i=0,s=t.instance_vars.length;i<s;i++)c.ivs[t.type.instvar_sids[i].toString()]=t.instance_vars[i];if(h.is_world){if(n={x:t.x,y:t.y,w:t.width,h:t.height,l:t.layer.sid,zi:t.get_zindex()},0!==t.angle&&(n.a=t.angle),1!==t.opacity&&(n.o=t.opacity),.5!==t.hotspotX&&(n.hX=t.hotspotX),.5!==t.hotspotY&&(n.hY=t.hotspotY),0!==t.blend_mode&&(n.bm=t.blend_mode),t.visible||(n.v=t.visible),t.collisionsEnabled||(n.ce=t.collisionsEnabled),-1!==t.my_timescale&&(n.mts=t.my_timescale),a.effect_types.length)for(n.fx=[],i=0,s=a.effect_types.length;i<s;i++)o=a.effect_types[i],n.fx.push({name:o.name,active:t.active_effect_flags[o.index],params:t.effect_params[o.index]});c.w=n}if(t.behavior_insts&&t.behavior_insts.length)for(c.behs={},i=0,s=t.behavior_insts.length;i<s;i++)(r=t.behavior_insts[i]).saveToJSON&&(c.behs[r.type.sid.toString()]=r.saveToJSON());return t.saveToJSON&&(c.data=t.saveToJSON()),c},e.prototype.getInstanceVarIndexBySid=function(t,e){var i,s;for(i=0,s=t.instvar_sids.length;i<s;i++)if(t.instvar_sids[i]===e)return i;return-1},e.prototype.getBehaviorIndexBySid=function(t,e){var i,s;for(i=0,s=t.behavior_insts.length;i<s;i++)if(t.behavior_insts[i].type.sid===e)return i;return-1},e.prototype.loadInstanceFromJSON=function(t,e,i){var s,n,r,o,a,h,c,l,u,p,d,f=t.type,g=f.plugin;if(i){if(!e.c2)return}else t.uid=e.uid;if(e.ex?t.extra=e.ex:cr.wipe(t.extra),a=e.ivs)for(s in a)if(a.hasOwnProperty(s)){if((o=this.getInstanceVarIndexBySid(f,parseInt(s,10)))<0||o>=t.instance_vars.length)continue;null===(p=a[s])&&(p=NaN),t.instance_vars[o]=p}if(g.is_world){if(h=e.w,t.layer.sid!==h.l&&(d=t.layer,t.layer=this.running_layout.getLayerBySid(h.l),t.layer?(d.removeFromInstanceList(t,!0),t.layer.appendToInstanceList(t,!0),t.set_bbox_changed(),t.layer.setZIndicesStaleFrom(0)):(t.layer=d,i||this.DestroyInstance(t))),t.x=h.x,t.y=h.y,t.width=h.w,t.height=h.h,t.zindex=h.zi,t.angle=h.hasOwnProperty("a")?h.a:0,t.opacity=h.hasOwnProperty("o")?h.o:1,t.hotspotX=h.hasOwnProperty("hX")?h.hX:.5,t.hotspotY=h.hasOwnProperty("hY")?h.hY:.5,t.visible=!h.hasOwnProperty("v")||h.v,t.collisionsEnabled=!h.hasOwnProperty("ce")||h.ce,t.my_timescale=h.hasOwnProperty("mts")?h.mts:-1,t.blend_mode=h.hasOwnProperty("bm")?h.bm:0,t.compositeOp=cr.effectToCompositeOp(t.blend_mode),this.gl&&cr.setGLBlend(t,t.blend_mode,this.gl),t.set_bbox_changed(),h.hasOwnProperty("fx"))for(n=0,r=h.fx.length;n<r;n++)(c=f.getEffectIndexByName(h.fx[n].name))<0||(t.active_effect_flags[c]=h.fx[n].active,t.effect_params[c]=h.fx[n].params);t.updateActiveEffects()}if(l=e.behs)for(s in l)if(l.hasOwnProperty(s)){if((u=this.getBehaviorIndexBySid(t,parseInt(s,10)))<0)continue;t.behavior_insts[u].loadFromJSON(l[s])}e.data&&t.loadFromJSON(e.data)},e.prototype.fetchLocalFileViaCordova=function(t,e,i){var s=cordova.file.applicationDirectory+"www/"+t;window.resolveLocalFileSystemURL(s,function(t){t.file(e,i)},i)},e.prototype.fetchLocalFileViaCordovaAsText=function(t,e,i){this.fetchLocalFileViaCordova(t,function(t){var s=new FileReader;s.onload=function(t){e(t.target.result)},s.onerror=i,s.readAsText(t)},i)};var M=[],F=0;e.prototype.maybeStartNextArrayBufferRead=function(){if(M.length&&!(F>=8)){F++;var t=M.shift();this.doFetchLocalFileViaCordovaAsArrayBuffer(t.filename,t.successCallback,t.errorCallback)}},e.prototype.fetchLocalFileViaCordovaAsArrayBuffer=function(t,e,i){var s=this;M.push({filename:t,successCallback:function(t){F--,s.maybeStartNextArrayBufferRead(),e(t)},errorCallback:function(t){F--,s.maybeStartNextArrayBufferRead(),i(t)}}),this.maybeStartNextArrayBufferRead()},e.prototype.doFetchLocalFileViaCordovaAsArrayBuffer=function(t,e,i){this.fetchLocalFileViaCordova(t,function(t){var i=new FileReader;i.onload=function(t){e(t.target.result)},i.readAsArrayBuffer(t)},i)},e.prototype.fetchLocalFileViaCordovaAsURL=function(t,e,i){var s="",n=t.toLowerCase(),r=n.substr(n.length-4),o=n.substr(n.length-5);".mp4"===r?s="video/mp4":".webm"===o?s="video/webm":".m4a"===r?s="audio/mp4":".mp3"===r&&(s="audio/mpeg"),this.fetchLocalFileViaCordovaAsArrayBuffer(t,function(t){var i=new Blob([t],{type:s}),n=URL.createObjectURL(i);e(n)},i)},e.prototype.isAbsoluteUrl=function(t){return/^(?:[a-z]+:)?\/\//.test(t)||"data:"===t.substr(0,5)||"blob:"===t.substr(0,5)},e.prototype.setImageSrc=function(t,e){this.isWKWebView&&!this.isAbsoluteUrl(e)?this.fetchLocalFileViaCordovaAsURL(e,function(e){t.src=e},function(t){alert("Failed to load image: "+t)}):t.src=e},e.prototype.setCtxImageSmoothingEnabled=function(t,e){void 0!==t.imageSmoothingEnabled?t.imageSmoothingEnabled=e:(t.webkitImageSmoothingEnabled=e,t.mozImageSmoothingEnabled=e,t.msImageSmoothingEnabled=e)},cr.runtime=e,cr.createRuntime=function(t){return new e(document.getElementById(t))},cr.createDCRuntime=function(t,i){return new e({dc:!0,width:t,height:i})},window.cr_createRuntime=cr.createRuntime,window.cr_createDCRuntime=cr.createDCRuntime,window.createCocoonJSRuntime=function(){window.c2cocoonjs=!0;var t=document.createElement("screencanvas")||document.createElement("canvas");t.screencanvas=!0,document.body.appendChild(t);var i=new e(t);return window.c2runtime=i,window.addEventListener("orientationchange",function(){window.c2runtime.setSize(window.innerWidth,window.innerHeight)}),window.c2runtime.setSize(window.innerWidth,window.innerHeight),i},window.createEjectaRuntime=function(){var t=new e(document.getElementById("canvas"));return window.c2runtime=t,window.c2runtime.setSize(window.innerWidth,window.innerHeight),t}}(),window.cr_getC2Runtime=function(){var t=document.getElementById("c2canvas");return t?t.c2runtime:window.c2runtime?window.c2runtime:null},window.cr_getSnapshot=function(t,e){var i=window.cr_getC2Runtime();i&&i.doCanvasSnapshot(t,e)},window.cr_sizeCanvas=function(t,e){if(0!==t&&0!==e){var i=window.cr_getC2Runtime();i&&i.setSize(t,e)}},window.cr_setSuspended=function(t){var e=window.cr_getC2Runtime();e&&e.setSuspended(t)},function(){function t(t,e){this.runtime=t,this.event_sheet=null,this.scrollX=this.runtime.original_width/2,this.scrollY=this.runtime.original_height/2,this.scale=1,this.angle=0,this.first_visit=!0,this.name=e[0],this.originalWidth=e[1],this.originalHeight=e[2],this.width=e[1],this.height=e[2],this.unbounded_scrolling=e[3],this.sheetname=e[4],this.sid=e[5];var i,s,n=e[6];for(this.layers=[],this.initial_types=[],i=0,s=n.length;i<s;i++){var r=new cr.layer(this,n[i]);r.number=i,cr.seal(r),this.layers.push(r)}var o=e[7];for(this.initial_nonworld=[],i=0,s=o.length;i<s;i++){var a=o[i],h=this.runtime.types_by_index[a[1]];h.default_instance||(h.default_instance=a),this.initial_nonworld.push(a),-1===this.initial_types.indexOf(h)&&this.initial_types.push(h)}for(this.effect_types=[],this.active_effect_types=[],this.shaders_preserve_opaqueness=!0,this.effect_params=[],i=0,s=e[8].length;i<s;i++)this.effect_types.push({id:e[8][i][0],name:e[8][i][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:i}),this.effect_params.push(e[8][i][2].slice(0));this.updateActiveEffects(),this.rcTex=new cr.rect(0,0,1,1),this.rcTex2=new cr.rect(0,0,1,1),this.persist_data={}}t.prototype.saveObjectToPersist=function(t){var e=t.type.sid.toString();this.persist_data.hasOwnProperty(e)||(this.persist_data[e]=[]),this.persist_data[e].push(this.runtime.saveInstanceToJSON(t))},t.prototype.hasOpaqueBottomLayer=function(){var t=this.layers[0];return!t.transparent&&1===t.opacity&&!t.forceOwnTexture&&t.visible},t.prototype.updateActiveEffects=function(){var t,e,i;for(cr.clearArray(this.active_effect_types),this.shaders_preserve_opaqueness=!0,t=0,e=this.effect_types.length;t<e;t++)(i=this.effect_types[t]).active&&(this.active_effect_types.push(i),i.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))},t.prototype.getEffectByName=function(t){var e,i,s;for(e=0,i=this.effect_types.length;e<i;e++)if((s=this.effect_types[e]).name===t)return s;return null};var e=[];function i(t,e){return t.zindex-e.zindex}var s=!0;t.prototype.startRunning=function(){var t,n,r,o,a,h,c,l,u,p,d,f,g,m;for(this.sheetname&&(this.event_sheet=this.runtime.eventsheets[this.sheetname],this.event_sheet.updateDeepIncludes()),this.runtime.running_layout=this,this.width=this.originalWidth,this.height=this.originalHeight,this.scrollX=this.runtime.original_width/2,this.scrollY=this.runtime.original_height/2,t=0,r=this.runtime.types_by_index.length;t<r;t++)if(!(a=this.runtime.types_by_index[t]).is_family)for(n=0,o=(h=a.instances).length;n<o;n++)if((l=h[n]).layer){var y=l.layer.number;y>=this.layers.length&&(y=this.layers.length-1),l.layer=this.layers[y],-1===l.layer.instances.indexOf(l)&&l.layer.instances.push(l),l.layer.zindices_stale=!0}if(!s)for(t=0,r=this.layers.length;t<r;++t)this.layers[t].instances.sort(i);for(cr.clearArray(e),this.boundScrolling(),t=0,r=this.layers.length;t<r;t++)(m=this.layers[t]).createInitialInstances(),m.updateViewport(null);var _=!1;if(!this.first_visit){for(f in this.persist_data)if(this.persist_data.hasOwnProperty(f)){if(!(a=this.runtime.getObjectTypeBySid(parseInt(f,10)))||a.is_family||!this.runtime.typeHasPersistBehavior(a))continue;for(t=0,r=(g=this.persist_data[f]).length;t<r;t++)m=null,a.plugin.is_world&&!(m=this.getLayerBySid(g[t].w.l))||(l=this.runtime.createInstanceFromInit(a.default_instance,m,!1,0,0,!0),this.runtime.loadInstanceFromJSON(l,g[t]),_=!0,e.push(l));cr.clearArray(g)}for(t=0,r=this.layers.length;t<r;t++)this.layers[t].instances.sort(i),this.layers[t].zindices_stale=!0}for(_&&(this.runtime.ClearDeathRow(),this.runtime.refreshUidMap()),t=0;t<e.length;t++)if((l=e[t]).type.is_contained)for(u=l.get_iid(),n=0,o=l.type.container.length;n<o;n++)p=l.type.container[n],l.type!==p&&(p.instances.length>u?l.siblings.push(p.instances[u]):p.default_instance&&(d=this.runtime.createInstanceFromInit(p.default_instance,l.layer,!0,l.x,l.y,!0),this.runtime.ClearDeathRow(),p.updateIIDs(),l.siblings.push(d),e.push(d)));for(t=0,r=this.initial_nonworld.length;t<r;t++)c=this.initial_nonworld[t],(a=this.runtime.types_by_index[c[1]]).is_contained||(l=this.runtime.createInstanceFromInit(this.initial_nonworld[t],null,!0));if(this.runtime.changelayout=null,this.runtime.ClearDeathRow(),this.runtime.ctx&&!this.runtime.isDomFree)for(t=0,r=this.runtime.types_by_index.length;t<r;t++)!(p=this.runtime.types_by_index[t]).is_family&&p.instances.length&&p.preloadCanvas2D&&p.preloadCanvas2D(this.runtime.ctx);if(this.runtime.isLoadingState)cr.shallowAssignArray(this.runtime.fireOnCreateAfterLoad,e);else for(t=0,r=e.length;t<r;t++)l=e[t],this.runtime.trigger(Object.getPrototypeOf(l.type.plugin).cnds.OnCreated,l);cr.clearArray(e),this.runtime.isLoadingState||this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutStart,null),this.first_visit=!1},t.prototype.createGlobalNonWorlds=function(){var t,e,i,s,n;for(t=0,e=0,i=this.initial_nonworld.length;t<i;t++)s=this.initial_nonworld[t],(n=this.runtime.types_by_index[s[1]]).global?n.is_contained||this.runtime.createInstanceFromInit(s,null,!0):(this.initial_nonworld[e]=s,e++);cr.truncateArray(this.initial_nonworld,e)},t.prototype.stopRunning=function(){var t,e,i,n,r,o,a;if(this.runtime.isLoadingState||this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutEnd,null),this.runtime.isEndingLayout=!0,cr.clearArray(this.runtime.system.waits),!this.first_visit)for(t=0,e=this.layers.length;t<e;t++)for(this.layers[t].updateZIndices(),i=0,n=(r=this.layers[t].instances).length;i<n;i++)(o=r[i]).type.global||this.runtime.typeHasPersistBehavior(o.type)&&this.saveObjectToPersist(o);for(t=0,e=this.layers.length;t<e;t++){for(i=0,n=(r=this.layers[t].instances).length;i<n;i++)(o=r[i]).type.global||this.runtime.DestroyInstance(o);this.runtime.ClearDeathRow(),cr.clearArray(r),this.layers[t].zindices_stale=!0}for(t=0,e=this.runtime.types_by_index.length;t<e;t++)if(!((a=this.runtime.types_by_index[t]).global||a.plugin.is_world||a.plugin.singleglobal||a.is_family)){for(i=0,n=a.instances.length;i<n;i++)this.runtime.DestroyInstance(a.instances[i]);this.runtime.ClearDeathRow()}s=!1,this.runtime.isEndingLayout=!1};var n=new cr.rect(0,0,0,0);function r(t,e){this.layout=t,this.runtime=t.runtime,this.instances=[],this.scale=1,this.angle=0,this.disableAngle=!1,this.tmprect=new cr.rect(0,0,0,0),this.tmpquad=new cr.quad,this.viewLeft=0,this.viewRight=0,this.viewTop=0,this.viewBottom=0,this.zindices_stale=!1,this.zindices_stale_from=-1,this.clear_earlyz_index=0,this.name=e[0],this.index=e[1],this.sid=e[2],this.visible=e[3],this.background_color=e[4],this.transparent=e[5],this.parallaxX=e[6],this.parallaxY=e[7],this.opacity=e[8],this.forceOwnTexture=e[9],this.useRenderCells=e[10],this.zoomRate=e[11],this.blend_mode=e[12],this.effect_fallback=e[13],this.compositeOp="source-over",this.srcBlend=0,this.destBlend=0,this.render_grid=null,this.last_render_list=a(),this.render_list_stale=!0,this.last_render_cells=new cr.rect(0,0,-1,-1),this.cur_render_cells=new cr.rect(0,0,-1,-1),this.useRenderCells&&(this.render_grid=new cr.RenderGrid(this.runtime.original_width,this.runtime.original_height)),this.render_offscreen=!1;var i,s,n=e[14];for(this.startup_initial_instances=[],this.initial_instances=[],this.created_globals=[],i=0,s=n.length;i<s;i++){var r=n[i],o=this.runtime.types_by_index[r[1]];o.default_instance||(o.default_instance=r,o.default_layerindex=this.index),this.initial_instances.push(r),-1===this.layout.initial_types.indexOf(o)&&this.layout.initial_types.push(o)}for(cr.shallowAssignArray(this.startup_initial_instances,this.initial_instances),this.effect_types=[],this.active_effect_types=[],this.shaders_preserve_opaqueness=!0,this.effect_params=[],i=0,s=e[15].length;i<s;i++)this.effect_types.push({id:e[15][i][0],name:e[15][i][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:i}),this.effect_params.push(e[15][i][2].slice(0));this.updateActiveEffects(),this.rcTex=new cr.rect(0,0,1,1),this.rcTex2=new cr.rect(0,0,1,1)}t.prototype.recreateInitialObjects=function(t,e,i,s,r){var o,a;for(n.set(e,i,s,r),o=0,a=this.layers.length;o<a;o++)this.layers[o].recreateInitialObjects(t,n)},t.prototype.draw=function(t){var e,i,s,n,r=t,o=!1,a=!this.runtime.fullscreenScalingQuality;for(a&&(this.runtime.layout_canvas||(this.runtime.layout_canvas=document.createElement("canvas"),(e=this.runtime.layout_canvas).width=this.runtime.draw_width,e.height=this.runtime.draw_height,this.runtime.layout_ctx=e.getContext("2d"),o=!0),e=this.runtime.layout_canvas,r=this.runtime.layout_ctx,e.width!==this.runtime.draw_width&&(e.width=this.runtime.draw_width,o=!0),e.height!==this.runtime.draw_height&&(e.height=this.runtime.draw_height,o=!0),o&&this.runtime.setCtxImageSmoothingEnabled(r,this.runtime.linearSampling)),r.globalAlpha=1,r.globalCompositeOperation="source-over",this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&r.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height),i=0,s=this.layers.length;i<s;i++)(n=this.layers[i]).visible&&n.opacity>0&&11!==n.blend_mode&&(n.instances.length||!n.transparent)?n.draw(r):n.updateViewport(null);a&&t.drawImage(e,0,0,this.runtime.width,this.runtime.height)},t.prototype.drawGL_earlyZPass=function(t){var e,i;for(t.setEarlyZPass(!0),this.runtime.layout_tex||(this.runtime.layout_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling)),this.runtime.layout_tex.c2width===this.runtime.draw_width&&this.runtime.layout_tex.c2height===this.runtime.draw_height||(t.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling)),t.setRenderingToTexture(this.runtime.layout_tex),this.runtime.fullscreenScalingQuality||t.setSize(this.runtime.draw_width,this.runtime.draw_height),e=this.layers.length-1;e>=0;--e)(i=this.layers[e]).visible&&1===i.opacity&&i.shaders_preserve_opaqueness&&0===i.blend_mode&&(i.instances.length||!i.transparent)?i.drawGL_earlyZPass(t):i.updateViewport(null);t.setEarlyZPass(!1)},t.prototype.drawGL=function(t){var e,i,s,n=this.active_effect_types.length>0||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack;for(n?(this.runtime.layout_tex||(this.runtime.layout_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling)),this.runtime.layout_tex.c2width===this.runtime.draw_width&&this.runtime.layout_tex.c2height===this.runtime.draw_height||(t.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling)),t.setRenderingToTexture(this.runtime.layout_tex),this.runtime.fullscreenScalingQuality||t.setSize(this.runtime.draw_width,this.runtime.draw_height)):this.runtime.layout_tex&&(t.setRenderingToTexture(null),t.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=null),this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&t.clear(0,0,0,0),e=0,i=this.layers.length;e<i;e++)(s=this.layers[e]).visible&&s.opacity>0&&(s.instances.length||!s.transparent)?s.drawGL(t):s.updateViewport(null);if(n)if(0===this.active_effect_types.length||1===this.active_effect_types.length&&this.runtime.fullscreenScalingQuality){if(1===this.active_effect_types.length){var r=this.active_effect_types[0].index;t.switchProgram(this.active_effect_types[0].shaderindex),t.setProgramParameters(null,1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,this.scale,this.angle,0,0,this.runtime.draw_width/2,this.runtime.draw_height/2,this.runtime.kahanTime.sum,this.effect_params[r]),t.programIsAnimated(this.active_effect_types[0].shaderindex)&&(this.runtime.redraw=!0)}else t.switchProgram(0);this.runtime.fullscreenScalingQuality||t.setSize(this.runtime.width,this.runtime.height),t.setRenderingToTexture(null),t.setDepthTestEnabled(!1),t.setOpacity(1),t.setTexture(this.runtime.layout_tex),t.setAlphaBlend(),t.resetModelView(),t.updateModelView();var o=this.runtime.width/2,a=this.runtime.height/2;t.quad(-o,a,o,a,o,-a,-o,-a),t.setTexture(null),t.setDepthTestEnabled(!0)}else this.renderEffectChain(t,null,null,null)},t.prototype.getRenderTarget=function(){return this.active_effect_types.length>0||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack?this.runtime.layout_tex:null},t.prototype.getMinLayerScale=function(){var t,e,i,s=this.layers[0].getScale();for(t=1,e=this.layers.length;t<e;t++)0===(i=this.layers[t]).parallaxX&&0===i.parallaxY||i.getScale()<s&&(s=i.getScale());return s},t.prototype.scrollToX=function(t){if(!this.unbounded_scrolling){var e=this.runtime.draw_width*(1/this.getMinLayerScale())/2;t>this.width-e&&(t=this.width-e),t<e&&(t=e)}this.scrollX!==t&&(this.scrollX=t,this.runtime.redraw=!0)},t.prototype.scrollToY=function(t){if(!this.unbounded_scrolling){var e=this.runtime.draw_height*(1/this.getMinLayerScale())/2;t>this.height-e&&(t=this.height-e),t<e&&(t=e)}this.scrollY!==t&&(this.scrollY=t,this.runtime.redraw=!0)},t.prototype.boundScrolling=function(){this.scrollToX(this.scrollX),this.scrollToY(this.scrollY)},t.prototype.renderEffectChain=function(t,e,i,s){var n=i?i.active_effect_types:e?e.active_effect_types:this.active_effect_types,r=1,o=0,a=0,h=0,c=this.runtime.draw_width,l=this.runtime.draw_height;i?(r=i.layer.getScale(),o=i.layer.getAngle(),a=i.layer.viewLeft,h=i.layer.viewTop,c=i.layer.viewRight,l=i.layer.viewBottom):e&&(r=e.getScale(),o=e.getAngle(),a=e.viewLeft,h=e.viewTop,c=e.viewRight,l=e.viewBottom);var u,p,d,f,g,m=this.runtime.fx_tex,y=0,_=1,v=this.runtime.draw_width,b=this.runtime.draw_height,w=v/2,x=b/2,S=e?e.rcTex:this.rcTex,T=e?e.rcTex2:this.rcTex2,C=0,O=0,k=0,A=0,E=v,I=v,P=b,M=b,F=0,L=0,D=i?i.layer.getAngle():0;if(i){for(u=0,p=n.length;u<p;u++)F+=t.getProgramBoxExtendHorizontal(n[u].shaderindex),L+=t.getProgramBoxExtendVertical(n[u].shaderindex);var R=i.bbox;if(C=e.layerToCanvas(R.left,R.top,!0,!0),k=e.layerToCanvas(R.left,R.top,!1,!0),E=e.layerToCanvas(R.right,R.bottom,!0,!0),P=e.layerToCanvas(R.right,R.bottom,!1,!0),0!==D){var B=e.layerToCanvas(R.right,R.top,!0,!0),j=e.layerToCanvas(R.right,R.top,!1,!0),N=e.layerToCanvas(R.left,R.bottom,!0,!0),V=e.layerToCanvas(R.left,R.bottom,!1,!0);d=Math.min(C,E,B,N),E=Math.max(C,E,B,N),C=d,d=Math.min(k,P,j,V),P=Math.max(k,P,j,V),k=d}C-=F,k-=L,E+=F,P+=L,T.left=C/v,T.top=1-k/b,T.right=E/v,T.bottom=1-P/b,O=C=cr.floor(C),A=k=cr.floor(k),I=E=cr.ceil(E),M=P=cr.ceil(P),C<0&&(C=0),k<0&&(k=0),E>v&&(E=v),P>b&&(P=b),(O-=F)<0&&(O=0),(A-=L)<0&&(A=0),(I+=F)>v&&(I=v),(M+=L)>b&&(M=b),S.left=C/v,S.top=1-k/b,S.right=E/v,S.bottom=1-P/b}else S.left=T.left=0,S.top=T.top=0,S.right=T.right=1,S.bottom=T.bottom=1;var X=i&&(t.programUsesDest(n[0].shaderindex)||0!==F||0!==L||1!==i.opacity||i.type.plugin.must_predraw)||e&&!i&&1!==e.opacity;t.setAlphaBlend(),X&&(m[y]||(m[y]=t.createEmptyTexture(v,b,this.runtime.linearSampling)),m[y].c2width===v&&m[y].c2height===b||(t.deleteTexture(m[y]),m[y]=t.createEmptyTexture(v,b,this.runtime.linearSampling)),t.switchProgram(0),t.setRenderingToTexture(m[y]),f=b-A-(g=M-A),t.clearRect(O,f,I-O,g),i?i.drawGL(t):(t.setTexture(this.runtime.layer_tex),t.setOpacity(e.opacity),t.resetModelView(),t.translate(-w,-x),t.updateModelView(),t.quadTex(C,P,E,P,E,k,C,k,S)),T.left=T.top=0,T.right=T.bottom=1,i&&(d=S.top,S.top=S.bottom,S.bottom=d),y=1,_=0),t.setOpacity(1);var G=n.length-1,W=t.programUsesCrossSampling(n[G].shaderindex)||!e&&!i&&!this.runtime.fullscreenScalingQuality,z=0;for(u=0,p=n.length;u<p;u++){if(m[y]||(m[y]=t.createEmptyTexture(v,b,this.runtime.linearSampling)),m[y].c2width===v&&m[y].c2height===b||(t.deleteTexture(m[y]),m[y]=t.createEmptyTexture(v,b,this.runtime.linearSampling)),t.switchProgram(n[u].shaderindex),z=n[u].index,t.programIsAnimated(n[u].shaderindex)&&(this.runtime.redraw=!0),0!=u||X)t.setProgramParameters(s,1/v,1/b,T.left,T.top,T.right,T.bottom,r,o,a,h,(a+c)/2,(h+l)/2,this.runtime.kahanTime.sum,i?i.effect_params[z]:e?e.effect_params[z]:this.effect_params[z]),t.setTexture(null),u!==G||W?(t.setRenderingToTexture(m[y]),f=b-A-(g=M-A),t.clearRect(O,f,I-O,g)):(i?t.setBlend(i.srcBlend,i.destBlend):e&&t.setBlend(e.srcBlend,e.destBlend),t.setRenderingToTexture(s)),t.setTexture(m[_]),t.resetModelView(),t.translate(-w,-x),t.updateModelView(),t.quadTex(C,P,E,P,E,k,C,k,S),u!==G||W||t.setTexture(null);else{if(t.setRenderingToTexture(m[y]),f=b-A-(g=M-A),t.clearRect(O,f,I-O,g),i){var U,Y;if(i.curFrame&&i.curFrame.texture_img){var J=i.curFrame.texture_img;U=1/J.width,Y=1/J.height}else U=1/i.width,Y=1/i.height;t.setProgramParameters(s,U,Y,T.left,T.top,T.right,T.bottom,r,o,a,h,(a+c)/2,(h+l)/2,this.runtime.kahanTime.sum,i.effect_params[z]),i.drawGL(t)}else t.setProgramParameters(s,1/v,1/b,0,0,1,1,r,o,a,h,(a+c)/2,(h+l)/2,this.runtime.kahanTime.sum,e?e.effect_params[z]:this.effect_params[z]),t.setTexture(e?this.runtime.layer_tex:this.runtime.layout_tex),t.resetModelView(),t.translate(-w,-x),t.updateModelView(),t.quadTex(C,P,E,P,E,k,C,k,S);T.left=T.top=0,T.right=T.bottom=1,i&&!W&&(d=P,P=k,k=d)}_=0===(y=0===y?1:0)?1:0}W&&(t.switchProgram(0),i?t.setBlend(i.srcBlend,i.destBlend):e?t.setBlend(e.srcBlend,e.destBlend):this.runtime.fullscreenScalingQuality||(t.setSize(this.runtime.width,this.runtime.height),w=this.runtime.width/2,x=this.runtime.height/2,C=0,k=0,E=this.runtime.width,P=this.runtime.height),t.setRenderingToTexture(s),t.setTexture(m[_]),t.resetModelView(),t.translate(-w,-x),t.updateModelView(),i&&1===n.length&&!X?t.quadTex(C,k,E,k,E,P,C,P,S):t.quadTex(C,P,E,P,E,k,C,k,S),t.setTexture(null))},t.prototype.getLayerBySid=function(t){var e,i;for(e=0,i=this.layers.length;e<i;e++)if(this.layers[e].sid===t)return this.layers[e];return null},t.prototype.saveToJSON=function(){var t,e,i,s,n={sx:this.scrollX,sy:this.scrollY,s:this.scale,a:this.angle,w:this.width,h:this.height,fv:this.first_visit,persist:this.persist_data,fx:[],layers:{}};for(t=0,e=this.effect_types.length;t<e;t++)s=this.effect_types[t],n.fx.push({name:s.name,active:s.active,params:this.effect_params[s.index]});for(t=0,e=this.layers.length;t<e;t++)i=this.layers[t],n.layers[i.sid.toString()]=i.saveToJSON();return n},t.prototype.loadFromJSON=function(t){var e,i,s,n,r;this.scrollX=t.sx,this.scrollY=t.sy,this.scale=t.s,this.angle=t.a,this.width=t.w,this.height=t.h,this.persist_data=t.persist,void 0!==t.fv&&(this.first_visit=t.fv);var o=t.fx;for(e=0,i=o.length;e<i;e++)(s=this.getEffectByName(o[e].name))&&(s.active=o[e].active,this.effect_params[s.index]=o[e].params);this.updateActiveEffects();var a=t.layers;for(n in a)if(a.hasOwnProperty(n)){if(!(r=this.getLayerBySid(parseInt(n,10))))continue;r.loadFromJSON(a[n])}},cr.layout=t,r.prototype.updateActiveEffects=function(){var t,e,i;for(cr.clearArray(this.active_effect_types),this.shaders_preserve_opaqueness=!0,t=0,e=this.effect_types.length;t<e;t++)(i=this.effect_types[t]).active&&(this.active_effect_types.push(i),i.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))},r.prototype.getEffectByName=function(t){var e,i,s;for(e=0,i=this.effect_types.length;e<i;e++)if((s=this.effect_types[e]).name===t)return s;return null},r.prototype.createInitialInstances=function(){var t,i,s,n,r,o,a;for(t=0,i=0,s=this.initial_instances.length;t<s;t++){if(r=this.initial_instances[t],o=this.runtime.types_by_index[r[1]],a=!0,!this.runtime.typeHasPersistBehavior(o)||this.layout.first_visit){if(!(n=this.runtime.createInstanceFromInit(r,this,!0)))continue;e.push(n),n.type.global&&(a=!1,this.created_globals.push(n.uid))}a&&(this.initial_instances[i]=this.initial_instances[t],i++)}this.initial_instances.length=i,this.runtime.ClearDeathRow(),!this.runtime.glwrap&&this.effect_types.length&&(this.blend_mode=this.effect_fallback),this.compositeOp=cr.effectToCompositeOp(this.blend_mode),this.runtime.gl&&cr.setGLBlend(this,this.blend_mode,this.runtime.gl),this.render_list_stale=!0},r.prototype.recreateInitialObjects=function(t,e){var i,s,n,r,o,a,h,c,l,u,p,d=this.runtime.types_by_index,f=t.is_family,g=t.members;for(i=0,s=this.initial_instances.length;i<s;++i)if(a=(o=(n=this.initial_instances[i])[0])[0],h=o[1],e.contains_pt(a,h)){if((r=d[n[1]])!==t){if(!f)continue;if(g.indexOf(r)<0)continue}if(c=this.runtime.createInstanceFromInit(n,this,!1),this.runtime.isInOnDestroy++,this.runtime.trigger(Object.getPrototypeOf(r.plugin).cnds.OnCreated,c),c.is_contained)for(l=0,u=c.siblings.length;l<u;l++)p=c.siblings[i],this.runtime.trigger(Object.getPrototypeOf(p.type.plugin).cnds.OnCreated,p);this.runtime.isInOnDestroy--}},r.prototype.removeFromInstanceList=function(t,e){var i=cr.fastIndexOf(this.instances,t);i<0||(e&&this.useRenderCells&&t.rendercells&&t.rendercells.right>=t.rendercells.left&&(t.update_bbox(),this.render_grid.update(t,t.rendercells,null),t.rendercells.set(0,0,-1,-1)),i===this.instances.length-1?this.instances.pop():(cr.arrayRemove(this.instances,i),this.setZIndicesStaleFrom(i)),this.render_list_stale=!0)},r.prototype.appendToInstanceList=function(t,e){t.zindex=this.instances.length,this.instances.push(t),e&&this.useRenderCells&&t.rendercells&&t.set_bbox_changed(),this.render_list_stale=!0},r.prototype.prependToInstanceList=function(t,e){this.instances.unshift(t),this.setZIndicesStaleFrom(0),e&&this.useRenderCells&&t.rendercells&&t.set_bbox_changed()},r.prototype.moveInstanceAdjacent=function(t,e,i){var s=t.get_zindex(),n=e.get_zindex();cr.arrayRemove(this.instances,s),s<n&&n--,i&&n++,n===this.instances.length?this.instances.push(t):this.instances.splice(n,0,t),this.setZIndicesStaleFrom(s<n?s:n)},r.prototype.setZIndicesStaleFrom=function(t){(-1===this.zindices_stale_from||t<this.zindices_stale_from)&&(this.zindices_stale_from=t),this.zindices_stale=!0,this.render_list_stale=!0},r.prototype.updateZIndices=function(){if(this.zindices_stale){var t,e,i;if(-1===this.zindices_stale_from&&(this.zindices_stale_from=0),this.useRenderCells)for(t=this.zindices_stale_from,e=this.instances.length;t<e;++t)(i=this.instances[t]).zindex=t,this.render_grid.markRangeChanged(i.rendercells);else for(t=this.zindices_stale_from,e=this.instances.length;t<e;++t)this.instances[t].zindex=t;this.zindices_stale=!1,this.zindices_stale_from=-1}},r.prototype.getScale=function(t){return this.getNormalScale()*(this.runtime.fullscreenScalingQuality||t?this.runtime.aspect_scale:1)},r.prototype.getNormalScale=function(){return(this.scale*this.layout.scale-1)*this.zoomRate+1},r.prototype.getAngle=function(){return this.disableAngle?0:cr.clamp_angle(this.layout.angle+this.angle)};var o=[];function a(){return o.length?o.pop():[]}function h(t){cr.clearArray(t),o.push(t)}function c(t,e,i){var s,n,r=0,o=0,a=0,h=t.length,c=e.length;for(i.length=h+c;r<h&&o<c;++a)s=t[r],n=e[o],s.zindex<n.zindex?(i[a]=s,++r):(i[a]=n,++o);for(;r<h;++r,++a)i[a]=t[r];for(;o<c;++o,++a)i[a]=e[o]}var l=[];function u(t,e){var i,s,n,r,o;for(i=0,s=t.length;i<s-1;i+=2)c(n=t[i],r=t[i+1],o=a()),e||(h(n),h(r)),l.push(o);s%2==1&&(e?(n=a(),cr.shallowAssignArray(n,t[s-1]),l.push(n)):l.push(t[s-1])),cr.shallowAssignArray(t,l),cr.clearArray(l)}var p=[];r.prototype.getRenderCellInstancesToDraw=function(){if(this.updateZIndices(),this.render_grid.queryRange(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom,p),!p.length)return a();if(1===p.length){var t=a();return cr.shallowAssignArray(t,p[0]),cr.clearArray(p),t}var e=function(t){for(var e=!0;t.length>1;)u(t,e),e=!1;return t[0]}(p);return cr.clearArray(p),e},r.prototype.draw=function(t){this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0!==this.blend_mode;var e=this.runtime.canvas,i=t,s=!1;this.render_offscreen&&(this.runtime.layer_canvas||(this.runtime.layer_canvas=document.createElement("canvas"),(e=this.runtime.layer_canvas).width=this.runtime.draw_width,e.height=this.runtime.draw_height,this.runtime.layer_ctx=e.getContext("2d"),s=!0),e=this.runtime.layer_canvas,i=this.runtime.layer_ctx,e.width!==this.runtime.draw_width&&(e.width=this.runtime.draw_width,s=!0),e.height!==this.runtime.draw_height&&(e.height=this.runtime.draw_height,s=!0),s&&this.runtime.setCtxImageSmoothingEnabled(i,this.runtime.linearSampling),this.transparent&&i.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height)),i.globalAlpha=1,i.globalCompositeOperation="source-over",this.transparent||(i.fillStyle="rgb("+this.background_color[0]+","+this.background_color[1]+","+this.background_color[2]+")",i.fillRect(0,0,this.runtime.draw_width,this.runtime.draw_height)),i.save(),this.disableAngle=!0;var n=this.canvasToLayer(0,0,!0,!0),r=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1,this.runtime.pixel_rounding&&(n=Math.round(n),r=Math.round(r)),this.rotateViewport(n,r,i);var o,a=this.getScale();i.scale(a,a),i.translate(-n,-r),this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(h(this.last_render_list),o=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):o=this.last_render_list):o=this.instances;var c,l,u,p=null;for(c=0,l=o.length;c<l;++c)(u=o[c])!==p&&(this.drawInstance(u,i),p=u);this.useRenderCells&&(this.last_render_list=o),i.restore(),this.render_offscreen&&(t.globalCompositeOperation=this.compositeOp,t.globalAlpha=this.opacity,t.drawImage(e,0,0))},r.prototype.drawInstance=function(t,e){if(t.visible&&0!==t.width&&0!==t.height){t.update_bbox();var i=t.bbox;i.right<this.viewLeft||i.bottom<this.viewTop||i.left>this.viewRight||i.top>this.viewBottom||(e.globalCompositeOperation=t.compositeOp,t.draw(e))}},r.prototype.updateViewport=function(t){this.disableAngle=!0;var e=this.canvasToLayer(0,0,!0,!0),i=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1,this.runtime.pixel_rounding&&(e=Math.round(e),i=Math.round(i)),this.rotateViewport(e,i,t)},r.prototype.rotateViewport=function(t,e,i){var s,n=this.getScale();this.viewLeft=t,this.viewTop=e,this.viewRight=t+this.runtime.draw_width*(1/n),this.viewBottom=e+this.runtime.draw_height*(1/n),this.viewLeft>this.viewRight&&(s=this.viewLeft,this.viewLeft=this.viewRight,this.viewRight=s),this.viewTop>this.viewBottom&&(s=this.viewTop,this.viewTop=this.viewBottom,this.viewBottom=s);var r=this.getAngle();0!==r&&(i&&(i.translate(this.runtime.draw_width/2,this.runtime.draw_height/2),i.rotate(-r),i.translate(this.runtime.draw_width/-2,this.runtime.draw_height/-2)),this.tmprect.set(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom),this.tmprect.offset((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),this.tmpquad.set_from_rotated_rect(this.tmprect,r),this.tmpquad.bounding_box(this.tmprect),this.tmprect.offset((this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2),this.viewLeft=this.tmprect.left,this.viewTop=this.tmprect.top,this.viewRight=this.tmprect.right,this.viewBottom=this.tmprect.bottom)},r.prototype.drawGL_earlyZPass=function(t){this.runtime.draw_width,this.runtime.draw_height;this.render_offscreen=this.forceOwnTexture,this.render_offscreen&&(this.runtime.layer_tex||(this.runtime.layer_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling)),this.runtime.layer_tex.c2width===this.runtime.draw_width&&this.runtime.layer_tex.c2height===this.runtime.draw_height||(t.deleteTexture(this.runtime.layer_tex),this.runtime.layer_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling)),t.setRenderingToTexture(this.runtime.layer_tex)),this.disableAngle=!0;var e=this.canvasToLayer(0,0,!0,!0),i=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1,this.runtime.pixel_rounding&&(e=Math.round(e),i=Math.round(i)),this.rotateViewport(e,i,null);var s,n=this.getScale();t.resetModelView(),t.scale(n,n),t.rotateZ(-this.getAngle()),t.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),t.updateModelView(),this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(h(this.last_render_list),s=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):s=this.last_render_list):s=this.instances;var r,o,a=null;for(r=s.length-1;r>=0;--r)(o=s[r])!==a&&(this.drawInstanceGL_earlyZPass(s[r],t),a=o);this.useRenderCells&&(this.last_render_list=s),this.transparent||(this.clear_earlyz_index=this.runtime.earlyz_index++,t.setEarlyZIndex(this.clear_earlyz_index),t.setColorFillMode(1,1,1,1),t.fullscreenQuad(),t.restoreEarlyZMode())},r.prototype.drawGL=function(t){this.runtime.draw_width,this.runtime.draw_height;var e=0,i=0;this.render_offscreen=this.forceOwnTexture||1!==this.opacity||this.active_effect_types.length>0||0!==this.blend_mode,this.render_offscreen&&(this.runtime.layer_tex||(this.runtime.layer_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling)),this.runtime.layer_tex.c2width===this.runtime.draw_width&&this.runtime.layer_tex.c2height===this.runtime.draw_height||(t.deleteTexture(this.runtime.layer_tex),this.runtime.layer_tex=t.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling)),t.setRenderingToTexture(this.runtime.layer_tex),this.transparent&&t.clear(0,0,0,0)),this.transparent||(this.runtime.enableFrontToBack?(t.setEarlyZIndex(this.clear_earlyz_index),t.setColorFillMode(this.background_color[0]/255,this.background_color[1]/255,this.background_color[2]/255,1),t.fullscreenQuad(),t.setTextureFillMode()):t.clear(this.background_color[0]/255,this.background_color[1]/255,this.background_color[2]/255,1)),this.disableAngle=!0;var s=this.canvasToLayer(0,0,!0,!0),n=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1,this.runtime.pixel_rounding&&(s=Math.round(s),n=Math.round(n)),this.rotateViewport(s,n,null);var r,o=this.getScale();t.resetModelView(),t.scale(o,o),t.rotateZ(-this.getAngle()),t.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),t.updateModelView(),this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(h(this.last_render_list),r=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):r=this.last_render_list):r=this.instances;var a,c,l,u=null;for(a=0,c=r.length;a<c;++a)(l=r[a])!==u&&(this.drawInstanceGL(r[a],t),u=l);if(this.useRenderCells&&(this.last_render_list=r),this.render_offscreen)if(e=this.active_effect_types.length?this.active_effect_types[0].shaderindex:0,i=this.active_effect_types.length?this.active_effect_types[0].index:0,0===this.active_effect_types.length||1===this.active_effect_types.length&&!t.programUsesCrossSampling(e)&&1===this.opacity){1===this.active_effect_types.length?(t.switchProgram(e),t.setProgramParameters(this.layout.getRenderTarget(),1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,o,this.getAngle(),this.viewLeft,this.viewTop,(this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2,this.runtime.kahanTime.sum,this.effect_params[i]),t.programIsAnimated(e)&&(this.runtime.redraw=!0)):t.switchProgram(0),t.setRenderingToTexture(this.layout.getRenderTarget()),t.setOpacity(this.opacity),t.setTexture(this.runtime.layer_tex),t.setBlend(this.srcBlend,this.destBlend),t.resetModelView(),t.updateModelView();var p=this.runtime.draw_width/2,d=this.runtime.draw_height/2;t.quad(-p,d,p,d,p,-d,-p,-d),t.setTexture(null)}else this.layout.renderEffectChain(t,this,null,this.layout.getRenderTarget())},r.prototype.drawInstanceGL=function(t,e){if(t.visible&&0!==t.width&&0!==t.height){t.update_bbox();var i=t.bbox;i.right<this.viewLeft||i.bottom<this.viewTop||i.left>this.viewRight||i.top>this.viewBottom||(e.setEarlyZIndex(t.earlyz_index),t.uses_shaders?this.drawInstanceWithShadersGL(t,e):(e.switchProgram(0),e.setBlend(t.srcBlend,t.destBlend),t.drawGL(e)))}},r.prototype.drawInstanceGL_earlyZPass=function(t,e){if(t.visible&&0!==t.width&&0!==t.height){t.update_bbox();var i=t.bbox;i.right<this.viewLeft||i.bottom<this.viewTop||i.left>this.viewRight||i.top>this.viewBottom||(t.earlyz_index=this.runtime.earlyz_index++,0===t.blend_mode&&1===t.opacity&&t.shaders_preserve_opaqueness&&t.drawGL_earlyZPass&&(e.setEarlyZIndex(t.earlyz_index),t.drawGL_earlyZPass(e)))}},r.prototype.drawInstanceWithShadersGL=function(t,e){var i=t.active_effect_types[0].shaderindex,s=t.active_effect_types[0].index,n=this.getScale();if(1!==t.active_effect_types.length||e.programUsesCrossSampling(i)||e.programExtendsBox(i)||(t.angle||t.layer.getAngle())&&e.programUsesDest(i)||1!==t.opacity||t.type.plugin.must_predraw)this.layout.renderEffectChain(e,this,t,this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget()),e.resetModelView(),e.scale(n,n),e.rotateZ(-this.getAngle()),e.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),e.updateModelView();else{e.switchProgram(i),e.setBlend(t.srcBlend,t.destBlend),e.programIsAnimated(i)&&(this.runtime.redraw=!0);var r,o,a=0,h=0,c=0,l=0;if(e.programUsesDest(i)){var u=t.bbox,p=this.layerToCanvas(u.left,u.top,!0,!0),d=this.layerToCanvas(u.left,u.top,!1,!0),f=this.layerToCanvas(u.right,u.bottom,!0,!0),g=this.layerToCanvas(u.right,u.bottom,!1,!0);a=p/windowWidth,h=1-d/windowHeight,c=f/windowWidth,l=1-g/windowHeight}if(t.curFrame&&t.curFrame.texture_img){var m=t.curFrame.texture_img;r=1/m.width,o=1/m.height}else r=1/t.width,o=1/t.height;e.setProgramParameters(this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget(),r,o,a,h,c,l,n,this.getAngle(),this.viewLeft,this.viewTop,(this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2,this.runtime.kahanTime.sum,t.effect_params[s]),t.drawGL(e)}},r.prototype.canvasToLayer=function(t,e,i,s){var n=this.runtime.devicePixelRatio;this.runtime.isRetina&&(t*=n,e*=n);var r=this.runtime.parallax_x_origin,o=this.runtime.parallax_y_origin,a=(this.layout.scrollX-r)*this.parallaxX+r,h=(this.layout.scrollY-o)*this.parallaxY+o,c=a,l=h,u=1/this.getScale(!s);s?(c-=this.runtime.draw_width*u/2,l-=this.runtime.draw_height*u/2):(c-=this.runtime.width*u/2,l-=this.runtime.height*u/2),c+=t*u,l+=e*u;var p=this.getAngle();if(0!==p){c-=a,l-=h;var d=Math.cos(p),f=Math.sin(p),g=c*d-l*f;l=l*d+c*f,c=g,c+=a,l+=h}return i?c:l},r.prototype.layerToCanvas=function(t,e,i,s){var n=this.runtime.parallax_x_origin,r=this.runtime.parallax_y_origin,o=(this.layout.scrollX-n)*this.parallaxX+n,a=(this.layout.scrollY-r)*this.parallaxY+r,h=o,c=a,l=this.getAngle();if(0!==l){t-=o,e-=a;var u=Math.cos(-l),p=Math.sin(-l),d=t*u-e*p;e=e*u+t*p,t=d,t+=o,e+=a}var f=1/this.getScale(!s);s?(h-=this.runtime.draw_width*f/2,c-=this.runtime.draw_height*f/2):(h-=this.runtime.width*f/2,c-=this.runtime.height*f/2),h=(t-h)/f,c=(e-c)/f;var g=this.runtime.devicePixelRatio;return this.runtime.isRetina&&!s&&(h/=g,c/=g),i?h:c},r.prototype.rotatePt=function(t,e,i){if(0===this.getAngle())return i?t:e;var s=this.layerToCanvas(t,e,!0),n=this.layerToCanvas(t,e,!1);this.disableAngle=!0;var r=this.canvasToLayer(s,n,!0),o=this.canvasToLayer(s,n,!0);return this.disableAngle=!1,i?r:o},r.prototype.saveToJSON=function(){var t,e,i,s={s:this.scale,a:this.angle,vl:this.viewLeft,vt:this.viewTop,vr:this.viewRight,vb:this.viewBottom,v:this.visible,bc:this.background_color,t:this.transparent,px:this.parallaxX,py:this.parallaxY,o:this.opacity,zr:this.zoomRate,fx:[],cg:this.created_globals,instances:[]};for(t=0,e=this.effect_types.length;t<e;t++)i=this.effect_types[t],s.fx.push({name:i.name,active:i.active,params:this.effect_params[i.index]});return s},r.prototype.loadFromJSON=function(t){var e,s,n,r;this.scale=t.s,this.angle=t.a,this.viewLeft=t.vl,this.viewTop=t.vt,this.viewRight=t.vr,this.viewBottom=t.vb,this.visible=t.v,this.background_color=t.bc,this.transparent=t.t,this.parallaxX=t.px,this.parallaxY=t.py,this.opacity=t.o,this.zoomRate=t.zr,this.created_globals=t.cg||[],cr.shallowAssignArray(this.initial_instances,this.startup_initial_instances);var o=new cr.ObjectSet;for(e=0,n=this.created_globals.length;e<n;++e)o.add(this.created_globals[e]);for(e=0,s=0,n=this.initial_instances.length;e<n;++e)o.contains(this.initial_instances[e][2])||(this.initial_instances[s]=this.initial_instances[e],++s);cr.truncateArray(this.initial_instances,s);var a=t.fx;for(e=0,n=a.length;e<n;e++)(r=this.getEffectByName(a[e].name))&&(r.active=a[e].active,this.effect_params[r.index]=a[e].params);this.updateActiveEffects(),this.instances.sort(i),this.zindices_stale=!0},cr.layer=r}(),function(){var t=[];function e(t,e){var i,s=t.length;switch(s){case 0:return!0;case 1:return t[0]===e[0];case 2:return t[0]===e[0]&&t[1]===e[1];default:for(i=0;i<s;i++)if(t[i]!==e[i])return!1;return!0}}function i(t,e){return t.index-e.index}function s(s){var n,r,o,a,h;for(2===s.length?s[0].index>s[1].index&&(a=s[0],s[0]=s[1],s[1]=a):s.length>2&&s.sort(i),s.length>=t.length&&(t.length=s.length+1),t[s.length]||(t[s.length]=[]),n=0,r=(h=t[s.length]).length;n<r;n++)if(e(s,o=h[n]))return o;return h.push(s),s}function n(t,e){this.runtime=t,this.triggers={},this.fasttriggers={},this.hasRun=!1,this.includes=new cr.ObjectSet,this.deep_includes=[],this.already_included_sheets=[],this.name=e[0];var i,s,n=e[1];for(this.events=[],i=0,s=n.length;i<s;i++)this.init_event(n[i],null,this.events)}function r(t){this.type=t,this.instances=[],this.else_instances=[],this.select_all=!0}function o(t,e,i){var s,n;this.sheet=t,this.parent=e,this.runtime=t.runtime,this.solModifiers=[],this.solModifiersIncludingParents=[],this.solWriterAfterCnds=!1,this.group=!1,this.initially_activated=!1,this.toplevelevent=!1,this.toplevelgroup=!1,this.has_else_block=!1,this.conditions=[],this.actions=[],this.subevents=[],this.group_name="",this.group=!1,this.initially_activated=!1,this.group_active=!1,this.contained_includes=null,i[1]&&(this.group_name=i[1][1].toLowerCase(),this.group=!0,this.initially_activated=!!i[1][0],this.contained_includes=[],this.group_active=this.initially_activated,this.runtime.allGroups.push(this),this.runtime.groups_by_name[this.group_name]=this),this.orblock=i[2],this.sid=i[4],this.group||(this.runtime.blocksBySid[this.sid.toString()]=this);var r=i[5];for(s=0,n=r.length;s<n;s++){var o=new cr.condition(this,r[s]);o.index=s,cr.seal(o),this.conditions.push(o),this.addSolModifier(o.type)}var a=i[6];for(s=0,n=a.length;s<n;s++){var h=new cr.action(this,a[s]);h.index=s,cr.seal(h),this.actions.push(h)}if(8===i.length){var c=i[7];for(s=0,n=c.length;s<n;s++)this.sheet.init_event(c[s],this,this.subevents)}this.is_else_block=!1,this.conditions.length&&(this.is_else_block=null==this.conditions[0].type&&this.conditions[0].func==cr.system_object.prototype.cnds.Else)}function a(t,e){var i,s,n;if(t&&(-1===e.indexOf(t)&&e.push(t),t.is_contained))for(i=0,s=t.container.length;i<s;i++)t!==(n=t.container[i])&&-1===e.indexOf(n)&&e.push(n)}function h(t,e){if(this.block=t,this.sheet=t.sheet,this.runtime=t.runtime,this.parameters=[],this.results=[],this.extra={},this.index=-1,this.anyParamVariesPerInstance=!1,this.func=this.runtime.GetObjectReference(e[1]),this.trigger=e[3]>0,this.fasttrigger=2===e[3],this.looping=e[4],this.inverted=e[5],this.isstatic=e[6],this.sid=e[7],this.runtime.cndsBySid[this.sid.toString()]=this,-1===e[0]?(this.type=null,this.run=this.run_system,this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[e[0]],this.isstatic?this.run=this.run_static:this.run=this.run_object,e[2]?(this.behaviortype=this.type.getBehaviorByName(e[2]),this.beh_index=this.type.getBehaviorIndexByName(e[2])):(this.behaviortype=null,this.beh_index=-1),this.block.parent&&this.block.parent.setSolWriterAfterCnds()),this.fasttrigger&&(this.run=this.run_true),10===e.length){var i,s,n=e[9];for(i=0,s=n.length;i<s;i++){var r=new cr.parameter(this,n[i]);cr.seal(r),this.parameters.push(r)}this.results.length=n.length}}function c(t,e){if(this.block=t,this.sheet=t.sheet,this.runtime=t.runtime,this.parameters=[],this.results=[],this.extra={},this.index=-1,this.anyParamVariesPerInstance=!1,this.func=this.runtime.GetObjectReference(e[1]),-1===e[0]?(this.type=null,this.run=this.run_system,this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[e[0]],this.run=this.run_object,e[2]?(this.behaviortype=this.type.getBehaviorByName(e[2]),this.beh_index=this.type.getBehaviorIndexByName(e[2])):(this.behaviortype=null,this.beh_index=-1)),this.sid=e[3],this.runtime.actsBySid[this.sid.toString()]=this,6===e.length){var i,s,n=e[5];for(i=0,s=n.length;i<s;i++){var r=new cr.parameter(this,n[i]);cr.seal(r),this.parameters.push(r)}this.results.length=n.length}}n.prototype.toString=function(){return this.name},n.prototype.init_event=function(t,e,i){switch(t[0]){case 0:var s,n,r=new cr.eventblock(this,e,t);if(cr.seal(r),r.orblock)for(i.push(r),s=0,n=r.conditions.length;s<n;s++)r.conditions[s].trigger&&this.init_trigger(r,s);else r.is_trigger()?this.init_trigger(r,0):i.push(r);break;case 1:var o=new cr.eventvariable(this,e,t);cr.seal(o),i.push(o);break;case 2:var a=new cr.eventinclude(this,e,t);cr.seal(a),i.push(a)}},n.prototype.postInit=function(){var t,e;for(t=0,e=this.events.length;t<e;t++)this.events[t].postInit(t<e-1&&this.events[t+1].is_else_block)},n.prototype.updateDeepIncludes=function(){cr.clearArray(this.deep_includes),cr.clearArray(this.already_included_sheets),this.addDeepIncludes(this),cr.clearArray(this.already_included_sheets)},n.prototype.addDeepIncludes=function(t){var e,i,s,n,r=t.deep_includes,o=t.already_included_sheets,a=this.includes.valuesRef();for(e=0,i=a.length;e<i;++e)n=(s=a[e]).include_sheet,!s.isActive()||t===n||o.indexOf(n)>-1||(o.push(n),n.addDeepIncludes(t),r.push(n))},n.prototype.run=function(t){var e,i;for(this.runtime.resuming_breakpoint||(this.hasRun=!0,t||(this.runtime.isRunningEvents=!0)),e=0,i=this.events.length;e<i;e++){var s=this.events[e];s.run(),this.runtime.clearSol(s.solModifiers),this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()}t||(this.runtime.isRunningEvents=!1)},n.prototype.init_trigger=function(t,e){t.orblock||this.runtime.triggers_to_postinit.push(t);var i,s=t.conditions[e];i=s.type?s.type.name:"system";var n=s.fasttrigger,r=n?this.fasttriggers:this.triggers;r[i]||(r[i]=[]);var o=r[i],a=s.func;if(n){if(!s.parameters.length)return;var h,c=s.parameters[0];if(1!==c.type||2!==c.expression.type)return;var l,u,p=c.expression.value.toLowerCase();for(l=0,u=o.length;l<u;l++)if(o[l].method==a)return void((h=o[l].evs)[p]?h[p].push([t,e]):h[p]=[[t,e]]);(h={})[p]=[[t,e]],o.push({method:a,evs:h})}else{for(l=0,u=o.length;l<u;l++)if(o[l].method==a)return void o[l].evs.push([t,e]);!function(t){return!(!cr.plugins_.Sprite||t!==cr.plugins_.Sprite.prototype.cnds.OnFrameChanged)}(a)?o.push({method:a,evs:[[t,e]]}):o.unshift({method:a,evs:[[t,e]]})}},cr.eventsheet=n,r.prototype.hasObjects=function(){return this.select_all?this.type.instances.length:this.instances.length},r.prototype.getObjects=function(){return this.select_all?this.type.instances:this.instances},r.prototype.pick_one=function(t){if(t)if(t.runtime.getCurrentEventStack().current_event.orblock){this.select_all&&(cr.clearArray(this.instances),cr.shallowAssignArray(this.else_instances,t.type.instances),this.select_all=!1);var e=this.else_instances.indexOf(t);-1!==e&&(this.instances.push(this.else_instances[e]),this.else_instances.splice(e,1))}else this.select_all=!1,cr.clearArray(this.instances),this.instances[0]=t},cr.selection=r,window._c2hh_="6A19FFAE7F62FE8813F3700E41734FD8D2C6DB17",o.prototype.postInit=function(t){var e,i,n=this.parent;if(this.group)for(this.toplevelgroup=!0;n;){if(!n.group){this.toplevelgroup=!1;break}n=n.parent}for(this.toplevelevent=!this.is_trigger()&&(!this.parent||this.parent.group&&this.parent.toplevelgroup),this.has_else_block=!!t,this.solModifiersIncludingParents=this.solModifiers.slice(0),n=this.parent;n;){for(e=0,i=n.solModifiers.length;e<i;e++)this.addParentSolModifier(n.solModifiers[e]);n=n.parent}for(this.solModifiers=s(this.solModifiers),this.solModifiersIncludingParents=s(this.solModifiersIncludingParents),e=0,i=this.conditions.length;e<i;e++)this.conditions[e].postInit();for(e=0,i=this.actions.length;e<i;e++)this.actions[e].postInit();for(e=0,i=this.subevents.length;e<i;e++)this.subevents[e].postInit(e<i-1&&this.subevents[e+1].is_else_block)},o.prototype.setGroupActive=function(t){if(this.group_active!==!!t){var e,i;for(this.group_active=!!t,e=0,i=this.contained_includes.length;e<i;++e)this.contained_includes[e].updateActive();i>0&&this.runtime.running_layout.event_sheet&&this.runtime.running_layout.event_sheet.updateDeepIncludes()}},o.prototype.addSolModifier=function(t){a(t,this.solModifiers)},o.prototype.addParentSolModifier=function(t){a(t,this.solModifiersIncludingParents)},o.prototype.setSolWriterAfterCnds=function(){this.solWriterAfterCnds=!0,this.parent&&this.parent.setSolWriterAfterCnds()},o.prototype.is_trigger=function(){return!!this.conditions.length&&this.conditions[0].trigger},o.prototype.run=function(){var t,e,i=!1,s=this.runtime,n=this.runtime.getCurrentEventStack();n.current_event=this;var r=this.conditions;if(this.is_else_block||(n.else_branch_ran=!1),this.orblock){for(0===r.length&&(i=!0),n.cndindex=0,t=r.length;n.cndindex<t;n.cndindex++)(e=r[n.cndindex]).trigger||e.run()&&(i=!0);n.last_event_true=i,i&&this.run_actions_and_subevents()}else{for(n.cndindex=0,t=r.length;n.cndindex<t;n.cndindex++)if(!r[n.cndindex].run())return n.last_event_true=!1,void(this.toplevelevent&&s.hasPendingInstances&&s.ClearDeathRow());n.last_event_true=!0,this.run_actions_and_subevents()}this.end_run(n)},o.prototype.end_run=function(t){t.last_event_true&&this.has_else_block&&(t.else_branch_ran=!0),this.toplevelevent&&this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()},o.prototype.run_orblocktrigger=function(t){this.runtime.getCurrentEventStack().current_event=this,this.conditions[t].run()&&(this.run_actions_and_subevents(),this.runtime.getCurrentEventStack().last_event_true=!0)},o.prototype.run_actions_and_subevents=function(){var t,e=this.runtime.getCurrentEventStack();for(e.actindex=0,t=this.actions.length;e.actindex<t;e.actindex++)if(this.actions[e.actindex].run())return;this.run_subevents()},o.prototype.resume_actions_and_subevents=function(){var t,e=this.runtime.getCurrentEventStack();for(t=this.actions.length;e.actindex<t;e.actindex++)if(this.actions[e.actindex].run())return;this.run_subevents()},o.prototype.run_subevents=function(){if(this.subevents.length){var t,e,i,s,n=this.subevents.length-1;if(this.runtime.pushEventStack(this),this.solWriterAfterCnds)for(t=0,e=this.subevents.length;t<e;t++)i=this.subevents[t],(s=!this.toplevelgroup||!this.group&&t<n)&&this.runtime.pushCopySol(i.solModifiers),i.run(),s?this.runtime.popSol(i.solModifiers):this.runtime.clearSol(i.solModifiers);else for(t=0,e=this.subevents.length;t<e;t++)this.subevents[t].run();this.runtime.popEventStack()}},o.prototype.run_pretrigger=function(){var t=this.runtime.getCurrentEventStack();t.current_event=this;var e,i=!1;for(t.cndindex=0,e=this.conditions.length;t.cndindex<e;t.cndindex++)if(this.conditions[t.cndindex].run())i=!0;else if(!this.orblock)return!1;return!this.orblock||i},o.prototype.retrigger=function(){this.runtime.execcount++;var t,e=this.runtime.getCurrentEventStack().cndindex,i=this.runtime.pushEventStack(this);if(!this.orblock)for(i.cndindex=e+1,t=this.conditions.length;i.cndindex<t;i.cndindex++)if(!this.conditions[i.cndindex].run())return this.runtime.popEventStack(),!1;return this.run_actions_and_subevents(),this.runtime.popEventStack(),!0},o.prototype.isFirstConditionOfType=function(t){var e=t.index;if(0===e)return!0;for(--e;e>=0;--e)if(this.conditions[e].type===t.type)return!1;return!0},cr.eventblock=o,h.prototype.postInit=function(){var t,e,i;for(t=0,e=this.parameters.length;t<e;t++)(i=this.parameters[t]).postInit(),i.variesPerInstance&&(this.anyParamVariesPerInstance=!0)},h.prototype.run_true=function(){return!0},h.prototype.run_system=function(){var t,e;for(t=0,e=this.parameters.length;t<e;t++)this.results[t]=this.parameters[t].get();return cr.xor(this.func.apply(this.runtime.system,this.results),this.inverted)},h.prototype.run_static=function(){var t,e;for(t=0,e=this.parameters.length;t<e;t++)this.results[t]=this.parameters[t].get();var i=this.func.apply(this.behaviortype?this.behaviortype:this.type,this.results);return this.type.applySolToContainer(),i},h.prototype.run_object=function(){var t,e,i,s,n,r,o,a,h,c,l,u,p=this.type,d=p.getCurrentSol(),f=this.block.orblock&&!this.trigger,g=0,m=p.is_contained,y=p.is_family,_=p.family_index,v=this.beh_index,b=v>-1,w=this.anyParamVariesPerInstance,x=this.parameters,S=this.results,T=this.inverted,C=this.func;if(w)for(e=0,n=x.length;e<n;++e)(r=x[e]).variesPerInstance||(S[e]=r.get(0));else for(e=0,n=x.length;e<n;++e)S[e]=x[e].get(0);if(d.select_all){for(cr.clearArray(d.instances),cr.clearArray(d.else_instances),t=0,s=(l=p.instances).length;t<s;++t){if(a=l[t],w)for(e=0,n=x.length;e<n;++e)(r=x[e]).variesPerInstance&&(S[e]=r.get(t));b?(g=0,y&&(g=a.type.family_beh_map[_]),o=C.apply(a.behavior_insts[v+g],S)):o=C.apply(a,S),cr.xor(o,T)?d.instances.push(a):f&&d.else_instances.push(a)}return p.finish&&p.finish(!0),d.select_all=!1,p.applySolToContainer(),d.hasObjects()}i=0;var O=f&&!this.block.isFirstConditionOfType(this),k=!1;for(t=0,s=(l=O?d.else_instances:d.instances).length;t<s;++t){if(a=l[t],w)for(e=0,n=x.length;e<n;++e)(r=x[e]).variesPerInstance&&(S[e]=r.get(t));if(b?(g=0,y&&(g=a.type.family_beh_map[_]),o=C.apply(a.behavior_insts[v+g],S)):o=C.apply(a,S),cr.xor(o,T))if(k=!0,O){if(d.instances.push(a),m)for(e=0,n=a.siblings.length;e<n;e++)(h=a.siblings[e]).type.getCurrentSol().instances.push(h)}else{if(l[i]=a,m)for(e=0,n=a.siblings.length;e<n;e++)(h=a.siblings[e]).type.getCurrentSol().instances[i]=h;i++}else if(O){if(l[i]=a,m)for(e=0,n=a.siblings.length;e<n;e++)(h=a.siblings[e]).type.getCurrentSol().else_instances[i]=h;i++}else if(f&&(d.else_instances.push(a),m))for(e=0,n=a.siblings.length;e<n;e++)(h=a.siblings[e]).type.getCurrentSol().else_instances.push(h)}if(cr.truncateArray(l,i),m)for(t=0,s=(u=p.container).length;t<s;t++)c=u[t].getCurrentSol(),O?cr.truncateArray(c.else_instances,i):cr.truncateArray(c.instances,i);var A=k;if(O&&!k)for(t=0,s=d.instances.length;t<s;t++){if(a=d.instances[t],w)for(e=0,n=x.length;e<n;e++)(r=x[e]).variesPerInstance&&(S[e]=r.get(t));if(o=b?C.apply(a.behavior_insts[v],S):C.apply(a,S),cr.xor(o,T)){k=!0;break}}return p.finish&&p.finish(A||f),f?k:d.hasObjects()},cr.condition=h,c.prototype.postInit=function(){var t,e,i;for(t=0,e=this.parameters.length;t<e;t++)(i=this.parameters[t]).postInit(),i.variesPerInstance&&(this.anyParamVariesPerInstance=!0)},c.prototype.run_system=function(){var t,e,i=this.runtime,s=this.parameters,n=this.results;for(t=0,e=s.length;t<e;++t)n[t]=s[t].get();return this.func.apply(i.system,n)},c.prototype.run_object=function(){var t,e,i,s,n,r,o,a=this.type,h=this.beh_index,c=a.family_index,l=this.anyParamVariesPerInstance,u=this.parameters,p=this.results,d=this.func,f=a.getCurrentSol().getObjects(),g=a.is_family,m=h>-1;if(l)for(e=0,s=u.length;e<s;++e)(n=u[e]).variesPerInstance||(p[e]=n.get(0));else for(e=0,s=u.length;e<s;++e)p[e]=u[e].get(0);for(t=0,i=f.length;t<i;++t){if(r=f[t],l)for(e=0,s=u.length;e<s;++e)(n=u[e]).variesPerInstance&&(p[e]=n.get(t));m?(o=0,g&&(o=r.type.family_beh_map[c]),d.apply(r.behavior_insts[h+o],p)):d.apply(r,p)}return!1},cr.action=c;var l=[],u=-1;function p(){return u++,l.length===u&&l.push(new cr.expvalue),l[u]}function d(){u--}function f(t,e){var i,s,n;switch(this.owner=t,this.block=t.block,this.sheet=t.sheet,this.runtime=t.runtime,this.type=e[0],this.expression=null,this.solindex=0,this.get=null,this.combosel=0,this.layout=null,this.key=0,this.object=null,this.index=0,this.varname=null,this.eventvar=null,this.fileinfo=null,this.subparams=null,this.variadicret=null,this.subparams=null,this.variadicret=null,this.variesPerInstance=!1,e[0]){case 0:case 7:this.expression=new cr.expNode(this,e[1]),this.solindex=0,this.get=this.get_exp;break;case 1:this.expression=new cr.expNode(this,e[1]),this.solindex=0,this.get=this.get_exp_str;break;case 5:this.expression=new cr.expNode(this,e[1]),this.solindex=0,this.get=this.get_layer;break;case 3:case 8:this.combosel=e[1],this.get=this.get_combosel;break;case 6:this.layout=this.runtime.layouts[e[1]],this.get=this.get_layout;break;case 9:this.key=e[1],this.get=this.get_key;break;case 4:this.object=this.runtime.types_by_index[e[1]],this.get=this.get_object,this.block.addSolModifier(this.object),this.owner instanceof cr.action?this.block.setSolWriterAfterCnds():this.block.parent&&this.block.parent.setSolWriterAfterCnds();break;case 10:this.index=e[1],t.type&&t.type.is_family?(this.get=this.get_familyvar,this.variesPerInstance=!0):this.get=this.get_instvar;break;case 11:this.varname=e[1],this.eventvar=null,this.get=this.get_eventvar;break;case 2:case 12:this.fileinfo=e[1],this.get=this.get_audiofile;break;case 13:for(this.get=this.get_variadic,this.subparams=[],this.variadicret=[],i=1,s=e.length;i<s;i++)n=new cr.parameter(this.owner,e[i]),cr.seal(n),this.subparams.push(n),this.variadicret.push(0)}}function g(t,e,i){this.sheet=t,this.parent=e,this.runtime=t.runtime,this.solModifiers=[],this.name=i[1],this.vartype=i[2],this.initial=i[3],this.is_static=!!i[4],this.is_constant=!!i[5],this.sid=i[6],this.runtime.varsBySid[this.sid.toString()]=this,this.data=this.initial,this.parent?(this.is_static||this.is_constant?this.localIndex=-1:this.localIndex=this.runtime.stackLocalCount++,this.runtime.all_local_vars.push(this)):(this.localIndex=-1,this.runtime.all_global_vars.push(this))}function m(t,e,i){this.sheet=t,this.parent=e,this.runtime=t.runtime,this.solModifiers=[],this.include_sheet=null,this.include_sheet_name=i[1],this.active=!0}function y(){this.temp_parents_arr=[],this.reset(null),cr.seal(this)}f.prototype.postInit=function(){var t,e;if(11===this.type)this.eventvar=this.runtime.getEventVariableByName(this.varname,this.block.parent);else if(13===this.type)for(t=0,e=this.subparams.length;t<e;t++)this.subparams[t].postInit();this.expression&&this.expression.postInit()},f.prototype.maybeVaryForType=function(t){this.variesPerInstance||t&&(t.plugin.singleglobal||(this.variesPerInstance=!0))},f.prototype.setVaries=function(){this.variesPerInstance=!0},f.prototype.get_exp=function(t){this.solindex=t||0;var e=p();return this.expression.get(e),d(),e.data},f.prototype.get_exp_str=function(t){this.solindex=t||0;var e=p();return this.expression.get(e),d(),cr.is_string(e.data)?e.data:""},f.prototype.get_object=function(){return this.object},f.prototype.get_combosel=function(){return this.combosel},f.prototype.get_layer=function(t){this.solindex=t||0;var e=p();return this.expression.get(e),d(),e.is_number()?this.runtime.getLayerByNumber(e.data):this.runtime.getLayerByName(e.data)},f.prototype.get_layout=function(){return this.layout},f.prototype.get_key=function(){return this.key},f.prototype.get_instvar=function(){return this.index},f.prototype.get_familyvar=function(t){var e=t||0,i=this.owner.type,s=null,n=i.getCurrentSol(),r=n.getObjects();if(r.length)s=r[e%r.length].type;else if(n.else_instances.length)s=n.else_instances[e%n.else_instances.length].type;else{if(!i.instances.length)return 0;s=i.instances[e%i.instances.length].type}return this.index+s.family_var_map[i.family_index]},f.prototype.get_eventvar=function(){return this.eventvar},f.prototype.get_audiofile=function(){return this.fileinfo},f.prototype.get_variadic=function(){var t,e;for(t=0,e=this.subparams.length;t<e;t++)this.variadicret[t]=this.subparams[t].get();return this.variadicret},cr.parameter=f,g.prototype.postInit=function(){this.solModifiers=s(this.solModifiers)},g.prototype.setValue=function(t){var e=this.runtime.getCurrentLocalVarStack();this.parent&&!this.is_static&&e?(this.localIndex>=e.length&&(e.length=this.localIndex+1),e[this.localIndex]=t):this.data=t},g.prototype.getValue=function(){var t=this.runtime.getCurrentLocalVarStack();return!this.parent||this.is_static||!t||this.is_constant?this.data:this.localIndex>=t.length||void 0===t[this.localIndex]?this.initial:t[this.localIndex]},g.prototype.run=function(){!this.parent||this.is_static||this.is_constant||this.setValue(this.initial)},cr.eventvariable=g,m.prototype.toString=function(){return"include:"+this.include_sheet.toString()},m.prototype.postInit=function(){this.include_sheet=this.runtime.eventsheets[this.include_sheet_name],this.sheet.includes.add(this),this.solModifiers=s(this.solModifiers);for(var t=this.parent;t;)t.group&&t.contained_includes.push(this),t=t.parent;this.updateActive()},m.prototype.run=function(){this.parent&&this.runtime.pushCleanSol(this.runtime.types_by_index),this.include_sheet.hasRun||this.include_sheet.run(!0),this.parent&&this.runtime.popSol(this.runtime.types_by_index)},m.prototype.updateActive=function(){for(var t=this.parent;t;){if(t.group&&!t.group_active)return void(this.active=!1);t=t.parent}this.active=!0},m.prototype.isActive=function(){return this.active},cr.eventinclude=m,y.prototype.reset=function(t){this.current_event=t,this.cndindex=0,this.actindex=0,cr.clearArray(this.temp_parents_arr),this.last_event_true=!1,this.else_branch_ran=!1,this.any_true_state=!1},y.prototype.isModifierAfterCnds=function(){return!!this.current_event.solWriterAfterCnds||this.cndindex<this.current_event.conditions.length-1&&!!this.current_event.solModifiers.length},cr.eventStackFrame=y}(),function(){function t(t,e){this.owner=t,this.runtime=t.runtime,this.type=e[0],this.get=[this.eval_int,this.eval_float,this.eval_string,this.eval_unaryminus,this.eval_add,this.eval_subtract,this.eval_multiply,this.eval_divide,this.eval_mod,this.eval_power,this.eval_and,this.eval_or,this.eval_equal,this.eval_notequal,this.eval_less,this.eval_lessequal,this.eval_greater,this.eval_greaterequal,this.eval_conditional,this.eval_system_exp,this.eval_object_exp,this.eval_instvar_exp,this.eval_behavior_exp,this.eval_eventvar_exp][this.type];var i,s,n=null;switch(this.value=null,this.first=null,this.second=null,this.third=null,this.func=null,this.results=null,this.parameters=null,this.object_type=null,this.beh_index=-1,this.instance_expr=null,this.varindex=-1,this.behavior_type=null,this.varname=null,this.eventvar=null,this.return_string=!1,this.type){case 0:case 1:case 2:this.value=e[1];break;case 3:this.first=new cr.expNode(t,e[1]);break;case 18:this.first=new cr.expNode(t,e[1]),this.second=new cr.expNode(t,e[2]),this.third=new cr.expNode(t,e[3]);break;case 19:this.func=this.runtime.GetObjectReference(e[1]),this.func!==cr.system_object.prototype.exps.random&&this.func!==cr.system_object.prototype.exps.choose||this.owner.setVaries(),this.results=[],this.parameters=[],3===e.length?(n=e[2],this.results.length=n.length+1):this.results.length=1;break;case 20:this.object_type=this.runtime.types_by_index[e[1]],this.beh_index=-1,this.func=this.runtime.GetObjectReference(e[2]),this.return_string=e[3],cr.plugins_.Function&&this.func===cr.plugins_.Function.prototype.exps.Call&&this.owner.setVaries(),e[4]?this.instance_expr=new cr.expNode(t,e[4]):this.instance_expr=null,this.results=[],this.parameters=[],6===e.length?(n=e[5],this.results.length=n.length+1):this.results.length=1;break;case 21:this.object_type=this.runtime.types_by_index[e[1]],this.return_string=e[2],e[3]?this.instance_expr=new cr.expNode(t,e[3]):this.instance_expr=null,this.varindex=e[4];break;case 22:this.object_type=this.runtime.types_by_index[e[1]],this.behavior_type=this.object_type.getBehaviorByName(e[2]),this.beh_index=this.object_type.getBehaviorIndexByName(e[2]),this.func=this.runtime.GetObjectReference(e[3]),this.return_string=e[4],e[5]?this.instance_expr=new cr.expNode(t,e[5]):this.instance_expr=null,this.results=[],this.parameters=[],7===e.length?(n=e[6],this.results.length=n.length+1):this.results.length=1;break;case 23:this.varname=e[1],this.eventvar=null}if(this.owner.maybeVaryForType(this.object_type),this.type>=4&&this.type<=17&&(this.first=new cr.expNode(t,e[1]),this.second=new cr.expNode(t,e[2])),n)for(i=0,s=n.length;i<s;i++)this.parameters.push(new cr.expNode(t,n[i]));cr.seal(this)}t.prototype.postInit=function(){var t,e;if(23===this.type&&(this.eventvar=this.owner.runtime.getEventVariableByName(this.varname,this.owner.block.parent)),this.first&&this.first.postInit(),this.second&&this.second.postInit(),this.third&&this.third.postInit(),this.instance_expr&&this.instance_expr.postInit(),this.parameters)for(t=0,e=this.parameters.length;t<e;t++)this.parameters[t].postInit()};var e=[],i=-1;function s(){return++i,e.length===i&&e.push(new cr.expvalue),e[i]}function n(){--i}function r(t,e,i){var s,n;for(s=0,n=t.length;s<n;++s)t[s].get(i),e[s+1]=i.data}function o(t,e){this.type=t||cr.exptype.Integer,this.data=e||0,this.object_class=null,this.type==cr.exptype.Integer&&(this.data=Math.floor(this.data)),cr.seal(this)}t.prototype.eval_system_exp=function(t){var e=this.parameters,i=this.results;i[0]=t,r(e,i,s()),n(),this.func.apply(this.runtime.system,i)},t.prototype.eval_object_exp=function(t){var e=this.object_type,i=this.results,o=this.parameters,a=this.instance_expr,h=this.func,c=this.owner.solindex,l=e.getCurrentSol(),u=l.getObjects();if(!u.length){if(!l.else_instances.length)return void(this.return_string?t.set_string(""):t.set_int(0));u=l.else_instances}i[0]=t,t.object_class=e;var p=s();r(o,i,p),a&&(a.get(p),p.is_number()&&(c=p.data,u=e.instances)),n();var d=u.length;(c>=d||c<=-d)&&(c%=d),c<0&&(c+=d);h.apply(u[c],i)},t.prototype.eval_behavior_exp=function(t){var e=this.object_type,i=this.results,o=this.parameters,a=this.instance_expr,h=this.beh_index,c=this.func,l=this.owner.solindex,u=e.getCurrentSol(),p=u.getObjects();if(!p.length){if(!u.else_instances.length)return void(this.return_string?t.set_string(""):t.set_int(0));p=u.else_instances}i[0]=t,t.object_class=e;var d=s();r(o,i,d),a&&(a.get(d),d.is_number()&&(l=d.data,p=e.instances)),n();var f=p.length;(l>=f||l<=-f)&&(l%=f),l<0&&(l+=f);var g=p[l],m=0;e.is_family&&(m=g.type.family_beh_map[e.family_index]);c.apply(g.behavior_insts[h+m],i)},t.prototype.eval_instvar_exp=function(t){var e,i=this.instance_expr,r=this.object_type,o=this.varindex,a=this.owner.solindex,h=r.getCurrentSol(),c=h.getObjects();if(!c.length){if(!h.else_instances.length)return void(this.return_string?t.set_string(""):t.set_int(0));c=h.else_instances}if(i){var l=s();if(i.get(l),l.is_number()){a=l.data;var u=r.instances;0!==u.length&&(a%=u.length)<0&&(a+=u.length);var p=(e=r.getInstanceByIID(a)).instance_vars[o];return cr.is_string(p)?t.set_string(p):t.set_float(p),void n()}n()}var d=c.length;(a>=d||a<=-d)&&(a%=d),a<0&&(a+=d),e=c[a];var f=0;r.is_family&&(f=e.type.family_var_map[r.family_index]);p=e.instance_vars[o+f];cr.is_string(p)?t.set_string(p):t.set_float(p)},t.prototype.eval_int=function(t){t.type=cr.exptype.Integer,t.data=this.value},t.prototype.eval_float=function(t){t.type=cr.exptype.Float,t.data=this.value},t.prototype.eval_string=function(t){t.type=cr.exptype.String,t.data=this.value},t.prototype.eval_unaryminus=function(t){this.first.get(t),t.is_number()&&(t.data=-t.data)},t.prototype.eval_add=function(t){this.first.get(t);var e=s();this.second.get(e),t.is_number()&&e.is_number()&&(t.data+=e.data,e.is_float()&&t.make_float()),n()},t.prototype.eval_subtract=function(t){this.first.get(t);var e=s();this.second.get(e),t.is_number()&&e.is_number()&&(t.data-=e.data,e.is_float()&&t.make_float()),n()},t.prototype.eval_multiply=function(t){this.first.get(t);var e=s();this.second.get(e),t.is_number()&&e.is_number()&&(t.data*=e.data,e.is_float()&&t.make_float()),n()},t.prototype.eval_divide=function(t){this.first.get(t);var e=s();this.second.get(e),t.is_number()&&e.is_number()&&(t.data/=e.data,t.make_float()),n()},t.prototype.eval_mod=function(t){this.first.get(t);var e=s();this.second.get(e),t.is_number()&&e.is_number()&&(t.data%=e.data,e.is_float()&&t.make_float()),n()},t.prototype.eval_power=function(t){this.first.get(t);var e=s();this.second.get(e),t.is_number()&&e.is_number()&&(t.data=Math.pow(t.data,e.data),e.is_float()&&t.make_float()),n()},t.prototype.eval_and=function(t){this.first.get(t);var e=s();this.second.get(e),e.is_string()||t.is_string()?this.eval_and_stringconcat(t,e):this.eval_and_logical(t,e),n()},t.prototype.eval_and_stringconcat=function(t,e){t.is_string()&&e.is_string()?this.eval_and_stringconcat_str_str(t,e):this.eval_and_stringconcat_num(t,e)},t.prototype.eval_and_stringconcat_str_str=function(t,e){t.data+=e.data},t.prototype.eval_and_stringconcat_num=function(t,e){t.is_string()?t.data+=(Math.round(1e10*e.data)/1e10).toString():t.set_string(t.data.toString()+e.data)},t.prototype.eval_and_logical=function(t,e){t.set_int(t.data&&e.data?1:0)},t.prototype.eval_or=function(t){this.first.get(t);var e=s();this.second.get(e),t.is_number()&&e.is_number()&&(t.data||e.data?t.set_int(1):t.set_int(0)),n()},t.prototype.eval_conditional=function(t){this.first.get(t),t.data?this.second.get(t):this.third.get(t)},t.prototype.eval_equal=function(t){this.first.get(t);var e=s();this.second.get(e),t.set_int(t.data===e.data?1:0),n()},t.prototype.eval_notequal=function(t){this.first.get(t);var e=s();this.second.get(e),t.set_int(t.data!==e.data?1:0),n()},t.prototype.eval_less=function(t){this.first.get(t);var e=s();this.second.get(e),t.set_int(t.data<e.data?1:0),n()},t.prototype.eval_lessequal=function(t){this.first.get(t);var e=s();this.second.get(e),t.set_int(t.data<=e.data?1:0),n()},t.prototype.eval_greater=function(t){this.first.get(t);var e=s();this.second.get(e),t.set_int(t.data>e.data?1:0),n()},t.prototype.eval_greaterequal=function(t){this.first.get(t);var e=s();this.second.get(e),t.set_int(t.data>=e.data?1:0),n()},t.prototype.eval_eventvar_exp=function(t){var e=this.eventvar.getValue();cr.is_number(e)?t.set_float(e):t.set_string(e)},cr.expNode=t,o.prototype.is_int=function(){return this.type===cr.exptype.Integer},o.prototype.is_float=function(){return this.type===cr.exptype.Float},o.prototype.is_number=function(){return this.type===cr.exptype.Integer||this.type===cr.exptype.Float},o.prototype.is_string=function(){return this.type===cr.exptype.String},o.prototype.make_int=function(){this.is_int()||(this.is_float()?this.data=Math.floor(this.data):this.is_string()&&(this.data=parseInt(this.data,10)),this.type=cr.exptype.Integer)},o.prototype.make_float=function(){this.is_float()||(this.is_string()&&(this.data=parseFloat(this.data)),this.type=cr.exptype.Float)},o.prototype.make_string=function(){this.is_string()||(this.data=this.data.toString(),this.type=cr.exptype.String)},o.prototype.set_int=function(t){this.type=cr.exptype.Integer,this.data=Math.floor(t)},o.prototype.set_float=function(t){this.type=cr.exptype.Float,this.data=t},o.prototype.set_string=function(t){this.type=cr.exptype.String,this.data=t},o.prototype.set_any=function(t){cr.is_number(t)?(this.type=cr.exptype.Float,this.data=t):cr.is_string(t)?(this.type=cr.exptype.String,this.data=t.toString()):(this.type=cr.exptype.Integer,this.data=0)},cr.expvalue=o,cr.exptype={Integer:0,Float:1,String:2}}(),cr.system_object=function(t){this.runtime=t,this.waits=[]},cr.system_object.prototype.saveToJSON=function(){var t,e,i,s,n,r,o,a,h={};h.waits=[];var c,l=h.waits;for(t=0,e=this.waits.length;t<e;t++){for(c={t:(r=this.waits[t]).time,st:r.signaltag,s:r.signalled,ev:r.ev.sid,sm:[],sols:{}},r.ev.actions[r.actindex]&&(c.act=r.ev.actions[r.actindex].sid),i=0,s=r.solModifiers.length;i<s;i++)c.sm.push(r.solModifiers[i].sid);for(n in r.sols)if(r.sols.hasOwnProperty(n)){for(o=this.runtime.types_by_index[parseInt(n,10)],a={sa:r.sols[n].sa,insts:[]},i=0,s=r.sols[n].insts.length;i<s;i++)a.insts.push(r.sols[n].insts[i].uid);c.sols[o.sid.toString()]=a}l.push(c)}return h},cr.system_object.prototype.loadFromJSON=function(t){var e,i,s,n,r,o,a,h,c,l,u,p,d,f=t.waits;for(cr.clearArray(this.waits),e=0,i=f.length;e<i;e++)if(o=f[e],h=this.runtime.blocksBySid[o.ev.toString()]){for(c=-1,s=0,n=h.actions.length;s<n;s++)if(h.actions[s].sid===o.act){c=s;break}if(-1!==c){for((a={}).sols={},a.solModifiers=[],a.deleteme=!1,a.time=o.t,a.signaltag=o.st||"",a.signalled=!!o.s,a.ev=h,a.actindex=c,s=0,n=o.sm.length;s<n;s++)(l=this.runtime.getObjectTypeBySid(o.sm[s]))&&a.solModifiers.push(l);for(r in o.sols)if(o.sols.hasOwnProperty(r)){if(!(l=this.runtime.getObjectTypeBySid(parseInt(r,10))))continue;for(p={sa:(u=o.sols[r]).sa,insts:[]},s=0,n=u.insts.length;s<n;s++)(d=this.runtime.getObjectByUID(u.insts[s]))&&p.insts.push(d);a.sols[l.index.toString()]=p}this.waits.push(a)}}},function(){var t=cr.system_object.prototype;function e(){}e.prototype.EveryTick=function(){return!0},e.prototype.OnLayoutStart=function(){return!0},e.prototype.OnLayoutEnd=function(){return!0},e.prototype.Compare=function(t,e,i){return cr.do_cmp(t,e,i)},e.prototype.CompareTime=function(t,e){var i=this.runtime.kahanTime.sum;if(0===t){var s=this.runtime.getCurrentCondition();return!s.extra.CompareTime_executed&&i>=e&&(s.extra.CompareTime_executed=!0,!0)}return cr.do_cmp(i,t,e)},e.prototype.LayerVisible=function(t){return!!t&&t.visible},e.prototype.LayerEmpty=function(t){return!!t&&!t.instances.length},e.prototype.LayerCmpOpacity=function(t,e,i){return!!t&&cr.do_cmp(100*t.opacity,e,i)},e.prototype.Repeat=function(t){var e,i=this.runtime.getCurrentEventStack(),s=i.current_event,n=i.isModifierAfterCnds(),r=this.runtime.pushLoopStack();if(n)for(e=0;e<t&&!r.stopped;e++)this.runtime.pushCopySol(s.solModifiers),r.index=e,s.retrigger(),this.runtime.popSol(s.solModifiers);else for(e=0;e<t&&!r.stopped;e++)r.index=e,s.retrigger();return this.runtime.popLoopStack(),!1},e.prototype.While=function(t){var e,i=this.runtime.getCurrentEventStack(),s=i.current_event,n=i.isModifierAfterCnds(),r=this.runtime.pushLoopStack();if(n)for(e=0;!r.stopped;e++)this.runtime.pushCopySol(s.solModifiers),r.index=e,s.retrigger()||(r.stopped=!0),this.runtime.popSol(s.solModifiers);else for(e=0;!r.stopped;e++)r.index=e,s.retrigger()||(r.stopped=!0);return this.runtime.popLoopStack(),!1},e.prototype.For=function(t,e,i){var s,n=this.runtime.getCurrentEventStack(),r=n.current_event,o=n.isModifierAfterCnds(),a=this.runtime.pushLoopStack(t);if(i<e)if(o)for(s=e;s>=i&&!a.stopped;--s)this.runtime.pushCopySol(r.solModifiers),a.index=s,r.retrigger(),this.runtime.popSol(r.solModifiers);else for(s=e;s>=i&&!a.stopped;--s)a.index=s,r.retrigger();else if(o)for(s=e;s<=i&&!a.stopped;++s)this.runtime.pushCopySol(r.solModifiers),a.index=s,r.retrigger(),this.runtime.popSol(r.solModifiers);else for(s=e;s<=i&&!a.stopped;++s)a.index=s,r.retrigger();return this.runtime.popLoopStack(),!1};var i=[],s=-1;function n(t,e){var i=t.extra.c2_feo_val,s=e.extra.c2_feo_val;return cr.is_number(i)&&cr.is_number(s)?i-s:(i=""+i)<(s=""+s)?-1:i>s?1:0}e.prototype.ForEach=function(t){var e=t.getCurrentSol();s++,i.length===s&&i.push([]);var n=i[s];cr.shallowAssignArray(n,e.getObjects());var r,o,a,h,c,l,u,p=this.runtime.getCurrentEventStack(),d=p.current_event,f=p.isModifierAfterCnds(),g=this.runtime.pushLoopStack(),m=t.is_contained;if(f)for(r=0,o=n.length;r<o&&!g.stopped;r++){if(this.runtime.pushCopySol(d.solModifiers),c=n[r],(e=t.getCurrentSol()).select_all=!1,cr.clearArray(e.instances),e.instances[0]=c,m)for(a=0,h=c.siblings.length;a<h;a++)(u=(l=c.siblings[a]).type.getCurrentSol()).select_all=!1,cr.clearArray(u.instances),u.instances[0]=l;g.index=r,d.retrigger(),this.runtime.popSol(d.solModifiers)}else for(e.select_all=!1,cr.clearArray(e.instances),r=0,o=n.length;r<o&&!g.stopped;r++){if(c=n[r],e.instances[0]=c,m)for(a=0,h=c.siblings.length;a<h;a++)(u=(l=c.siblings[a]).type.getCurrentSol()).select_all=!1,cr.clearArray(u.instances),u.instances[0]=l;g.index=r,d.retrigger()}return cr.clearArray(n),this.runtime.popLoopStack(),s--,!1},e.prototype.ForEachOrdered=function(t,e,r){var o=t.getCurrentSol();s++,i.length===s&&i.push([]);var a=i[s];cr.shallowAssignArray(a,o.getObjects());var h,c,l,u,p,d,f,g=this.runtime.getCurrentEventStack(),m=g.current_event,y=this.runtime.getCurrentCondition(),_=g.isModifierAfterCnds(),v=this.runtime.pushLoopStack();for(h=0,c=a.length;h<c;h++)a[h].extra.c2_feo_val=y.parameters[1].get(h);a.sort(n),1===r&&a.reverse();var b=t.is_contained;if(_)for(h=0,c=a.length;h<c&&!v.stopped;h++){if(this.runtime.pushCopySol(m.solModifiers),p=a[h],(o=t.getCurrentSol()).select_all=!1,cr.clearArray(o.instances),o.instances[0]=p,b)for(l=0,u=p.siblings.length;l<u;l++)(f=(d=p.siblings[l]).type.getCurrentSol()).select_all=!1,cr.clearArray(f.instances),f.instances[0]=d;v.index=h,m.retrigger(),this.runtime.popSol(m.solModifiers)}else for(o.select_all=!1,cr.clearArray(o.instances),h=0,c=a.length;h<c&&!v.stopped;h++){if(p=a[h],o.instances[0]=p,b)for(l=0,u=p.siblings.length;l<u;l++)(f=(d=p.siblings[l]).type.getCurrentSol()).select_all=!1,cr.clearArray(f.instances),f.instances[0]=d;v.index=h,m.retrigger()}return cr.clearArray(a),this.runtime.popLoopStack(),s--,!1},e.prototype.PickByComparison=function(t,e,n,r){var o,a,h,c;if(t){s++,i.length===s&&i.push([]);var l=i[s],u=t.getCurrentSol();cr.shallowAssignArray(l,u.getObjects()),u.select_all&&cr.clearArray(u.else_instances);var p=this.runtime.getCurrentCondition();for(o=0,h=0,a=l.length;o<a;o++)c=l[o],l[h]=c,e=p.parameters[1].get(o),r=p.parameters[3].get(o),cr.do_cmp(e,n,r)?h++:u.else_instances.push(c);return cr.truncateArray(l,h),u.select_all=!1,cr.shallowAssignArray(u.instances,l),cr.clearArray(l),s--,t.applySolToContainer(),!!u.instances.length}},e.prototype.PickByEvaluate=function(t,e){var n,r,o,a;if(t){s++,i.length===s&&i.push([]);var h=i[s],c=t.getCurrentSol();cr.shallowAssignArray(h,c.getObjects()),c.select_all&&cr.clearArray(c.else_instances);var l=this.runtime.getCurrentCondition();for(n=0,o=0,r=h.length;n<r;n++)a=h[n],h[o]=a,l.parameters[1].get(n)?o++:c.else_instances.push(a);return cr.truncateArray(h,o),c.select_all=!1,cr.shallowAssignArray(c.instances,h),cr.clearArray(h),s--,t.applySolToContainer(),!!c.instances.length}},e.prototype.TriggerOnce=function(){var t=this.runtime.getCurrentCondition().extra;void 0===t.TriggerOnce_lastTick&&(t.TriggerOnce_lastTick=-1);var e=t.TriggerOnce_lastTick,i=this.runtime.tickcount;return t.TriggerOnce_lastTick=i,this.runtime.layout_first_tick||e!==i-1},e.prototype.Every=function(t){var e=this.runtime.getCurrentCondition(),i=e.extra.Every_lastTime||0,s=this.runtime.kahanTime.sum;void 0===e.extra.Every_seconds&&(e.extra.Every_seconds=t);var n=e.extra.Every_seconds;return s>=i+n?(e.extra.Every_lastTime=i+n,s>=e.extra.Every_lastTime+.04&&(e.extra.Every_lastTime=s),e.extra.Every_seconds=t,!0):(s<i-.1&&(e.extra.Every_lastTime=s),!1)},e.prototype.PickNth=function(t,e){if(!t)return!1;var i=t.getCurrentSol(),s=i.getObjects();if((e=cr.floor(e))<0||e>=s.length)return!1;var n=s[e];return i.pick_one(n),t.applySolToContainer(),!0},e.prototype.PickRandom=function(t){if(!t)return!1;var e=t.getCurrentSol(),i=e.getObjects(),s=cr.floor(Math.random()*i.length);if(s>=i.length)return!1;var n=i[s];return e.pick_one(n),t.applySolToContainer(),!0},e.prototype.CompareVar=function(t,e,i){return cr.do_cmp(t.getValue(),e,i)},e.prototype.IsGroupActive=function(t){var e=this.runtime.groups_by_name[t.toLowerCase()];return e&&e.group_active},e.prototype.IsPreview=function(){return"undefined"!=typeof cr_is_preview},e.prototype.PickAll=function(t){return!!t&&(!!t.instances.length&&(t.getCurrentSol().select_all=!0,t.applySolToContainer(),!0))},e.prototype.IsMobile=function(){return this.runtime.isMobile},e.prototype.CompareBetween=function(t,e,i){return t>=e&&t<=i},e.prototype.Else=function(){var t=this.runtime.getCurrentEventStack();return!t.else_branch_ran&&!t.last_event_true},e.prototype.OnLoadFinished=function(){return!0},e.prototype.OnCanvasSnapshot=function(){return!0},e.prototype.EffectsSupported=function(){return!!this.runtime.glwrap},e.prototype.OnSaveComplete=function(){return!0},e.prototype.OnSaveFailed=function(){return!0},e.prototype.OnLoadComplete=function(){return!0},e.prototype.OnLoadFailed=function(){return!0},e.prototype.ObjectUIDExists=function(t){return!!this.runtime.getObjectByUID(t)},e.prototype.IsOnPlatform=function(t){var e=this.runtime;switch(t){case 0:return!(e.isDomFree||e.isNodeWebkit||e.isCordova||e.isWinJS||e.isWindowsPhone8||e.isBlackberry10||e.isAmazonWebApp);case 1:return e.isiOS;case 2:return e.isAndroid;case 3:return e.isWindows8App;case 4:return e.isWindowsPhone8;case 5:return e.isBlackberry10;case 6:return e.isTizen;case 7:return e.isCocoonJs;case 8:return e.isCordova;case 9:return e.isArcade;case 10:return e.isNodeWebkit;case 11:return e.isCrosswalk;case 12:return e.isAmazonWebApp;case 13:return e.isWindows10;default:return!1}};var r=null,o="",a="";function h(t,e){return r&&t===o&&e===a||(r=new RegExp(t,e),o=t,a=e),r.lastIndex=0,r}e.prototype.RegexTest=function(t,e,i){return h(e,i).test(t)};var c=[];function l(){}e.prototype.PickOverlappingPoint=function(t,e,i){if(!t)return!1;var s,n,r,o=t.getCurrentSol(),a=o.getObjects(),h=this.runtime.getCurrentEventStack().current_event.orblock,l=this.runtime.getCurrentCondition();for(o.select_all?(cr.shallowAssignArray(c,a),cr.clearArray(o.else_instances),o.select_all=!1,cr.clearArray(o.instances)):h?(cr.shallowAssignArray(c,o.else_instances),cr.clearArray(o.else_instances)):(cr.shallowAssignArray(c,a),cr.clearArray(o.instances)),s=0,n=c.length;s<n;++s)(r=c[s]).update_bbox(),cr.xor(r.contains_pt(e,i),l.inverted)?o.instances.push(r):o.else_instances.push(r);return t.applySolToContainer(),cr.xor(!!o.instances.length,l.inverted)},e.prototype.IsNaN=function(t){return!!isNaN(t)},e.prototype.AngleWithin=function(t,e,i){return cr.angleDiff(cr.to_radians(t),cr.to_radians(i))<=cr.to_radians(e)},e.prototype.IsClockwiseFrom=function(t,e){return cr.angleClockwise(cr.to_radians(t),cr.to_radians(e))},e.prototype.IsBetweenAngles=function(t,e,i){var s=cr.to_clamped_radians(t),n=cr.to_clamped_radians(e),r=cr.to_clamped_radians(i);return!cr.angleClockwise(r,n)?!(!cr.angleClockwise(s,n)&&cr.angleClockwise(s,r)):cr.angleClockwise(s,n)&&!cr.angleClockwise(s,r)},e.prototype.IsValueType=function(t,e){return"number"==typeof t?0===e:1===e},t.cnds=new e,l.prototype.GoToLayout=function(t){this.runtime.isloading||this.runtime.changelayout||(this.runtime.changelayout=t)},l.prototype.NextPrevLayout=function(t){if(!this.runtime.isloading&&!this.runtime.changelayout){var e=this.runtime.layouts_by_index.indexOf(this.runtime.running_layout);if((!t||0!==e)&&(t||e!==this.runtime.layouts_by_index.length-1)){var i=this.runtime.layouts_by_index[e+(t?-1:1)];this.runtime.changelayout=i}}},l.prototype.CreateObject=function(t,e,i,s){if(e&&t){var n=this.runtime.createInstance(t,e,i,s);if(n){var r,o,a;if(this.runtime.isInOnDestroy++,this.runtime.trigger(Object.getPrototypeOf(t.plugin).cnds.OnCreated,n),n.is_contained)for(r=0,o=n.siblings.length;r<o;r++)a=n.siblings[r],this.runtime.trigger(Object.getPrototypeOf(a.type.plugin).cnds.OnCreated,a);this.runtime.isInOnDestroy--;var h=t.getCurrentSol();if(h.select_all=!1,cr.clearArray(h.instances),h.instances[0]=n,n.is_contained)for(r=0,o=n.siblings.length;r<o;r++)(h=(a=n.siblings[r]).type.getCurrentSol()).select_all=!1,cr.clearArray(h.instances),h.instances[0]=a}}},l.prototype.SetLayerVisible=function(t,e){t&&t.visible!==e&&(t.visible=e,this.runtime.redraw=!0)},l.prototype.SetLayerOpacity=function(t,e){t&&(e=cr.clamp(e/100,0,1),t.opacity!==e&&(t.opacity=e,this.runtime.redraw=!0))},l.prototype.SetLayerScaleRate=function(t,e){t&&t.zoomRate!==e&&(t.zoomRate=e,this.runtime.redraw=!0)},l.prototype.SetLayerForceOwnTexture=function(t,e){t&&(e=!!e,t.forceOwnTexture!==e&&(t.forceOwnTexture=e,this.runtime.redraw=!0))},l.prototype.SetLayoutScale=function(t){this.runtime.running_layout&&this.runtime.running_layout.scale!==t&&(this.runtime.running_layout.scale=t,this.runtime.running_layout.boundScrolling(),this.runtime.redraw=!0)},l.prototype.ScrollX=function(t){this.runtime.running_layout.scrollToX(t)},l.prototype.ScrollY=function(t){this.runtime.running_layout.scrollToY(t)},l.prototype.Scroll=function(t,e){this.runtime.running_layout.scrollToX(t),this.runtime.running_layout.scrollToY(e)},l.prototype.ScrollToObject=function(t){var e=t.getFirstPicked();e&&(this.runtime.running_layout.scrollToX(e.x),this.runtime.running_layout.scrollToY(e.y))},l.prototype.SetVar=function(t,e){0===t.vartype?cr.is_number(e)?t.setValue(e):t.setValue(parseFloat(e)):1===t.vartype&&t.setValue(e.toString())},l.prototype.AddVar=function(t,e){0===t.vartype?cr.is_number(e)?t.setValue(t.getValue()+e):t.setValue(t.getValue()+parseFloat(e)):1===t.vartype&&t.setValue(t.getValue()+e.toString())},l.prototype.SubVar=function(t,e){0===t.vartype&&(cr.is_number(e)?t.setValue(t.getValue()-e):t.setValue(t.getValue()-parseFloat(e)))},l.prototype.SetGroupActive=function(t,e){var i=this.runtime.groups_by_name[t.toLowerCase()];if(i)switch(e){case 0:i.setGroupActive(!1);break;case 1:i.setGroupActive(!0);break;case 2:i.setGroupActive(!i.group_active)}},l.prototype.SetTimescale=function(t){var e=t;e<0&&(e=0),this.runtime.timescale=e},l.prototype.SetObjectTimescale=function(t,e){var i=e;if(i<0&&(i=0),t){var s,n,r=t.getCurrentSol().getObjects();for(s=0,n=r.length;s<n;s++)r[s].my_timescale=i}},l.prototype.RestoreObjectTimescale=function(t){if(!t)return!1;var e,i,s=t.getCurrentSol().getObjects();for(e=0,i=s.length;e<i;e++)s[e].my_timescale=-1};var u=[];function p(){var t;return u.length?t=u.pop():((t={}).sols={},t.solModifiers=[]),t.deleteme=!1,t}function d(t){cr.wipe(t.sols),cr.clearArray(t.solModifiers),u.push(t)}var f=[];function g(){var t;return f.length?t=f.pop():(t={}).insts=[],t.sa=!1,t}function m(t){cr.clearArray(t.insts),f.push(t)}function y(t,e){var i=t[0]-e[0];return 0!==i?i:t[1]-e[1]}function _(t,e){return t[1]-e[1]}function v(){}l.prototype.Wait=function(t){if(!(t<0)){var e,i,s,n,r,o=this.runtime.getCurrentEventStack(),a=p();for(a.time=this.runtime.kahanTime.sum+t,a.signaltag="",a.signalled=!1,a.ev=o.current_event,a.actindex=o.actindex+1,e=0,i=this.runtime.types_by_index.length;e<i;e++)(s=(n=this.runtime.types_by_index[e]).getCurrentSol()).select_all&&-1===o.current_event.solModifiers.indexOf(n)||(a.solModifiers.push(n),(r=g()).sa=s.select_all,cr.shallowAssignArray(r.insts,s.instances),a.sols[e.toString()]=r);return this.waits.push(a),!0}},l.prototype.WaitForSignal=function(t){var e,i,s,n,r,o=this.runtime.getCurrentEventStack(),a=p();for(a.time=-1,a.signaltag=t.toLowerCase(),a.signalled=!1,a.ev=o.current_event,a.actindex=o.actindex+1,e=0,i=this.runtime.types_by_index.length;e<i;e++)(s=(n=this.runtime.types_by_index[e]).getCurrentSol()).select_all&&-1===o.current_event.solModifiers.indexOf(n)||(a.solModifiers.push(n),(r=g()).sa=s.select_all,cr.shallowAssignArray(r.insts,s.instances),a.sols[e.toString()]=r);return this.waits.push(a),!0},l.prototype.Signal=function(t){var e,i,s,n=t.toLowerCase();for(e=0,i=this.waits.length;e<i;++e)-1===(s=this.waits[e]).time&&s.signaltag===n&&(s.signalled=!0)},l.prototype.SetLayerScale=function(t,e){t&&t.scale!==e&&(t.scale=e,this.runtime.redraw=!0)},l.prototype.ResetGlobals=function(){var t,e,i;for(t=0,e=this.runtime.all_global_vars.length;t<e;t++)(i=this.runtime.all_global_vars[t]).data=i.initial},l.prototype.SetLayoutAngle=function(t){t=cr.to_radians(t),t=cr.clamp_angle(t),this.runtime.running_layout&&this.runtime.running_layout.angle!==t&&(this.runtime.running_layout.angle=t,this.runtime.redraw=!0)},l.prototype.SetLayerAngle=function(t,e){t&&(e=cr.to_radians(e),e=cr.clamp_angle(e),t.angle!==e&&(t.angle=e,this.runtime.redraw=!0))},l.prototype.SetLayerParallax=function(t,e,i){if(t&&(t.parallaxX!==e/100||t.parallaxY!==i/100)){if(t.parallaxX=e/100,t.parallaxY=i/100,1!==t.parallaxX||1!==t.parallaxY){var s,n,r=t.instances;for(s=0,n=r.length;s<n;++s)r[s].type.any_instance_parallaxed=!0}this.runtime.redraw=!0}},l.prototype.SetLayerBackground=function(t,e){if(t){var i=cr.GetRValue(e),s=cr.GetGValue(e),n=cr.GetBValue(e);t.background_color[0]===i&&t.background_color[1]===s&&t.background_color[2]===n||(t.background_color[0]=i,t.background_color[1]=s,t.background_color[2]=n,this.runtime.redraw=!0)}},l.prototype.SetLayerTransparent=function(t,e){t&&!!e!=!!t.transparent&&(t.transparent=!!e,this.runtime.redraw=!0)},l.prototype.SetLayerBlendMode=function(t,e){t&&t.blend_mode!==e&&(t.blend_mode=e,t.compositeOp=cr.effectToCompositeOp(t.blend_mode),this.runtime.gl&&cr.setGLBlend(t,t.blend_mode,this.runtime.gl),this.runtime.redraw=!0)},l.prototype.StopLoop=function(){this.runtime.loop_stack_index<0||(this.runtime.getCurrentLoop().stopped=!0)},l.prototype.GoToLayoutByName=function(t){var e;if(!this.runtime.isloading&&!this.runtime.changelayout)for(e in this.runtime.layouts)if(this.runtime.layouts.hasOwnProperty(e)&&cr.equals_nocase(e,t))return void(this.runtime.changelayout=this.runtime.layouts[e])},l.prototype.RestartLayout=function(t){var e,i,s;if(!this.runtime.isloading&&(!this.runtime.changelayout&&this.runtime.running_layout))for(this.runtime.changelayout=this.runtime.running_layout,e=0,i=this.runtime.allGroups.length;e<i;e++)(s=this.runtime.allGroups[e]).setGroupActive(s.initially_activated)},l.prototype.SnapshotCanvas=function(t,e){this.runtime.doCanvasSnapshot(0===t?"image/png":"image/jpeg",e/100)},l.prototype.SetCanvasSize=function(t,e){if(!(t<=0||e<=0)){var i=this.runtime.fullscreen_mode;(document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen||this.runtime.isNodeFullscreen)&&this.runtime.fullscreen_scaling>0&&(i=this.runtime.fullscreen_scaling),0===i?this.runtime.setSize(t,e,!0):(this.runtime.original_width=t,this.runtime.original_height=e,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0))}},l.prototype.SetLayoutEffectEnabled=function(t,e){if(this.runtime.running_layout&&this.runtime.glwrap){var i=this.runtime.running_layout.getEffectByName(e);if(i){var s=1===t;i.active!=s&&(i.active=s,this.runtime.running_layout.updateActiveEffects(),this.runtime.redraw=!0)}}},l.prototype.SetLayerEffectEnabled=function(t,e,i){if(t&&this.runtime.glwrap){var s=t.getEffectByName(i);if(s){var n=1===e;s.active!=n&&(s.active=n,t.updateActiveEffects(),this.runtime.redraw=!0)}}},l.prototype.SetLayoutEffectParam=function(t,e,i){if(this.runtime.running_layout&&this.runtime.glwrap){var s=this.runtime.running_layout.getEffectByName(t);if(s){var n=this.runtime.running_layout.effect_params[s.index];(e=Math.floor(e))<0||e>=n.length||(1===this.runtime.glwrap.getProgramParameterType(s.shaderindex,e)&&(i/=100),n[e]!==i&&(n[e]=i,s.active&&(this.runtime.redraw=!0)))}}},l.prototype.SetLayerEffectParam=function(t,e,i,s){if(t&&this.runtime.glwrap){var n=t.getEffectByName(e);if(n){var r=t.effect_params[n.index];(i=Math.floor(i))<0||i>=r.length||(1===this.runtime.glwrap.getProgramParameterType(n.shaderindex,i)&&(s/=100),r[i]!==s&&(r[i]=s,n.active&&(this.runtime.redraw=!0)))}}},l.prototype.SaveState=function(t){this.runtime.saveToSlot=t},l.prototype.LoadState=function(t){this.runtime.loadFromSlot=t},l.prototype.LoadStateJSON=function(t){this.runtime.loadFromJson=t},l.prototype.SetHalfFramerateMode=function(t){this.runtime.halfFramerateMode=0!==t},l.prototype.SetFullscreenQuality=function(t){(document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen||this.isNodeFullscreen||0!==this.runtime.fullscreen_mode)&&(this.runtime.wantFullscreenScalingQuality=0!==t,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0))},l.prototype.ResetPersisted=function(){var t,e;for(t=0,e=this.runtime.layouts_by_index.length;t<e;++t)this.runtime.layouts_by_index[t].persist_data={},this.runtime.layouts_by_index[t].first_visit=!0},l.prototype.RecreateInitialObjects=function(t,e,i,s,n){t&&this.runtime.running_layout.recreateInitialObjects(t,e,i,s,n)},l.prototype.SetPixelRounding=function(t){this.runtime.pixel_rounding=0!==t,this.runtime.redraw=!0},l.prototype.SetMinimumFramerate=function(t){t<1&&(t=1),t>120&&(t=120),this.runtime.minimumFramerate=t},l.prototype.SortZOrderByInstVar=function(t,e){if(t){var i,s,n,r,o,a,h=t.getCurrentSol().getObjects(),c=[],l=[],u=this.runtime.running_layout,p=t.is_family,d=t.family_index;for(i=0,s=h.length;i<s;++i)(n=h[i]).layer&&(r=p?n.instance_vars[e+n.type.family_var_map[d]]:n.instance_vars[e],c.push([n.layer.index,n.get_zindex()]),l.push([n,r]));if(c.length)for(c.sort(y),l.sort(_),i=0,s=c.length;i<s;++i)n=l[i][0],o=u.layers[c[i][0]],a=c[i][1],o.instances[a]!==n&&(o.instances[a]=n,n.layer=o,o.setZIndicesStaleFrom(a))}},t.acts=new l,v.prototype.int=function(t,e){cr.is_string(e)?(t.set_int(parseInt(e,10)),isNaN(t.data)&&(t.data=0)):t.set_int(e)},v.prototype.float=function(t,e){cr.is_string(e)?(t.set_float(parseFloat(e)),isNaN(t.data)&&(t.data=0)):t.set_float(e)},v.prototype.str=function(t,e){cr.is_string(e)?t.set_string(e):t.set_string(e.toString())},v.prototype.len=function(t,e){t.set_int(e.length||0)},v.prototype.random=function(t,e,i){void 0===i?t.set_float(Math.random()*e):t.set_float(Math.random()*(i-e)+e)},v.prototype.sqrt=function(t,e){t.set_float(Math.sqrt(e))},v.prototype.abs=function(t,e){t.set_float(Math.abs(e))},v.prototype.round=function(t,e){t.set_int(Math.round(e))},v.prototype.floor=function(t,e){t.set_int(Math.floor(e))},v.prototype.ceil=function(t,e){t.set_int(Math.ceil(e))},v.prototype.sin=function(t,e){t.set_float(Math.sin(cr.to_radians(e)))},v.prototype.cos=function(t,e){t.set_float(Math.cos(cr.to_radians(e)))},v.prototype.tan=function(t,e){t.set_float(Math.tan(cr.to_radians(e)))},v.prototype.asin=function(t,e){t.set_float(cr.to_degrees(Math.asin(e)))},v.prototype.acos=function(t,e){t.set_float(cr.to_degrees(Math.acos(e)))},v.prototype.atan=function(t,e){t.set_float(cr.to_degrees(Math.atan(e)))},v.prototype.exp=function(t,e){t.set_float(Math.exp(e))},v.prototype.ln=function(t,e){t.set_float(Math.log(e))},v.prototype.log10=function(t,e){t.set_float(Math.log(e)/Math.LN10)},v.prototype.max=function(t){var e,i,s,n=arguments[1];for("number"!=typeof n&&(n=0),e=2,i=arguments.length;e<i;e++)"number"==typeof(s=arguments[e])&&n<s&&(n=s);t.set_float(n)},v.prototype.min=function(t){var e,i,s,n=arguments[1];for("number"!=typeof n&&(n=0),e=2,i=arguments.length;e<i;e++)"number"==typeof(s=arguments[e])&&n>s&&(n=s);t.set_float(n)},v.prototype.dt=function(t){t.set_float(this.runtime.dt)},v.prototype.timescale=function(t){t.set_float(this.runtime.timescale)},v.prototype.wallclocktime=function(t){t.set_float((Date.now()-this.runtime.start_time)/1e3)},v.prototype.time=function(t){t.set_float(this.runtime.kahanTime.sum)},v.prototype.tickcount=function(t){t.set_int(this.runtime.tickcount)},v.prototype.objectcount=function(t){t.set_int(this.runtime.objectcount)},v.prototype.fps=function(t){t.set_int(this.runtime.fps)},v.prototype.loopindex=function(t,e){var i,s;if(this.runtime.loop_stack.length)if(e){for(s=this.runtime.loop_stack_index;s>=0;--s)if((i=this.runtime.loop_stack[s]).name===e)return void t.set_int(i.index);t.set_int(0)}else i=this.runtime.getCurrentLoop(),t.set_int(i?i.index:-1);else t.set_int(0)},v.prototype.distance=function(t,e,i,s,n){t.set_float(cr.distanceTo(e,i,s,n))},v.prototype.angle=function(t,e,i,s,n){t.set_float(cr.to_degrees(cr.angleTo(e,i,s,n)))},v.prototype.scrollx=function(t){t.set_float(this.runtime.running_layout.scrollX)},v.prototype.scrolly=function(t){t.set_float(this.runtime.running_layout.scrollY)},v.prototype.newline=function(t){t.set_string("\n")},v.prototype.lerp=function(t,e,i,s){t.set_float(cr.lerp(e,i,s))},v.prototype.qarp=function(t,e,i,s,n){t.set_float(cr.qarp(e,i,s,n))},v.prototype.cubic=function(t,e,i,s,n,r){t.set_float(cr.cubic(e,i,s,n,r))},v.prototype.cosp=function(t,e,i,s){t.set_float(cr.cosp(e,i,s))},v.prototype.windowwidth=function(t){t.set_int(this.runtime.width)},v.prototype.windowheight=function(t){t.set_int(this.runtime.height)},v.prototype.uppercase=function(t,e){t.set_string(cr.is_string(e)?e.toUpperCase():"")},v.prototype.lowercase=function(t,e){t.set_string(cr.is_string(e)?e.toLowerCase():"")},v.prototype.clamp=function(t,e,i,s){e<i?t.set_float(i):e>s?t.set_float(s):t.set_float(e)},v.prototype.layerscale=function(t,e){var i=this.runtime.getLayer(e);i?t.set_float(i.scale):t.set_float(0)},v.prototype.layeropacity=function(t,e){var i=this.runtime.getLayer(e);i?t.set_float(100*i.opacity):t.set_float(0)},v.prototype.layerscalerate=function(t,e){var i=this.runtime.getLayer(e);i?t.set_float(i.zoomRate):t.set_float(0)},v.prototype.layerparallaxx=function(t,e){var i=this.runtime.getLayer(e);i?t.set_float(100*i.parallaxX):t.set_float(0)},v.prototype.layerparallaxy=function(t,e){var i=this.runtime.getLayer(e);i?t.set_float(100*i.parallaxY):t.set_float(0)},v.prototype.layerindex=function(t,e){var i=this.runtime.getLayer(e);i?t.set_int(i.index):t.set_int(-1)},v.prototype.layoutscale=function(t){this.runtime.running_layout?t.set_float(this.runtime.running_layout.scale):t.set_float(0)},v.prototype.layoutangle=function(t){t.set_float(cr.to_degrees(this.runtime.running_layout.angle))},v.prototype.layerangle=function(t,e){var i=this.runtime.getLayer(e);i?t.set_float(cr.to_degrees(i.angle)):t.set_float(0)},v.prototype.layoutwidth=function(t){t.set_int(this.runtime.running_layout.width)},v.prototype.layoutheight=function(t){t.set_int(this.runtime.running_layout.height)},v.prototype.find=function(t,e,i){cr.is_string(e)&&cr.is_string(i)?t.set_int(e.search(new RegExp(cr.regexp_escape(i),"i"))):t.set_int(-1)},v.prototype.findcase=function(t,e,i){cr.is_string(e)&&cr.is_string(i)?t.set_int(e.search(new RegExp(cr.regexp_escape(i),""))):t.set_int(-1)},v.prototype.left=function(t,e,i){t.set_string(cr.is_string(e)?e.substr(0,i):"")},v.prototype.right=function(t,e,i){t.set_string(cr.is_string(e)?e.substr(e.length-i):"")},v.prototype.mid=function(t,e,i,s){t.set_string(cr.is_string(e)?e.substr(i,s):"")},v.prototype.tokenat=function(t,e,i,s){if(cr.is_string(e)&&cr.is_string(s)){var n=e.split(s),r=cr.floor(i);r<0||r>=n.length?t.set_string(""):t.set_string(n[r])}else t.set_string("")},v.prototype.tokencount=function(t,e,i){cr.is_string(e)&&e.length?t.set_int(e.split(i).length):t.set_int(0)},v.prototype.replace=function(t,e,i,s){cr.is_string(e)&&cr.is_string(i)&&cr.is_string(s)?t.set_string(e.replace(new RegExp(cr.regexp_escape(i),"gi"),s)):t.set_string(cr.is_string(e)?e:"")},v.prototype.trim=function(t,e){t.set_string(cr.is_string(e)?e.trim():"")},v.prototype.pi=function(t){t.set_float(cr.PI)},v.prototype.layoutname=function(t){this.runtime.running_layout?t.set_string(this.runtime.running_layout.name):t.set_string("")},v.prototype.renderer=function(t){t.set_string(this.runtime.gl?"webgl":"canvas2d")},v.prototype.rendererdetail=function(t){t.set_string(this.runtime.glUnmaskedRenderer)},v.prototype.anglediff=function(t,e,i){t.set_float(cr.to_degrees(cr.angleDiff(cr.to_radians(e),cr.to_radians(i))))},v.prototype.choose=function(t){var e=cr.floor(Math.random()*(arguments.length-1));t.set_any(arguments[e+1])},v.prototype.rgb=function(t,e,i,s){t.set_int(cr.RGB(e,i,s))},v.prototype.projectversion=function(t){t.set_string(this.runtime.versionstr)},v.prototype.projectname=function(t){t.set_string(this.runtime.projectName)},v.prototype.anglelerp=function(t,e,i,s){e=cr.to_radians(e),i=cr.to_radians(i);var n=cr.angleDiff(e,i);cr.angleClockwise(i,e)?t.set_float(cr.to_clamped_degrees(e+n*s)):t.set_float(cr.to_clamped_degrees(e-n*s))},v.prototype.anglerotate=function(t,e,i,s){e=cr.to_radians(e),i=cr.to_radians(i),s=cr.to_radians(s),t.set_float(cr.to_clamped_degrees(cr.angleRotate(e,i,s)))},v.prototype.zeropad=function(t,e,i){var s=e<0?"-":"";e<0&&(e=-e);for(var n=i-e.toString().length,r=0;r<n;r++)s+="0";t.set_string(s+e.toString())},v.prototype.cpuutilisation=function(t){t.set_float(this.runtime.cpuutilisation/1e3)},v.prototype.viewportleft=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?i.viewLeft:0)},v.prototype.viewporttop=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?i.viewTop:0)},v.prototype.viewportright=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?i.viewRight:0)},v.prototype.viewportbottom=function(t,e){var i=this.runtime.getLayer(e);t.set_float(i?i.viewBottom:0)},v.prototype.loadingprogress=function(t){t.set_float(this.runtime.loadingprogress)},v.prototype.unlerp=function(t,e,i,s){t.set_float(cr.unlerp(e,i,s))},v.prototype.canvassnapshot=function(t){t.set_string(this.runtime.snapshotData)},v.prototype.urlencode=function(t,e){t.set_string(encodeURIComponent(e))},v.prototype.urldecode=function(t,e){t.set_string(decodeURIComponent(e))},v.prototype.canvastolayerx=function(t,e,i,s){var n=this.runtime.getLayer(e);t.set_float(n?n.canvasToLayer(i,s,!0):0)},v.prototype.canvastolayery=function(t,e,i,s){var n=this.runtime.getLayer(e);t.set_float(n?n.canvasToLayer(i,s,!1):0)},v.prototype.layertocanvasx=function(t,e,i,s){var n=this.runtime.getLayer(e);t.set_float(n?n.layerToCanvas(i,s,!0):0)},v.prototype.layertocanvasy=function(t,e,i,s){var n=this.runtime.getLayer(e);t.set_float(n?n.layerToCanvas(i,s,!1):0)},v.prototype.savestatejson=function(t){t.set_string(this.runtime.lastSaveJson)},v.prototype.imagememoryusage=function(t){this.runtime.glwrap?t.set_float(Math.round(100*this.runtime.glwrap.estimateVRAM()/1048576)/100):t.set_float(0)},v.prototype.regexsearch=function(t,e,i,s){var n=h(i,s);t.set_int(e?e.search(n):-1)},v.prototype.regexreplace=function(t,e,i,s,n){var r=h(i,s);t.set_string(e?e.replace(r,n):"")};var b=[],w="",x="",S="";function T(t,e,i){if(t!==w||e!==x||i!==S){var s=h(e,i);b=t.match(s),w=t,x=e,S=i}}v.prototype.regexmatchcount=function(t,e,i,s){h(i,s);T(e.toString(),i,s),t.set_int(b?b.length:0)},v.prototype.regexmatchat=function(t,e,i,s,n){n=Math.floor(n);h(i,s);T(e.toString(),i,s),!b||n<0||n>=b.length?t.set_string(""):t.set_string(b[n])},v.prototype.infinity=function(t){t.set_float(1/0)},v.prototype.setbit=function(t,e,i,s){e|=0,i|=0,s=0!==s?1:0,t.set_int(e&~(1<<i)|s<<i)},v.prototype.togglebit=function(t,e,i){e|=0,i|=0,t.set_int(e^1<<i)},v.prototype.getbit=function(t,e,i){e|=0,i|=0,t.set_int(e&1<<i?1:0)},v.prototype.originalwindowwidth=function(t){t.set_int(this.runtime.original_width)},v.prototype.originalwindowheight=function(t){t.set_int(this.runtime.original_height)},t.exps=new v,t.runWaits=function(){var t,e,i,s,n,r,o,a=this.runtime.getCurrentEventStack();for(t=0,i=this.waits.length;t<i;t++){if(-1===(s=this.waits[t]).time){if(!s.signalled)continue}else if(s.time>this.runtime.kahanTime.sum)continue;for(n in a.current_event=s.ev,a.actindex=s.actindex,a.cndindex=0,s.sols)s.sols.hasOwnProperty(n)&&(r=this.runtime.types_by_index[parseInt(n,10)].getCurrentSol(),o=s.sols[n],r.select_all=o.sa,cr.shallowAssignArray(r.instances,o.insts),m(o));s.ev.resume_actions_and_subevents(),this.runtime.clearSol(s.solModifiers),s.deleteme=!0}for(t=0,e=0,i=this.waits.length;t<i;t++)s=this.waits[t],this.waits[e]=s,s.deleteme?d(s):e++;cr.truncateArray(this.waits,e)}}(),function(){cr.add_common_aces=function(t,e){var i=t[1],s=t[3],n=t[4],r=t[5],o=t[6],a=t[7],h=t[8];e.cnds||(e.cnds={}),e.acts||(e.acts={}),e.exps||(e.exps={});var c=e.cnds,l=e.acts,u=e.exps;s&&(c.CompareX=function(t,e){return cr.do_cmp(this.x,t,e)},c.CompareY=function(t,e){return cr.do_cmp(this.y,t,e)},c.IsOnScreen=function(){var t=this.layer;this.update_bbox();var e=this.bbox;return!(e.right<t.viewLeft||e.bottom<t.viewTop||e.left>t.viewRight||e.top>t.viewBottom)},c.IsOutsideLayout=function(){this.update_bbox();var t=this.bbox,e=this.runtime.running_layout;return t.right<0||t.bottom<0||t.left>e.width||t.top>e.height},c.PickDistance=function(t,e,i){var s=this.getCurrentSol(),n=s.getObjects();if(!n.length)return!1;var r,o,a,h=n[0],c=h,l=cr.distanceTo(h.x,h.y,e,i);for(r=1,o=n.length;r<o;r++)h=n[r],a=cr.distanceTo(h.x,h.y,e,i),(0===t&&a<l||1===t&&a>l)&&(l=a,c=h);return s.pick_one(c),!0},l.SetX=function(t){this.x!==t&&(this.x=t,this.set_bbox_changed())},l.SetY=function(t){this.y!==t&&(this.y=t,this.set_bbox_changed())},l.SetPos=function(t,e){this.x===t&&this.y===e||(this.x=t,this.y=e,this.set_bbox_changed())},l.SetPosToObject=function(t,e){var i,s,n=t.getPairedInstance(this);n&&(n.getImagePoint?(i=n.getImagePoint(e,!0),s=n.getImagePoint(e,!1)):(i=n.x,s=n.y),this.x===i&&this.y===s||(this.x=i,this.y=s,this.set_bbox_changed()))},l.MoveForward=function(t){0!==t&&(this.x+=Math.cos(this.angle)*t,this.y+=Math.sin(this.angle)*t,this.set_bbox_changed())},l.MoveAtAngle=function(t,e){0!==e&&(this.x+=Math.cos(cr.to_radians(t))*e,this.y+=Math.sin(cr.to_radians(t))*e,this.set_bbox_changed())},u.X=function(t){t.set_float(this.x)},u.Y=function(t){t.set_float(this.y)},u.dt=function(t){t.set_float(this.runtime.getDt(this))}),n&&(c.CompareWidth=function(t,e){return cr.do_cmp(this.width,t,e)},c.CompareHeight=function(t,e){return cr.do_cmp(this.height,t,e)},l.SetWidth=function(t){this.width!==t&&(this.width=t,this.set_bbox_changed())},l.SetHeight=function(t){this.height!==t&&(this.height=t,this.set_bbox_changed())},l.SetSize=function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.set_bbox_changed())},u.Width=function(t){t.set_float(this.width)},u.Height=function(t){t.set_float(this.height)},u.BBoxLeft=function(t){this.update_bbox(),t.set_float(this.bbox.left)},u.BBoxTop=function(t){this.update_bbox(),t.set_float(this.bbox.top)},u.BBoxRight=function(t){this.update_bbox(),t.set_float(this.bbox.right)},u.BBoxBottom=function(t){this.update_bbox(),t.set_float(this.bbox.bottom)}),r&&(c.AngleWithin=function(t,e){return cr.angleDiff(this.angle,cr.to_radians(e))<=cr.to_radians(t)},c.IsClockwiseFrom=function(t){return cr.angleClockwise(this.angle,cr.to_radians(t))},c.IsBetweenAngles=function(t,e){var i=cr.to_clamped_radians(t),s=cr.to_clamped_radians(e),n=cr.clamp_angle(this.angle);return!cr.angleClockwise(s,i)?!(!cr.angleClockwise(n,i)&&cr.angleClockwise(n,s)):cr.angleClockwise(n,i)&&!cr.angleClockwise(n,s)},l.SetAngle=function(t){var e=cr.to_radians(cr.clamp_angle_degrees(t));isNaN(e)||this.angle!==e&&(this.angle=e,this.set_bbox_changed())},l.RotateClockwise=function(t){0===t||isNaN(t)||(this.angle+=cr.to_radians(t),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},l.RotateCounterclockwise=function(t){0===t||isNaN(t)||(this.angle-=cr.to_radians(t),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},l.RotateTowardAngle=function(t,e){var i=cr.angleRotate(this.angle,cr.to_radians(e),cr.to_radians(t));isNaN(i)||this.angle!==i&&(this.angle=i,this.set_bbox_changed())},l.RotateTowardPosition=function(t,e,i){var s=e-this.x,n=i-this.y,r=Math.atan2(n,s),o=cr.angleRotate(this.angle,r,cr.to_radians(t));isNaN(o)||this.angle!==o&&(this.angle=o,this.set_bbox_changed())},l.SetTowardPosition=function(t,e){var i=t-this.x,s=e-this.y,n=Math.atan2(s,i);isNaN(n)||this.angle!==n&&(this.angle=n,this.set_bbox_changed())},u.Angle=function(t){t.set_float(cr.to_clamped_degrees(this.angle))}),i||(c.CompareInstanceVar=function(t,e,i){return cr.do_cmp(this.instance_vars[t],e,i)},c.IsBoolInstanceVarSet=function(t){return this.instance_vars[t]},c.PickInstVarHiLow=function(t,e){var i=this.getCurrentSol(),s=i.getObjects();if(!s.length)return!1;var n,r,o,a=s[0],h=a,c=a.instance_vars[e];for(n=1,r=s.length;n<r;n++)o=(a=s[n]).instance_vars[e],(0===t&&o<c||1===t&&o>c)&&(c=o,h=a);return i.pick_one(h),!0},c.PickByUID=function(t){var e,i,s,n,r,o,a;if(this.runtime.getCurrentCondition().inverted){if((a=this.getCurrentSol()).select_all){for(a.select_all=!1,cr.clearArray(a.instances),cr.clearArray(a.else_instances),e=0,i=(o=this.instances).length;e<i;e++)(n=o[e]).uid===t?a.else_instances.push(n):a.instances.push(n);return this.applySolToContainer(),!!a.instances.length}for(e=0,s=0,i=a.instances.length;e<i;e++)n=a.instances[e],a.instances[s]=n,n.uid===t?a.else_instances.push(n):s++;return cr.truncateArray(a.instances,s),this.applySolToContainer(),!!a.instances.length}if(!(n=this.runtime.getObjectByUID(t)))return!1;if(!(a=this.getCurrentSol()).select_all&&-1===a.instances.indexOf(n))return!1;if(this.is_family){for(e=0,i=(r=n.type.families).length;e<i;e++)if(r[e]===this)return a.pick_one(n),this.applySolToContainer(),!0}else if(n.type===this)return a.pick_one(n),this.applySolToContainer(),!0;return!1},c.OnCreated=function(){return!0},c.OnDestroyed=function(){return!0},l.SetInstanceVar=function(t,e){var i=this.instance_vars;cr.is_number(i[t])?cr.is_number(e)?i[t]=e:i[t]=parseFloat(e):cr.is_string(i[t])&&(cr.is_string(e)?i[t]=e:i[t]=e.toString())},l.AddInstanceVar=function(t,e){var i=this.instance_vars;cr.is_number(i[t])?cr.is_number(e)?i[t]+=e:i[t]+=parseFloat(e):cr.is_string(i[t])&&(cr.is_string(e)?i[t]+=e:i[t]+=e.toString())},l.SubInstanceVar=function(t,e){var i=this.instance_vars;cr.is_number(i[t])&&(cr.is_number(e)?i[t]-=e:i[t]-=parseFloat(e))},l.SetBoolInstanceVar=function(t,e){this.instance_vars[t]=e?1:0},l.ToggleBoolInstanceVar=function(t){this.instance_vars[t]=1-this.instance_vars[t]},l.Destroy=function(){this.runtime.DestroyInstance(this)},l.LoadFromJsonString||(l.LoadFromJsonString=function(t){var e,i,s,n;try{e=JSON.parse(t)}catch(t){return}if(this.runtime.loadInstanceFromJSON(this,e,!0),this.afterLoad&&this.afterLoad(),this.behavior_insts)for(i=0,s=this.behavior_insts.length;i<s;++i)(n=this.behavior_insts[i]).afterLoad&&n.afterLoad()}),u.Count=function(t){var e,i,s,n=t.object_class.instances.length;for(e=0,i=this.runtime.createRow.length;e<i;e++)s=this.runtime.createRow[e],t.object_class.is_family?s.type.families.indexOf(t.object_class)>=0&&n++:s.type===t.object_class&&n++;t.set_int(n)},u.PickedCount=function(t){t.set_int(t.object_class.getCurrentSol().getObjects().length)},u.UID=function(t){t.set_int(this.uid)},u.IID=function(t){t.set_int(this.get_iid())},u.AsJSON||(u.AsJSON=function(t){t.set_string(JSON.stringify(this.runtime.saveInstanceToJSON(this,!0)))})),o&&(c.IsVisible=function(){return this.visible},l.SetVisible=function(t){!t!=!this.visible&&(this.visible=!!t,this.runtime.redraw=!0)},c.CompareOpacity=function(t,e){return cr.do_cmp(cr.round6dp(100*this.opacity),t,e)},l.SetOpacity=function(t){var e=t/100;e<0?e=0:e>1&&(e=1),e!==this.opacity&&(this.opacity=e,this.runtime.redraw=!0)},u.Opacity=function(t){t.set_float(cr.round6dp(100*this.opacity))}),a&&(c.IsOnLayer=function(t){return!!t&&this.layer===t},c.PickTopBottom=function(t){var e=this.getCurrentSol(),i=e.getObjects();if(!i.length)return!1;var s,n,r=i[0],o=r;for(s=1,n=i.length;s<n;s++)r=i[s],0===t?(r.layer.index>o.layer.index||r.layer.index===o.layer.index&&r.get_zindex()>o.get_zindex())&&(o=r):(r.layer.index<o.layer.index||r.layer.index===o.layer.index&&r.get_zindex()<o.get_zindex())&&(o=r);return e.pick_one(o),!0},l.MoveToTop=function(){var t=this.layer,e=t.instances;e.length&&e[e.length-1]===this||(t.removeFromInstanceList(this,!1),t.appendToInstanceList(this,!1),this.runtime.redraw=!0)},l.MoveToBottom=function(){var t=this.layer,e=t.instances;e.length&&e[0]===this||(t.removeFromInstanceList(this,!1),t.prependToInstanceList(this,!1),this.runtime.redraw=!0)},l.MoveToLayer=function(t){t&&t!=this.layer&&(this.layer.removeFromInstanceList(this,!0),this.layer=t,t.appendToInstanceList(this,!0),this.runtime.redraw=!0)},l.ZMoveToObject=function(t,e){var i=0===t;if(e){var s=e.getFirstPicked(this);s&&s.uid!==this.uid&&(this.layer.index!==s.layer.index&&(this.layer.removeFromInstanceList(this,!0),this.layer=s.layer,s.layer.appendToInstanceList(this,!0)),this.layer.moveInstanceAdjacent(this,s,i),this.runtime.redraw=!0)}},u.LayerNumber=function(t){t.set_int(this.layer.number)},u.LayerName=function(t){t.set_string(this.layer.name)},u.ZIndex=function(t){t.set_int(this.get_zindex())}),h&&(l.SetEffectEnabled=function(t,e){if(this.runtime.glwrap){var i=this.type.getEffectIndexByName(e);if(!(i<0)){var s=1===t;this.active_effect_flags[i]!==s&&(this.active_effect_flags[i]=s,this.updateActiveEffects(),this.runtime.redraw=!0)}}},l.SetEffectParam=function(t,e,i){if(this.runtime.glwrap){var s=this.type.getEffectIndexByName(t);if(!(s<0)){var n=this.type.effect_types[s],r=this.effect_params[s];(e=Math.floor(e))<0||e>=r.length||(1===this.runtime.glwrap.getProgramParameterType(n.shaderindex,e)&&(i/=100),r[e]!==i&&(r[e]=i,n.active&&(this.runtime.redraw=!0)))}}})},cr.set_bbox_changed=function(){this.bbox_changed=!0,this.cell_changed=!0,this.type.any_cell_changed=!0,this.runtime.redraw=!0;var t,e,i=this.bbox_changed_callbacks;for(t=0,e=i.length;t<e;++t)i[t](this);this.layer.useRenderCells&&this.update_bbox()},cr.add_bbox_changed_callback=function(t){t&&this.bbox_changed_callbacks.push(t)},cr.update_bbox=function(){if(this.bbox_changed){var t=this.bbox,e=this.bquad;t.set(this.x,this.y,this.x+this.width,this.y+this.height),t.offset(-this.hotspotX*this.width,-this.hotspotY*this.height),this.angle?(t.offset(-this.x,-this.y),e.set_from_rotated_rect(t,this.angle),e.offset(this.x,this.y),e.bounding_box(t)):e.set_from_rect(t),t.normalize(),this.bbox_changed=!1,this.update_render_cell()}};var t=new cr.rect(0,0,0,0);cr.update_render_cell=function(){if(this.layer.useRenderCells){var e=this.layer.render_grid,i=this.bbox;t.set(e.XToCell(i.left),e.YToCell(i.top),e.XToCell(i.right),e.YToCell(i.bottom)),this.rendercells.equals(t)||(this.rendercells.right<this.rendercells.left?e.update(this,null,t):e.update(this,this.rendercells,t),this.rendercells.copy(t),this.layer.render_list_stale=!0)}},cr.update_collision_cell=function(){if(this.cell_changed&&this.collisionsEnabled){this.update_bbox();var e=this.type.collision_grid,i=this.bbox;t.set(e.XToCell(i.left),e.YToCell(i.top),e.XToCell(i.right),e.YToCell(i.bottom)),this.collcells.equals(t)||(this.collcells.right<this.collcells.left?e.update(this,null,t):e.update(this,this.collcells,t),this.collcells.copy(t),this.cell_changed=!1)}},cr.inst_contains_pt=function(t,e){return!!this.bbox.contains_pt(t,e)&&(!!this.bquad.contains_pt(t,e)&&(this.tilemap_exists?this.testPointOverlapTile(t,e):!(this.collision_poly&&!this.collision_poly.is_empty())||(this.collision_poly.cache_poly(this.width,this.height,this.angle),this.collision_poly.contains_pt(t-this.x,e-this.y))))},cr.inst_get_iid=function(){return this.type.updateIIDs(),this.iid},cr.inst_get_zindex=function(){return this.layer.updateZIndices(),this.zindex},cr.inst_updateActiveEffects=function(){var t,e,i;cr.clearArray(this.active_effect_types);var s=!0;for(t=0,e=this.active_effect_flags.length;t<e;t++)this.active_effect_flags[t]&&(i=this.type.effect_types[t],this.active_effect_types.push(i),i.preservesOpaqueness||(s=!1));this.uses_shaders=!!this.active_effect_types.length,this.shaders_preserve_opaqueness=s},cr.inst_toString=function(){return"Inst"+this.puid},cr.type_getFirstPicked=function(t){var e,i,s;if(t&&t.is_contained&&t.type!=this)for(e=0,i=t.siblings.length;e<i;e++)if((s=t.siblings[e]).type==this)return s;var n=this.getCurrentSol().getObjects();return n.length?n[0]:null},cr.type_getPairedInstance=function(t){var e=this.getCurrentSol().getObjects();return e.length?e[t.get_iid()%e.length]:null},cr.type_updateIIDs=function(){if(this.stale_iids&&!this.is_family){var t,e;for(t=0,e=this.instances.length;t<e;t++)this.instances[t].iid=t;var i=t,s=this.runtime.createRow;for(t=0,e=s.length;t<e;++t)s[t].type===this&&(s[t].iid=i++);this.stale_iids=!1}},cr.type_getInstanceByIID=function(t){if(t<this.instances.length)return this.instances[t];t-=this.instances.length;var e,i,s=this.runtime.createRow;for(e=0,i=s.length;e<i;++e)if(s[e].type===this){if(0===t)return s[e];--t}return null},cr.type_getCurrentSol=function(){return this.solstack[this.cur_sol]},cr.type_pushCleanSol=function(){this.cur_sol++,this.cur_sol===this.solstack.length?this.solstack.push(new cr.selection(this)):(this.solstack[this.cur_sol].select_all=!0,cr.clearArray(this.solstack[this.cur_sol].else_instances))},cr.type_pushCopySol=function(){this.cur_sol++,this.cur_sol===this.solstack.length&&this.solstack.push(new cr.selection(this));var t=this.solstack[this.cur_sol],e=this.solstack[this.cur_sol-1];e.select_all?t.select_all=!0:(t.select_all=!1,cr.shallowAssignArray(t.instances,e.instances)),cr.clearArray(t.else_instances)},cr.type_popSol=function(){this.cur_sol--},cr.type_getBehaviorByName=function(t){var e,i,s,n,r,o=0;if(!this.is_family)for(e=0,i=this.families.length;e<i;e++)for(s=0,n=(r=this.families[e]).behaviors.length;s<n;s++){if(t===r.behaviors[s].name)return this.extra.lastBehIndex=o,r.behaviors[s];o++}for(e=0,i=this.behaviors.length;e<i;e++){if(t===this.behaviors[e].name)return this.extra.lastBehIndex=o,this.behaviors[e];o++}return null},cr.type_getBehaviorIndexByName=function(t){return this.getBehaviorByName(t)?this.extra.lastBehIndex:-1},cr.type_getEffectIndexByName=function(t){var e,i;for(e=0,i=this.effect_types.length;e<i;e++)if(this.effect_types[e].name===t)return e;return-1},cr.type_applySolToContainer=function(){if(this.is_contained&&!this.is_family){var t,e,i,s,n,r,o;this.updateIIDs();var a=(r=this.getCurrentSol()).select_all,h=this.runtime.getCurrentEventStack(),c=h&&h.current_event&&h.current_event.orblock;for(t=0,e=this.container.length;t<e;t++)if((n=this.container[t])!==this&&(n.updateIIDs(),(o=n.getCurrentSol()).select_all=a,!a)){for(cr.clearArray(o.instances),i=0,s=r.instances.length;i<s;++i)o.instances[i]=n.getInstanceByIID(r.instances[i].iid);if(c)for(cr.clearArray(o.else_instances),i=0,s=r.else_instances.length;i<s;++i)o.else_instances[i]=n.getInstanceByIID(r.else_instances[i].iid)}}},cr.type_toString=function(){return"Type"+this.sid},cr.do_cmp=function(t,e,i){if(void 0===t||void 0===i)return!1;switch(e){case 0:return t===i;case 1:return t!==i;case 2:return t<i;case 3:return t<=i;case 4:return t>i;case 5:return t>=i;default:return!1}}}(),cr.shaders={},cr.shaders.difference={src:["varying mediump vec2 vTex;","uniform lowp sampler2D samplerFront;","uniform lowp sampler2D samplerBack;","uniform mediump vec2 destStart;","uniform mediump vec2 destEnd;","void main(void)","{","lowp vec4 front = texture2D(samplerFront, vTex);","front.rgb /= front.a;","lowp vec4 back = texture2D(samplerBack, mix(destStart, destEnd, vTex));","back.rgb /= back.a;","front.rgb = (max(front.rgb, back.rgb) - min(front.rgb, back.rgb)) * front.a;","gl_FragColor = front;","}"].join("\n"),extendBoxHorizontal:0,extendBoxVertical:0,crossSampling:!0,preservesOpaqueness:!1,animated:!1,parameters:[]},cr.shaders.replacecolor={src:["varying mediump vec2 vTex;","uniform lowp sampler2D samplerFront;","uniform mediump float rsource;","uniform mediump float gsource;","uniform mediump float bsource;","uniform mediump float rdest;","uniform mediump float gdest;","uniform mediump float bdest;","uniform lowp float tolerance;","void main(void)","{","lowp vec4 front = texture2D(samplerFront, vTex);","lowp float a = front.a;","if (a != 0.0)","front.rgb /= a;","lowp float diff = length(front.rgb - vec3(rsource, gsource, bsource) / 255.0);","if (diff <= tolerance)","{","front.rgb = mix(front.rgb, vec3(rdest, gdest, bdest) / 255.0, 1.0 - diff / tolerance);","}","front.rgb *= a;","gl_FragColor = front;","}"].join("\n"),extendBoxHorizontal:0,extendBoxVertical:0,crossSampling:!1,preservesOpaqueness:!0,animated:!1,parameters:[["rsource",0,0],["gsource",0,0],["bsource",0,0],["rdest",0,0],["gdest",0,0],["bdest",0,0],["tolerance",0,1]]},cr.plugins_.AJAX=function(t){this.runtime=t},function(){var t=!1,e=null,i=null,s="",n=cr.plugins_.AJAX.prototype;n.Type=function(t){this.plugin=t,this.runtime=t.runtime},n.Type.prototype.onCreate=function(){},n.Instance=function(n){if(this.type=n,this.runtime=n.runtime,this.lastData="",this.curTag="",this.progress=0,this.timeout=-1,t=this.runtime.isNWjs){e=require("path"),i=require("fs");var r=window.process||nw.process;s=e.dirname(r.execPath)+"\\"}};var r=n.Instance.prototype,o=null;window.C2_AJAX_DCSide=function(t,e,i){o&&("success"===t?(o.curTag=e,o.lastData=i,o.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,o),o.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,o)):"error"===t?(o.curTag=e,o.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,o),o.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,o)):"progress"===t&&(o.progress=i,o.curTag=e,o.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnProgress,o)))},r.onCreate=function(){o=this},r.saveToJSON=function(){return{lastData:this.lastData}},r.loadFromJSON=function(t){this.lastData=t.lastData,this.curTag="",this.progress=0};var a={},h="";function c(){}function l(){}function u(){}r.doRequest=function(e,n,r,o){if(this.runtime.isDirectCanvas)AppMobi.webview.execute('C2_AJAX_WebSide("'+e+'", "'+n+'", "'+r+'", '+(o?'"'+o+'"':"null")+");");else{var c=this,l=null,u=function(){c.curTag=e,c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,c),c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,c)},p=function(){if(t){var r=s+n;i.existsSync(r)?i.readFile(r,{encoding:"utf8"},function(t,i){t?u():(c.curTag=e,c.lastData=i.replace(/\r\n/g,"\n"),c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,c),c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,c))}):u()}else u()};try{(l=this.runtime.isWindowsPhone8?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest).onreadystatechange=function(){4===l.readyState&&(c.curTag=e,l.responseText?c.lastData=l.responseText.replace(/\r\n/g,"\n"):c.lastData="",l.status>=400?(c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,c),c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,c)):t&&!c.lastData.length||!t&&0===l.status&&!c.lastData.length||(c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,c),c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,c)))},this.runtime.isWindowsPhone8||(l.onerror=p,l.ontimeout=p,l.onabort=p,l.onprogress=function(t){t.lengthComputable&&(c.progress=t.loaded/t.total,c.curTag=e,c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnProgress,c))}),l.open(r,n),this.runtime.isWindowsPhone8||this.timeout>=0&&void 0!==l.timeout&&(l.timeout=this.timeout);try{l.responseType="text"}catch(t){}if(o&&l.setRequestHeader&&!a.hasOwnProperty("Content-Type")&&l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.setRequestHeader){var d;for(d in a)if(a.hasOwnProperty(d))try{l.setRequestHeader(d,a[d])}catch(t){}a={}}if(h&&l.overrideMimeType){try{l.overrideMimeType(h)}catch(t){}h=""}o?l.send(o):l.send()}catch(t){p()}}},c.prototype.OnComplete=function(t){return cr.equals_nocase(t,this.curTag)},c.prototype.OnAnyComplete=function(t){return!0},c.prototype.OnError=function(t){return cr.equals_nocase(t,this.curTag)},c.prototype.OnAnyError=function(t){return!0},c.prototype.OnProgress=function(t){return cr.equals_nocase(t,this.curTag)},n.cnds=new c,l.prototype.Request=function(t,e){var i=this;this.runtime.isWKWebView&&!this.runtime.isAbsoluteUrl(e)?this.runtime.fetchLocalFileViaCordovaAsText(e,function(e){i.curTag=t,i.lastData=e.replace(/\r\n/g,"\n"),i.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,i),i.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,i)},function(e){i.curTag=t,i.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,i),i.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,i)}):this.doRequest(t,e,"GET")},l.prototype.RequestFile=function(t,e){var i=this;this.runtime.isWKWebView?this.runtime.fetchLocalFileViaCordovaAsText(e,function(e){i.curTag=t,i.lastData=e.replace(/\r\n/g,"\n"),i.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,i),i.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,i)},function(e){i.curTag=t,i.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,i),i.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,i)}):this.doRequest(t,e,"GET")},l.prototype.Post=function(t,e,i,s){this.doRequest(t,e,s,i)},l.prototype.SetTimeout=function(t){this.timeout=1e3*t},l.prototype.SetHeader=function(t,e){a[t]=e},l.prototype.OverrideMIMEType=function(t){h=t},n.acts=new l,u.prototype.LastData=function(t){t.set_string(this.lastData)},u.prototype.Progress=function(t){t.set_float(this.progress)},u.prototype.Tag=function(t){t.set_string(this.curTag)},n.exps=new u}(),cr.plugins_.Arr=function(t){this.runtime=t},function(){var t=cr.plugins_.Arr.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,i=[];function s(){return i.length?i.pop():[]}function n(t){var e,s;for(e=0,s=t.length;e<s;e++)Array.isArray(t[e])&&n(t[e]);cr.clearArray(t),i.push(t)}function r(){}function o(){}function a(t,e){if(cr.is_number(t)&&cr.is_number(e))return t-e;var i=""+t,s=""+e;return i<s?-1:i>s?1:0}function h(){}Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),e.onCreate=function(){this.cx=this.properties[0],this.cy=this.properties[1],this.cz=this.properties[2],this.recycled||(this.arr=s());var t,e,i,n=this.arr;for(n.length=this.cx,t=0;t<this.cx;t++)for(n[t]||(n[t]=s()),n[t].length=this.cy,e=0;e<this.cy;e++)for(n[t][e]||(n[t][e]=s()),n[t][e].length=this.cz,i=0;i<this.cz;i++)n[t][e][i]=0;this.forX=[],this.forY=[],this.forZ=[],this.forDepth=-1},e.onDestroy=function(){var t;for(t=0;t<this.cx;t++)n(this.arr[t]);cr.clearArray(this.arr)},e.at=function(t,e,i){return t=Math.floor(t),e=Math.floor(e),i=Math.floor(i),isNaN(t)||t<0||t>this.cx-1||isNaN(e)||e<0||e>this.cy-1||isNaN(i)||i<0||i>this.cz-1?0:this.arr[t][e][i]},e.set=function(t,e,i,s){t=Math.floor(t),e=Math.floor(e),i=Math.floor(i),isNaN(t)||t<0||t>this.cx-1||isNaN(e)||e<0||e>this.cy-1||isNaN(i)||i<0||i>this.cz-1||(this.arr[t][e][i]=s)},e.getAsJSON=function(){return JSON.stringify({c2array:!0,size:[this.cx,this.cy,this.cz],data:this.arr})},e.saveToJSON=function(){return{size:[this.cx,this.cy,this.cz],data:this.arr}},e.loadFromJSON=function(t){var e=t.size;this.cx=e[0],this.cy=e[1],this.cz=e[2],this.arr=t.data},e.setSize=function(t,e,i){if(t<0&&(t=0),e<0&&(e=0),i<0&&(i=0),this.cx!==t||this.cy!==e||this.cz!==i){var n,r,o;this.cx=t,this.cy=e,this.cz=i;var a=this.arr;for(a.length=t,n=0;n<this.cx;n++)for(cr.is_undefined(a[n])&&(a[n]=s()),a[n].length=e,r=0;r<this.cy;r++)for(cr.is_undefined(a[n][r])&&(a[n][r]=s()),a[n][r].length=i,o=0;o<this.cz;o++)cr.is_undefined(a[n][r][o])&&(a[n][r][o]=0)}},e.getForX=function(){return this.forDepth>=0&&this.forDepth<this.forX.length?this.forX[this.forDepth]:0},e.getForY=function(){return this.forDepth>=0&&this.forDepth<this.forY.length?this.forY[this.forDepth]:0},e.getForZ=function(){return this.forDepth>=0&&this.forDepth<this.forZ.length?this.forZ[this.forDepth]:0},r.prototype.CompareX=function(t,e,i){return cr.do_cmp(this.at(t,0,0),e,i)},r.prototype.CompareXY=function(t,e,i,s){return cr.do_cmp(this.at(t,e,0),i,s)},r.prototype.CompareXYZ=function(t,e,i,s,n){return cr.do_cmp(this.at(t,e,i),s,n)},e.doForEachTrigger=function(t){this.runtime.pushCopySol(t.solModifiers),t.retrigger(),this.runtime.popSol(t.solModifiers)},r.prototype.ArrForEach=function(t){var e=this.runtime.getCurrentEventStack().current_event;this.forDepth++;var i=this.forDepth;switch(i===this.forX.length?(this.forX.push(0),this.forY.push(0),this.forZ.push(0)):(this.forX[i]=0,this.forY[i]=0,this.forZ[i]=0),t){case 0:for(this.forX[i]=0;this.forX[i]<this.cx;this.forX[i]++)for(this.forY[i]=0;this.forY[i]<this.cy;this.forY[i]++)for(this.forZ[i]=0;this.forZ[i]<this.cz;this.forZ[i]++)this.doForEachTrigger(e);break;case 1:for(this.forX[i]=0;this.forX[i]<this.cx;this.forX[i]++)for(this.forY[i]=0;this.forY[i]<this.cy;this.forY[i]++)this.doForEachTrigger(e);break;case 2:for(this.forX[i]=0;this.forX[i]<this.cx;this.forX[i]++)this.doForEachTrigger(e)}return this.forDepth--,!1},r.prototype.CompareCurrent=function(t,e){return cr.do_cmp(this.at(this.getForX(),this.getForY(),this.getForZ()),t,e)},r.prototype.Contains=function(t){var e,i,s;for(e=0;e<this.cx;e++)for(i=0;i<this.cy;i++)for(s=0;s<this.cz;s++)if(this.arr[e][i][s]===t)return!0;return!1},r.prototype.IsEmpty=function(){return 0===this.cx||0===this.cy||0===this.cz},r.prototype.CompareSize=function(t,e,i){var s=0;switch(t){case 0:s=this.cx;break;case 1:s=this.cy;break;case 2:s=this.cz}return cr.do_cmp(s,e,i)},t.cnds=new r,o.prototype.Clear=function(){var t,e,i;for(t=0;t<this.cx;t++)for(e=0;e<this.cy;e++)for(i=0;i<this.cz;i++)this.arr[t][e][i]=0},o.prototype.SetSize=function(t,e,i){this.setSize(t,e,i)},o.prototype.SetX=function(t,e){this.set(t,0,0,e)},o.prototype.SetXY=function(t,e,i){this.set(t,e,0,i)},o.prototype.SetXYZ=function(t,e,i,s){this.set(t,e,i,s)},o.prototype.Push=function(t,e,i){var n=0,r=0,o=0,a=this.arr;switch(i){case 0:for(0===t?(n=a.length,a.push(s())):(n=0,a.unshift(s())),a[n].length=this.cy;r<this.cy;r++)for(a[n][r]=s(),a[n][r].length=this.cz,o=0;o<this.cz;o++)a[n][r][o]=e;this.cx++;break;case 1:for(;n<this.cx;n++)for(0===t?(r=a[n].length,a[n].push(s())):(r=0,a[n].unshift(s())),a[n][r].length=this.cz,o=0;o<this.cz;o++)a[n][r][o]=e;this.cy++;break;case 2:for(;n<this.cx;n++)for(r=0;r<this.cy;r++)0===t?a[n][r].push(e):a[n][r].unshift(e);this.cz++}},o.prototype.Pop=function(t,e){var i=0,s=0,r=this.arr;switch(e){case 0:if(0===this.cx)break;n(0===t?r.pop():r.shift()),this.cx--;break;case 1:if(0===this.cy)break;for(;i<this.cx;i++)n(0===t?r[i].pop():r[i].shift());this.cy--;break;case 2:if(0===this.cz)break;for(;i<this.cx;i++)for(s=0;s<this.cy;s++)0===t?r[i][s].pop():r[i][s].shift();this.cz--}},o.prototype.Reverse=function(t){var e=0,i=0,s=this.arr;if(0!==this.cx&&0!==this.cy&&0!==this.cz)switch(t){case 0:s.reverse();break;case 1:for(;e<this.cx;e++)s[e].reverse();break;case 2:for(;e<this.cx;e++)for(i=0;i<this.cy;i++)s[e][i].reverse()}},o.prototype.Sort=function(t){var e=0,i=0,s=this.arr;if(0!==this.cx&&0!==this.cy&&0!==this.cz)switch(t){case 0:s.sort(function(t,e){return a(t[0][0],e[0][0])});break;case 1:for(;e<this.cx;e++)s[e].sort(function(t,e){return a(t[0],e[0])});break;case 2:for(;e<this.cx;e++)for(i=0;i<this.cy;i++)s[e][i].sort(a)}},o.prototype.Delete=function(t,e){var i=0,s=0;t=Math.floor(t);var r=this.arr;if(!(t<0))switch(e){case 0:if(t>=this.cx)break;n(r[t]),r.splice(t,1),this.cx--;break;case 1:if(t>=this.cy)break;for(;i<this.cx;i++)n(r[i][t]),r[i].splice(t,1);this.cy--;break;case 2:if(t>=this.cz)break;for(;i<this.cx;i++)for(s=0;s<this.cy;s++)r[i][s].splice(t,1);this.cz--}},o.prototype.Insert=function(t,e,i){var n=0,r=0,o=0;e=Math.floor(e);var a=this.arr;if(!(e<0))switch(i){case 0:if(e>this.cx)return;for(n=e,a.splice(n,0,s()),a[n].length=this.cy;r<this.cy;r++)for(a[n][r]=s(),a[n][r].length=this.cz,o=0;o<this.cz;o++)a[n][r][o]=t;this.cx++;break;case 1:if(e>this.cy)return;for(;n<this.cx;n++)for(r=e,a[n].splice(r,0,s()),a[n][r].length=this.cz,o=0;o<this.cz;o++)a[n][r][o]=t;this.cy++;break;case 2:if(e>this.cz)return;for(;n<this.cx;n++)for(r=0;r<this.cy;r++)a[n][r].splice(e,0,t);this.cz++}},o.prototype.JSONLoad=function(t){var e;try{e=JSON.parse(t)}catch(t){return}if(e.c2array){var i=e.size;this.cx=i[0],this.cy=i[1],this.cz=i[2],this.arr=e.data}},o.prototype.JSONDownload=function(t){var e=document.createElement("a");if(void 0===e.download){var i="data:text/html,"+encodeURIComponent("<p><a download='"+t+"' href=\"data:application/json,"+encodeURIComponent(this.getAsJSON())+'">Download link</a></p>');window.open(i)}else{var s=document.getElementsByTagName("body")[0];e.textContent=t,e.href="data:application/json,"+encodeURIComponent(this.getAsJSON()),e.download=t,s.appendChild(e);var n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(n),s.removeChild(e)}},t.acts=new o,h.prototype.At=function(t,e,i,s){var n=i||0,r=s||0;t.set_any(this.at(e,n,r))},h.prototype.Width=function(t){t.set_int(this.cx)},h.prototype.Height=function(t){t.set_int(this.cy)},h.prototype.Depth=function(t){t.set_int(this.cz)},h.prototype.CurX=function(t){t.set_int(this.getForX())},h.prototype.CurY=function(t){t.set_int(this.getForY())},h.prototype.CurZ=function(t){t.set_int(this.getForZ())},h.prototype.CurValue=function(t){t.set_any(this.at(this.getForX(),this.getForY(),this.getForZ()))},h.prototype.Front=function(t){t.set_any(this.at(0,0,0))},h.prototype.Back=function(t){t.set_any(this.at(this.cx-1,0,0))},h.prototype.IndexOf=function(t,e){for(var i=0;i<this.cx;i++)if(this.arr[i][0][0]===e)return void t.set_int(i);t.set_int(-1)},h.prototype.LastIndexOf=function(t,e){for(var i=this.cx-1;i>=0;i--)if(this.arr[i][0][0]===e)return void t.set_int(i);t.set_int(-1)},h.prototype.AsJSON=function(t){t.set_string(this.getAsJSON())},t.exps=new h}(),cr.plugins_.Audio=function(t){this.runtime=t},function(){var t=cr.plugins_.Audio.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){};var e=null,i=null,s="",n="",r=0,o=null,a=[],h=[],c=null,l=!1,u=0,p=!1,d=1,f=0,g=0,m=!1,y=1,_=1,v=10,b=1e4,w=1,x=null,S="",T=!1,C=[],O=!1,k=!1;function A(t){-1===C.indexOf(t)&&C.push(t)}function E(t){var i,s=t.instanceObject;try{i=s.play()}catch(e){return void A(t)}i?i.catch(function(e){A(t)}):T&&!e.isInUserInputEvent&&A(t)}function I(){var t,e,i,s;k||m||!o||(!function(){"suspended"===o.state&&o.resume&&o.resume();if(!o.createBuffer)return;var t=o.createBuffer(1,220,22050),e=o.createBufferSource();e.buffer=t,e.connect(o.destination),j(e)}(),"running"===o.state&&(k=!0));var n=C.slice(0);if(cr.clearArray(C),!p)for(t=0,e=n.length;t<e;++t)(i=n[t]).stopped||i.is_paused||(s=i.instanceObject.play())&&s.catch(function(t){A(i)})}function P(t){var e=F(t);return isFinite(e)||(e=0),e<0&&(e=0),e>1&&(e=1),e}function M(t){return t<0&&(t=0),t>1&&(t=1),function(t){return Math.log(t)/Math.log(10)*20}(t)}function F(t){return Math.pow(10,t/20)}document.addEventListener("pointerup",I,!0),document.addEventListener("touchend",I,!0),document.addEventListener("click",I,!0),document.addEventListener("keydown",I,!0),document.addEventListener("gamepadconnected",I,!0);var L={};function D(t){return t=t.toLowerCase(),L.hasOwnProperty(t)&&L[t].length?L[t][0].getInputNode():o.destination}function R(){return o.createGain?o.createGain():o.createGainNode()}function B(t){return o.createDelay?o.createDelay(t):o.createDelayNode(t)}function j(t,e){t.start?t.start(e||0):t.noteOn(e||0)}function N(t,e,i,s){t.start?t.start(s||0,e):t.noteGrainOn(s||0,e,i-e)}function V(t){try{t.stop?t.stop(0):t.noteOff(0)}catch(t){}}function X(t,e,i,s){if(t)if(t.cancelScheduledValues(0),0!==s){var n=o.currentTime;switch(s+=n,i){case 0:t.setValueAtTime(e,s);break;case 1:t.setValueAtTime(t.value,n),t.linearRampToValueAtTime(e,s);break;case 2:t.setValueAtTime(t.value,n),t.exponentialRampToValueAtTime(e,s)}}else t.value=e}var G=["lowpass","highpass","bandpass","lowshelf","highshelf","peaking","notch","allpass"];function W(t,e,i,s,n,r){this.type="filter",this.params=[t,e,i,s,n,r],this.inputNode=R(),this.wetNode=R(),this.wetNode.gain.value=r,this.dryNode=R(),this.dryNode.gain.value=1-r,this.filterNode=o.createBiquadFilter(),"number"==typeof this.filterNode.type?this.filterNode.type=t:this.filterNode.type=G[t],this.filterNode.frequency.value=e,this.filterNode.detune&&(this.filterNode.detune.value=i),this.filterNode.Q.value=s,this.filterNode.gain.value=n,this.inputNode.connect(this.filterNode),this.inputNode.connect(this.dryNode),this.filterNode.connect(this.wetNode)}function z(t,e,i){this.type="delay",this.params=[t,e,i],this.inputNode=R(),this.wetNode=R(),this.wetNode.gain.value=i,this.dryNode=R(),this.dryNode.gain.value=1-i,this.mainNode=R(),this.delayNode=B(t),this.delayNode.delayTime.value=t,this.delayGainNode=R(),this.delayGainNode.gain.value=e,this.inputNode.connect(this.mainNode),this.inputNode.connect(this.dryNode),this.mainNode.connect(this.wetNode),this.mainNode.connect(this.delayNode),this.delayNode.connect(this.delayGainNode),this.delayGainNode.connect(this.mainNode)}function U(t,e,i,s){this.type="convolve",this.params=[e,i,s],this.inputNode=R(),this.wetNode=R(),this.wetNode.gain.value=i,this.dryNode=R(),this.dryNode.gain.value=1-i,this.convolveNode=o.createConvolver(),t&&(this.convolveNode.normalize=e,this.convolveNode.buffer=t),this.inputNode.connect(this.convolveNode),this.inputNode.connect(this.dryNode),this.convolveNode.connect(this.wetNode)}function Y(t,e,i,s,n){this.type="flanger",this.params=[t,e,i,s,n],this.inputNode=R(),this.dryNode=R(),this.dryNode.gain.value=1-n/2,this.wetNode=R(),this.wetNode.gain.value=n/2,this.feedbackNode=R(),this.feedbackNode.gain.value=s,this.delayNode=B(t+e),this.delayNode.delayTime.value=t,this.oscNode=o.createOscillator(),this.oscNode.frequency.value=i,this.oscGainNode=R(),this.oscGainNode.gain.value=e,this.inputNode.connect(this.delayNode),this.inputNode.connect(this.dryNode),this.delayNode.connect(this.wetNode),this.delayNode.connect(this.feedbackNode),this.feedbackNode.connect(this.delayNode),this.oscNode.connect(this.oscGainNode),this.oscGainNode.connect(this.delayNode.delayTime),j(this.oscNode)}function J(t,e,i,s,n,r){this.type="phaser",this.params=[t,e,i,s,n,r],this.inputNode=R(),this.dryNode=R(),this.dryNode.gain.value=1-r/2,this.wetNode=R(),this.wetNode.gain.value=r/2,this.filterNode=o.createBiquadFilter(),"number"==typeof this.filterNode.type?this.filterNode.type=7:this.filterNode.type="allpass",this.filterNode.frequency.value=t,this.filterNode.detune&&(this.filterNode.detune.value=e),this.filterNode.Q.value=i,this.oscNode=o.createOscillator(),this.oscNode.frequency.value=n,this.oscGainNode=R(),this.oscGainNode.gain.value=s,this.inputNode.connect(this.filterNode),this.inputNode.connect(this.dryNode),this.filterNode.connect(this.wetNode),this.oscNode.connect(this.oscGainNode),this.oscGainNode.connect(this.filterNode.frequency),j(this.oscNode)}function H(t){this.type="gain",this.params=[t],this.node=R(),this.node.gain.value=t}function q(t,e){this.type="tremolo",this.params=[t,e],this.node=R(),this.node.gain.value=1-e/2,this.oscNode=o.createOscillator(),this.oscNode.frequency.value=t,this.oscGainNode=R(),this.oscGainNode.gain.value=e/2,this.oscNode.connect(this.oscGainNode),this.oscGainNode.connect(this.node.gain),j(this.oscNode)}function K(t,e){this.type="ringmod",this.params=[t,e],this.inputNode=R(),this.wetNode=R(),this.wetNode.gain.value=e,this.dryNode=R(),this.dryNode.gain.value=1-e,this.ringNode=R(),this.ringNode.gain.value=0,this.oscNode=o.createOscillator(),this.oscNode.frequency.value=t,this.oscNode.connect(this.ringNode.gain),j(this.oscNode),this.inputNode.connect(this.ringNode),this.inputNode.connect(this.dryNode),this.ringNode.connect(this.wetNode)}function Q(t,e,i,s,n){this.type="distortion",this.params=[t,e,i,s,n],this.inputNode=R(),this.preGain=R(),this.postGain=R(),this.setDrive(i,F(s)),this.wetNode=R(),this.wetNode.gain.value=n,this.dryNode=R(),this.dryNode.gain.value=1-n,this.waveShaper=o.createWaveShaper(),this.curve=new Float32Array(65536),this.generateColortouchCurve(t,e),this.waveShaper.curve=this.curve,this.inputNode.connect(this.preGain),this.inputNode.connect(this.dryNode),this.preGain.connect(this.waveShaper),this.waveShaper.connect(this.postGain),this.postGain.connect(this.wetNode)}function Z(t,e,i,s,n){this.type="compressor",this.params=[t,e,i,s,n],this.node=o.createDynamicsCompressor();try{this.node.threshold.value=t,this.node.knee.value=e,this.node.ratio.value=i,this.node.attack.value=s,this.node.release.value=n}catch(t){}}function $(t,e){this.type="analyser",this.params=[t,e],this.node=o.createAnalyser(),this.node.fftSize=t,this.node.smoothingTimeConstant=e,this.freqBins=new Float32Array(this.node.frequencyBinCount),this.signal=new Uint8Array(t),this.peak=0,this.rms=0}function tt(){this.obj=null,this.loadUid=0}function et(t,i){this.src=t,this.myapi=r,this.is_music=i,this.added_end_listener=!1;var s,n=this;switch(this.outNode=null,this.mediaSourceNode=null,this.panWhenReady=[],this.seekWhenReady=0,this.pauseWhenReady=!1,this.supportWebAudioAPI=!1,this.failedToLoad=!1,this.wasEverReady=!1,1===r&&i&&!O&&(this.myapi=0,this.outNode=R()),this.bufferObject=null,this.audioData=null,this.myapi){case 0:this.bufferObject=new Audio,this.bufferObject.crossOrigin="anonymous",this.bufferObject.addEventListener("canplaythrough",function(){n.wasEverReady=!0}),1===r&&o.createMediaElementSource&&!/wiiu/i.test(navigator.userAgent)&&(this.supportWebAudioAPI=!0,this.bufferObject.addEventListener("canplay",function(){!n.mediaSourceNode&&n.bufferObject&&(n.mediaSourceNode=o.createMediaElementSource(n.bufferObject),n.mediaSourceNode.connect(n.outNode))})),this.bufferObject.autoplay=!1,this.bufferObject.preload="auto",this.bufferObject.src=t;break;case 1:e.isWKWebView?e.fetchLocalFileViaCordovaAsArrayBuffer(t,function(t){n.audioData=t,n.decodeAudioBuffer()},function(t){n.failedToLoad=!0}):((s=new XMLHttpRequest).open("GET",t,!0),s.responseType="arraybuffer",s.onload=function(){n.audioData=s.response,n.decodeAudioBuffer()},s.onerror=function(){n.failedToLoad=!0},s.send());break;case 2:case 3:this.bufferObject=!0}}function it(t,a){var h=this;this.tag=a,this.fresh=!0,this.stopped=!0,this.src=t.src,this.buffer=t,this.myapi=r,this.is_music=t.is_music,this.playbackRate=1,this.hasPlaybackEnded=!0,this.resume_me=!1,this.is_paused=!1,this.resume_position=0,this.looping=!1,this.is_muted=!1,this.is_silent=!1,this.volume=1,this.onended_handler=function(t){if(!h.is_paused&&!h.resume_me){var n=this;n||(n=t.target),n===h.active_buffer&&(h.hasPlaybackEnded=!0,h.stopped=!0,s=h.tag,e.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,i))}},this.active_buffer=null,this.isTimescaled=1===u&&!this.is_music||2===u,this.mutevol=1,this.startTime=this.isTimescaled?e.kahanTime.sum:e.wallTime.sum,this.gainNode=null,this.pannerNode=null,this.pannerEnabled=!1,this.objectTracker=null,this.panX=0,this.panY=0,this.panAngle=0,this.panConeInner=0,this.panConeOuter=0,this.panConeOuterGain=0,this.instanceObject=null;var c=!1;switch(1!==this.myapi||0!==this.buffer.myapi||this.buffer.supportWebAudioAPI||(this.myapi=0),this.myapi){case 0:this.is_music?(this.instanceObject=t.bufferObject,c=!t.added_end_listener,t.added_end_listener=!0):(this.instanceObject=new Audio,this.instanceObject.crossOrigin="anonymous",this.instanceObject.autoplay=!1,this.instanceObject.src=t.bufferObject.src,c=!0),c&&this.instanceObject.addEventListener("ended",function(){s=h.tag,h.stopped=!0,e.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,i)});break;case 1:this.gainNode=R(),this.gainNode.connect(D(a)),1===this.buffer.myapi?t.bufferObject&&(this.instanceObject=o.createBufferSource(),this.instanceObject.buffer=t.bufferObject,this.instanceObject.connect(this.gainNode)):(this.instanceObject=this.buffer.bufferObject,this.buffer.outNode.connect(this.gainNode),this.buffer.added_end_listener||(this.buffer.added_end_listener=!0,this.buffer.bufferObject.addEventListener("ended",function(){s=h.tag,h.stopped=!0,e.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,i)})));break;case 2:this.instanceObject=new window.Media(n+this.src,null,null,function(t){t===window.Media.MEDIA_STOPPED&&(h.hasPlaybackEnded=!0,h.stopped=!0,s=h.tag,e.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,i))});break;case 3:this.instanceObject=!0}}W.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},W.prototype.remove=function(){this.inputNode.disconnect(),this.filterNode.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},W.prototype.getInputNode=function(){return this.inputNode},W.prototype.setParam=function(t,e,i,s){switch(t){case 0:(e/=100)<0&&(e=0),e>1&&(e=1),this.params[5]=e,X(this.wetNode.gain,e,i,s),X(this.dryNode.gain,1-e,i,s);break;case 1:this.params[1]=e,X(this.filterNode.frequency,e,i,s);break;case 2:this.params[2]=e,X(this.filterNode.detune,e,i,s);break;case 3:this.params[3]=e,X(this.filterNode.Q,e,i,s);break;case 4:this.params[4]=e,X(this.filterNode.gain,e,i,s)}},z.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},z.prototype.remove=function(){this.inputNode.disconnect(),this.mainNode.disconnect(),this.delayNode.disconnect(),this.delayGainNode.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},z.prototype.getInputNode=function(){return this.inputNode},z.prototype.setParam=function(t,e,i,s){switch(t){case 0:(e/=100)<0&&(e=0),e>1&&(e=1),this.params[2]=e,X(this.wetNode.gain,e,i,s),X(this.dryNode.gain,1-e,i,s);break;case 4:this.params[1]=P(e),X(this.delayGainNode.gain,P(e),i,s);break;case 5:this.params[0]=e,X(this.delayNode.delayTime,e,i,s)}},U.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},U.prototype.remove=function(){this.inputNode.disconnect(),this.convolveNode.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},U.prototype.getInputNode=function(){return this.inputNode},U.prototype.setParam=function(t,e,i,s){if(0===t)(e/=100)<0&&(e=0),e>1&&(e=1),this.params[1]=e,X(this.wetNode.gain,e,i,s),X(this.dryNode.gain,1-e,i,s)},Y.prototype.connectTo=function(t){this.dryNode.disconnect(),this.dryNode.connect(t),this.wetNode.disconnect(),this.wetNode.connect(t)},Y.prototype.remove=function(){this.inputNode.disconnect(),this.delayNode.disconnect(),this.oscNode.disconnect(),this.oscGainNode.disconnect(),this.dryNode.disconnect(),this.wetNode.disconnect(),this.feedbackNode.disconnect()},Y.prototype.getInputNode=function(){return this.inputNode},Y.prototype.setParam=function(t,e,i,s){switch(t){case 0:(e/=100)<0&&(e=0),e>1&&(e=1),this.params[4]=e,X(this.wetNode.gain,e/2,i,s),X(this.dryNode.gain,1-e/2,i,s);break;case 6:this.params[1]=e/1e3,X(this.oscGainNode.gain,e/1e3,i,s);break;case 7:this.params[2]=e,X(this.oscNode.frequency,e,i,s);break;case 8:this.params[3]=e/100,X(this.feedbackNode.gain,e/100,i,s)}},J.prototype.connectTo=function(t){this.dryNode.disconnect(),this.dryNode.connect(t),this.wetNode.disconnect(),this.wetNode.connect(t)},J.prototype.remove=function(){this.inputNode.disconnect(),this.filterNode.disconnect(),this.oscNode.disconnect(),this.oscGainNode.disconnect(),this.dryNode.disconnect(),this.wetNode.disconnect()},J.prototype.getInputNode=function(){return this.inputNode},J.prototype.setParam=function(t,e,i,s){switch(t){case 0:(e/=100)<0&&(e=0),e>1&&(e=1),this.params[5]=e,X(this.wetNode.gain,e/2,i,s),X(this.dryNode.gain,1-e/2,i,s);break;case 1:this.params[0]=e,X(this.filterNode.frequency,e,i,s);break;case 2:this.params[1]=e,X(this.filterNode.detune,e,i,s);break;case 3:this.params[2]=e,X(this.filterNode.Q,e,i,s);break;case 6:this.params[3]=e,X(this.oscGainNode.gain,e,i,s);break;case 7:this.params[4]=e,X(this.oscNode.frequency,e,i,s)}},H.prototype.connectTo=function(t){this.node.disconnect(),this.node.connect(t)},H.prototype.remove=function(){this.node.disconnect()},H.prototype.getInputNode=function(){return this.node},H.prototype.setParam=function(t,e,i,s){if(4===t)this.params[0]=P(e),X(this.node.gain,P(e),i,s)},q.prototype.connectTo=function(t){this.node.disconnect(),this.node.connect(t)},q.prototype.remove=function(){this.oscNode.disconnect(),this.oscGainNode.disconnect(),this.node.disconnect()},q.prototype.getInputNode=function(){return this.node},q.prototype.setParam=function(t,e,i,s){switch(t){case 0:(e/=100)<0&&(e=0),e>1&&(e=1),this.params[1]=e,X(this.node.gain.value,1-e/2,i,s),X(this.oscGainNode.gain.value,e/2,i,s);break;case 7:this.params[0]=e,X(this.oscNode.frequency,e,i,s)}},K.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},K.prototype.remove=function(){this.oscNode.disconnect(),this.ringNode.disconnect(),this.inputNode.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},K.prototype.getInputNode=function(){return this.inputNode},K.prototype.setParam=function(t,e,i,s){switch(t){case 0:(e/=100)<0&&(e=0),e>1&&(e=1),this.params[1]=e,X(this.wetNode.gain,e,i,s),X(this.dryNode.gain,1-e,i,s);break;case 7:this.params[0]=e,X(this.oscNode.frequency,e,i,s)}},Q.prototype.setDrive=function(t,e){t<.01&&(t=.01),this.preGain.gain.value=t,this.postGain.gain.value=Math.pow(1/t,.6)*e},Q.prototype.shape=function(t,e,i){var s=1.05*i*e-e,n=t<0?-1:1,r=t<0?-t:t,o=r<e?r:e+s*function(t,e){return 1-Math.exp(-e*t)}(r-e,1/s);return o*=n},Q.prototype.generateColortouchCurve=function(t,e){for(var i=F(t),s=F(e),n=32768,r=0,o=0;o<n;++o)r=o/n,r=this.shape(r,i,s),this.curve[n+o]=r,this.curve[n-o-1]=-r},Q.prototype.connectTo=function(t){this.wetNode.disconnect(),this.wetNode.connect(t),this.dryNode.disconnect(),this.dryNode.connect(t)},Q.prototype.remove=function(){this.inputNode.disconnect(),this.preGain.disconnect(),this.waveShaper.disconnect(),this.postGain.disconnect(),this.wetNode.disconnect(),this.dryNode.disconnect()},Q.prototype.getInputNode=function(){return this.inputNode},Q.prototype.setParam=function(t,e,i,s){if(0===t)(e/=100)<0&&(e=0),e>1&&(e=1),this.params[4]=e,X(this.wetNode.gain,e,i,s),X(this.dryNode.gain,1-e,i,s)},Z.prototype.connectTo=function(t){this.node.disconnect(),this.node.connect(t)},Z.prototype.remove=function(){this.node.disconnect()},Z.prototype.getInputNode=function(){return this.node},Z.prototype.setParam=function(t,e,i,s){},$.prototype.tick=function(){this.node.getFloatFrequencyData(this.freqBins),this.node.getByteTimeDomainData(this.signal);var t=this.node.fftSize,e=0;this.peak=0;for(var i=0,s=0;e<t;e++)(s=(this.signal[e]-128)/128)<0&&(s=-s),this.peak<s&&(this.peak=s),i+=s*s;this.peak=M(this.peak),this.rms=M(Math.sqrt(i/t))},$.prototype.connectTo=function(t){this.node.disconnect(),this.node.connect(t)},$.prototype.remove=function(){this.node.disconnect()},$.prototype.getInputNode=function(){return this.node},$.prototype.setParam=function(t,e,i,s){},tt.prototype.setObject=function(t){this.obj=t},tt.prototype.hasObject=function(){return!!this.obj},tt.prototype.tick=function(t){},et.prototype.release=function(){var t,e,i,s;for(t=0,i=0,e=h.length;t<e;++t)s=h[t],h[i]=s,s.buffer===this?s.stop():++i;h.length=i,this.mediaSourceNode&&(this.mediaSourceNode.disconnect(),this.mediaSourceNode=null),this.outNode&&(this.outNode.disconnect(),this.outNode=null),this.bufferObject=null,this.audioData=null},et.prototype.decodeAudioBuffer=function(){if(!this.bufferObject&&this.audioData){var t=this;if(o.decodeAudioData)o.decodeAudioData(this.audioData,function(i){var s,n,r,o;if(t.bufferObject=i,t.audioData=null,cr.is_undefined(t.playTagWhenReady)||p){if(!cr.is_undefined(t.convolveWhenReady)){var a=t.convolveWhenReady.convolveNode;a.normalize=t.normalizeWhenReady,a.buffer=i}}else if(t.panWhenReady.length){for(n=0,r=t.panWhenReady.length;n<r;n++)if(s=t.panWhenReady[n],(o=new it(t,s.thistag)).setPannerEnabled(!0),void 0===s.objUid||(s.obj=e.getObjectByUID(s.objUid),s.obj)){if(s.obj){var c=cr.rotatePtAround(s.obj.x,s.obj.y,-s.obj.layer.getAngle(),f,g,!0),l=cr.rotatePtAround(s.obj.x,s.obj.y,-s.obj.layer.getAngle(),f,g,!1);o.setPan(c,l,cr.to_degrees(s.obj.angle-s.obj.layer.getAngle()),s.ia,s.oa,s.og),o.setObject(s.obj)}else o.setPan(s.x,s.y,s.a,s.ia,s.oa,s.og);o.play(t.loopWhenReady,t.volumeWhenReady,t.seekWhenReady),t.pauseWhenReady&&o.pause(),h.push(o)}cr.clearArray(t.panWhenReady)}else(o=new it(t,t.playTagWhenReady||"")).play(t.loopWhenReady,t.volumeWhenReady,t.seekWhenReady),t.pauseWhenReady&&o.pause(),h.push(o)},function(e){t.failedToLoad=!0});else if(this.bufferObject=o.createBuffer(this.audioData,!1),this.audioData=null,cr.is_undefined(this.playTagWhenReady)||p){if(!cr.is_undefined(this.convolveWhenReady)){var i=this.convolveWhenReady.convolveNode;i.normalize=this.normalizeWhenReady,i.buffer=this.bufferObject}}else{var s=new it(this,this.playTagWhenReady);s.play(this.loopWhenReady,this.volumeWhenReady,this.seekWhenReady),this.pauseWhenReady&&s.pause(),h.push(s)}}},et.prototype.isLoaded=function(){switch(this.myapi){case 0:var t=this.bufferObject.readyState>=4;return t&&(this.wasEverReady=!0),t||this.wasEverReady;case 1:return!!this.audioData||!!this.bufferObject;case 2:case 3:return!0}return!1},et.prototype.isLoadedAndDecoded=function(){switch(this.myapi){case 0:return this.isLoaded();case 1:return!!this.bufferObject;case 2:case 3:return!0}return!1},et.prototype.hasFailedToLoad=function(){switch(this.myapi){case 0:return!!this.bufferObject.error;case 1:return this.failedToLoad}return!1},it.prototype.hasEnded=function(){switch(this.myapi){case 0:return this.instanceObject.ended;case 1:return 1===this.buffer.myapi?!(!this.fresh&&!this.stopped&&this.instanceObject.loop)&&(!this.is_paused&&this.hasPlaybackEnded):this.instanceObject.ended;case 2:return this.hasPlaybackEnded}return!0},it.prototype.canBeRecycled=function(){return!(!this.fresh&&!this.stopped)||this.hasEnded()},it.prototype.setPannerEnabled=function(t){if(1===r)if(!this.pannerEnabled&&t){if(!this.gainNode)return;this.pannerNode||(this.pannerNode=o.createPanner(),"number"==typeof this.pannerNode.panningModel?this.pannerNode.panningModel=y:this.pannerNode.panningModel=["equalpower","HRTF","soundfield"][y],"number"==typeof this.pannerNode.distanceModel?this.pannerNode.distanceModel=_:this.pannerNode.distanceModel=["linear","inverse","exponential"][_],this.pannerNode.refDistance=v,this.pannerNode.maxDistance=b,this.pannerNode.rolloffFactor=w),this.gainNode.disconnect(),this.gainNode.connect(this.pannerNode),this.pannerNode.connect(D(this.tag)),this.pannerEnabled=!0}else if(this.pannerEnabled&&!t){if(!this.gainNode)return;this.pannerNode.disconnect(),this.gainNode.disconnect(),this.gainNode.connect(D(this.tag)),this.pannerEnabled=!1}},it.prototype.setPan=function(t,e,i,s,n,o){this.pannerEnabled&&1===r&&(this.pannerNode.setPosition(t,e,0),this.pannerNode.setOrientation(Math.cos(cr.to_radians(i)),Math.sin(cr.to_radians(i)),0),this.pannerNode.coneInnerAngle=s,this.pannerNode.coneOuterAngle=n,this.pannerNode.coneOuterGain=o,this.panX=t,this.panY=e,this.panAngle=i,this.panConeInner=s,this.panConeOuter=n,this.panConeOuterGain=o)},it.prototype.setObject=function(t){this.pannerEnabled&&1===r&&(this.objectTracker||(this.objectTracker=new tt),this.objectTracker.setObject(t))},it.prototype.tick=function(t){if(this.pannerEnabled&&1===r&&this.objectTracker&&this.objectTracker.hasObject()&&this.isPlaying()){this.objectTracker.tick(t);var e=this.objectTracker.obj,i=cr.rotatePtAround(e.x,e.y,-e.layer.getAngle(),f,g,!0),s=cr.rotatePtAround(e.x,e.y,-e.layer.getAngle(),f,g,!1);this.pannerNode.setPosition(i,s,0);var n=0;void 0!==this.objectTracker.obj.angle&&(n=e.angle-e.layer.getAngle(),this.pannerNode.setOrientation(Math.cos(n),Math.sin(n),0))}},it.prototype.play=function(t,i,s,n){var r=this.instanceObject;this.looping=t,this.volume=i;var a=s||0;switch(n=n||0,this.myapi){case 0:if(1!==r.playbackRate&&(r.playbackRate=1),r.volume!==i*d&&(r.volume=i*d),r.loop!==t&&(r.loop=t),r.muted&&(r.muted=!1),r.currentTime!==a)try{r.currentTime=a}catch(t){}E(this);break;case 1:if(this.muted=!1,this.mutevol=1,1===this.buffer.myapi)this.gainNode.gain.value=i*d,this.fresh||(this.instanceObject=o.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode)),this.instanceObject.onended=this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=t,this.hasPlaybackEnded=!1,0===a?j(this.instanceObject,n):N(this.instanceObject,a,this.getDuration(),n);else{if(1!==r.playbackRate&&(r.playbackRate=1),r.loop!==t&&(r.loop=t),r.volume=i*d,r.currentTime!==a)try{r.currentTime=a}catch(t){}E(this)}break;case 2:(!this.fresh&&this.stopped||0!==a)&&r.seekTo(a),r.play(),this.hasPlaybackEnded=!1;break;case 3:e.isDirectCanvas?AppMobi.context.playSound(this.src,t):AppMobi.player.playSound(this.src,t)}this.playbackRate=1,this.startTime=(this.isTimescaled?e.kahanTime.sum:e.wallTime.sum)-a,this.fresh=!1,this.stopped=!1,this.is_paused=!1},it.prototype.stop=function(){switch(this.myapi){case 0:this.instanceObject.paused||this.instanceObject.pause();break;case 1:1===this.buffer.myapi?V(this.instanceObject):this.instanceObject.paused||this.instanceObject.pause();break;case 2:this.instanceObject.stop();break;case 3:e.isDirectCanvas&&AppMobi.context.stopSound(this.src)}this.stopped=!0,this.is_paused=!1},it.prototype.pause=function(){if(!(this.fresh||this.stopped||this.hasEnded()||this.is_paused)){switch(this.myapi){case 0:this.instanceObject.paused||this.instanceObject.pause();break;case 1:1===this.buffer.myapi?(this.resume_position=this.getPlaybackTime(!0),this.looping&&(this.resume_position=this.resume_position%this.getDuration()),this.is_paused=!0,V(this.instanceObject)):this.instanceObject.paused||this.instanceObject.pause();break;case 2:this.instanceObject.pause();break;case 3:e.isDirectCanvas&&AppMobi.context.stopSound(this.src)}this.is_paused=!0}},it.prototype.resume=function(){if(!(this.fresh||this.stopped||this.hasEnded())&&this.is_paused){switch(this.myapi){case 0:E(this);break;case 1:1===this.buffer.myapi?(this.instanceObject=o.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode),this.instanceObject.onended=this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=this.looping,this.gainNode.gain.value=d*this.volume*this.mutevol,this.updatePlaybackRate(),this.startTime=(this.isTimescaled?e.kahanTime.sum:e.wallTime.sum)-this.resume_position/(this.playbackRate||.001),N(this.instanceObject,this.resume_position,this.getDuration())):E(this);break;case 2:this.instanceObject.play();break;case 3:e.isDirectCanvas&&AppMobi.context.resumeSound(this.src)}this.is_paused=!1}},it.prototype.seek=function(t){if(!(this.fresh||this.stopped||this.hasEnded()))switch(this.myapi){case 0:try{this.instanceObject.currentTime=t}catch(t){}break;case 1:if(1===this.buffer.myapi)this.is_paused?this.resume_position=t:(this.pause(),this.resume_position=t,this.resume());else try{this.instanceObject.currentTime=t}catch(t){}break;case 2:break;case 3:e.isDirectCanvas&&AppMobi.context.seekSound(this.src,t)}},it.prototype.reconnect=function(t){1===this.myapi&&(this.pannerEnabled?(this.pannerNode.disconnect(),this.pannerNode.connect(t)):(this.gainNode.disconnect(),this.gainNode.connect(t)))},it.prototype.getDuration=function(t){var i=0;switch(this.myapi){case 0:void 0!==this.instanceObject.duration&&(i=this.instanceObject.duration);break;case 1:i=this.buffer.bufferObject.duration;break;case 2:i=this.instanceObject.getDuration();break;case 3:e.isDirectCanvas&&(i=AppMobi.context.getDurationSound(this.src))}return t&&(i/=this.playbackRate||.001),i},it.prototype.getPlaybackTime=function(t){var i=this.getDuration(),s=0;switch(this.myapi){case 0:void 0!==this.instanceObject.currentTime&&(s=this.instanceObject.currentTime);break;case 1:if(1===this.buffer.myapi){if(this.is_paused)return this.resume_position;s=(this.isTimescaled?e.kahanTime.sum:e.wallTime.sum)-this.startTime}else void 0!==this.instanceObject.currentTime&&(s=this.instanceObject.currentTime);break;case 2:break;case 3:e.isDirectCanvas&&(s=AppMobi.context.getPlaybackTimeSound(this.src))}return t&&(s*=this.playbackRate),!this.looping&&s>i&&(s=i),s},it.prototype.isPlaying=function(){return!(this.is_paused||this.fresh||this.stopped||this.hasEnded())},it.prototype.shouldSave=function(){return!this.fresh&&!this.stopped&&!this.hasEnded()},it.prototype.setVolume=function(t){this.volume=t,this.updateVolume()},it.prototype.updateVolume=function(){var t=this.volume*d;switch(isFinite(t)||(t=0),this.myapi){case 0:void 0!==this.instanceObject.volume&&this.instanceObject.volume!==t&&(this.instanceObject.volume=t);break;case 1:1===this.buffer.myapi?this.gainNode.gain.value=t*this.mutevol:void 0!==this.instanceObject.volume&&this.instanceObject.volume!==t&&(this.instanceObject.volume=t)}},it.prototype.getVolume=function(){return this.volume},it.prototype.doSetMuted=function(t){switch(this.myapi){case 0:this.instanceObject.muted!==!!t&&(this.instanceObject.muted=!!t);break;case 1:1===this.buffer.myapi?(this.mutevol=t?0:1,this.gainNode.gain.value=d*this.volume*this.mutevol):this.instanceObject.muted!==!!t&&(this.instanceObject.muted=!!t)}},it.prototype.setMuted=function(t){this.is_muted=!!t,this.doSetMuted(this.is_muted||this.is_silent)},it.prototype.setSilent=function(t){this.is_silent=!!t,this.doSetMuted(this.is_muted||this.is_silent)},it.prototype.setLooping=function(t){switch(this.looping=t,this.myapi){case 0:case 1:this.instanceObject.loop!==!!t&&(this.instanceObject.loop=!!t);break;case 2:break;case 3:e.isDirectCanvas&&AppMobi.context.setLoopingSound(this.src,t)}},it.prototype.setPlaybackRate=function(t){this.playbackRate=t,this.updatePlaybackRate()},it.prototype.updatePlaybackRate=function(){var t=this.playbackRate;switch(this.isTimescaled&&(t*=e.timescale),this.myapi){case 0:this.instanceObject.playbackRate!==t&&(this.instanceObject.playbackRate=t);break;case 1:1===this.buffer.myapi?this.instanceObject.playbackRate.value!==t&&(this.instanceObject.playbackRate.value=t):this.instanceObject.playbackRate!==t&&(this.instanceObject.playbackRate=t)}},it.prototype.setSuspended=function(t){switch(this.myapi){case 0:t?this.isPlaying()?(this.resume_me=!0,this.instanceObject.pause()):this.resume_me=!1:this.resume_me&&(this.instanceObject.play(),this.resume_me=!1);break;case 1:t?this.isPlaying()?(this.resume_me=!0,1===this.buffer.myapi?(this.resume_position=this.getPlaybackTime(!0),this.looping&&(this.resume_position=this.resume_position%this.getDuration()),V(this.instanceObject)):this.instanceObject.pause()):this.resume_me=!1:this.resume_me&&(1===this.buffer.myapi?(this.instanceObject=o.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode),this.instanceObject.onended=this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=this.looping,this.gainNode.gain.value=d*this.volume*this.mutevol,this.updatePlaybackRate(),this.startTime=(this.isTimescaled?e.kahanTime.sum:e.wallTime.sum)-this.resume_position/(this.playbackRate||.001),N(this.instanceObject,this.resume_position,this.getDuration())):this.instanceObject.play(),this.resume_me=!1);break;case 2:t?this.isPlaying()?(this.instanceObject.pause(),this.resume_me=!0):this.resume_me=!1:this.resume_me&&(this.resume_me=!1,this.instanceObject.play())}},t.Instance=function(t){if(this.type=t,this.runtime=t.runtime,e=this.runtime,i=this,this.listenerTracker=null,this.listenerZ=-600,this.runtime.isWKWebView&&(O=!0),!(this.runtime.isiOS||this.runtime.isAndroid&&(this.runtime.isChrome||this.runtime.isAndroidStockBrowser))||this.runtime.isCrosswalk||this.runtime.isDomFree||this.runtime.isAmazonWebApp||O||(T=!0),o=null,"undefined"!=typeof AudioContext?(r=1,o=new AudioContext):"undefined"!=typeof webkitAudioContext&&(r=1,o=new webkitAudioContext),this.runtime.isiOS&&o&&(o.close&&o.close(),"undefined"!=typeof AudioContext?o=new AudioContext:"undefined"!=typeof webkitAudioContext&&(o=new webkitAudioContext)),1!==r&&(this.runtime.isCordova&&void 0!==window.Media?r=2:this.runtime.isAppMobi&&(r=3)),2===r){var s=(n=location.href).lastIndexOf("/");s>-1&&(n=n.substr(0,s+1)),n=n.replace("file://","")}if(this.runtime.isSafari&&this.runtime.isWindows&&"undefined"==typeof Audio)alert("It looks like you're using Safari for Windows without Quicktime.  Audio cannot be played until Quicktime is installed."),this.runtime.DestroyInstance(this);else{if(this.runtime.isDirectCanvas)l=this.runtime.isAndroid;else try{l=!!(new Audio).canPlayType('audio/ogg; codecs="vorbis"')&&!this.runtime.isWindows10}catch(t){l=!1}r,this.runtime.tickMe(this)}};var st=t.Instance.prototype;st.onCreate=function(){this.runtime.audioInstance=this,u=this.properties[0],this.saveload=this.properties[1],this.playinbackground=0!==this.properties[2],this.nextPlayTime=0,y=this.properties[3],_=this.properties[4],this.listenerZ=-this.properties[5],v=this.properties[6],b=this.properties[7],w=this.properties[8],this.listenerTracker=new tt;var t=this.runtime.draw_width||this.runtime.width,e=this.runtime.draw_height||this.runtime.height;1===r&&(o.listener.setPosition(t/2,e/2,this.listenerZ),o.listener.setOrientation(0,0,1,0,-1,0),window.c2OnAudioMicStream=function(t,e){x&&x.disconnect(),S=e.toLowerCase(),(x=o.createMediaStreamSource(t)).connect(D(S))}),this.runtime.addSuspendCallback(function(t){i.onSuspend(t)});var s=this;this.runtime.addDestroyCallback(function(t){s.onInstanceDestroyed(t)})},st.onInstanceDestroyed=function(t){var e,i,s;for(e=0,i=h.length;e<i;e++)(s=h[e]).objectTracker&&s.objectTracker.obj===t&&(s.objectTracker.obj=null,s.pannerEnabled&&s.isPlaying()&&s.looping&&s.stop());this.listenerTracker.obj===t&&(this.listenerTracker.obj=null)},st.saveToJSON=function(){var t,e,i,s,n,r,o,a={silent:p,masterVolume:d,listenerZ:this.listenerZ,listenerUid:this.listenerTracker.hasObject()?this.listenerTracker.obj.uid:-1,playing:[],effects:{}},c=a.playing;for(t=0,e=h.length;t<e;t++)(i=h[t]).shouldSave()&&3!==this.saveload&&(i.is_music&&1===this.saveload||(i.is_music||2!==this.saveload)&&(o=i.getPlaybackTime(),i.looping&&(o%=i.getDuration()),s={tag:i.tag,buffersrc:i.buffer.src,is_music:i.is_music,playbackTime:o,volume:i.volume,looping:i.looping,muted:i.is_muted,playbackRate:i.playbackRate,paused:i.is_paused,resume_position:i.resume_position},i.pannerEnabled&&(s.pan={},r=s.pan,i.objectTracker&&i.objectTracker.hasObject()?r.objUid=i.objectTracker.obj.uid:(r.x=i.panX,r.y=i.panY,r.a=i.panAngle),r.ia=i.panConeInner,r.oa=i.panConeOuter,r.og=i.panConeOuterGain),c.push(s)));var l,u=a.effects;for(n in L)if(L.hasOwnProperty(n)){for(l=[],t=0,e=L[n].length;t<e;t++)l.push({type:L[n][t].type,params:L[n][t].params});u[n]=l}return a};var nt=[];st.loadFromJSON=function(t){var e=t.silent;d=t.masterVolume,this.listenerZ=t.listenerZ,this.listenerTracker.setObject(null);var i=t.listenerUid;-1!==i&&(this.listenerTracker.loadUid=i,nt.push(this.listenerTracker));var s,n,r,o,a,c,l,u,f,g,m,y,_,v,b,w,x,S,T=t.playing;if(3!==this.saveload)for(s=0,n=h.length;s<n;s++)(m=h[s]).is_music&&1===this.saveload||(m.is_music||2!==this.saveload)&&m.stop();for(y in L)if(L.hasOwnProperty(y))for(s=0,n=L[y].length;s<n;s++)L[y][s].remove();for(y in cr.wipe(L),t.effects)if(t.effects.hasOwnProperty(y))for(s=0,n=(b=t.effects[y]).length;s<n;s++)switch(w=b[s].type,x=b[s].params,w){case"filter":lt(y,new W(x[0],x[1],x[2],x[3],x[4],x[5]));break;case"delay":lt(y,new z(x[0],x[1],x[2]));break;case"convolve":o=x[2],(g=this.getAudioBuffer(o,!1)).bufferObject?S=new U(g.bufferObject,x[0],x[1],o):(S=new U(null,x[0],x[1],o),g.normalizeWhenReady=x[0],g.convolveWhenReady=S),lt(y,S);break;case"flanger":lt(y,new Y(x[0],x[1],x[2],x[3],x[4]));break;case"phaser":lt(y,new J(x[0],x[1],x[2],x[3],x[4],x[5]));break;case"gain":lt(y,new H(x[0]));break;case"tremolo":lt(y,new q(x[0],x[1]));break;case"ringmod":lt(y,new K(x[0],x[1]));break;case"distortion":lt(y,new Q(x[0],x[1],x[2],x[3],x[4]));break;case"compressor":lt(y,new Z(x[0],x[1],x[2],x[3],x[4]));break;case"analyser":lt(y,new $(x[0],x[1]))}for(s=0,n=T.length;s<n;s++)3!==this.saveload&&(o=(r=T[s]).buffersrc,a=r.is_music,c=r.tag,l=r.playbackTime,u=r.looping,f=r.volume,v=(_=r.pan)&&_.hasOwnProperty("objUid")?_.objUid:-1,a&&1===this.saveload||(a||2!==this.saveload)&&((m=this.getAudioInstance(o,c,a,u,f))?(m.resume_position=r.resume_position,m.setPannerEnabled(!!_),m.play(u,f,l),m.updatePlaybackRate(),m.updateVolume(),m.doSetMuted(m.is_muted||m.is_silent),r.paused&&m.pause(),r.muted&&m.setMuted(!0),m.doSetMuted(m.is_muted||m.is_silent),_&&(-1!==v?(m.objectTracker=m.objectTracker||new tt,m.objectTracker.loadUid=v,nt.push(m.objectTracker)):m.setPan(_.x,_.y,_.a,_.ia,_.oa,_.og))):((g=this.getAudioBuffer(o,a)).seekWhenReady=l,g.pauseWhenReady=r.paused,_&&(-1!==v?g.panWhenReady.push({objUid:v,ia:_.ia,oa:_.oa,og:_.og,thistag:c}):g.panWhenReady.push({x:_.x,y:_.y,a:_.a,ia:_.ia,oa:_.oa,og:_.og,thistag:c})))));if(e&&!p){for(s=0,n=h.length;s<n;s++)h[s].setSilent(!0);p=!0}else if(!e&&p){for(s=0,n=h.length;s<n;s++)h[s].setSilent(!1);p=!1}},st.afterLoad=function(){var t,e,i,s;for(t=0,e=nt.length;t<e;t++)i=nt[t],s=this.runtime.getObjectByUID(i.loadUid),i.setObject(s),i.loadUid=-1,s&&(f=s.x,g=s.y);cr.clearArray(nt)},st.onSuspend=function(t){if(!this.playinbackground){var e,i;for(!t&&o&&o.resume&&(o.resume(),m=!1),e=0,i=h.length;e<i;e++)h[e].setSuspended(t);t&&o&&o.suspend&&(o.suspend(),m=!0)}},st.tick=function(){var t,e,i,s,n,a,c=this.runtime.dt;for(t=0,e=h.length;t<e;t++)(i=h[t]).tick(c),0!==u&&i.updatePlaybackRate();for(s in L)if(L.hasOwnProperty(s))for(t=0,e=(n=L[s]).length;t<e;t++)(a=n[t]).tick&&a.tick();1===r&&this.listenerTracker.hasObject()&&(this.listenerTracker.tick(c),f=this.listenerTracker.obj.x,g=this.listenerTracker.obj.y,o.listener.setPosition(this.listenerTracker.obj.x,this.listenerTracker.obj.y,this.listenerZ))};var rt=[];st.setPreloadList=function(t){var e,i,s,n,r,o,a=0;for(e=0,i=t.length;e<i;++e)n=(s=t[e])[0],r=2*s[1],((o=n.length>4&&".ogg"===n.substr(n.length-4))&&l||!o&&!l)&&(rt.push({filename:n,size:r,obj:null}),a+=r);return a},st.startPreloads=function(){var t,e,i,s;for(t=0,e=rt.length;t<e;++t)i=rt[t],s=this.runtime.files_subfolder+i.filename,i.obj=this.getAudioBuffer(s,!1)},st.getPreloadedSize=function(){var t,e,i,s=0;for(t=0,e=rt.length;t<e;++t)(i=rt[t]).obj.isLoadedAndDecoded()||i.obj.hasFailedToLoad()||this.runtime.isDomFree||this.runtime.isAndroidStockBrowser?s+=i.size:i.obj.isLoaded()&&(s+=Math.floor(i.size/2));return s},st.releaseAllMusicBuffers=function(){var t,e,i,s;for(t=0,i=0,e=a.length;t<e;++t)s=a[t],a[i]=s,s.is_music?s.release():++i;a.length=i},st.getAudioBuffer=function(t,e,i){var s,n,r,o=null;for(s=0,n=a.length;s<n;s++)if((r=a[s]).src===t){o=r;break}return o||i||(O&&e&&this.releaseAllMusicBuffers(),o=new et(t,e),a.push(o)),o},st.getAudioInstance=function(t,e,i,s,n){var r,o,a;for(r=0,o=h.length;r<o;r++)if((a=h[r]).src===t&&(a.canBeRecycled()||i))return a.tag=e,a;var c=this.getAudioBuffer(t,i);return c.bufferObject?(a=new it(c,e),h.push(a),a):("<preload>"!==e&&(c.playTagWhenReady=e,c.loopWhenReady=s,c.volumeWhenReady=n),null)};var ot=[];function at(t,e){var i=t.isPlaying()?1:0,s=e.isPlaying()?1:0;return i===s?0:i<s?1:-1}function ht(t,e){if(cr.clearArray(ot),!t.length)return!c||c.hasEnded()?void 0:(cr.clearArray(ot),void(ot[0]=c));var i,s,n;for(i=0,s=h.length;i<s;i++)n=h[i],cr.equals_nocase(t,n.tag)&&ot.push(n);e&&ot.sort(at)}function ct(t){var e,i,s,n,r=o.destination;if(L.hasOwnProperty(t)&&(s=L[t]).length)for(r=s[0].getInputNode(),e=0,i=s.length;e<i;e++)n=s[e],e+1===i?n.connectTo(o.destination):n.connectTo(s[e+1].getInputNode());for(ht(t),e=0,i=ot.length;e<i;e++)ot[e].reconnect(r);x&&S===t&&(x.disconnect(),x.connect(r))}function lt(t,e){L.hasOwnProperty(t)?L[t].push(e):L[t]=[e],ct(t)}function ut(){}function pt(){}function dt(){}function ft(t,e){var i=null;return L.hasOwnProperty(t)&&(i=L[t]),i&&e>=0&&e<i.length&&i[e].freqBins?i[e]:null}ut.prototype.OnEnded=function(t){return cr.equals_nocase(s,t)},ut.prototype.PreloadsComplete=function(){var t,e;for(t=0,e=a.length;t<e;t++)if(!a[t].isLoadedAndDecoded()&&!a[t].hasFailedToLoad())return!1;return!0},ut.prototype.AdvancedAudioSupported=function(){return 1===r},ut.prototype.IsSilent=function(){return p},ut.prototype.IsAnyPlaying=function(){var t,e;for(t=0,e=h.length;t<e;t++)if(h[t].isPlaying())return!0;return!1},ut.prototype.IsTagPlaying=function(t){var e,i;for(ht(t),e=0,i=ot.length;e<i;e++)if(ot[e].isPlaying())return!0;return!1},t.cnds=new ut,pt.prototype.Play=function(t,e,i,s){if(!p){var n=P(i),r=t[1],o=this.runtime.files_subfolder+t[0]+(l?".ogg":".m4a");(c=this.getAudioInstance(o,s,r,0!==e,n))&&(c.setPannerEnabled(!1),c.play(0!==e,n,0,this.nextPlayTime),this.nextPlayTime=0)}},pt.prototype.PlayAtPosition=function(t,e,i,s,n,r,o,a,h,u){if(!p){var d=P(i),f=t[1],g=this.runtime.files_subfolder+t[0]+(l?".ogg":".m4a");if(c=this.getAudioInstance(g,u,f,0!==e,d))c.setPannerEnabled(!0),c.setPan(s,n,r,o,a,P(h)),c.play(0!==e,d,0,this.nextPlayTime),this.nextPlayTime=0;else this.getAudioBuffer(g,f).panWhenReady.push({x:s,y:n,a:r,ia:o,oa:a,og:P(h),thistag:u})}},pt.prototype.PlayAtObject=function(t,e,i,s,n,r,o,a){if(!p&&s){var h=s.getFirstPicked();if(h){var u=P(i),d=t[1],m=this.runtime.files_subfolder+t[0]+(l?".ogg":".m4a");if(c=this.getAudioInstance(m,a,d,0!==e,u)){c.setPannerEnabled(!0);var y=cr.rotatePtAround(h.x,h.y,-h.layer.getAngle(),f,g,!0),_=cr.rotatePtAround(h.x,h.y,-h.layer.getAngle(),f,g,!1);c.setPan(y,_,cr.to_degrees(h.angle-h.layer.getAngle()),n,r,P(o)),c.setObject(h),c.play(0!==e,u,0,this.nextPlayTime),this.nextPlayTime=0}else{this.getAudioBuffer(m,d).panWhenReady.push({obj:h,ia:n,oa:r,og:P(o),thistag:a})}}}},pt.prototype.PlayByName=function(t,e,i,s,n){if(!p){var r=P(s),o=1===t,a=this.runtime.files_subfolder+e.toLowerCase()+(l?".ogg":".m4a");(c=this.getAudioInstance(a,n,o,0!==i,r))&&(c.setPannerEnabled(!1),c.play(0!==i,r,0,this.nextPlayTime),this.nextPlayTime=0)}},pt.prototype.PlayAtPositionByName=function(t,e,i,s,n,r,o,a,h,u,d){if(!p){var f=P(s),g=1===t,m=this.runtime.files_subfolder+e.toLowerCase()+(l?".ogg":".m4a");if(c=this.getAudioInstance(m,d,g,0!==i,f))c.setPannerEnabled(!0),c.setPan(n,r,o,a,h,P(u)),c.play(0!==i,f,0,this.nextPlayTime),this.nextPlayTime=0;else this.getAudioBuffer(m,g).panWhenReady.push({x:n,y:r,a:o,ia:a,oa:h,og:P(u),thistag:d})}},pt.prototype.PlayAtObjectByName=function(t,e,i,s,n,r,o,a,h){if(!p&&n){var u=n.getFirstPicked();if(u){var d=P(s),m=1===t,y=this.runtime.files_subfolder+e.toLowerCase()+(l?".ogg":".m4a");if(c=this.getAudioInstance(y,h,m,0!==i,d)){c.setPannerEnabled(!0);var _=cr.rotatePtAround(u.x,u.y,-u.layer.getAngle(),f,g,!0),v=cr.rotatePtAround(u.x,u.y,-u.layer.getAngle(),f,g,!1);c.setPan(_,v,cr.to_degrees(u.angle-u.layer.getAngle()),r,o,P(a)),c.setObject(u),c.play(0!==i,d,0,this.nextPlayTime),this.nextPlayTime=0}else{this.getAudioBuffer(y,m).panWhenReady.push({obj:u,ia:r,oa:o,og:P(a),thistag:h})}}}},pt.prototype.SetLooping=function(t,e){var i,s;for(ht(t),i=0,s=ot.length;i<s;i++)ot[i].setLooping(0===e)},pt.prototype.SetMuted=function(t,e){var i,s;for(ht(t),i=0,s=ot.length;i<s;i++)ot[i].setMuted(0===e)},pt.prototype.SetVolume=function(t,e){ht(t);var i,s,n=P(e);for(i=0,s=ot.length;i<s;i++)ot[i].setVolume(n)},pt.prototype.Preload=function(t){if(!p){var e=t[1],i=this.runtime.files_subfolder+t[0]+(l?".ogg":".m4a");3!==r?2!==r&&this.getAudioInstance(i,"<preload>",e,!1):this.runtime.isDirectCanvas?AppMobi.context.loadSound(i):AppMobi.player.loadSound(i)}},pt.prototype.PreloadByName=function(t,e){if(!p){var i=1===t,s=this.runtime.files_subfolder+e.toLowerCase()+(l?".ogg":".m4a");3!==r?2!==r&&this.getAudioInstance(s,"<preload>",i,!1):this.runtime.isDirectCanvas?AppMobi.context.loadSound(s):AppMobi.player.loadSound(s)}},pt.prototype.SetPlaybackRate=function(t,e){var i,s;for(ht(t),e<0&&(e=0),i=0,s=ot.length;i<s;i++)ot[i].setPlaybackRate(e)},pt.prototype.Stop=function(t){var e,i;for(ht(t),e=0,i=ot.length;e<i;e++)ot[e].stop()},pt.prototype.StopAll=function(){var t,e;for(t=0,e=h.length;t<e;t++)h[t].stop()},pt.prototype.SetPaused=function(t,e){var i,s;for(ht(t),i=0,s=ot.length;i<s;i++)0===e?ot[i].pause():ot[i].resume()},pt.prototype.Seek=function(t,e){var i,s;for(ht(t),i=0,s=ot.length;i<s;i++)ot[i].seek(e)},pt.prototype.SetSilent=function(t){var e,i;if(2===t&&(t=p?1:0),0!==t||p){if(1===t&&p){for(e=0,i=h.length;e<i;e++)h[e].setSilent(!1);p=!1}}else{for(e=0,i=h.length;e<i;e++)h[e].setSilent(!0);p=!0}},pt.prototype.SetMasterVolume=function(t){var e,i;for(d=P(t),e=0,i=h.length;e<i;e++)h[e].updateVolume()},pt.prototype.AddFilterEffect=function(t,e,i,s,n,a,h){1!==r||e<0||e>=G.length||!o.createBiquadFilter||((h/=100)<0&&(h=0),h>1&&(h=1),lt(t=t.toLowerCase(),new W(e,i,s,n,a,h)))},pt.prototype.AddDelayEffect=function(t,e,i,s){1===r&&((s/=100)<0&&(s=0),s>1&&(s=1),lt(t=t.toLowerCase(),new z(e,P(i),s)))},pt.prototype.AddFlangerEffect=function(t,e,i,s,n,a){1===r&&o.createOscillator&&((a/=100)<0&&(a=0),a>1&&(a=1),lt(t=t.toLowerCase(),new Y(e/1e3,i/1e3,s,n/100,a)))},pt.prototype.AddPhaserEffect=function(t,e,i,s,n,a,h){1===r&&o.createOscillator&&((h/=100)<0&&(h=0),h>1&&(h=1),lt(t=t.toLowerCase(),new J(e,i,s,n,a,h)))},pt.prototype.AddConvolutionEffect=function(t,e,i,s){if(1===r&&o.createConvolver){var n,a=0===i,h=this.runtime.files_subfolder+e[0]+(l?".ogg":".m4a"),c=this.getAudioBuffer(h,!1);t=t.toLowerCase(),(s/=100)<0&&(s=0),s>1&&(s=1),c.bufferObject?n=new U(c.bufferObject,a,s,h):(n=new U(null,a,s,h),c.normalizeWhenReady=a,c.convolveWhenReady=n),lt(t,n)}},pt.prototype.AddGainEffect=function(t,e){1===r&&lt(t=t.toLowerCase(),new H(P(e)))},pt.prototype.AddMuteEffect=function(t){1===r&&lt(t=t.toLowerCase(),new H(0))},pt.prototype.AddTremoloEffect=function(t,e,i){1===r&&o.createOscillator&&((i/=100)<0&&(i=0),i>1&&(i=1),lt(t=t.toLowerCase(),new q(e,i)))},pt.prototype.AddRingModEffect=function(t,e,i){1===r&&o.createOscillator&&((i/=100)<0&&(i=0),i>1&&(i=1),lt(t=t.toLowerCase(),new K(e,i)))},pt.prototype.AddDistortionEffect=function(t,e,i,s,n,a){1===r&&o.createWaveShaper&&((a/=100)<0&&(a=0),a>1&&(a=1),lt(t=t.toLowerCase(),new Q(e,i,s,n,a)))},pt.prototype.AddCompressorEffect=function(t,e,i,s,n,a){1===r&&o.createDynamicsCompressor&&lt(t=t.toLowerCase(),new Z(e,i,s,n/1e3,a/1e3))},pt.prototype.AddAnalyserEffect=function(t,e,i){1===r&&lt(t=t.toLowerCase(),new $(e,i))},pt.prototype.RemoveEffects=function(t){var e,i,s;if(1===r&&(t=t.toLowerCase(),L.hasOwnProperty(t)&&(s=L[t]).length)){for(e=0,i=s.length;e<i;e++)s[e].remove();cr.clearArray(s),ct(t)}},pt.prototype.SetEffectParameter=function(t,e,i,s,n,o){var a;1===r&&(t=t.toLowerCase(),e=Math.floor(e),L.hasOwnProperty(t)&&(a=L[t],e<0||e>=a.length||a[e].setParam(i,s,n,o)))},pt.prototype.SetListenerObject=function(t){if(t&&1===r){var e=t.getFirstPicked();e&&(this.listenerTracker.setObject(e),f=e.x,g=e.y)}},pt.prototype.SetListenerZ=function(t){this.listenerZ=t},pt.prototype.ScheduleNextPlay=function(t){o&&(this.nextPlayTime=t)},pt.prototype.UnloadAudio=function(t){var e=t[1],i=this.runtime.files_subfolder+t[0]+(l?".ogg":".m4a"),s=this.getAudioBuffer(i,e,!0);s&&(s.release(),cr.arrayFindRemove(a,s))},pt.prototype.UnloadAudioByName=function(t,e){var i=1===t,s=this.runtime.files_subfolder+e.toLowerCase()+(l?".ogg":".m4a"),n=this.getAudioBuffer(s,i,!0);n&&(n.release(),cr.arrayFindRemove(a,n))},pt.prototype.UnloadAll=function(){var t,e;for(t=0,e=a.length;t<e;++t)a[t].release();cr.clearArray(a)},t.acts=new pt,dt.prototype.Duration=function(t,e){ht(e,!0),ot.length?t.set_float(ot[0].getDuration()):t.set_float(0)},dt.prototype.PlaybackTime=function(t,e){ht(e,!0),ot.length?t.set_float(ot[0].getPlaybackTime(!0)):t.set_float(0)},dt.prototype.Volume=function(t,e){if(ht(e,!0),ot.length){var i=ot[0].getVolume();t.set_float(M(i))}else t.set_float(0)},dt.prototype.MasterVolume=function(t){t.set_float(M(d))},dt.prototype.EffectCount=function(t,e){e=e.toLowerCase();var i=null;L.hasOwnProperty(e)&&(i=L[e]),t.set_int(i?i.length:0)},dt.prototype.AnalyserFreqBinCount=function(t,e,i){var s=ft(e=e.toLowerCase(),i=Math.floor(i));t.set_int(s?s.node.frequencyBinCount:0)},dt.prototype.AnalyserFreqBinAt=function(t,e,i,s){e=e.toLowerCase(),i=Math.floor(i),s=Math.floor(s);var n=ft(e,i);n?s<0||s>=n.node.frequencyBinCount?t.set_float(0):t.set_float(n.freqBins[s]):t.set_float(0)},dt.prototype.AnalyserPeakLevel=function(t,e,i){var s=ft(e=e.toLowerCase(),i=Math.floor(i));s?t.set_float(s.peak):t.set_float(0)},dt.prototype.AnalyserRMSLevel=function(t,e,i){var s=ft(e=e.toLowerCase(),i=Math.floor(i));s?t.set_float(s.rms):t.set_float(0)},dt.prototype.SampleRate=function(t){t.set_int(o?o.sampleRate:0)},dt.prototype.CurrentTime=function(t){t.set_float(o?o.currentTime:cr.performance_now())},t.exps=new dt}(),cr.plugins_.Browser=function(t){this.runtime=t},function(){var t=cr.plugins_.Browser.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){};var i=!1,s=!1;document.addEventListener("DOMContentLoaded",function(){if(window.C2_RegisterSW&&navigator.serviceWorker){var t=document.createElement("script");t.onload=function(){i=!0,r()},t.src="offlineClient.js",document.head.appendChild(t)}});var n=null;function r(){i&&s&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback(function(t){n.onSWMessage(t)})}e.onAppBegin=function(){s=!0,r()},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var o=t.Instance.prototype;o.onCreate=function(){var t=this;window.addEventListener("resize",function(){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnResize,t)}),n=this,void 0!==navigator.onLine&&(window.addEventListener("online",function(){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOnline,t)}),window.addEventListener("offline",function(){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOffline,t)})),this.runtime.isDirectCanvas||(document.addEventListener("appMobi.device.update.available",function(){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateReady,t)}),document.addEventListener("backbutton",function(){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,t)}),document.addEventListener("menubutton",function(){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton,t)}),document.addEventListener("searchbutton",function(){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnSearchButton,t)}),document.addEventListener("tizenhwkey",function(e){switch(e.keyName){case"back":t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,t)||window.tizen&&window.tizen.application.getCurrentApplication().exit();break;case"menu":t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton,t)||e.preventDefault()}})),this.runtime.isWindows10&&"undefined"!=typeof Windows?Windows.UI.Core.SystemNavigationManager.getForCurrentView().addEventListener("backrequested",function(e){t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,t)&&(e.handled=!0)}):this.runtime.isWinJS&&WinJS.Application&&(WinJS.Application.onbackclick=function(e){return!!t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,t)}),this.runtime.addSuspendCallback(function(e){e?t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageHidden,t):t.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageVisible,t)}),this.is_arcade=void 0!==window.is_scirra_arcade},o.onSWMessage=function(t){var e=t.data.type;"downloading-update"===e?this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateFound,this):"update-ready"===e||"update-pending"===e?this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateReady,this):"offline-ready"===e&&this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOfflineReady,this)};var a=null,h=!1;function c(){if(!h&&navigator.getBattery){var t=navigator.getBattery();h=!0,t&&t.then(function(t){a=t})}}function l(){}function u(){}l.prototype.CookiesEnabled=function(){return!!navigator&&navigator.cookieEnabled},l.prototype.IsOnline=function(){return!!navigator&&navigator.onLine},l.prototype.HasJava=function(){return!!navigator&&navigator.javaEnabled()},l.prototype.OnOnline=function(){return!0},l.prototype.OnOffline=function(){return!0},l.prototype.IsDownloadingUpdate=function(){return!1},l.prototype.OnUpdateReady=function(){return!0},l.prototype.PageVisible=function(){return!this.runtime.isSuspended},l.prototype.OnPageVisible=function(){return!0},l.prototype.OnPageHidden=function(){return!0},l.prototype.OnResize=function(){return!0},l.prototype.IsFullscreen=function(){return!!(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||this.runtime.isNodeFullscreen)},l.prototype.OnBackButton=function(){return!0},l.prototype.OnMenuButton=function(){return!0},l.prototype.OnSearchButton=function(){return!0},l.prototype.IsMetered=function(){var t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return!!t&&!!t.metered},l.prototype.IsCharging=function(){var t=navigator.battery||navigator.mozBattery||navigator.webkitBattery;return t?!!t.charging:(c(),!a||!!a.charging)},l.prototype.IsPortraitLandscape=function(t){return(window.innerWidth<=window.innerHeight?0:1)===t},l.prototype.SupportsFullscreen=function(){if(this.runtime.isNodeWebkit)return!0;var t=this.runtime.canvasdiv||this.runtime.canvas;return!!(t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullScreen)},l.prototype.OnUpdateFound=function(){return!0},l.prototype.OnUpdateReady=function(){return!0},l.prototype.OnOfflineReady=function(){return!0},t.cnds=new l,u.prototype.Alert=function(t){this.runtime.isDomFree||alert(t.toString())},u.prototype.Close=function(){this.runtime.isCocoonJs?CocoonJS.App.forceToFinish():window.tizen?window.tizen.application.getCurrentApplication().exit():navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&navigator.device.exitApp?navigator.device.exitApp():this.is_arcade||this.runtime.isDomFree||window.close()},u.prototype.Focus=function(){this.runtime.isNodeWebkit?window.nwgui.Window.get().focus():this.is_arcade||this.runtime.isDomFree||window.focus()},u.prototype.Blur=function(){this.runtime.isNodeWebkit?window.nwgui.Window.get().blur():this.is_arcade||this.runtime.isDomFree||window.blur()},u.prototype.GoBack=function(){navigator.app&&navigator.app.backHistory?navigator.app.backHistory():this.is_arcade||this.runtime.isDomFree||!window.back||window.back()},u.prototype.GoForward=function(){this.is_arcade||this.runtime.isDomFree||!window.forward||window.forward()},u.prototype.GoHome=function(){this.is_arcade||this.runtime.isDomFree||!window.home||window.home()},u.prototype.GoToURL=function(t,e){this.runtime.isCocoonJs?CocoonJS.App.openURL(t):this.runtime.isEjecta?ejecta.openURL(t):this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(t)):navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(t,{openExternal:!0}):self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(t,"_system"):this.is_arcade||this.runtime.isDomFree||(2!==e||this.is_arcade?1!==e||this.is_arcade?window.location=t:window.parent.location=t:window.top.location=t)},u.prototype.GoToURLWindow=function(t,e){this.runtime.isCocoonJs?CocoonJS.App.openURL(t):this.runtime.isEjecta?ejecta.openURL(t):this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(t)):navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(t,{openExternal:!0}):self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(t,"_system"):this.is_arcade||this.runtime.isDomFree||window.open(t,e)},u.prototype.Reload=function(){this.is_arcade||this.runtime.isDomFree||window.location.reload()};var p=!0,d=null;function f(t){console&&console.warn&&console.warn("Fullscreen request failed: ",t),d.setSize(window.innerWidth,window.innerHeight)}u.prototype.RequestFullScreen=function(t){if(this.runtime.isDomFree)cr.logexport("[Construct 2] Requesting fullscreen is not supported on this platform - the request has been ignored");else if(t>=2&&(t+=1),6===t&&(t=2),this.runtime.isNodeWebkit)this.runtime.isDebug?debuggerFullscreen(!0):!this.runtime.isNodeFullscreen&&window.nwgui&&(window.nwgui.Window.get().enterFullscreen(),this.runtime.isNodeFullscreen=!0,this.runtime.fullscreen_scaling=t>=2?t:0);else{if(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||document.fullScreenElement)return;this.runtime.fullscreen_scaling=t>=2?t:0;var e=document.documentElement;p&&(p=!1,d=this.runtime,e.addEventListener("mozfullscreenerror",f),e.addEventListener("webkitfullscreenerror",f),e.addEventListener("MSFullscreenError",f),e.addEventListener("fullscreenerror",f)),e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():e.webkitRequestFullScreen&&("undefined"!=typeof Element&&void 0!==Element.ALLOW_KEYBOARD_INPUT?e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):e.webkitRequestFullScreen())}},u.prototype.CancelFullScreen=function(){this.runtime.isDomFree?cr.logexport("[Construct 2] Exiting fullscreen is not supported on this platform - the request has been ignored"):this.runtime.isNodeWebkit?this.runtime.isDebug?debuggerFullscreen(!1):this.runtime.isNodeFullscreen&&window.nwgui&&(window.nwgui.Window.get().leaveFullscreen(),this.runtime.isNodeFullscreen=!1):document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()},u.prototype.Vibrate=function(t){try{var e,i,s=t.split(",");for(e=0,i=s.length;e<i;e++)s[e]=parseInt(s[e],10);navigator.vibrate?navigator.vibrate(s):navigator.mozVibrate?navigator.mozVibrate(s):navigator.webkitVibrate?navigator.webkitVibrate(s):navigator.msVibrate&&navigator.msVibrate(s)}catch(t){}},u.prototype.InvokeDownload=function(t,e){var i=document.createElement("a");if(void 0===i.download)window.open(t);else{var s=document.getElementsByTagName("body")[0];i.textContent=e,i.href=t,i.download=e,s.appendChild(i);var n=new MouseEvent("click");i.dispatchEvent(n),s.removeChild(i)}},u.prototype.InvokeDownloadString=function(t,e,i){var s="data:"+e+","+encodeURIComponent(t),n=document.createElement("a");if(void 0===n.download)window.open(s);else{var r=document.getElementsByTagName("body")[0];n.textContent=i,n.href=s,n.download=i,r.appendChild(n);var o=new MouseEvent("click");n.dispatchEvent(o),r.removeChild(n)}},u.prototype.ConsoleLog=function(t,e){"undefined"!=typeof console&&(0===t&&console.log&&console.log(e.toString()),1===t&&console.warn&&console.warn(e.toString()),2===t&&console.error&&console.error(e.toString()))},u.prototype.ConsoleGroup=function(t){console&&console.group&&console.group(t)},u.prototype.ConsoleGroupEnd=function(){console&&console.groupEnd&&console.groupEnd()},u.prototype.ExecJs=function(t){try{eval&&eval(t)}catch(t){console&&console.error&&console.error("Error executing Javascript: ",t)}};var g=["portrait","landscape","portrait-primary","portrait-secondary","landscape-primary","landscape-secondary"];function m(){}u.prototype.LockOrientation=function(t){if(!((t=Math.floor(t))<0||t>=g.length)){this.runtime.autoLockOrientation=!1;var e=g[t];screen.orientation&&screen.orientation.lock?screen.orientation.lock(e):screen.lockOrientation?screen.lockOrientation(e):screen.webkitLockOrientation?screen.webkitLockOrientation(e):screen.mozLockOrientation?screen.mozLockOrientation(e):screen.msLockOrientation&&screen.msLockOrientation(e)}},u.prototype.UnlockOrientation=function(){this.runtime.autoLockOrientation=!1,screen.orientation&&screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},t.acts=new u,m.prototype.URL=function(t){t.set_string(this.runtime.isDomFree?"":window.location.toString())},m.prototype.Protocol=function(t){t.set_string(this.runtime.isDomFree?"":window.location.protocol)},m.prototype.Domain=function(t){t.set_string(this.runtime.isDomFree?"":window.location.hostname)},m.prototype.PathName=function(t){t.set_string(this.runtime.isDomFree?"":window.location.pathname)},m.prototype.Hash=function(t){t.set_string(this.runtime.isDomFree?"":window.location.hash)},m.prototype.Referrer=function(t){t.set_string(this.runtime.isDomFree?"":document.referrer)},m.prototype.Title=function(t){t.set_string(this.runtime.isDomFree?"":document.title)},m.prototype.Name=function(t){t.set_string(this.runtime.isDomFree?"":navigator.appName)},m.prototype.Version=function(t){t.set_string(this.runtime.isDomFree?"":navigator.appVersion)},m.prototype.Language=function(t){navigator&&navigator.language?t.set_string(navigator.language):t.set_string("")},m.prototype.Platform=function(t){t.set_string(this.runtime.isDomFree?"":navigator.platform)},m.prototype.Product=function(t){navigator&&navigator.product?t.set_string(navigator.product):t.set_string("")},m.prototype.Vendor=function(t){navigator&&navigator.vendor?t.set_string(navigator.vendor):t.set_string("")},m.prototype.UserAgent=function(t){t.set_string(this.runtime.isDomFree?"":navigator.userAgent)},m.prototype.QueryString=function(t){t.set_string(this.runtime.isDomFree?"":window.location.search)},m.prototype.QueryParam=function(t,e){if(this.runtime.isDomFree)t.set_string("");else{var i=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);i?t.set_string(decodeURIComponent(i[1].replace(/\+/g," "))):t.set_string("")}},m.prototype.Bandwidth=function(t){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;e?void 0!==e.bandwidth?t.set_float(e.bandwidth):void 0!==e.downlinkMax?t.set_float(e.downlinkMax):t.set_float(Number.POSITIVE_INFINITY):t.set_float(Number.POSITIVE_INFINITY)},m.prototype.ConnectionType=function(t){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;e?t.set_string(e.type||"unknown"):t.set_string("unknown")},m.prototype.BatteryLevel=function(t){var e=navigator.battery||navigator.mozBattery||navigator.webkitBattery;e?t.set_float(e.level):(c(),a?t.set_float(a.level):t.set_float(1))},m.prototype.BatteryTimeLeft=function(t){var e=navigator.battery||navigator.mozBattery||navigator.webkitBattery;e?t.set_float(e.dischargingTime):(c(),a?t.set_float(a.dischargingTime):t.set_float(Number.POSITIVE_INFINITY))},m.prototype.ExecJS=function(t,e){if(eval){var i=0;try{i=eval(e)}catch(t){console&&console.error&&console.error("Error executing Javascript: ",t)}"number"==typeof i||"string"==typeof i?t.set_any(i):"boolean"==typeof i?t.set_any(i?1:0):t.set_any(0)}else t.set_any(0)},m.prototype.ScreenWidth=function(t){t.set_int(screen.width)},m.prototype.ScreenHeight=function(t){t.set_int(screen.height)},m.prototype.DevicePixelRatio=function(t){t.set_float(this.runtime.devicePixelRatio)},m.prototype.WindowInnerWidth=function(t){t.set_int(window.innerWidth)},m.prototype.WindowInnerHeight=function(t){t.set_int(window.innerHeight)},m.prototype.WindowOuterWidth=function(t){t.set_int(window.outerWidth)},m.prototype.WindowOuterHeight=function(t){t.set_int(window.outerHeight)},t.exps=new m}(),cr.plugins_.Button=function(t){this.runtime=t},function(){var t=cr.plugins_.Button.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){this.runtime.isDomFree?cr.logexport("[Construct 2] Button plugin not supported on this platform - the object will not be created"):(this.isCheckbox=1===this.properties[0],this.inputElem=document.createElement("input"),this.isCheckbox?this.elem=document.createElement("label"):this.elem=this.inputElem,this.labelText=null,this.inputElem.type=this.isCheckbox?"checkbox":"button",this.inputElem.id=this.properties[6],jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body"),this.isCheckbox?(jQuery(this.inputElem).appendTo(this.elem),this.labelText=document.createTextNode(this.properties[1]),jQuery(this.elem).append(this.labelText),this.inputElem.checked=0!==this.properties[7],jQuery(this.elem).css("font-family","sans-serif"),jQuery(this.elem).css("display","inline-block"),jQuery(this.elem).css("color","black")):this.inputElem.value=this.properties[1],this.elem.title=this.properties[2],this.inputElem.disabled=0===this.properties[4],this.autoFontSize=0!==this.properties[5],this.element_hidden=!1,0===this.properties[3]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0),this.inputElem.onclick=function(t){return function(e){e.stopPropagation(),t.runtime.isInUserInputEvent=!0,t.runtime.trigger(cr.plugins_.Button.prototype.cnds.OnClicked,t),t.runtime.isInUserInputEvent=!1}}(this),this.elem.addEventListener("touchstart",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchmove",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchend",function(t){t.stopPropagation()},!1),jQuery(this.elem).mousedown(function(t){t.stopPropagation()}),jQuery(this.elem).mouseup(function(t){t.stopPropagation()}),jQuery(this.elem).keydown(function(t){t.stopPropagation()}),jQuery(this.elem).keyup(function(t){t.stopPropagation()}),this.lastLeft=0,this.lastTop=0,this.lastRight=0,this.lastBottom=0,this.lastWinWidth=0,this.lastWinHeight=0,this.updatePosition(!0),this.runtime.tickMe(this))},e.saveToJSON=function(){var t={tooltip:this.elem.title,disabled:!!this.inputElem.disabled};return this.isCheckbox?(t.checked=!!this.inputElem.checked,t.text=this.labelText.nodeValue):t.text=this.elem.value,t},e.loadFromJSON=function(t){this.elem.title=t.tooltip,this.inputElem.disabled=t.disabled,this.isCheckbox?(this.inputElem.checked=t.checked,this.labelText.nodeValue=t.text):this.elem.value=t.text},e.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)},e.tick=function(){this.updatePosition()};function i(){}function s(){}e.updatePosition=function(t){if(!this.runtime.isDomFree){var e=this.layer.layerToCanvas(this.x,this.y,!0),i=this.layer.layerToCanvas(this.x,this.y,!1),s=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),n=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),r=this.runtime.width/this.runtime.devicePixelRatio,o=this.runtime.height/this.runtime.devicePixelRatio;if(!this.visible||!this.layer.visible||s<=0||n<=0||e>=r||i>=o)return this.element_hidden||jQuery(this.elem).hide(),void(this.element_hidden=!0);e<1&&(e=1),i<1&&(i=1),s>=r&&(s=r-1),n>=o&&(n=o-1);var a=window.innerWidth,h=window.innerHeight;if(t||this.lastLeft!==e||this.lastTop!==i||this.lastRight!==s||this.lastBottom!==n||this.lastWinWidth!==a||this.lastWinHeight!==h){this.lastLeft=e,this.lastTop=i,this.lastRight=s,this.lastBottom=n,this.lastWinWidth=a,this.lastWinHeight=h,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1);var c=Math.round(e)+jQuery(this.runtime.canvas).offset().left,l=Math.round(i)+jQuery(this.runtime.canvas).offset().top;jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:c,top:l}),jQuery(this.elem).width(Math.round(s-e)),jQuery(this.elem).height(Math.round(n-i)),this.autoFontSize&&jQuery(this.elem).css("font-size",this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em")}else this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1)}},e.draw=function(t){},e.drawGL=function(t){},i.prototype.OnClicked=function(){return!0},i.prototype.IsChecked=function(){return this.isCheckbox&&this.inputElem.checked},t.cnds=new i,s.prototype.SetText=function(t){this.runtime.isDomFree||(this.isCheckbox?this.labelText.nodeValue=t:this.elem.value=t)},s.prototype.SetTooltip=function(t){this.runtime.isDomFree||(this.elem.title=t)},s.prototype.SetVisible=function(t){this.runtime.isDomFree||(this.visible=0!==t)},s.prototype.SetEnabled=function(t){this.runtime.isDomFree||(this.inputElem.disabled=0===t)},s.prototype.SetFocus=function(){this.runtime.isDomFree||this.inputElem.focus()},s.prototype.SetBlur=function(){this.runtime.isDomFree||this.inputElem.blur()},s.prototype.SetCSSStyle=function(t,e){this.runtime.isDomFree||jQuery(this.elem).css(t,e)},s.prototype.SetChecked=function(t){!this.runtime.isDomFree&&this.isCheckbox&&(this.inputElem.checked=1===t)},s.prototype.ToggleChecked=function(){!this.runtime.isDomFree&&this.isCheckbox&&(this.inputElem.checked=!this.inputElem.checked)},t.acts=new s,t.exps=new function(){}}();var lastCSS="",importList=[];function importcssfile(t){if(-1==importList.indexOf(t)){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",t),document.getElementsByTagName("head")[0].appendChild(e),importList.push(t)}}function removecssfile(t){for(var e=document.getElementsByTagName("link"),i=e.length;i>=0;i--)e[i]&&null!=e[i].getAttribute("href")&&-1!=e[i].getAttribute("href").indexOf(t)&&e[i].parentNode.removeChild(e[i]);importList.splice(importList.indexOf(t),1)}Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){e=e||0;for(var i=this.length;e<i;){if(this[e]===t)return e;++e}return-1}),cr.plugins_.CSS_import=function(t){this.runtime=t},function(){var t=cr.plugins_.CSS_import.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){""!=this.properties[0]&&(importcssfile(this.properties[0]),lastCSS=this.properties[0])},e.onDestroy=function(){},e.draw=function(t){},e.drawGL=function(t){},t.cnds={},t.cnds.CompareCSS=function(t,e){return this.properties[0]===t},t.acts={};var i=t.acts;i.SetCSS=function(t){importcssfile(t),lastCSS=t},i.RemCSS=function(t){removecssfile(t)},t.exps={},t.exps.GetCSS=function(t){""!=lastCSS?t.set_string(lastCSS):""!=this.properties[0]?t.set_string(this.properties[0]):t.set_string("")}}(),cr.plugins_.Function=function(t){this.runtime=t},function(){var t=cr.plugins_.Function.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,i=[],s=-1;function n(){this.name="",this.retVal=0,this.params=[]}function r(){return++s===i.length&&i.push(new n),i[s]}function o(){return s<0?null:i[s]}function a(){s--}function h(){}function c(){}function l(){}e.onCreate=function(){"undefined"!=typeof cr_is_preview;var t=this;window.c2_callFunction=function(e,i){var s,n,o,h=r();if(h.name=e.toLowerCase(),h.retVal=0,i)for(h.params.length=i.length,s=0,n=i.length;s<n;++s)o=i[s],h.params[s]="number"==typeof o||"string"==typeof o?o:"boolean"==typeof o&&o?1:0;else cr.clearArray(h.params);return t.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,t,h.name),a(),h.retVal}},h.prototype.OnFunction=function(t){var e=o();return!!e&&cr.equals_nocase(t,e.name)},h.prototype.CompareParam=function(t,e,i){var s=o();return!!s&&(!((t=cr.floor(t))<0||t>=s.params.length)&&cr.do_cmp(s.params[t],e,i))},t.cnds=new h,c.prototype.CallFunction=function(t,e){var i=r();i.name=t.toLowerCase(),i.retVal=0,cr.shallowAssignArray(i.params,e);this.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,this,i.name);a()},c.prototype.SetReturnValue=function(t){var e=o();e&&(e.retVal=t)},c.prototype.CallExpression=function(t){},t.acts=new c,l.prototype.ReturnValue=function(t){var e=function(){if(!i.length)return null;var t=s+1;return t>=i.length&&(t=i.length-1),i[t]}();e?t.set_any(e.retVal):t.set_int(0)},l.prototype.ParamCount=function(t){var e=o();e?t.set_int(e.params.length):t.set_int(0)},l.prototype.Param=function(t,e){e=cr.floor(e);var i=o();i&&e>=0&&e<i.params.length?t.set_any(i.params[e]):t.set_int(0)},l.prototype.Call=function(t,e){var i,s,n=r();for(n.name=e.toLowerCase(),n.retVal=0,cr.clearArray(n.params),i=2,s=arguments.length;i<s;i++)n.params.push(arguments[i]);this.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,this,n.name);a(),t.set_any(n.retVal)},t.exps=new l}(),cr.plugins_.GameAnalytics=function(t){this.runtime=t},function(){var t=cr.plugins_.GameAnalytics.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}e.onCreate=function(){this.build=this.properties[0],this.customUserId=this.properties[1],this.enableManualSessionHandling=this.properties[2],this.enableInfoLog=this.properties[3],this.enableVerboseLog=this.properties[4],this.gameKeyBrowser=this.properties[5],this.secretKeyBrowser=this.properties[6],this.gameKeyAndroid=this.properties[7],this.secretKeyAndroid=this.properties[8],this.gameKeyIOS=this.properties[9],this.secretKeyIOS=this.properties[10],this.customDimensions01=[],this.customDimensions02=[],this.customDimensions03=[],this.resourceCurrencies=[],this.resourceItemTypes=[]},e.onDestroy=function(){},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.draw=function(t){},e.drawGL=function(t){},t.cnds=new function(){},i.prototype.addAvailableCustomDimension01=function(t){this.customDimensions01.push(t)},i.prototype.addAvailableCustomDimension02=function(t){this.customDimensions02.push(t)},i.prototype.addAvailableCustomDimension03=function(t){this.customDimensions03.push(t)},i.prototype.addAvailableResourceCurrency=function(t){this.resourceCurrencies.push(t)},i.prototype.addAvailableResourceItemType=function(t){this.resourceItemTypes.push(t)},i.prototype.initialize=function(){var t="1.1.1";if("function"==typeof window.GameAnalytics.initialize){this.enableInfoLog&&GameAnalytics.setEnabledInfoLog(!0),this.enableVerboseLog&&GameAnalytics.setEnabledVerboseLog(!0),this.enableManualSessionHandling&&GameAnalytics.setEnabledManualSessionHandling(!0),this.customDimensions01.length>0&&GameAnalytics.configureAvailableCustomDimensions01(this.customDimensions01),this.customDimensions02.length>0&&GameAnalytics.configureAvailableCustomDimensions02(this.customDimensions02),this.customDimensions03.length>0&&GameAnalytics.configureAvailableCustomDimensions03(this.customDimensions03),this.resourceCurrencies.length>0&&GameAnalytics.configureAvailableResourceCurrencies(this.resourceCurrencies),this.resourceItemTypes.length>0&&GameAnalytics.configureAvailableResourceItemTypes(this.resourceItemTypes),GameAnalytics.configureBuild(this.build);var e="construct "+t,i="Android"===device.platform?this.gameKeyAndroid:this.gameKeyIOS,s="Android"===device.platform?this.secretKeyAndroid:this.secretKeyIOS;GameAnalytics.initialize({gameKey:i,secretKey:s,sdkVersion:e})}else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("initialize: GameAnalytics object not found");var n=window.gameanalytics.GameAnalytics;this.enableInfoLog&&n.setEnabledInfoLog(!0),this.enableVerboseLog&&n.setEnabledVerboseLog(!0),this.enableManualSessionHandling&&n.setEnabledManualSessionHandling(!0),this.customDimensions01.length>0&&n.configureAvailableCustomDimensions01(this.customDimensions01),this.customDimensions02.length>0&&n.configureAvailableCustomDimensions02(this.customDimensions02),this.customDimensions03.length>0&&n.configureAvailableCustomDimensions03(this.customDimensions03),this.resourceCurrencies.length>0&&n.configureAvailableResourceCurrencies(this.resourceCurrencies),this.resourceItemTypes.length>0&&n.configureAvailableResourceItemTypes(this.resourceItemTypes),n.configureBuild(this.build),n.configureSdkGameEngineVersion("construct "+t),n.initialize(this.gameKeyBrowser,this.secretKeyBrowser)}},i.prototype.addBusinessEvent=function(t,e,i,s,n){if("function"==typeof window.GameAnalytics.addBusinessEvent)GameAnalytics.addBusinessEvent({currency:t,amount:e,itemType:i,itemId:s,cartType:n});else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("addBusinessEvent: GameAnalytics object not found");window.gameanalytics.GameAnalytics.addBusinessEvent(t,e,i,s,n)}},i.prototype.addResourceEvent=function(t,e,i,s,n){if("function"==typeof window.GameAnalytics.addResourceEvent)GameAnalytics.addResourceEvent({flowType:t,currency:e,amount:i,itemType:s,itemId:n});else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("addResourceEvent: GameAnalytics object not found");window.gameanalytics.GameAnalytics.addResourceEvent(t,e,i,s,n)}},i.prototype.addProgressionEvent=function(t,e,i,s){if("function"==typeof window.GameAnalytics.addProgressionEvent)GameAnalytics.addProgressionEvent({progressionStatus:t,progression01:e,progression02:i,progression03:s});else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("addProgressionEvent: GameAnalytics object not found");window.gameanalytics.GameAnalytics.addProgressionEvent(t,e,i,s)}},i.prototype.addProgressionEventWithScore=function(t,e,i,s,n){if("function"==typeof window.GameAnalytics.addProgressionEvent)GameAnalytics.addProgressionEvent({progressionStatus:t,progression01:e,progression02:i,progression03:s,score:n});else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("addProgressionEventWithScore: GameAnalytics object not found");window.gameanalytics.GameAnalytics.addProgressionEvent(t,e,i,s,n)}},i.prototype.addDesignEvent=function(t){if("function"==typeof window.GameAnalytics.addDesignEvent)GameAnalytics.addDesignEvent({eventId:t});else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("addDesignEvent: GameAnalytics object not found");window.gameanalytics.GameAnalytics.addDesignEvent(t)}},i.prototype.addDesignEventWithValue=function(t,e){if("function"==typeof window.GameAnalytics.addDesignEvent)GameAnalytics.addDesignEvent({eventId:t,value:e});else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("addDesignEventWithValue: GameAnalytics object not found");window.gameanalytics.GameAnalytics.addDesignEvent(t,e)}},i.prototype.addErrorEvent=function(t,e){if("function"==typeof window.GameAnalytics.addErrorEvent)GameAnalytics.addErrorEvent({severity:t,message:e});else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("addErrorEvent: GameAnalytics object not found");window.gameanalytics.GameAnalytics.addErrorEvent(t,e)}},i.prototype.setEnabledManualSessionHandling=function(t){if("function"==typeof window.GameAnalytics.setEnabledManualSessionHandling)GameAnalytics.setEnabledManualSessionHandling(!!t);else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("setEnabledManualSessionHandling: GameAnalytics object not found");window.gameanalytics.GameAnalytics.setEnabledManualSessionHandling(!!t)}},i.prototype.setCustomDimension01=function(t){if("function"==typeof window.GameAnalytics.setCustomDimension01)GameAnalytics.setCustomDimension01(t);else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("setCustomDimension01: GameAnalytics object not found");window.gameanalytics.GameAnalytics.setCustomDimension01(t)}},i.prototype.setCustomDimension02=function(t){if("function"==typeof window.GameAnalytics.setCustomDimension02)GameAnalytics.setCustomDimension02(t);else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("setCustomDimension02: GameAnalytics object not found");window.gameanalytics.GameAnalytics.setCustomDimension02(t)}},i.prototype.setCustomDimension03=function(t){if("function"==typeof window.GameAnalytics.setCustomDimension03)GameAnalytics.setCustomDimension03(t);else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("setCustomDimension03: GameAnalytics object not found");window.gameanalytics.GameAnalytics.setCustomDimension03(t)}},i.prototype.setFacebookId=function(t){if("function"==typeof window.GameAnalytics.setFacebookId)GameAnalytics.setFacebookId(t);else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("setFacebookId: GameAnalytics object not found");window.gameanalytics.GameAnalytics.setFacebookId(t)}},i.prototype.setGender=function(t){if("function"==typeof window.GameAnalytics.setGender)GameAnalytics.setGender(t);else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("setGender: GameAnalytics object not found");window.gameanalytics.GameAnalytics.setGender(t)}},i.prototype.setBirthYear=function(t){if("function"==typeof window.GameAnalytics.setBirthYear)GameAnalytics.setBirthYear(t);else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("setBirthYear: GameAnalytics object not found");window.gameanalytics.GameAnalytics.setBirthYear(t)}},i.prototype.startSession=function(){if("function"==typeof window.GameAnalytics.startSession)GameAnalytics.startSession();else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("startSession: GameAnalytics object not found");window.gameanalytics.GameAnalytics.startSession()}},i.prototype.endSession=function(){if("function"==typeof window.GameAnalytics.endSession)GameAnalytics.endSession();else{if(void 0===window.gameanalytics.GameAnalytics)return void console.log("endSession: GameAnalytics object not found");window.gameanalytics.GameAnalytics.endSession()}},t.acts=new i,t.exps=new function(){}}(),cr.plugins_.Globals=function(t){this.runtime=t},function(){var t=cr.plugins_.Globals.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}e.onCreate=function(){this.defaultVarsValues=JSON.stringify(this.instance_vars)},e.saveToJSON=function(){return{v:JSON.stringify(this.instance_vars)}},e.loadFromJSON=function(t){this.instance_vars=JSON.parse(t.v)},t.cnds=new function(){},i.prototype.ResetVariables=function(){this.instance_vars=JSON.parse(this.defaultVarsValues)},i.prototype.LoadVariables=function(t){this.instance_vars=JSON.parse(t)},t.acts=new i,s.prototype.GetVariablesAsJSON=function(t){t.set_string(JSON.stringify(this.instance_vars))},t.exps=new s}(),cr.plugins_.HTML_Div_Pode=function(t){this.runtime=t},function(){var t=cr.plugins_.HTML_Div_Pode.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime,this.divloaded=0};var e=t.Instance.prototype;e.onCreate=function(){this.elem=document.createElement("div"),this.elem.innerHTML=this.properties[1],this.elem.style.cssText=this.properties[2],this.CSSstyle=this.properties[2];var t=this.width>0?1:-1,e=this.height>0?1:-1;this.elem.setAttribute("id",this.properties[3]),this.angle2D=this.angle,this.rotation2D="-webkit-transform:rotate("+this.angle*t*e*180/3.1416+"deg);-moz-transform:rotate("+this.angle*t*e*180/3.1416+"deg);-o-transform:rotate("+this.angle*t*e*180/3.1416+"deg);",this.elem.style.cssText+=";"+this.rotation2D,this.elem.width=Math.round(this.elem.width),this.elem.height=Math.round(this.elem.height),this.elem.x=Math.round(this.elem.x),this.elem.y=Math.round(this.elem.y),jQuery(this.elem).appendTo("body"),0===this.properties[0]&&(jQuery(this.elem).hide(),this.visible=!1),this.updatePosition(),this.runtime.tickMe(this)},e.onDestroy=function(){jQuery(this.elem).remove(),this.elem=null},e.tick=function(){this.updatePosition()},e.updatePosition=function(){var t=this.layer.layerToCanvas(this.x,this.y,!0),e=this.layer.layerToCanvas(this.x,this.y,!1),i=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),s=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1);if(!this.visible||!this.layer.visible||i<=0||s<=0||t>=this.runtime.width||e>=this.runtime.height)jQuery(this.elem).hide();else{t<1&&(t=1),e<1&&(e=1),i>=this.runtime.width&&(i=this.runtime.width-1),s>=this.runtime.height&&(s=this.runtime.height-1),jQuery(this.elem).show();var n=t+jQuery(this.runtime.canvas).offset().left,r=e+jQuery(this.runtime.canvas).offset().top;jQuery(this.elem).offset({left:n,top:r}),jQuery(this.elem).width(i-t),jQuery(this.elem).height(s-e),this.elem.width=Math.round(this.elem.width),this.elem.height=Math.round(this.elem.height),this.elem.x=Math.round(this.elem.x),this.elem.y=Math.round(this.elem.y)}},e.draw=function(t){},e.drawGL=function(t){},t.cnds={};var i=t.cnds;i.CompareinnerHTML=function(t,e){return this.elem.innerHTML===t},i.CompareStyle=function(t,e){return this.elem.style.cssText===t},i.OnComplete=function(t){return!0},i.OnError=function(){return!0},i.isFocused=function(){return this.elem==document.activeElement},t.acts={};var s=t.acts;s.SetInnerHTML=function(t){this.elem.innerHTML=t},s.rotate3d=function(t,e,i,s){var n="";1==t&&(this.angle3DX=this.angle3DX+s,n="-webkit-transform:rotateX("+this.angle3DX+"deg);-moz-transform:rotateX("+this.angle3DX+"deg);-o-transform:rotateX("+this.angle3DX+"deg);-ms-transform:rotateX("+this.angle3DX+"deg);transform:rotateX("+this.angle3DX+"deg);"),1==e&&(this.angle3DY=this.angle3DY+s,n=n+"-webkit-transform:rotateY("+this.angle3DY+"deg);-moz-transform:rotateY("+this.angle3DY+"deg);-o-transform:rotateY("+this.angle3DY+"deg);-ms-transform:rotateY("+this.angle3DY+"deg);transform:rotateY("+this.angle3DY+"deg);"),1==i&&(this.angle3DZ=this.angle3DZ+s,n=n+"-webkit-transform:rotateZ("+this.angle3DZ+"deg);-moz-transform:rotateZ("+this.angle3DZ+"deg);-o-transform:rotateZ("+this.angle3DZ+"deg);-ms-transform:rotateZ("+this.angle3DZ+"deg);transform:rotateZ("+this.angle3DZ+"deg);"),this.rotation3D=n,this.elem.style.cssText=this.CSSstyle+this.rotation2D+this.perspectiveValue+this.rotation3D,this.updatePosition()},s.rotate2d=function(t){var e=this.width>0?1:-1,i=this.height>0?1:-1;this.rotation2D="-webkit-transform:rotate("+t*e*i*180/3.1416+"deg);-moz-transform:rotate("+t*e*i*180/3.1416+"deg);-o-transform:rotate("+t*e*i*180/3.1416+"deg);",this.elem.style.cssText=this.CSSstyle+this.rotation2D+this.perspectiveValue+this.rotation3D,this.angle=this.angle2D+180*t/3.1416},s.setPerspective=function(t){this.perspectiveValue="-webkit-perspective:"+t+";-moz-perspective:"+t+";-o-perspective:"+t+";-ms-perspective:"+t+";perspective:"+t+";",this.elem.style.cssText=this.CSSstyle+this.rotation2D+this.perspectiveValue+this.rotation3D},s.LoadDiv=function(t,e){e.length?jQuery.ajax({context:this,dataType:"text",type:"POST",url:t,data:e,success:function(t){this.elem.innerHTML=t,this.runtime.trigger(cr.plugins_.HTML_Div.prototype.cnds.OnComplete,this)},error:function(){this.runtime.trigger(cr.plugins_.HTML_Div.prototype.cnds.OnError,this)}}):jQuery.ajax({context:this,dataType:"text",type:"GET",url:t,success:function(t){this.elem.innerHTML=t,this.runtime.trigger(cr.plugins_.HTML_Div.prototype.cnds.OnComplete,this)},error:function(){this.runtime.trigger(cr.plugins_.HTML_Div.prototype.cnds.OnError,this)}})},s.SetStyle=function(t){this.CSSstyle=t,this.elem.style.cssText=this.CSSstyle+this.rotation2D+this.perspectiveValue+this.rotation3D},s.SetVisible=function(t){this.visible=0!==t},s.setFocus=function(){this.elem.focus()},t.exps={};var n=t.exps;n.GetInnerHTML=function(t){t.set_string(this.elem.innerHTML)},n.GetStyle=function(t){t.set_string(this.elem.style.cssText)}}(),cr.plugins_.JSON=function(t){this.runtime=t,this.references={}},function(){var t=function(t,e){function i(t,e,i){var s,n=[],c=[t],l=[t],p=[i?r:"[Circular]"],d=t,f=1;return function(t,g){return e&&(g=e.call(this,t,g)),""!==t&&(d!==this&&(s=f-u.call(c,this)-1,f-=s,c.splice(f,c.length),n.splice(f-1,n.length),d=this),"object"==typeof g&&g?(u.call(c,g)<0&&c.push(d=g),f=c.length,(s=u.call(l,g))<0?(s=l.push(g)-1,i?(n.push((""+t).replace(h,o)),p[s]=r+n.join(r)):p[s]=p[0]):g=p[s]):"string"==typeof g&&i&&(g=g.replace(o,a).replace(r,o))),g}}function s(t){return function(e,i){var s="string"==typeof i;return s&&i.charAt(0)===r?new p(i.slice(1)):(""===e&&(i=n(i,i,{})),s&&(i=i.replace(l,"$1"+r).replace(a,o)),t?t.call(this,e,i):i)}}function n(t,e,i){return e instanceof Array?function(t,e,i){for(var s=0,r=e.length;s<r;s++)e[s]=n(t,e[s],i);return e}(t,e,i):e instanceof p?e.length?i.hasOwnProperty(e)?i[e]:i[e]=function(t,e){for(var i=0,s=e.length;i<s;t=t[e[i++].replace(c,r)]);return t}(t,e.split(r)):t:e instanceof Object?function(t,e,i){for(var s in e)e.hasOwnProperty(s)&&(e[s]=n(t,e[s],i));return e}(t,e,i):e}var r="~",o="\\x"+("0"+r.charCodeAt(0).toString(16)).slice(-2),a="\\"+o,h=new e(o,"g"),c=new e(a,"g"),l=new e("(?:^|([^\\\\]))"+a),u=[].indexOf||function(t){for(var e=this.length;e--&&this[e]!==t;);return e},p=String;return{stringify:function(e,s,n,r){return t.stringify(e,i(e,s,!r),n)},parse:function(e,i){return t.parse(e,s(i))}}}(JSON,RegExp),e=cr.plugins_.JSON.prototype;e.Type=function(t){this.plugin=t,this.runtime=t.runtime},e.Type.prototype.onCreate=function(){},e.Instance=function(t){this.type=t,this.runtime=t.runtime};var i=e.Instance.prototype,s="root";function n(t){return"array"===r(t)||"object"===r(t)}function r(t){return void 0===t?"undefined":null===t?"null":t===!!t?"boolean":"[object Number]"===Object.prototype.toString.call(t)?"number":"[object String]"===Object.prototype.toString.call(t)?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":"[object Object]"===Object.prototype.toString.call(t)?"object":void 0}function o(){}function a(){}function h(){}i.onCreate=function(){this.data={},this.curKey="",this.curValue=void 0,this.curPath=[]},i.onDestroy=function(){this.data=null,this.curKey=null,this.curPath=null,this.curValue=null;var t=this.type.plugin.references;for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&t[e].origin===this&&delete t[e]},i.saveToJSON=function(){return this.data[s]},i.loadFromJSON=function(t){this.data[s]=t},i.getValueFromPath=function(t,e){if(t)return this.getValueFromPath(!1,this.curPath.concat(e));for(var i=[s].concat(e),n=this.data,r=0;r<i.length;r++){if(void 0===n){logInvalidPath(e);break}if(null===n){r<i.length-1&&(logInvalidPath(e),n=void 0);break}n=n[i[r]]}return n},i.setValueFromPath=function(t,e,i){if(t)i=this.setValueFromPath(!1,this.curPath.concat(e),i);else for(var r=[s].concat(e),o=this.data,a=0;a<r.length;a++){if(!n(o))return void logInvalidPath(e);a<r.length-1?o=o[r[a]]:o[r[a]]=i}},o.prototype.OnJSONParseError=function(){return!0},o.prototype.IsObject=function(t,e){return"object"===r(this.getValueFromPath(1===t,e))},o.prototype.IsArray=function(t,e){return"array"===r(this.getValueFromPath(1===t,e))},o.prototype.IsBoolean=function(t,e){return"boolean"===r(this.getValueFromPath(1===t,e))},o.prototype.IsNumber=function(t,e){return"number"===r(this.getValueFromPath(1===t,e))},o.prototype.IsString=function(t,e){return"string"===r(this.getValueFromPath(1===t,e))},o.prototype.IsNull=function(t,e){return"null"===r(this.getValueFromPath(1===t,e))},o.prototype.IsUndefined=function(t,e){return void 0===this.getValueFromPath(1===t,e)},o.prototype.IsEmpty=function(t,e){var i=this.getValueFromPath(1===t,e),s=r(i);if("array"===s)return 0===i.length;if("object"===s){for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n))return!1;return!0}return void 0===i},o.prototype.ForEachProperty=function(t,e){var i,s=this.runtime.getCurrentEventStack(),n=s.current_event,r=s.isModifierAfterCnds(),o=this.runtime.pushLoopStack(),a=this.curPath;i=1===t?this.curPath.concat(e):e;var h,c=this.getValueFromPath(!1,i);if(r){for(h in c)if(Object.prototype.hasOwnProperty.call(c,h)&&(this.curPath=i.concat(h),this.curKey=h,this.curValue=c[h],this.runtime.pushCopySol(n.solModifiers),n.retrigger(),this.runtime.popSol(n.solModifiers),o.stopped))break}else for(h in c)if(Object.prototype.hasOwnProperty.call(c,h)&&(this.curPath=i.concat(h),this.curKey=h,this.curValue=c[h],n.retrigger(),o.stopped))break;return this.curPath=a,this.curKey="",this.curValue=void 0,this.runtime.popLoopStack(),!1},o.prototype.ReferenceExists=function(t){return t in this.type.plugin.references},e.cnds=new o,a.prototype.NewObject=function(t,e){this.setValueFromPath(t,e,{})},a.prototype.NewArray=function(t,e){this.setValueFromPath(t,e,[])},a.prototype.SetValue=function(t,e,i){this.setValueFromPath(e,i,t)},a.prototype.SetBoolean=function(t,e,i){this.setValueFromPath(e,i,0===t)},a.prototype.SetNull=function(t,e){this.setValueFromPath(t,e,null)},a.prototype.Delete=function(t,e){var i;function n(t,e){null!=t?"object"===r(t)&&void 0!==t[e]?delete t[e]:"array"===r(t)&&"number"===r(e)&&t.splice(Math.floor(e),1):logInvalidPath(i)}0===(i=t?this.curPath.concat(e):e).length?n(this.data,s):n(this.getValueFromPath(!1,i.slice(0,i.length-1)),i[i.length-1])},a.prototype.Clear=function(t,e){var i;function n(t,e){if(null!=t&&"object"==typeof t){var s=r(t[e]);if("array"===s)t[e].length=0;else if("object"===s)for(var n in t[e])Object.prototype.hasOwnProperty.call(t[e],n)&&delete t[e][n];else delete t[e]}else logInvalidPath(i)}0===(i=t?this.curPath.concat(e):e).length?n(this.data,s):n(this.getValueFromPath(!1,i.slice(0,i.length-1)),i[i.length-1])},i.LoadJSON=function(e,i,s){try{this.setValueFromPath(i,s,t.parse(e))}catch(t){console.warn("LoadJSON error:",t),this.runtime.trigger(cr.plugins_.JSON.prototype.cnds.OnJSONParseError,this)}},a.prototype.LoadJSON=function(t,e,i){this.LoadJSON(t,e,i)},a.prototype.LogData=function(){var e=void 0!==console.groupCollapsed&&void 0!==console.groupEnd;e?(console.groupCollapsed(s+":"),console.log(t.stringify(this.data[s],null,2)),console.groupEnd()):console.log(s+":",t.stringify(this.data[s],null,2)),console.log("Current Path:",t.stringify(this.curPath)),e?console.group("References:"):console.log("References:");var i=this.type.plugin.references;for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e?(console.groupCollapsed(n),console.log(t.stringify(i[n].value,null,2)),console.groupEnd()):console.log("["+n+"]",t.stringify(i[n].value,null,2)));e&&console.groupEnd(),console.log("")},a.prototype.SetCurrentPath=function(t,e){this.curPath=t?this.curPath.concat(e):e.slice()},a.prototype.PushPathNode=function(t){this.curPath.push(t)},a.prototype.PopPathNode=function(){this.curPath.pop()},a.prototype.SaveReference=function(t,e,i){this.type.plugin.references[t]={value:this.getValueFromPath(1===e,i),origin:this}},a.prototype.LoadReference=function(t,e,i){this.setValueFromPath(1===e,i,this.type.plugin.references[t].value)},a.prototype.DeleteReference=function(t){delete this.type.plugin.references[t]},a.prototype.DeleteAllReferences=function(t){this.type.plugin.references={}},e.acts=new a,h.prototype.Size=function(t){var e=Array.prototype.slice.call(arguments);e.shift();var i=e.shift(),s=this.getValueFromPath(1===i,e),n=r(s);if("array"===n)t.set_int(s.length);else if("object"===n){var o=0;for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&o++;t.set_int(o)}else t.set_int(-1)},h.prototype.Value=function(t){var e=Array.prototype.slice.call(arguments);e.shift();var i=e.shift(),s=this.getValueFromPath(1===i,e),n=r(s);"number"===n||"string"===n?t.set_any(s):"boolean"===n?t.set_any(s?1:0):t.set_any(n)},h.prototype.AsJson=function(e){var i=Array.prototype.slice.call(arguments);i.shift();var s=i.shift(),n=this.getValueFromPath(1===s,i),o=r(n);"undefined"===o?e.set_string(o):e.set_string(t.stringify(n))},h.prototype.TypeOf=function(t){var e=Array.prototype.slice.call(arguments);e.shift();var i=e.shift(),s=this.getValueFromPath(1===i,e);t.set_string(r(s))},h.prototype.CurrentKey=function(t){t.set_string(this.curKey)},h.prototype.CurrentValue=function(t){var e=this.curValue,i=r(e);"number"===i||"string"===i?t.set_any(e):"boolean"===i?t.set_any(e?1:0):t.set_any(i)},e.exps=new h}(),cr.plugins_.Keyboard=function(t){this.runtime=t},function(){var t=cr.plugins_.Keyboard.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime,this.keyMap=new Array(256),this.usedKeys=new Array(256),this.triggerKey=0};var e=t.Instance.prototype;e.onCreate=function(){var t=this;this.runtime.isDomFree||(jQuery(document).keydown(function(e){t.onKeyDown(e)}),jQuery(document).keyup(function(e){t.onKeyUp(e)}))};var i=[32,33,34,35,36,37,38,39,40,44];function s(){}function n(){}e.onKeyDown=function(t){var e=!1;if(window!=window.top&&i.indexOf(t.which)>-1&&(t.preventDefault(),e=!0,t.stopPropagation()),this.keyMap[t.which])this.usedKeys[t.which]&&!e&&t.preventDefault();else{this.keyMap[t.which]=!0,this.triggerKey=t.which,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKey,this);var s=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKey,this),n=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCode,this);this.runtime.isInUserInputEvent=!1,(s||n)&&(this.usedKeys[t.which]=!0,e||t.preventDefault())}},e.onKeyUp=function(t){this.keyMap[t.which]=!1,this.triggerKey=t.which,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this);var e=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),i=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this);this.runtime.isInUserInputEvent=!1,(e||i||this.usedKeys[t.which])&&(this.usedKeys[t.which]=!0,t.preventDefault())},e.onWindowBlur=function(){var t;for(t=0;t<256;++t)if(this.keyMap[t]){this.keyMap[t]=!1,this.triggerKey=t,this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this);var e=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),i=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this);(e||i)&&(this.usedKeys[t]=!0)}},e.saveToJSON=function(){return{triggerKey:this.triggerKey}},e.loadFromJSON=function(t){this.triggerKey=t.triggerKey},s.prototype.IsKeyDown=function(t){return this.keyMap[t]},s.prototype.OnKey=function(t){return t===this.triggerKey},s.prototype.OnAnyKey=function(t){return!0},s.prototype.OnAnyKeyReleased=function(t){return!0},s.prototype.OnKeyReleased=function(t){return t===this.triggerKey},s.prototype.IsKeyCodeDown=function(t){return!((t=Math.floor(t))<0||t>=this.keyMap.length)&&this.keyMap[t]},s.prototype.OnKeyCode=function(t){return t===this.triggerKey},s.prototype.OnKeyCodeReleased=function(t){return t===this.triggerKey},t.cnds=new s,t.acts=new function(){},n.prototype.LastKeyCode=function(t){t.set_int(this.triggerKey)},n.prototype.StringFromKeyCode=function(t,e){t.set_string(function(t){switch(t=Math.floor(t)){case 8:return"backspace";case 9:return"tab";case 13:return"enter";case 16:return"shift";case 17:return"control";case 18:return"alt";case 19:return"pause";case 20:return"capslock";case 27:return"esc";case 33:return"pageup";case 34:return"pagedown";case 35:return"end";case 36:return"home";case 37:return"";case 38:return"";case 39:return"";case 40:return"";case 45:return"insert";case 46:return"del";case 91:return"left window key";case 92:return"right window key";case 93:return"select";case 96:return"numpad 0";case 97:return"numpad 1";case 98:return"numpad 2";case 99:return"numpad 3";case 100:return"numpad 4";case 101:return"numpad 5";case 102:return"numpad 6";case 103:return"numpad 7";case 104:return"numpad 8";case 105:return"numpad 9";case 106:return"numpad *";case 107:return"numpad +";case 109:return"numpad -";case 110:return"numpad .";case 111:return"numpad /";case 112:return"F1";case 113:return"F2";case 114:return"F3";case 115:return"F4";case 116:return"F5";case 117:return"F6";case 118:return"F7";case 119:return"F8";case 120:return"F9";case 121:return"F10";case 122:return"F11";case 123:return"F12";case 144:return"numlock";case 145:return"scroll lock";case 186:return";";case 187:return"=";case 188:return",";case 189:return"-";case 190:return".";case 191:return"/";case 192:return"'";case 219:return"[";case 220:return"\\";case 221:return"]";case 222:return"#";case 223:return"`";default:return String.fromCharCode(t)}}(e))},t.exps=new n}();var localForageInitFailed=!1;try{!function(){var t,e,i,s,n;s={},n={},t=function(t,e,i){s[t]={deps:e,callback:i}},i=e=function(t){function r(e){if("."!==e.charAt(0))return e;for(var i=e.split("/"),s=t.split("/").slice(0,-1),n=0,r=i.length;r>n;n++){var o=i[n];if(".."===o)s.pop();else{if("."===o)continue;s.push(o)}}return s.join("/")}if(i._eak_seen=s,n[t])return n[t];if(n[t]={},!s[t])throw new Error("Could not find module "+t);for(var o,a=s[t],h=a.deps,c=a.callback,l=[],u=0,p=h.length;p>u;u++)"exports"===h[u]?l.push(o={}):l.push(e(r(h[u])));var d=c.apply(this,l);return n[t]=o||d},t("promise/all",["./utils","exports"],function(t,e){"use strict";var i=t.isArray,s=t.isFunction;e.all=function(t){if(!i(t))throw new TypeError("You must pass an array to all.");return new this(function(e,i){function n(t){return function(e){r(t,e)}}function r(t,i){a[t]=i,0===--h&&e(a)}var o,a=[],h=t.length;0===h&&e([]);for(var c=0;c<t.length;c++)(o=t[c])&&s(o.then)?o.then(n(c),i):r(c,o)})}}),t("promise/asap",["exports"],function(t){"use strict";function e(){for(var t=0;t<o.length;t++){var e=o[t];(0,e[0])(e[1])}o=[]}var i,s=void 0!==window?window:{},n=s.MutationObserver||s.WebKitMutationObserver,r="undefined"!=typeof global?global:void 0===this?window:this,o=[];i="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?function(){process.nextTick(e)}:n?function(){var t=0,i=new n(e),s=document.createTextNode("");return i.observe(s,{characterData:!0}),function(){s.data=t=++t%2}}():function(){r.setTimeout(e,1)},t.asap=function(t,e){1===o.push([t,e])&&i()}}),t("promise/config",["exports"],function(t){"use strict";var e={instrument:!1};t.config=e,t.configure=function(t,i){return 2!==arguments.length?e[t]:void(e[t]=i)}}),t("promise/polyfill",["./promise","./utils","exports"],function(t,e,i){"use strict";var s=t.Promise,n=e.isFunction;i.polyfill=function(){var t;"Promise"in(t="undefined"!=typeof global?global:void 0!==window&&window.document?window:self)&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&function(){var e;return new t.Promise(function(t){e=t}),n(e)}()||(t.Promise=s)}}),t("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(t,e,i,s,n,r,o,a){"use strict";function h(t){if(!v(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof h))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],function(t,e){function i(t){p(e,t)}function s(t){f(e,t)}try{t(i,s)}catch(t){s(t)}}(t,this)}function c(t,e,i,s){var n,r,o,a,h=v(i);if(h)try{n=i(s),o=!0}catch(t){a=!0,r=t}else n=s,o=!0;u(e,n)||(h&&o?p(e,n):a?f(e,r):t===k?p(e,n):t===A&&f(e,n))}function l(t,e){for(var i=t._subscribers,s=t._detail,n=0;n<i.length;n+=3)c(e,i[n],i[n+e],s);t._subscribers=null}function u(t,e){var i,s=null;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(_(e)&&(s=e.then,v(s)))return s.call(e,function(s){return!!i||(i=!0,void(e!==s?p(t,s):d(t,s)))},function(e){return!!i||(i=!0,void f(t,e))}),!0}catch(e){return i||f(t,e),!0}return!1}function p(t,e){t===e?d(t,e):u(t,e)||d(t,e)}function d(t,e){t._state===C&&(t._state=O,t._detail=e,y.async(g,t))}function f(t,e){t._state===C&&(t._state=O,t._detail=e,y.async(m,t))}function g(t){l(t,t._state=k)}function m(t){l(t,t._state=A)}var y=t.config,_=(t.configure,e.objectOrFunction),v=e.isFunction,b=(e.now,i.all),w=s.race,x=n.resolve,S=r.reject,T=o.asap;y.async=T;var C=void 0,O=0,k=1,A=2;h.prototype={constructor:h,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(t,e){var i=this,s=new this.constructor(function(){});if(this._state){var n=arguments;y.async(function(){c(i._state,s,n[i._state-1],i._detail)})}else!function(t,e,i,s){var n=t._subscribers,r=n.length;n[r]=e,n[r+k]=i,n[r+A]=s}(this,s,t,e);return s},catch:function(t){return this.then(null,t)}},h.all=b,h.race=w,h.resolve=x,h.reject=S,a.Promise=h}),t("promise/race",["./utils","exports"],function(t,e){"use strict";var i=t.isArray;e.race=function(t){if(!i(t))throw new TypeError("You must pass an array to race.");return new this(function(e,i){for(var s,n=0;n<t.length;n++)(s=t[n])&&"function"==typeof s.then?s.then(e,i):e(s)})}}),t("promise/reject",["exports"],function(t){"use strict";t.reject=function(t){return new this(function(e,i){i(t)})}}),t("promise/resolve",["exports"],function(t){"use strict";t.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this(function(e){e(t)})}}),t("promise/utils",["exports"],function(t){"use strict";function e(t){return"function"==typeof t}var i=Date.now||function(){return(new Date).getTime()};t.objectOrFunction=function(t){return e(t)||"object"==typeof t&&null!==t},t.isFunction=e,t.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},t.now=i}),e("promise/polyfill").polyfill()}(),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.localforage=e():t.localforage=e()}(this,function(){return function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";e.__esModule=!0;var s=function(t){function e(t,e){t[e]=function(){var i=arguments;return t.ready().then(function(){return t[e].apply(t,i)})}}function s(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var i in e)e.hasOwnProperty(i)&&(u(e[i])?arguments[0][i]=e[i].slice():arguments[0][i]=e[i])}return arguments[0]}function n(t){for(var e in o)if(o.hasOwnProperty(e)&&o[e]===t)return!0;return!1}var r={},o={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},a=[o.INDEXEDDB,o.WEBSQL,o.LOCALSTORAGE],h=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],c={description:"",driver:a.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},l=function(t){var e={};return e[o.INDEXEDDB]=!!function(){try{var e=e||t.indexedDB||t.webkitIndexedDB||t.mozIndexedDB||t.OIndexedDB||t.msIndexedDB;return!(void 0!==t.openDatabase&&t.navigator&&t.navigator.userAgent&&/Safari/.test(t.navigator.userAgent)&&!/Chrome/.test(t.navigator.userAgent))&&(e&&"function"==typeof e.open&&void 0!==t.IDBKeyRange)}catch(t){return!1}}(),e[o.WEBSQL]=!!function(){try{return t.openDatabase}catch(t){return!1}}(),e[o.LOCALSTORAGE]=!!function(){try{return t.localStorage&&"setItem"in t.localStorage&&t.localStorage.setItem}catch(t){return!1}}(),e}(t),u=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},p=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.INDEXEDDB=o.INDEXEDDB,this.LOCALSTORAGE=o.LOCALSTORAGE,this.WEBSQL=o.WEBSQL,this._defaultConfig=s({},c),this._config=s({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)}return t.prototype.config=function(t){if("object"==typeof t){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t)"storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),this._config[e]=t[e];return"driver"in t&&t.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,i){var s=new Promise(function(e,i){try{var s=t._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),a=new Error("Custom driver name already in use: "+t._driver);if(!t._driver)return void i(o);if(n(t._driver))return void i(a);for(var c=h.concat("_initStorage"),u=0;u<c.length;u++){var p=c[u];if(!p||!t[p]||"function"!=typeof t[p])return void i(o)}var d=Promise.resolve(!0);"_support"in t&&(d=t._support&&"function"==typeof t._support?t._support():Promise.resolve(!!t._support)),d.then(function(i){l[s]=i,r[s]=t,e()},i)}catch(t){i(t)}});return s.then(e,i),s},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,s){var o=this,a=function(){if(n(t))switch(t){case o.INDEXEDDB:return new Promise(function(t,e){t(i(1))});case o.LOCALSTORAGE:return new Promise(function(t,e){t(i(2))});case o.WEBSQL:return new Promise(function(t,e){t(i(4))})}else if(r[t])return Promise.resolve(r[t]);return Promise.reject(new Error("Driver not found."))}();return a.then(e,s),a},t.prototype.getSerializer=function(t){var e=new Promise(function(t,e){t(i(3))});return t&&"function"==typeof t&&e.then(function(e){t(e)}),e},t.prototype.ready=function(t){var e=this,i=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return i.then(t,t),i},t.prototype.setDriver=function(t,e,i){function s(){n._config.driver=n.driver()}var n=this;u(t)||(t=[t]);var r=this._getSupportedDrivers(t),o=null!==this._driverSet?this._driverSet.catch(function(){return Promise.resolve()}):Promise.resolve();return this._driverSet=o.then(function(){var t=r[0];return n._dbInfo=null,n._ready=null,n.getDriver(t).then(function(t){n._driver=t._driver,s(),n._wrapLibraryMethodsWithReady(),n._initDriver=function(t){return function(){var e=0;return function i(){for(;e<t.length;){var r=t[e];return e++,n._dbInfo=null,n._ready=null,n.getDriver(r).then(function(t){return n._extend(t),s(),n._ready=n._initStorage(n._config),n._ready}).catch(i)}s();var o=new Error("No available storage method found.");return n._driverSet=Promise.reject(o),n._driverSet}()}}(r)})}).catch(function(){s();var t=new Error("No available storage method found.");return n._driverSet=Promise.reject(t),n._driverSet}),this._driverSet.then(e,i),this._driverSet},t.prototype.supports=function(t){return!!l[t]},t.prototype._extend=function(t){s(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],i=0,s=t.length;s>i;i++){var n=t[i];this.supports(n)&&e.push(n)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0;t<h.length;t++)e(this,h[t])},t.prototype.createInstance=function(e){return new t(e)},t}();return new p}(void 0!==window?window:self);e.default=s,t.exports=e.default},function(t,e){"use strict";e.__esModule=!0;var i=function(t){function e(e,i){e=e||[],i=i||{};try{return new Blob(e,i)}catch(r){if("TypeError"!==r.name)throw r;for(var s=new(t.BlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder||t.WebKitBlobBuilder),n=0;n<e.length;n+=1)s.append(e[n]);return s.getBlob(i.type)}}function i(t){return new Promise(function(i,s){var n=e([""],{type:"image/png"}),r=t.transaction([d],"readwrite");r.objectStore(d).put(n,"key"),r.oncomplete=function(){var e=t.transaction([d],"readwrite").objectStore(d).get("key");e.onerror=s,e.onsuccess=function(t){var e=t.target.result,s=URL.createObjectURL(e);(function(t){return new Promise(function(e,i){var s=new XMLHttpRequest;s.open("GET",t),s.withCredentials=!0,s.responseType="arraybuffer",s.onreadystatechange=function(){return 4===s.readyState?200===s.status?e({response:s.response,type:s.getResponseHeader("Content-Type")}):void i({status:s.status,response:s.response}):void 0},s.send()})})(s).then(function(t){i(!(!t||"image/png"!==t.type))},function(){i(!1)}).then(function(){URL.revokeObjectURL(s)})}},r.onerror=r.onabort=s}).catch(function(){return!1})}function s(t){return"boolean"==typeof u?Promise.resolve(u):i(t).then(function(t){return u=t})}function n(t){var i=function(t){for(var e=t.length,i=new ArrayBuffer(e),s=new Uint8Array(i),n=0;e>n;n++)s[n]=t.charCodeAt(n);return i}(atob(t.data));return e([i],{type:t.type})}function r(t){return t&&t.__local_forage_encoded_blob}function o(t){var e=this,i=e._initReady().then(function(){var t=p[e._dbInfo.name];return t&&t.dbReady?t.dbReady:void 0});return i.then(t,t),i}function a(e,i){return new Promise(function(s,n){if(e.db){if(!i)return s(e.db);(function(t){var e=p[t.name],i={};i.promise=new Promise(function(t){i.resolve=t}),e.deferredOperations.push(i),e.dbReady?e.dbReady=e.dbReady.then(function(){return i.promise}):e.dbReady=i.promise})(e),e.db.close()}var r=[e.name];i&&r.push(e.version);var o=l.open.apply(l,r);i&&(o.onupgradeneeded=function(i){var s=o.result;try{s.createObjectStore(e.storeName),i.oldVersion<=1&&s.createObjectStore(d)}catch(s){if("ConstraintError"!==s.name)throw s;t.console.warn('The database "'+e.name+'" has been upgraded from version '+i.oldVersion+" to version "+i.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),o.onerror=function(){n(o.error)},o.onsuccess=function(){s(o.result),function(t){var e=p[t.name].deferredOperations.pop();e&&e.resolve()}(e)}})}function h(e,i){if(!e.db)return!0;var s=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,r=e.version>e.db.version;if(n&&(e.version!==i&&t.console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),r||s){if(s){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function c(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}var l=l||t.indexedDB||t.webkitIndexedDB||t.mozIndexedDB||t.OIndexedDB||t.msIndexedDB;if(l){var u,p,d="local-forage-detect-blob-support",f={_driver:"asyncStorage",_initStorage:function(t){function e(){return Promise.resolve()}var i=this,s={db:null};if(t)for(var n in t)s[n]=t[n];p||(p={});var r=p[s.name];r||(r={forages:[],db:null,dbReady:null,deferredOperations:[]},p[s.name]=r),r.forages.push(i),i._initReady||(i._initReady=i.ready,i.ready=o);for(var c=[],l=0;l<r.forages.length;l++){var u=r.forages[l];u!==i&&c.push(u._initReady().catch(e))}var d=r.forages.slice(0);return Promise.all(c).then(function(){return s.db=r.db,function(t){return a(t,!1)}(s)}).then(function(t){return s.db=t,h(s,i._defaultConfig.version)?function(t){return a(t,!0)}(s):t}).then(function(t){s.db=r.db=t,i._dbInfo=s;for(var e=0;e<d.length;e++){var n=d[e];n!==i&&(n._dbInfo.db=s.db,n._dbInfo.version=s.version)}})},iterate:function(t,e){var i=this,s=new Promise(function(e,s){i.ready().then(function(){var o=i._dbInfo,a=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName).openCursor(),h=1;a.onsuccess=function(){var i=a.result;if(i){var s=i.value;r(s)&&(s=n(s));var o=t(s,i.key,h++);void 0!==o?e(o):i.continue()}else e()},a.onerror=function(){s(a.error)}}).catch(s)});return c(s,e),s},getItem:function(e,i){var s=this;"string"!=typeof e&&(t.console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new Promise(function(t,i){s.ready().then(function(){var o=s._dbInfo,a=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName).get(e);a.onsuccess=function(){var e=a.result;void 0===e&&(e=null),r(e)&&(e=n(e)),t(e)},a.onerror=function(){i(a.error)}}).catch(i)});return c(o,i),o},setItem:function(e,i,n){var r=this;"string"!=typeof e&&(t.console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new Promise(function(t,n){var o;r.ready().then(function(){return o=r._dbInfo,i instanceof Blob?s(o.db).then(function(t){return t?i:function(t){return new Promise(function(e,i){var s=new FileReader;s.onerror=i,s.onloadend=function(i){var s=btoa(i.target.result||"");e({__local_forage_encoded_blob:!0,data:s,type:t.type})},s.readAsBinaryString(t)})}(i)}):i}).then(function(i){var s=o.db.transaction(o.storeName,"readwrite"),r=s.objectStore(o.storeName);null===i&&(i=void 0),s.oncomplete=function(){void 0===i&&(i=null),t(i)},s.onabort=s.onerror=function(){var t=a.error?a.error:a.transaction.error;n(t)};var a=r.put(i,e)}).catch(n)});return c(o,n),o},removeItem:function(e,i){var s=this;"string"!=typeof e&&(t.console.warn(e+" used as a key, but it is not a string."),e=String(e));var n=new Promise(function(t,i){s.ready().then(function(){var n=s._dbInfo,r=n.db.transaction(n.storeName,"readwrite"),o=r.objectStore(n.storeName).delete(e);r.oncomplete=function(){t()},r.onerror=function(){i(o.error)},r.onabort=function(){var t=o.error?o.error:o.transaction.error;i(t)}}).catch(i)});return c(n,i),n},clear:function(t){var e=this,i=new Promise(function(t,i){e.ready().then(function(){var s=e._dbInfo,n=s.db.transaction(s.storeName,"readwrite"),r=n.objectStore(s.storeName).clear();n.oncomplete=function(){t()},n.onabort=n.onerror=function(){var t=r.error?r.error:r.transaction.error;i(t)}}).catch(i)});return c(i,t),i},length:function(t){var e=this,i=new Promise(function(t,i){e.ready().then(function(){var s=e._dbInfo,n=s.db.transaction(s.storeName,"readonly").objectStore(s.storeName).count();n.onsuccess=function(){t(n.result)},n.onerror=function(){i(n.error)}}).catch(i)});return c(i,t),i},key:function(t,e){var i=this,s=new Promise(function(e,s){return 0>t?void e(null):void i.ready().then(function(){var n=i._dbInfo,r=n.db.transaction(n.storeName,"readonly").objectStore(n.storeName),o=!1,a=r.openCursor();a.onsuccess=function(){var i=a.result;return i?void(0===t||o?e(i.key):(o=!0,i.advance(t))):void e(null)},a.onerror=function(){s(a.error)}}).catch(s)});return c(s,e),s},keys:function(t){var e=this,i=new Promise(function(t,i){e.ready().then(function(){var s=e._dbInfo,n=s.db.transaction(s.storeName,"readonly").objectStore(s.storeName).openCursor(),r=[];n.onsuccess=function(){var e=n.result;return e?(r.push(e.key),void e.continue()):void t(r)},n.onerror=function(){i(n.error)}}).catch(i)});return c(i,t),i}};return f}}(void 0!==window?window:self);e.default=i,t.exports=e.default},function(t,e,i){"use strict";e.__esModule=!0;var s=function(t){function e(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}var s=null;try{if(!t.localStorage||!("setItem"in t.localStorage))return;s=t.localStorage}catch(t){return}var n={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var s in t)e[s]=t[s];return e.keyPrefix=e.name+"/",e.storeName!==this._defaultConfig.storeName&&(e.keyPrefix+=e.storeName+"/"),this._dbInfo=e,new Promise(function(t,e){t(i(3))}).then(function(t){return e.serializer=t,Promise.resolve()})},iterate:function(t,i){var n=this,r=n.ready().then(function(){for(var e=n._dbInfo,i=e.keyPrefix,r=i.length,o=s.length,a=1,h=0;o>h;h++){var c=s.key(h);if(0===c.indexOf(i)){var l=s.getItem(c);if(l&&(l=e.serializer.deserialize(l)),void 0!==(l=t(l,c.substring(r),a++)))return l}}});return e(r,i),r},getItem:function(i,n){var r=this;"string"!=typeof i&&(t.console.warn(i+" used as a key, but it is not a string."),i=String(i));var o=r.ready().then(function(){var t=r._dbInfo,e=s.getItem(t.keyPrefix+i);return e&&(e=t.serializer.deserialize(e)),e});return e(o,n),o},setItem:function(i,n,r){var o=this;"string"!=typeof i&&(t.console.warn(i+" used as a key, but it is not a string."),i=String(i));var a=o.ready().then(function(){void 0===n&&(n=null);var t=n;return new Promise(function(e,r){var a=o._dbInfo;a.serializer.serialize(n,function(n,o){if(o)r(o);else try{s.setItem(a.keyPrefix+i,n),e(t)}catch(t){("QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&r(t),r(t)}})})});return e(a,r),a},removeItem:function(i,n){var r=this;"string"!=typeof i&&(t.console.warn(i+" used as a key, but it is not a string."),i=String(i));var o=r.ready().then(function(){var t=r._dbInfo;s.removeItem(t.keyPrefix+i)});return e(o,n),o},clear:function(t){var i=this,n=i.ready().then(function(){for(var t=i._dbInfo.keyPrefix,e=s.length-1;e>=0;e--){var n=s.key(e);0===n.indexOf(t)&&s.removeItem(n)}});return e(n,t),n},length:function(t){var i=this.keys().then(function(t){return t.length});return e(i,t),i},key:function(t,i){var n=this,r=n.ready().then(function(){var e,i=n._dbInfo;try{e=s.key(t)}catch(t){e=null}return e&&(e=e.substring(i.keyPrefix.length)),e});return e(r,i),r},keys:function(t){var i=this,n=i.ready().then(function(){for(var t=i._dbInfo,e=s.length,n=[],r=0;e>r;r++)0===s.key(r).indexOf(t.keyPrefix)&&n.push(s.key(r).substring(t.keyPrefix.length));return n});return e(n,t),n}};return n}(void 0!==window?window:self);e.default=s,t.exports=e.default},function(t,e){"use strict";e.__esModule=!0;var i=function(t){function e(e,i){e=e||[],i=i||{};try{return new Blob(e,i)}catch(r){if("TypeError"!==r.name)throw r;for(var s=new(t.BlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder||t.WebKitBlobBuilder),n=0;n<e.length;n+=1)s.append(e[n]);return s.getBlob(i.type)}}function i(t){var e,i,s,r,o,a=.75*t.length,h=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var l=new ArrayBuffer(a),u=new Uint8Array(l);for(e=0;h>e;e+=4)i=n.indexOf(t[e]),s=n.indexOf(t[e+1]),r=n.indexOf(t[e+2]),o=n.indexOf(t[e+3]),u[c++]=i<<2|s>>4,u[c++]=(15&s)<<4|r>>2,u[c++]=(3&r)<<6|63&o;return l}function s(t){var e,i=new Uint8Array(t),s="";for(e=0;e<i.length;e+=3)s+=n[i[e]>>2],s+=n[(3&i[e])<<4|i[e+1]>>4],s+=n[(15&i[e+1])<<2|i[e+2]>>6],s+=n[63&i[e+2]];return i.length%3==2?s=s.substring(0,s.length-1)+"=":i.length%3==1&&(s=s.substring(0,s.length-2)+"=="),s}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="~~local_forage_type~",o=/^~~local_forage_type~([^~]+)~/,a="__lfsc__:",h=a.length,c="arbf",l="blob",u="si08",p="ui08",d="uic8",f="si16",g="si32",m="ur16",y="ui32",_="fl32",v="fl64",b=h+c.length,w={serialize:function(t,e){var i="";if(t&&(i=t.toString()),t&&("[object ArrayBuffer]"===t.toString()||t.buffer&&"[object ArrayBuffer]"===t.buffer.toString())){var n,o=a;t instanceof ArrayBuffer?(n=t,o+=c):(n=t.buffer,"[object Int8Array]"===i?o+=u:"[object Uint8Array]"===i?o+=p:"[object Uint8ClampedArray]"===i?o+=d:"[object Int16Array]"===i?o+=f:"[object Uint16Array]"===i?o+=m:"[object Int32Array]"===i?o+=g:"[object Uint32Array]"===i?o+=y:"[object Float32Array]"===i?o+=_:"[object Float64Array]"===i?o+=v:e(new Error("Failed to get type for BinaryArray"))),e(o+s(n))}else if("[object Blob]"===i){var h=new FileReader;h.onload=function(){var i=r+t.type+"~"+s(this.result);e(a+l+i)},h.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(i){console.error("Couldn't convert value into a JSON string: ",t),e(null,i)}},deserialize:function(t){if(t.substring(0,h)!==a)return JSON.parse(t);var s,n=t.substring(b),r=t.substring(h,b);if(r===l&&o.test(n)){var w=n.match(o);s=w[1],n=n.substring(w[0].length)}var x=i(n);switch(r){case c:return x;case l:return e([x],{type:s});case u:return new Int8Array(x);case p:return new Uint8Array(x);case d:return new Uint8ClampedArray(x);case f:return new Int16Array(x);case m:return new Uint16Array(x);case g:return new Int32Array(x);case y:return new Uint32Array(x);case _:return new Float32Array(x);case v:return new Float64Array(x);default:throw new Error("Unkown type: "+r)}},stringToBuffer:i,bufferToString:s};return w}(void 0!==window?window:self);e.default=i,t.exports=e.default},function(t,e,i){"use strict";e.__esModule=!0;var s=function(t){function e(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}var s=t.openDatabase;if(s){var n={_driver:"webSQLStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var r in t)n[r]="string"!=typeof t[r]?t[r].toString():t[r];var o=new Promise(function(t,i){try{n.db=s(n.name,String(n.version),n.description,n.size)}catch(t){return i(t)}n.db.transaction(function(s){s.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){e._dbInfo=n,t()},function(t,e){i(e)})})});return new Promise(function(t,e){t(i(3))}).then(function(t){return n.serializer=t,o})},iterate:function(t,i){var s=this,n=new Promise(function(e,i){s.ready().then(function(){var n=s._dbInfo;n.db.transaction(function(s){s.executeSql("SELECT * FROM "+n.storeName,[],function(i,s){for(var r=s.rows,o=r.length,a=0;o>a;a++){var h=r.item(a),c=h.value;if(c&&(c=n.serializer.deserialize(c)),void 0!==(c=t(c,h.key,a+1)))return void e(c)}e()},function(t,e){i(e)})})}).catch(i)});return e(n,i),n},getItem:function(i,s){var n=this;"string"!=typeof i&&(t.console.warn(i+" used as a key, but it is not a string."),i=String(i));var r=new Promise(function(t,e){n.ready().then(function(){var s=n._dbInfo;s.db.transaction(function(n){n.executeSql("SELECT * FROM "+s.storeName+" WHERE key = ? LIMIT 1",[i],function(e,i){var n=i.rows.length?i.rows.item(0).value:null;n&&(n=s.serializer.deserialize(n)),t(n)},function(t,i){e(i)})})}).catch(e)});return e(r,s),r},setItem:function(i,s,n){var r=this;"string"!=typeof i&&(t.console.warn(i+" used as a key, but it is not a string."),i=String(i));var o=new Promise(function(t,e){r.ready().then(function(){void 0===s&&(s=null);var n=s,o=r._dbInfo;o.serializer.serialize(s,function(s,r){r?e(r):o.db.transaction(function(r){r.executeSql("INSERT OR REPLACE INTO "+o.storeName+" (key, value) VALUES (?, ?)",[i,s],function(){t(n)},function(t,i){e(i)})},function(t){t.code===t.QUOTA_ERR&&e(t)})})}).catch(e)});return e(o,n),o},removeItem:function(i,s){var n=this;"string"!=typeof i&&(t.console.warn(i+" used as a key, but it is not a string."),i=String(i));var r=new Promise(function(t,e){n.ready().then(function(){var s=n._dbInfo;s.db.transaction(function(n){n.executeSql("DELETE FROM "+s.storeName+" WHERE key = ?",[i],function(){t()},function(t,i){e(i)})})}).catch(e)});return e(r,s),r},clear:function(t){var i=this,s=new Promise(function(t,e){i.ready().then(function(){var s=i._dbInfo;s.db.transaction(function(i){i.executeSql("DELETE FROM "+s.storeName,[],function(){t()},function(t,i){e(i)})})}).catch(e)});return e(s,t),s},length:function(t){var i=this,s=new Promise(function(t,e){i.ready().then(function(){var s=i._dbInfo;s.db.transaction(function(i){i.executeSql("SELECT COUNT(key) as c FROM "+s.storeName,[],function(e,i){var s=i.rows.item(0).c;t(s)},function(t,i){e(i)})})}).catch(e)});return e(s,t),s},key:function(t,i){var s=this,n=new Promise(function(e,i){s.ready().then(function(){var n=s._dbInfo;n.db.transaction(function(s){s.executeSql("SELECT key FROM "+n.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,i){var s=i.rows.length?i.rows.item(0).key:null;e(s)},function(t,e){i(e)})})}).catch(i)});return e(n,i),n},keys:function(t){var i=this,s=new Promise(function(t,e){i.ready().then(function(){var s=i._dbInfo;s.db.transaction(function(i){i.executeSql("SELECT key FROM "+s.storeName,[],function(e,i){for(var s=[],n=0;n<i.rows.length;n++)s.push(i.rows.item(n).key);t(s)},function(t,i){e(i)})})}).catch(e)});return e(s,t),s}};return n}}(void 0!==window?window:self);e.default=s,t.exports=e.default}])})}catch(t){localForageInitFailed=!0}function c3JSONtoC2JSON(t){try{t=JSON.parse(t)}catch(t){return""}var e='{""c2array"": true,""size"": [2,'+t.length+', 1],""data"":';data0="",data1="";for(var i=0;i<t.length;i++){var s=t[i];data0+="["+s[0]+"],",data1+='[""'+s[1]+'""],'}return data0=data0.substring(0,data0.length-1),data1=data1.substring(0,data1.length-1),e+="[["+data0+"],["+data1+"]]}"}cr.plugins_.LocalStorage=function(t){this.runtime=t},function(){var t="",e="",i=[],s="";function n(t){return t?"string"==typeof t?t:"string"==typeof t.message?t.message:"string"==typeof t.name?t.name:"string"==typeof t.data?t.data:"unknown error":"unknown error"}function r(t,e){s=e,t.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError,t)}var o="",a=void 0!==window.is_scirra_arcade;function h(t){return!o||t.substr(0,o.length)===o}function c(t){return o?h(t)?t.substr(o.length):void 0:t}a&&(o="sa"+window.scirra_arcade_id+"_");var l=cr.plugins_.LocalStorage.prototype;l.Type=function(t){this.plugin=t,this.runtime=t.runtime},l.Type.prototype.onCreate=function(){},l.Instance=function(t){this.type=t,this.runtime=t.runtime};var u=l.Instance.prototype;u.onCreate=function(){this.pendingSets=0,this.pendingGets=0},u.onDestroy=function(){},u.saveToJSON=function(){return{}},u.loadFromJSON=function(t){};function p(){}function d(){}function f(){}p.prototype.OnItemSet=function(e){return t===e},p.prototype.OnAnyItemSet=function(){return!0},p.prototype.OnItemGet=function(e){return t===e},p.prototype.OnAnyItemGet=function(){return!0},p.prototype.OnItemRemoved=function(e){return t===e},p.prototype.OnAnyItemRemoved=function(){return!0},p.prototype.OnCleared=function(){return!0},p.prototype.OnAllKeyNamesLoaded=function(){return!0},p.prototype.OnError=function(){return!0},p.prototype.OnItemExists=function(e){return t===e},p.prototype.OnItemMissing=function(e){return t===e},p.prototype.CompareKey=function(e,i){return cr.do_cmp(t,e,i)},p.prototype.CompareValue=function(t,i){return cr.do_cmp(e,t,i)},p.prototype.IsProcessingSets=function(){return this.pendingSets>0},p.prototype.IsProcessingGets=function(){return this.pendingGets>0},p.prototype.OnAllSetsComplete=function(){return!0},p.prototype.OnAllGetsComplete=function(){return!0},l.cnds=new p,d.prototype.SetItem=function(i,a){if(localForageInitFailed)r(this,"storage failed to initialise - may be disabled in browser settings");else{var h=o+i;this.pendingSets++;var c=this;localforage.setItem(h,a,function(r,o){c.pendingSets--,r?(s=n(r),c.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError,c)):(t=i,e=o,c.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAnyItemSet,c),c.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemSet,c),t="",e=""),0===c.pendingSets&&c.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAllSetsComplete,c)})}},d.prototype.GetItem=function(i){if(localForageInitFailed)r(this,"storage failed to initialise - may be disabled in browser settings");else{var a=o+i;this.pendingGets++;var h=this;localforage.getItem(a,function(r,o){h.pendingGets--,r?(s=n(r),h.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError,h)):(t=i,null==(e=o)&&(e=""),h.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAnyItemGet,h),h.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemGet,h),t="",e=""),0===h.pendingGets&&h.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAllGetsComplete,h)})}},d.prototype.CheckItemExists=function(i){if(localForageInitFailed)r(this,"storage failed to initialise - may be disabled in browser settings");else{var a=o+i,h=this;localforage.getItem(a,function(r,o){r?(s=n(r),h.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError,h)):(t=i,null===o?(e="",h.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemMissing,h)):(e=o,h.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemExists,h)),t="",e="")})}},d.prototype.RemoveItem=function(i){if(localForageInitFailed)r(this,"storage failed to initialise - may be disabled in browser settings");else{var a=o+i,h=this;localforage.removeItem(a,function(r){r?(s=n(r),h.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError,h)):(t=i,e="",h.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAnyItemRemoved,h),h.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemRemoved,h),t="")})}},d.prototype.ClearStorage=function(){if(localForageInitFailed)r(this,"storage failed to initialise - may be disabled in browser settings");else if(!a){var o=this;localforage.clear(function(r){r?(s=n(r),o.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError,o)):(t="",e="",cr.clearArray(i),o.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnCleared,o))})}},d.prototype.GetAllKeyNames=function(){if(localForageInitFailed)r(this,"storage failed to initialise - may be disabled in browser settings");else{var t=this;localforage.keys(function(e,r){var o,a,l;if(e)s=n(e),t.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError,t);else{for(cr.clearArray(i),o=0,a=r.length;o<a;++o)h(l=r[o])&&i.push(c(l));t.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAllKeyNamesLoaded,t)}})}},l.acts=new d,f.prototype.ItemValue=function(t){t.set_any(e)},f.prototype.Key=function(e){e.set_string(t)},f.prototype.KeyCount=function(t){t.set_int(i.length)},f.prototype.KeyAt=function(t,e){(e=Math.floor(e))<0||e>=i.length?t.set_string(""):t.set_string(i[e])},f.prototype.ErrorMessage=function(t){t.set_string(s)},l.exps=new f}(),cr.plugins_.MagiCam=function(t){this.runtime=t},function(){var t={};function e(t,e,i,s,n,r){this.type=t,this.duration=e,this.param1=i,this.param2=s,this.param3=n,this.param4=r,this.progress=0}function i(t,e,i,s,n){this.global=n,this.name=t,this.x=e,this.y=i,this.scale=s,this.following=!1,this.followedObjects=[],this.followedObjectUIDs=[],this.objectWeights=[],this.followedObjectIPs=[],this.followLag=1,this.zoomToContain=!1,this.zoomMarginH=0,this.zoomMarginV=0,this.zoomBoundU=-1,this.zoomBoundL=-1,this.transitions=[],this.moveTransFinished=!1,this.zoomTransFinished=!1,this.isShaking=!1,this.shakeX=0,this.shakeY=0,this.shakeZoom=0,this.shakeTimer=0,this.shakeStrength=0,this.shakeMaxDeviation=0,this.shakeMaxZoomDeviation=0,this.shakeLength=0,this.shakeBuildTime=0,this.shakeDropTime=0}t.lerp=function(t,e,i){return t+(e-t)*i},t.cubic=function(t,e,i,s,n){return this.lerp(this.lerp(this.lerp(t,e,n),this.lerp(e,i,n),n),this.lerp(this.lerp(e,i,n),this.lerp(i,s,n),n),n)},t.clamp=function(t,e,i){return t<e?e:t>i?i:t},i.prototype.GetName=function(){return this.name},i.prototype.GetX=function(){return this.x},i.prototype.SetX=function(t){this.x=t},i.prototype.GetY=function(){return this.y},i.prototype.SetY=function(t){this.y=t},i.prototype.GetShakeX=function(){return this.shakeX},i.prototype.GetShakeY=function(){return this.shakeY},i.prototype.SetFollowedObject=function(t){this.followedObject=t},i.prototype.ShakeCamera=function(e){if(this.isShaking)if(this.shakeTimer+=e,this.shakeTimer<this.shakeLength){var i=0;i=this.shakeTimer<this.shakeBuildTime?t.lerp(0,this.shakeStrength,this.shakeTimer/this.shakeBuildTime):this.shakeStrength,this.shakeTimer>this.shakeDropTime&&(i=t.lerp(this.shakeStrength,0,(this.shakeTimer-this.shakeDropTime)/(this.shakeLength-this.shakeDropTime)));var s=Math.floor(361*Math.random())/57.2958,n=t.lerp(0,Math.cos(s)*this.shakeMaxDeviation,i),r=t.lerp(0,Math.sin(s)*this.shakeMaxDeviation,i),o=t.lerp(0,Math.floor(201*Math.random()-100)/100*this.shakeMaxZoomDeviation,i);this.shakeX=t.lerp(this.shakeX,n,i),this.shakeY=t.lerp(this.shakeY,r,i),this.shakeZoom=t.lerp(this.shakeZoom,o,i)}else this.isShaking=!1,this.shakeX=0,this.shakeY=0,this.shakeZoom=0},i.prototype.ProcessTransitions=function(e){var i;this.moveTransFinished=!1,this.zoomTransFinished=!1;for(var s=0;s<this.transitions.length;)(i=this.transitions[s]).progress=t.clamp(i.progress+1/i.duration*e,0,1),"MOVE"==i.type?(this.x=t.cubic(i.param3,i.param3,i.param1,i.param1,i.progress),this.y=t.cubic(i.param4,i.param4,i.param2,i.param2,i.progress)):"SCALE"==i.type&&(this.scale=t.cubic(i.param2,i.param2,i.param1,i.param1,i.progress)),1==i.progress?("MOVE"==i.type?this.moveTransFinished=!0:"SCALE"==i.type&&(this.zoomTransFinished=!0),this.transitions.splice(s,1)):s++},i.prototype.UpdateCameraTarget=function(t,e){for(var i=0;i<this.transitions.length;i++){var s=this.transitions[i];"MOVE"==s.type?(s.param1=e.GetX(),s.param2=e.GetY()):"SCALE"==s.type&&(s.param1=e.scale)}},i.prototype.ProcessFollowing=function(e,i,s,n){var r=this.followedObjects,o=this.followedObjectIPs;if(this.following&&r.length>0){var a=0,h=0,c=0;if(this.zoomToContain){var l=0,u=0,p=0,d=0,f=!1,g=!1,m=!1,y=!1;for(T=0;T<r.length;T++){var _=r[T];_.update_bbox(),f?l=Math.min(l,_.bbox.left):(l=_.bbox.left,f=!0),g?u=Math.max(u,_.bbox.right):(u=_.bbox.right,g=!0),m?p=Math.min(p,_.bbox.top):(p=_.bbox.top,m=!0),y?d=Math.max(d,_.bbox.bottom):(d=_.bbox.bottom,y=!0)}var v=(i-2*this.zoomMarginH)/(u-l),b=(s-2*this.zoomMarginV)/(d-p);a=t.lerp(l,u,.5),h=t.lerp(p,d,.5),this.x<i/2/v&&(a=i/(v=(i-this.zoomMarginH)/u)/2),this.x>n.width-i/2/v&&(v=(i-this.zoomMarginH)/(n.width-l),a=n.width-i/v/2),this.y<s/2/b&&(h=s/(b=(s-this.zoomMarginV)/d)/2),this.y>n.height-s/2/b&&(b=(s-this.zoomMarginV)/(n.height-p),h=n.height-s/b/2),c=Math.min(v,b),-1!=this.zoomBoundL&&c<this.zoomBoundL&&(c=this.zoomBoundL),-1!=this.zoomBoundU&&c>this.zoomBoundU&&(c=this.zoomBoundU)}else{for(var w=0,x=0,S=0,T=0;T<r.length;T++)w+=r[T].getImagePoint(o[T],!0)*this.objectWeights[T],x+=r[T].getImagePoint(o[T],!1)*this.objectWeights[T],S+=this.objectWeights[T];a=w/S,h=x/S}if(1==this.followLag)this.x=a,this.y=h,this.zoomToContain&&(this.scale=c);else{var C=4*this.followLag*e*Math.sqrt(1/e);this.x=t.lerp(this.x,a,C),this.y=t.lerp(this.y,h,C),this.zoomToContain&&(this.scale=t.lerp(this.scale,c,C))}}};var s=cr.plugins_.MagiCam.prototype;s.Type=function(t){this.plugin=t,this.runtime=t.runtime},s.Type.prototype.onCreate=function(){},s.Instance=function(t){this.type=t,this.runtime=t.runtime,this.localCameras=[],this.localCameraCount=0,this.localCameraCountOld=0,this.transCamera=null,this.transTarget=null,this.isSwitchingCameras=!1,this.globalCameras=[],this.activeCamera=null};var n=s.Instance.prototype;function r(){}function o(){}function a(){}n.onCreate=function(){this.runtime.tickMe(this),this.my_timescale=-1},n.saveToJSON=function(){null!=this.transCamera&&this.localCameras.push(this.transCamera);for(var t={lcc:this.localCameraCount,olcc:this.localCameraCountOld,alcc:this.localCameras.length,agcc:this.globalCameras.length,tcnn:null!=this.transCamera},e=0;e<this.localCameras.length;e++){t["lc"+e+"g"]=this.localCameras[e].global,t["lc"+e+"n"]=this.localCameras[e].name,t["lc"+e+"x"]=this.localCameras[e].x,t["lc"+e+"y"]=this.localCameras[e].y,t["lc"+e+"s"]=this.localCameras[e].scale,t["lc"+e+"f"]=this.localCameras[e].following,t["lc"+e+"foc"]=this.localCameras[e].followedObjects.length;for(var i=0;i<this.localCameras[e].followedObjects.length;i++)t["lc"+e+"fo"+i]=this.localCameras[e].followedObjects[i].uid;for(var s=0;s<this.localCameras[e].objectWeights.length;s++)t["lc"+e+"fow"+s]=this.localCameras[e].objectWeights[s];for(var n=0;n<this.localCameras[e].followedObjectIPs.length;n++)t["lc"+e+"foip"+n]=this.localCameras[e].followedObjectIPs[n];t["lc"+e+"fl"]=this.localCameras[e].followLag,t["lc"+e+"ztc"]=this.localCameras[e].zoomToContain,t["lc"+e+"zmh"]=this.localCameras[e].zoomMarginH,t["lc"+e+"zmv"]=this.localCameras[e].zoomMarginV,t["lc"+e+"zbu"]=this.localCameras[e].zoomBoundU,t["lc"+e+"zbl"]=this.localCameras[e].zoomBoundL,t["lc"+e+"tc"]=this.localCameras[e].transitions.length;for(var r=0;r<this.localCameras[e].transitions.length;r++)t["lc"+e+"t"+r+"tp"]=this.localCameras[e].transitions[r].type,t["lc"+e+"t"+r+"d"]=this.localCameras[e].transitions[r].duration,t["lc"+e+"t"+r+"p1"]=this.localCameras[e].transitions[r].param1,t["lc"+e+"t"+r+"p2"]=this.localCameras[e].transitions[r].param2,t["lc"+e+"t"+r+"p3"]=this.localCameras[e].transitions[r].param3,t["lc"+e+"t"+r+"p4"]=this.localCameras[e].transitions[r].param4,t["lc"+e+"t"+r+"pr"]=this.localCameras[e].transitions[r].progress;t["lc"+e+"mtf"]=this.localCameras[e].moveTransFinished,t["lc"+e+"ztf"]=this.localCameras[e].zoomTransFinished,t["lc"+e+"csis"]=this.localCameras[e].isShaking,t["lc"+e+"cssx"]=this.localCameras[e].shakeX,t["lc"+e+"cssy"]=this.localCameras[e].shakeY,t["lc"+e+"cssz"]=this.localCameras[e].shakeZoom,t["lc"+e+"csst"]=this.localCameras[e].shakeTimer,t["lc"+e+"csss"]=this.localCameras[e].shakeStrength,t["lc"+e+"cssmd"]=this.localCameras[e].shakeMaxDeviation,t["lc"+e+"cssmzd"]=this.localCameras[e].shakeMaxZoomDeviation,t["lc"+e+"cssl"]=this.localCameras[e].shakeLength,t["lc"+e+"cssbt"]=this.localCameras[e].shakeBuildTime,t["lc"+e+"cssdt"]=this.localCameras[e].shakeDropTime}for(e=0;e<this.globalCameras.length;e++){t["gc"+e+"g"]=this.globalCameras[e].global,t["gc"+e+"n"]=this.globalCameras[e].name,t["gc"+e+"x"]=this.globalCameras[e].x,t["gc"+e+"y"]=this.globalCameras[e].y,t["gc"+e+"s"]=this.globalCameras[e].scale,t["gc"+e+"f"]=this.globalCameras[e].following,t["gc"+e+"foc"]=this.globalCameras[e].followedObjects.length;for(i=0;i<this.globalCameras[e].followedObjects.length;i++)t["gc"+e+"fo"+i]=this.globalCameras[e].followedObjects[i].uid;for(s=0;s<this.globalCameras[e].objectWeights.length;s++)t["gc"+e+"fow"+s]=this.globalCameras[e].objectWeights[s];for(n=0;n<this.globalCameras[e].followedObjectIPs.length;n++)t["gc"+e+"foip"+n]=this.globalCameras[e].followedObjectIPs[n];t["gc"+e+"fl"]=this.globalCameras[e].followLag,t["gc"+e+"ztc"]=this.globalCameras[e].zoomToContain,t["gc"+e+"zmh"]=this.globalCameras[e].zoomMarginH,t["gc"+e+"zmv"]=this.globalCameras[e].zoomMarginV,t["gc"+e+"zbu"]=this.globalCameras[e].zoomBoundU,t["gc"+e+"zbl"]=this.globalCameras[e].zoomBoundL,t["gc"+e+"tc"]=this.globalCameras[e].transitions.length;for(r=0;r<this.globalCameras[e].transitions.length;r++)t["gc"+e+"t"+r+"tp"]=this.globalCameras[e].transitions[r].type,t["gc"+e+"t"+r+"d"]=this.globalCameras[e].transitions[r].duration,t["gc"+e+"t"+r+"p1"]=this.globalCameras[e].transitions[r].param1,t["gc"+e+"t"+r+"p2"]=this.globalCameras[e].transitions[r].param2,t["gc"+e+"t"+r+"p3"]=this.globalCameras[e].transitions[r].param3,t["gc"+e+"t"+r+"p4"]=this.globalCameras[e].transitions[r].param4;t["gc"+e+"mtf"]=this.globalCameras[e].moveTransFinished,t["gc"+e+"ztf"]=this.globalCameras[e].zoomTransFinished,t["gc"+e+"csis"]=this.globalCameras[e].isShaking,t["gc"+e+"cssx"]=this.globalCameras[e].shakeX,t["gc"+e+"cssy"]=this.globalCameras[e].shakeY,t["gc"+e+"cssz"]=this.globalCameras[e].shakeZoom,t["gc"+e+"csst"]=this.globalCameras[e].shakeTimer,t["gc"+e+"csss"]=this.globalCameras[e].shakeStrength,t["gc"+e+"cssmd"]=this.globalCameras[e].shakeMaxDeviation,t["gc"+e+"cssmzd"]=this.globalCameras[e].shakeMaxZoomDeviation,t["gc"+e+"cssl"]=this.globalCameras[e].shakeLength,t["gc"+e+"cssbt"]=this.globalCameras[e].shakeBuildTime,t["gc"+e+"cssdt"]=this.globalCameras[e].shakeDropTime}return null!=this.activeCamera?t.ac=this.activeCamera.name:t.ac="null",null!=this.transTarget&&(t.tt=this.transTarget.name),t},n.loadFromJSON=function(t){this.localCameras=[],this.globalCameras=[],this.localCameraCount=t.lcc,this.localCameraCountOld=t.olcc;for(var s=t.alcc,n=0;n<s;n++){(p=new i("",0,0,0,!1)).global=t["lc"+n+"g"],p.name=t["lc"+n+"n"],p.x=t["lc"+n+"x"],p.y=t["lc"+n+"y"],p.scale=t["lc"+n+"s"],p.following=t["lc"+n+"f"];for(var r=t["lc"+n+"foc"],o=0;o<r;o++)p.followedObjectUIDs.push(t["lc"+n+"fo"+o]);for(var a=0;a<r;a++)p.objectWeights.push(t["lc"+n+"fow"+a]);for(var h=0;h<r;h++)p.followedObjectIPs.push(t["lc"+n+"foip"+h]);p.followLag=t["lc"+n+"fl"],p.zoomToContain=t["lc"+n+"ztc"],p.zoomMarginH=t["lc"+n+"zmh"],p.zoomMarginV=t["lc"+n+"zmv"],p.zoomBoundU=t["lc"+n+"zbu"],p.zoomBoundL=t["lc"+n+"zbl"];for(var c=t["lc"+n+"tc"],l=0;l<c;l++){(d=new e("",0,0,0,0)).type=t["lc"+n+"t"+l+"tp"],d.duration=t["lc"+n+"t"+l+"d"],d.param1=t["lc"+n+"t"+l+"p1"],d.param2=t["lc"+n+"t"+l+"p2"],d.param3=t["lc"+n+"t"+l+"p3"],d.param4=t["lc"+n+"t"+l+"p4"],d.progress=t["lc"+n+"t"+l+"pr"],p.transitions.push(d)}p.moveTransFinished=t["lc"+n+"mtf"],p.zoomTransFinished=t["lc"+n+"ztf"],p.isShaking=t["lc"+n+"csis"],p.shakeX=t["lc"+n+"cssx"],p.shakeY=t["lc"+n+"cssy"],p.shakeZoom=t["lc"+n+"cssz"],p.shakeTimer=t["lc"+n+"csst"],p.shakeStrength=t["lc"+n+"csss"],p.shakeMaxDeviation=t["lc"+n+"cssmd"],p.shakeMaxZoomDeviation=t["lc"+n+"cssmzd"],p.shakeLength=t["lc"+n+"cssl"],p.shakeBuildTime=t["lc"+n+"cssbt"],p.shakeDropTime=t["lc"+n+"cssdt"],this.localCameras.push(p)}var u=t.agcc;for(n=0;n<u;n++){var p;(p=new i("",0,0,0,!1)).global=t["gc"+n+"g"],p.name=t["gc"+n+"n"],p.x=t["gc"+n+"x"],p.y=t["gc"+n+"y"],p.scale=t["gc"+n+"s"],p.following=t["gc"+n+"f"];for(r=t["gc"+n+"foc"],o=0;o<r;o++)p.followedObjectUIDs.push(t["gc"+n+"fo"+o]);for(a=0;a<r;a++)p.objectWeights.push(t["gc"+n+"fow"+a]);for(h=0;h<r;h++)p.followedObjectIPs.push(t["gc"+n+"foip"+h]);p.followLag=t["gc"+n+"fl"],p.zoomToContain=t["gc"+n+"ztc"],p.zoomMarginH=t["gc"+n+"zmh"],p.zoomMarginV=t["gc"+n+"zmv"],p.zoomBoundU=t["gc"+n+"zbu"],p.zoomBoundL=t["gc"+n+"zbl"];for(c=t["gc"+n+"tc"],l=0;l<c;l++){var d;(d=new e("",0,0,0,0)).type=t["gc"+n+"t"+l+"tp"],d.duration=t["gc"+n+"t"+l+"d"],d.param1=t["gc"+n+"t"+l+"p1"],d.param2=t["gc"+n+"t"+l+"p2"],d.param3=t["gc"+n+"t"+l+"p3"],d.param4=t["gc"+n+"t"+l+"p4"],p.transitions.push(d)}p.moveTransFinished=t["gc"+n+"mtf"],p.zoomTransFinished=t["gc"+n+"ztf"],p.isShaking=t["gc"+n+"csis"],p.shakeX=t["gc"+n+"cssx"],p.shakeY=t["gc"+n+"cssy"],p.shakeZoom=t["gc"+n+"cssz"],p.shakeTimer=t["gc"+n+"csst"],p.shakeStrength=t["gc"+n+"csss"],p.shakeMaxDeviation=t["gc"+n+"cssmd"],p.shakeMaxZoomDeviation=t["gc"+n+"cssmzd"],p.shakeLength=t["gc"+n+"cssl"],p.shakeBuildTime=t["gc"+n+"cssbt"],p.shakeDropTime=t["gc"+n+"cssdt"],this.globalCameras.push(p)}var f=t.ac;this.activeCamera="null"==f?null:this.GetCamera(f),t.tcnn&&(this.transCamera=this.localCameras.pop(),this.transTarget=this.GetCamera(t.tt))},n.afterLoad=function(){for(var t=0;t<this.localCameras.length;t++)for(var e=0;e<this.localCameras[t].followedObjectUIDs.length;e++)this.localCameras[t].followedObjects.push(this.runtime.getObjectByUID(this.localCameras[t].followedObjectUIDs[e]));for(t=0;t<this.globalCameras.length;t++)for(e=0;e<this.globalCameras[t].followedObjectUIDs.length;e++)this.globalCameras[t].followedObjects.push(this.runtime.getObjectByUID(this.globalCameras[t].followedObjectUIDs[e]))},n.onLayoutChange=function(){for(var t=0;t<this.localCameraCountOld;t++)this.localCameras.shift();this.localCameraCount-=this.localCameraCountOld},n.tick=function(){this.localCameraCountOld=this.localCameraCount;var t=this.runtime.getDt(this);0==t&&(t=.1);for(var e=0;e<this.globalCameras.length;e++)this.globalCameras[e].ProcessTransitions(t),this.globalCameras[e].ProcessFollowing(t,this.runtime.original_width,this.runtime.original_height,this.runtime.running_layout),this.globalCameras[e].ShakeCamera(t);for(e=0;e<this.localCameras.length;e++)this.localCameras[e].ProcessTransitions(t),this.localCameras[e].ProcessFollowing(t,this.runtime.original_width,this.runtime.original_height,this.runtime.running_layout),this.localCameras[e].ShakeCamera(t);null!=this.transCamera&&(this.transCamera.UpdateCameraTarget(t,this.transTarget),this.transCamera.ProcessTransitions(t),this.transCamera.moveTransFinished&&(this.activeCamera=this.transTarget,this.transCamera=null)),null!=this.activeCamera&&(this.runtime.running_layout.scrollToX(this.activeCamera.GetX()+this.activeCamera.GetShakeX()),this.runtime.running_layout.scrollToY(this.activeCamera.GetY()+this.activeCamera.GetShakeY()),this.runtime.running_layout.scale=this.activeCamera.scale+this.activeCamera.shakeZoom,this.runtime.redraw=!0)},n.draw=function(t){},n.drawGL=function(t){},n.GetCamera=function(t){if(""==t)return this.activeCamera;for(var e=this.globalCameras.length-1;e>=0;e--)if(this.globalCameras[e].GetName()==t)return this.globalCameras[e];for(e=this.localCameras.length-1;e>=0;e--)if(this.localCameras[e].GetName()==t)return this.localCameras[e];return null},r.prototype.TransitionFinished=function(t,e){var i=this.GetCamera(t);if(null!=i){if(0==e)return i.moveTransFinished;if(1==e)return i.zoomTransFinished}return!1},r.prototype.TransitionIsInProgress=function(t,e){var i=this.GetCamera(t);if(null!=i)for(var s=0;s<i.transitions.length;s++){if("MOVE"==i.transitions[s].type&&0==e)return!0;if("SCALE"==i.transitions[s].type&&1==e)return!0}return!1},s.cnds=new r,o.prototype.FollowObject=function(t,e,i,s){if(e){var n=this.GetCamera(t);if(null!=n){var r=e.getFirstPicked();if(n.global&&!e.global)return void alert("MagiCam:\n\nObject not global - global cameras must follow global objects.");n.followedObjects.push(r),n.objectWeights.push(i),n.followedObjectIPs.push(s)}}},o.prototype.SetFollowLag=function(t,e){var i=this.GetCamera(t);null!=i&&(i.followLag=1-e/100)},o.prototype.ZoomToContain=function(t,e,i,s,n,r){var o=this.GetCamera(t);null!=o&&(0==e?(o.zoomToContain=!0,o.zoomMarginH=i,o.zoomMarginV=s,o.zoomBoundU=n,o.zoomBoundL=r):o.zoomToContain=!1)},o.prototype.EnableFollowing=function(t,e){var i=this.GetCamera(t);null!=i&&(i.following=0==e)},o.prototype.UnfollowObject=function(t,e){if(e){var i=this.GetCamera(t);if(null!=i)for(var s=e.getFirstPicked(),n=0;n<i.followedObjects.length;n++)if(i.followedObjects[n]==s){i.followedObjects.splice(n,1);break}}},o.prototype.CreateLocalCamera=function(t,e,s,n,r){""!=t?(this.localCameras.push(new i(t,e,s,n,!1)),this.localCameraCount++,1==r&&(this.activeCamera=this.localCameras[this.localCameras.length-1],this.runtime.running_layout.scale=this.activeCamera.scale)):alert("Camera name must not be blank.")},o.prototype.CreateGlobalCamera=function(t,e,s,n,r){""!=t?null==this.GetCamera(t)&&(this.globalCameras.push(new i(t,e,s,n,!0)),1==r&&(this.activeCamera=this.globalCameras[this.globalCameras.length-1],this.runtime.running_layout.scrollToX(this.activeCamera.GetX()),this.runtime.running_layout.scrollToY(this.activeCamera.GetY()),this.runtime.running_layout.scale=this.activeCamera.scale)):alert("Camera name must not be blank.")},o.prototype.SetActiveCamera=function(t){var e=this.GetCamera(t);null!=e&&(this.activeCamera=e,this.runtime.running_layout.scrollToX(e.GetX()),this.runtime.running_layout.scrollToY(e.GetY()),this.runtime.running_layout.scale=e.scale)},o.prototype.SetScrollSmoothing=function(t){},o.prototype.SetXPosition=function(t,e){var i=this.GetCamera(t);null!=i&&i.SetX(e)},o.prototype.SetYPosition=function(t,e){var i=this.GetCamera(t);null!=i&&i.SetY(e)},o.prototype.SetPosition=function(t,e,i){var s=this.GetCamera(t);null!=s&&(s.SetX(e),s.SetY(i))},o.prototype.SetZoom=function(t,e){var i=this.GetCamera(t);null!=i&&(i.scale=e)},o.prototype.TransitionToPoint=function(t,i,s,n){var r=this.GetCamera(t);if(null!=r){for(var o=0;o<r.transitions.length;o++)if("MOVE"==r.transitions[o].type){r.transitions.splice(o,1);break}r.transitions.push(new e("MOVE",n,i,s,r.GetX(),r.GetY())),r.following=!1,r.zoomToContain=!1}},o.prototype.TransitionToZoom=function(t,i,s){var n=this.GetCamera(t);if(null!=n){for(var r=0;r<n.transitions.length;r++)if("SCALE"==n.transitions[r].type){n.transitions.splice(r,1);break}n.transitions.push(new e("SCALE",s,i,n.scale,null,null)),n.zoomToContain=!1}},o.prototype.TransitionToCamera=function(t,s){var n=this.GetCamera(t);null!=n&&(this.transTarget=n,this.transCamera=new i("transCamera",this.activeCamera.GetX(),this.activeCamera.GetY(),this.activeCamera.scale,!1),this.transCamera.transitions.push(new e("MOVE",s,this.transTarget.GetX(),this.transTarget.GetY(),this.transCamera.GetX(),this.transCamera.GetY())),this.transCamera.transitions.push(new e("SCALE",s,this.transTarget.scale,this.transCamera.scale,null,null)),this.activeCamera=this.transCamera,this.isSwitchingCameras=!0)},o.prototype.ShakeCamera=function(t,e,i,s,n,r,o){var a=this.GetCamera(t);null!=a&&(a.isShaking=!0,a.shakeStrength=e/100,a.shakeMaxDeviation=i,a.shakeMaxZoomDeviation=s,a.shakeBuildTime=n,a.shakeDropTime=r,a.shakeLength=o,a.shakeTimer=0)},s.acts=new o,a.prototype.MovementTransitionProgress=function(t,e){var i=this.GetCamera(e);if(null!=i)for(var s=0;s<i.transitions.length;s++)if("MOVE"==i.transitions[s].type)return void t.set_float(i.transitions[s].progress);t.set_float(0)},a.prototype.ZoomTransitionProgress=function(t,e){var i=this.GetCamera(e);if(null!=i)for(var s=0;s<i.transitions.length;s++)if("SCALE"==i.transitions[s].type)return void t.set_float(i.transitions[s].progress);t.set_float(0)},a.prototype.GetX=function(t,e){var i=this.GetCamera(e);null==i?t.set_float(0):t.set_float(i.x)},a.prototype.GetY=function(t,e){var i=this.GetCamera(e);null==i?t.set_float(0):t.set_float(i.y)},a.prototype.GetZoom=function(t,e){var i=this.GetCamera(e);null==i?t.set_float(0):t.set_float(i.scale)},a.prototype.GetActiveCamera=function(t){null==this.activeCamera?t.set_string("null"):t.set_string(this.activeCamera.name)},s.exps=new a}(),cr.plugins_.Mouse=function(t){this.runtime=t},function(){var t=cr.plugins_.Mouse.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime,this.buttonMap=new Array(4),this.mouseXcanvas=0,this.mouseYcanvas=0,this.triggerButton=0,this.triggerType=0,this.triggerDir=0,this.handled=!1};var e=t.Instance.prototype;e.onCreate=function(){var t=this;if(!this.runtime.isDomFree){jQuery(document).mousemove(function(e){t.onMouseMove(e)}),jQuery(document).mousedown(function(e){t.onMouseDown(e)}),jQuery(document).mouseup(function(e){t.onMouseUp(e)}),jQuery(document).dblclick(function(e){t.onDoubleClick(e)});var e=function(e){t.onWheel(e)};document.addEventListener("mousewheel",e,!1),document.addEventListener("DOMMouseScroll",e,!1)}};var i={left:0,top:0};function s(){}function n(){}e.onMouseMove=function(t){var e=this.runtime.isDomFree?i:jQuery(this.runtime.canvas).offset();this.mouseXcanvas=t.pageX-e.left,this.mouseYcanvas=t.pageY-e.top},e.mouseInGame=function(){return this.runtime.fullscreen_mode>0||this.mouseXcanvas>=0&&this.mouseYcanvas>=0&&this.mouseXcanvas<this.runtime.width&&this.mouseYcanvas<this.runtime.height},e.onMouseDown=function(t){this.mouseInGame()&&(this.buttonMap[t.which]=!0,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnAnyClick,this),this.triggerButton=t.which-1,this.triggerType=0,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnClick,this),this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnObjectClicked,this),this.runtime.isInUserInputEvent=!1)},e.onMouseUp=function(t){this.buttonMap[t.which]&&(this.runtime.had_a_click&&!this.runtime.isMobile&&t.preventDefault(),this.runtime.had_a_click=!0,this.buttonMap[t.which]=!1,this.runtime.isInUserInputEvent=!0,this.triggerButton=t.which-1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnRelease,this),this.runtime.isInUserInputEvent=!1)},e.onDoubleClick=function(t){this.mouseInGame()&&(t.preventDefault(),this.runtime.isInUserInputEvent=!0,this.triggerButton=t.which-1,this.triggerType=1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnClick,this),this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnObjectClicked,this),this.runtime.isInUserInputEvent=!1)},e.onWheel=function(t){var e=t.wheelDelta?t.wheelDelta:t.detail?-t.detail:0;this.triggerDir=e<0?0:1,this.handled=!1,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnWheel,this),this.runtime.isInUserInputEvent=!1,this.handled&&cr.isCanvasInputEvent(t)&&t.preventDefault()},e.onWindowBlur=function(){var t,e;for(t=0,e=this.buttonMap.length;t<e;++t)this.buttonMap[t]&&(this.buttonMap[t]=!1,this.triggerButton=t-1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnRelease,this))},s.prototype.OnClick=function(t,e){return t===this.triggerButton&&e===this.triggerType},s.prototype.OnAnyClick=function(){return!0},s.prototype.IsButtonDown=function(t){return this.buttonMap[t+1]},s.prototype.OnRelease=function(t){return t===this.triggerButton},s.prototype.IsOverObject=function(t){var e=this.runtime.getCurrentCondition(),i=this.mouseXcanvas,s=this.mouseYcanvas;return cr.xor(this.runtime.testAndSelectCanvasPointOverlap(t,i,s,e.inverted),e.inverted)},s.prototype.OnObjectClicked=function(t,e,i){return t===this.triggerButton&&e===this.triggerType&&this.runtime.testAndSelectCanvasPointOverlap(i,this.mouseXcanvas,this.mouseYcanvas,!1)},s.prototype.OnWheel=function(t){return this.handled=!0,t===this.triggerDir},t.cnds=new s;var r=null;function o(){}n.prototype.SetCursor=function(t){if(!this.runtime.isDomFree){var e=["auto","pointer","text","crosshair","move","help","wait","none"][t];r!==e&&(r=e,document.body.style.cursor=e)}},n.prototype.SetCursorSprite=function(t){if(!this.runtime.isDomFree&&!this.runtime.isMobile&&t){var e=t.getFirstPicked();if(e&&e.curFrame){var i=e.curFrame;if(r!==i){r=i;var s="url("+i.getDataUri()+") "+Math.round(i.hotspotX*i.width)+" "+Math.round(i.hotspotY*i.height)+", auto";document.body.style.cursor="",document.body.style.cursor=s}}}},t.acts=new n,o.prototype.X=function(t,e){var i,s,n,r,o;cr.is_undefined(e)?(s=(i=this.runtime.getLayerByNumber(0)).scale,n=i.zoomRate,r=i.parallaxX,o=i.angle,i.scale=1,i.zoomRate=1,i.parallaxX=1,i.angle=0,t.set_float(i.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!0)),i.scale=s,i.zoomRate=n,i.parallaxX=r,i.angle=o):(i=cr.is_number(e)?this.runtime.getLayerByNumber(e):this.runtime.getLayerByName(e))?t.set_float(i.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!0)):t.set_float(0)},o.prototype.Y=function(t,e){var i,s,n,r,o;cr.is_undefined(e)?(s=(i=this.runtime.getLayerByNumber(0)).scale,n=i.zoomRate,r=i.parallaxY,o=i.angle,i.scale=1,i.zoomRate=1,i.parallaxY=1,i.angle=0,t.set_float(i.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!1)),i.scale=s,i.zoomRate=n,i.parallaxY=r,i.angle=o):(i=cr.is_number(e)?this.runtime.getLayerByNumber(e):this.runtime.getLayerByName(e))?t.set_float(i.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!1)):t.set_float(0)},o.prototype.AbsoluteX=function(t){t.set_float(this.mouseXcanvas)},o.prototype.AbsoluteY=function(t){t.set_float(this.mouseYcanvas)},t.exps=new o}(),cr.plugins_.NinePatch=function(t){this.runtime=t},function(){var t=cr.plugins_.NinePatch.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){this.is_family||(this.texture_img=new Image,this.texture_img.cr_filesize=this.texture_filesize,this.runtime.waitForImageLoad(this.texture_img,this.texture_file),this.fillPattern=null,this.leftPattern=null,this.rightPattern=null,this.topPattern=null,this.bottomPattern=null,this.webGL_texture=null,this.webGL_fillTexture=null,this.webGL_leftTexture=null,this.webGL_rightTexture=null,this.webGL_topTexture=null,this.webGL_bottomTexture=null)},e.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null,this.webGL_fillTexture=null,this.webGL_leftTexture=null,this.webGL_rightTexture=null,this.webGL_topTexture=null,this.webGL_bottomTexture=null)},e.onRestoreWebGLContext=function(){!this.is_family&&this.instances.length&&(this.webGL_texture||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat)))},e.unloadTextures=function(){this.is_family||this.instances.length||this.runtime.glwrap&&(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.runtime.glwrap.deleteTexture(this.webGL_fillTexture),this.runtime.glwrap.deleteTexture(this.webGL_leftTexture),this.runtime.glwrap.deleteTexture(this.webGL_rightTexture),this.runtime.glwrap.deleteTexture(this.webGL_topTexture),this.runtime.glwrap.deleteTexture(this.webGL_bottomTexture),this.webGL_texture=null,this.webGL_fillTexture=null,this.webGL_leftTexture=null,this.webGL_rightTexture=null,this.webGL_topTexture=null,this.webGL_bottomTexture=null)},e.slicePatch=function(t,e,i,s){var n=document.createElement("canvas"),r=i-t,o=s-e;return n.width=r,n.height=o,n.getContext("2d").drawImage(this.texture_img,t,e,r,o,0,0,r,o),n},e.createPatch=function(t,e,i,s){var n=this.texture_img.width,r=this.texture_img.height,o=n-e,a=r-s;if(this.runtime.glwrap){if(this.webGL_fillTexture)return;var h=this.runtime.glwrap,c=this.runtime.linearSampling,l=this.texture_pixelformat;o>t&&a>i&&(this.webGL_fillTexture=h.loadTexture(this.slicePatch(t,i,o,a),!0,c,l)),t>0&&a>i&&(this.webGL_leftTexture=h.loadTexture(this.slicePatch(0,i,t,a),!0,c,l,"repeat-y")),e>0&&a>i&&(this.webGL_rightTexture=h.loadTexture(this.slicePatch(o,i,n,a),!0,c,l,"repeat-y")),i>0&&o>t&&(this.webGL_topTexture=h.loadTexture(this.slicePatch(t,0,o,i),!0,c,l,"repeat-x")),s>0&&o>t&&(this.webGL_bottomTexture=h.loadTexture(this.slicePatch(t,a,o,r),!0,c,l,"repeat-x"))}else{if(this.fillPattern)return;var u=this.runtime.ctx;o>t&&a>i&&(this.fillPattern=u.createPattern(this.slicePatch(t,i,o,a),"repeat")),t>0&&a>i&&(this.leftPattern=u.createPattern(this.slicePatch(0,i,t,a),"repeat")),e>0&&a>i&&(this.rightPattern=u.createPattern(this.slicePatch(o,i,n,a),"repeat")),i>0&&o>t&&(this.topPattern=u.createPattern(this.slicePatch(t,0,o,i),"repeat")),s>0&&o>t&&(this.bottomPattern=u.createPattern(this.slicePatch(t,a,o,r),"repeat"))}},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var i=t.Instance.prototype;function s(t,e,i,s,n,r,o,a,h,c){t.save(),t.fillStyle=e;var l=n%i,u=r%s;l<0&&(l+=i),u<0&&(u+=s),t.translate(l+h,u+c),t.fillRect(n-l-h,r-u-c,o,a),t.restore()}function n(){}function r(){}i.onCreate=function(){this.leftMargin=this.properties[0],this.rightMargin=this.properties[1],this.topMargin=this.properties[2],this.bottomMargin=this.properties[3],this.edges=this.properties[4],this.fill=this.properties[5],this.visible=0===this.properties[6],this.seamless=0!==this.properties[8],this.recycled?this.rcTex.set(0,0,0,0):this.rcTex=new cr.rect(0,0,0,0),this.runtime.glwrap&&(this.type.webGL_texture||(this.type.webGL_texture=this.runtime.glwrap.loadTexture(this.type.texture_img,!1,this.runtime.linearSampling,this.type.texture_pixelformat))),this.type.createPatch(this.leftMargin,this.rightMargin,this.topMargin,this.bottomMargin)},i.draw=function(t){var e=this.type.texture_img,i=this.leftMargin,n=this.rightMargin,r=this.topMargin,o=this.bottomMargin,a=e.width,h=e.height,c=a-n,l=h-o;t.globalAlpha=this.opacity,t.save();var u=this.x,p=this.y,d=this.width,f=this.height;this.runtime.pixel_rounding&&(u=Math.round(u),p=Math.round(p));var g=-this.hotspotX*this.width,m=-this.hotspotY*this.height,y=g%a,_=m%h;y<0&&(y+=a),_<0&&(_+=h),t.translate(u+y,p+_);var v=g-y,b=m-_,w=this.seamless?1:0;if(i>0&&r>0&&t.drawImage(e,0,0,i+w,r+w,v,b,i+w,r+w),n>0&&r>0&&t.drawImage(e,c-w,0,n+w,r+w,v+d-n-w,b,n+w,r+w),n>0&&o>0&&t.drawImage(e,c-w,l-w,n+w,o+w,v+d-n-w,b+f-o-w,n+w,o+w),i>0&&o>0&&t.drawImage(e,0,l-w,i+w,o+w,v,b+f-o-w,i+w,o+w),0===this.edges){var x=2===this.fill?0:w;i>0&&l>r&&s(t,this.type.leftPattern,i,l-r,v,b+r,i+x,f-r-o,0,0),n>0&&l>r&&s(t,this.type.rightPattern,n,l-r,v+d-n-x,b+r,n+x,f-r-o,x,0),r>0&&c>i&&s(t,this.type.topPattern,c-i,r,v+i,b,d-i-n,r+x,0,0),o>0&&c>i&&s(t,this.type.bottomPattern,c-i,o,v+i,b+f-o-x,d-i-n,o+x,0,x)}else 1===this.edges&&(i>0&&l>r&&f-r-o>0&&t.drawImage(e,0,r,i,l-r,v,b+r,i,f-r-o),n>0&&l>r&&f-r-o>0&&t.drawImage(e,c,r,n,l-r,v+d-n,b+r,n,f-r-o),r>0&&c>i&&d-i-n>0&&t.drawImage(e,i,0,c-i,r,v+i,b,d-i-n,r),o>0&&c>i&&d-i-n>0&&t.drawImage(e,i,l,c-i,o,v+i,b+f-o,d-i-n,o));l>r&&c>i&&(0===this.fill?s(t,this.type.fillPattern,c-i,l-r,v+i,b+r,d-i-n,f-r-o,0,0):1===this.fill&&d-i-n>0&&f-r-o>0&&t.drawImage(e,i,r,c-i,l-r,v+i,b+r,d-i-n,f-r-o)),t.restore()},i.drawPatch=function(t,e,i,s,n,r,o,a,h,c){t.setTexture(e);var l=this.rcTex;l.left=i/e.c2width,l.top=s/e.c2height,l.right=(i+n)/e.c2width,l.bottom=(s+r)/e.c2height,t.quadTex(o,a,o+h,a,o+h,a+c,o,a+c,l)},i.tilePatch=function(t,e,i,s,n,r,o,a){t.setTexture(e);var h=this.rcTex;h.left=-o/e.c2width,h.top=-a/e.c2height,h.right=(n-o)/e.c2width,h.bottom=(r-a)/e.c2height,t.quadTex(i,s,i+n,s,i+n,s+r,i,s+r,h)},i.drawGL_earlyZPass=function(t){this.drawGL(t)},i.drawGL=function(t){var e=this.leftMargin,i=this.rightMargin,s=this.topMargin,n=this.bottomMargin,r=this.type.texture_img.width-i,o=this.type.texture_img.height-n;t.setOpacity(this.opacity);this.rcTex;var a=this.bquad,h=a.tlx,c=a.tly,l=this.width,u=this.height;this.runtime.pixel_rounding&&(h=Math.round(h),c=Math.round(c));var p=this.seamless?1:0;if(e>0&&s>0&&this.drawPatch(t,this.type.webGL_texture,0,0,e+p,s+p,h,c,e+p,s+p),i>0&&s>0&&this.drawPatch(t,this.type.webGL_texture,r-p,0,i+p,s+p,h+l-i-p,c,i+p,s+p),i>0&&n>0&&this.drawPatch(t,this.type.webGL_texture,r-p,o-p,i+p,n+p,h+l-i-p,c+u-n-p,i+p,n+p),e>0&&n>0&&this.drawPatch(t,this.type.webGL_texture,0,o-p,e+p,n+p,h,c+u-n-p,e+p,n+p),0===this.edges){var d=2===this.fill?0:p;e>0&&o>s&&this.tilePatch(t,this.type.webGL_leftTexture,h,c+s,e+d,u-s-n,0,0),i>0&&o>s&&this.tilePatch(t,this.type.webGL_rightTexture,h+l-i-d,c+s,i+d,u-s-n,d,0),s>0&&r>e&&this.tilePatch(t,this.type.webGL_topTexture,h+e,c,l-e-i,s+d,0,0),n>0&&r>e&&this.tilePatch(t,this.type.webGL_bottomTexture,h+e,c+u-n-d,l-e-i,n+d,0,d)}else 1===this.edges&&(e>0&&o>s&&this.drawPatch(t,this.type.webGL_texture,0,s,e,o-s,h,c+s,e,u-s-n),i>0&&o>s&&this.drawPatch(t,this.type.webGL_texture,r,s,i,o-s,h+l-i,c+s,i,u-s-n),s>0&&r>e&&this.drawPatch(t,this.type.webGL_texture,e,0,r-e,s,h+e,c,l-e-i,s),n>0&&r>e&&this.drawPatch(t,this.type.webGL_texture,e,o,r-e,n,h+e,c+u-n,l-e-i,n));o>s&&r>e&&(0===this.fill?this.tilePatch(t,this.type.webGL_fillTexture,h+e,c+s,l-e-i,u-s-n,0,0):1===this.fill&&this.drawPatch(t,this.type.webGL_texture,e,s,r-e,o-s,h+e,c+s,l-e-i,u-s-n))},n.prototype.OnURLLoaded=function(){return!0},t.cnds=new n,r.prototype.SetEffect=function(t){this.blend_mode=t,this.compositeOp=cr.effectToCompositeOp(t),cr.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},t.acts=new r,t.exps=new function(){}}(),cr.plugins_.NodeWebkit=function(t){this.runtime=t},function(){var t=!1,e=null,i=null,s=null,n=null,r=null,o=null,a="",h="",c="",l="\\",u=[],p="",d="",f=cr.plugins_.NodeWebkit.prototype;f.Type=function(t){this.plugin=t,this.runtime=t.runtime},f.Type.prototype.onCreate=function(){},f.Instance=function(t){this.type=t,this.runtime=t.runtime};var g=f.Instance.prototype;function m(){}function y(){}function _(){}g.onCreate=function(){t=this.runtime.isNWjs;var u=this;if(t){e=require("path"),i=require("fs"),s=require("os"),r=require("child_process"),"win32"!==(o=window.process||nw.process).platform&&(l="/"),a=e.dirname(o.execPath)+l,h=s.homedir()+l,n=window.nwgui,c=o.mainModule.filename;var f=Math.max(c.lastIndexOf("/"),c.lastIndexOf("\\"));-1!==f&&(c=c.substr(0,f+1)),window.ondrop=function(t){t.preventDefault();for(var e=0;e<t.dataTransfer.files.length;++e)p=t.dataTransfer.files[e].path,u.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnFileDrop,u);return!1};var g=document.getElementById("c2nwOpenFileDialog");g.onchange=function(t){d=g.value,u.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnOpenDlg,u);try{g.value=null}catch(t){}},g.oncancel=function(){u.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnOpenDlgCancel,u)};var m=document.getElementById("c2nwChooseFolderDialog");m.onchange=function(t){d=m.value,u.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnFolderDlg,u);try{m.value=null}catch(t){}},m.oncancel=function(){u.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnFolderDlgCancel,u)};var y=document.getElementById("c2nwSaveDialog");y.onchange=function(t){d=y.value,u.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnSaveDlg,u);try{y.value=null}catch(t){}},y.oncancel=function(){u.runtime.trigger(cr.plugins_.NodeWebkit.prototype.cnds.OnSaveDlgCancel,u)}}},g.onDestroy=function(){},g.saveToJSON=function(){return{}},g.loadFromJSON=function(t){},m.prototype.PathExists=function(e){return!!t&&i.existsSync(e)},m.prototype.OnFileDrop=function(){return!0},m.prototype.OnOpenDlg=function(){return!0},m.prototype.OnFolderDlg=function(){return!0},m.prototype.OnSaveDlg=function(){return!0},m.prototype.OnOpenDlgCancel=function(){return!0},m.prototype.OnFolderDlgCancel=function(){return!0},m.prototype.OnSaveDlgCancel=function(){return!0},f.cnds=new m,y.prototype.WriteFile=function(e,s){if(t)try{i.writeFileSync(e,s,{encoding:"utf8"})}catch(t){}},y.prototype.RenameFile=function(e,s){if(t)try{i.renameSync(e,s)}catch(t){}},y.prototype.DeleteFile=function(e){if(t)try{i.unlinkSync(e)}catch(t){}},y.prototype.CopyFile=function(e,s){if(t&&e!==s)try{var n=i.readFileSync(e,{flags:"rb"});i.writeFileSync(s,n,{flags:"wb"})}catch(t){}},y.prototype.MoveFile=function(e,s){if(t&&e!==s)try{var n=i.readFileSync(e,{flags:"rb"});i.writeFileSync(s,n,{flags:"wb"}),i.existsSync(s)&&i.unlinkSync(e)}catch(t){}},y.prototype.RunFile=function(e){t&&r.exec(e,function(){})},y.prototype.ShellOpen=function(e){t&&nw.Shell.openItem(e)},y.prototype.OpenBrowser=function(i){if(t){var s;switch(o.platform){case"win32":s='start ""';break;case"darwin":s="open";break;default:s=e.join(__dirname,"../vendor/xdg-open")}r.exec(s+' "'+i.replace(/"/,'\\"')+'"')}},y.prototype.CreateFolder=function(e){if(t)try{i.mkdirSync(e)}catch(t){}},y.prototype.AppendFile=function(e,s){if(t)try{i.appendFileSync(e,s,{encoding:"utf8"})}catch(t){}},y.prototype.ListFiles=function(e){if(t){try{u=i.readdirSync(e)}catch(t){u=[],console.warn("Error listing files at '"+e+"': ",t)}u||(u=[])}},y.prototype.ShowOpenDlg=function(e){if(t){var i=jQuery("#c2nwOpenFileDialog");i.attr("accept",e),i.trigger("click")}},y.prototype.ShowFolderDlg=function(e){t&&jQuery("#c2nwChooseFolderDialog").trigger("click")},y.prototype.ShowSaveDlg=function(e){if(t){var i=jQuery("#c2nwSaveDialog");i.attr("accept",e),i.trigger("click")}},y.prototype.SetWindowX=function(e){t&&n&&(n.Window.get().x=e)},y.prototype.SetWindowY=function(e){t&&n&&(n.Window.get().y=e)},y.prototype.SetWindowWidth=function(e){t&&n&&(n.Window.get().width=e)},y.prototype.SetWindowHeight=function(e){t&&n&&(n.Window.get().height=e)},y.prototype.SetWindowTitle=function(e){t&&n&&(n.Window.get().title=e,document.title=e)},y.prototype.WindowMinimize=function(){if(t&&n){var e=n.Window.get();setTimeout(function(){e.minimize()},100)}},y.prototype.WindowMaximize=function(){if(t&&n){var e=n.Window.get();setTimeout(function(){e.maximize()},100)}},y.prototype.WindowUnmaximize=function(){if(t&&n){var e=n.Window.get();setTimeout(function(){e.unmaximize()},100)}},y.prototype.WindowRestore=function(){if(t&&n){var e=n.Window.get();setTimeout(function(){e.restore()},100)}},y.prototype.WindowRequestAttention=function(e){t&&n&&n.Window.get().requestAttention(e?3:0)},y.prototype.WindowSetMaxSize=function(e,i){t&&n&&n.Window.get().setMaximumSize(e,i)},y.prototype.WindowSetMinSize=function(e,i){t&&n&&n.Window.get().setMinimumSize(e,i)},y.prototype.WindowSetResizable=function(e){t&&n&&n.Window.get().setResizable(0!==e)},y.prototype.WindowSetAlwaysOnTop=function(e){t&&n&&n.Window.get().setAlwaysOnTop(0!==e)},y.prototype.ShowDevTools=function(){t&&n&&n.Window.get().showDevTools()},y.prototype.SetClipboardText=function(e){t&&n&&n.Clipboard.get().set(e)},y.prototype.ClearClipboard=function(){t&&n&&n.Clipboard.get().clear()},f.acts=new y,_.prototype.AppFolder=function(t){t.set_string(a)},_.prototype.AppFolderURL=function(t){t.set_string("file://"+a)},_.prototype.ProjectFilesFolder=function(t){t.set_string(c)},_.prototype.ProjectFilesFolderURL=function(t){t.set_string("file://"+c)},_.prototype.UserFolder=function(t){t.set_string(h)},_.prototype.ReadFile=function(e,s){if(t){var n="";try{n=i.readFileSync(s,{encoding:"utf8"})}catch(t){}e.set_string(n)}else e.set_string("")},_.prototype.FileSize=function(e,s){if(t){var n=0;try{var r=i.statSync(s);r&&(n=r.size||0)}catch(t){}e.set_int(n)}else e.set_int(0)},_.prototype.ListCount=function(t){t.set_int(u.length)},_.prototype.ListAt=function(t,e){(e=Math.floor(e))<0||e>=u.length?t.set_string(""):t.set_string(u[e])},_.prototype.DroppedFile=function(t){t.set_string(p)},_.prototype.ChosenPath=function(t){t.set_string(d)},_.prototype.WindowX=function(e){e.set_int(t&&n?n.Window.get().x:0)},_.prototype.WindowY=function(e){e.set_int(t&&n?n.Window.get().y:0)},_.prototype.WindowWidth=function(e){e.set_int(t&&n?n.Window.get().width:0)},_.prototype.WindowHeight=function(e){e.set_int(t&&n?n.Window.get().height:0)},_.prototype.WindowTitle=function(e){e.set_string(t&&n?n.Window.get().title||"":0)},_.prototype.ClipboardText=function(e){e.set_string(t&&n?n.Clipboard.get().get()||"":0)},f.exps=new _}(),cr.plugins_.Particles=function(t){this.runtime=t},function(){var t=cr.plugins_.Particles.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;function i(t){this.owner=t,this.active=!1,this.x=0,this.y=0,this.speed=0,this.angle=0,this.opacity=1,this.grow=0,this.size=0,this.gs=0,this.age=0,cr.seal(this)}e.onCreate=function(){this.is_family||(this.texture_img=new Image,this.texture_img.cr_filesize=this.texture_filesize,this.webGL_texture=null,this.runtime.waitForImageLoad(this.texture_img,this.texture_file))},e.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null)},e.onRestoreWebGLContext=function(){!this.is_family&&this.instances.length&&(this.webGL_texture||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat)))},e.loadTextures=function(){this.is_family||this.webGL_texture||!this.runtime.glwrap||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat))},e.unloadTextures=function(){this.is_family||this.instances.length||!this.webGL_texture||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)},e.preloadCanvas2D=function(t){t.drawImage(this.texture_img,0,0)},i.prototype.init=function(){var t=this.owner;this.x=t.x-t.xrandom/2+Math.random()*t.xrandom,this.y=t.y-t.yrandom/2+Math.random()*t.yrandom,this.speed=t.initspeed-t.speedrandom/2+Math.random()*t.speedrandom,this.angle=t.angle-t.spraycone/2+Math.random()*t.spraycone,this.opacity=t.initopacity,this.size=t.initsize-t.sizerandom/2+Math.random()*t.sizerandom,this.grow=t.growrate-t.growrandom/2+Math.random()*t.growrandom,this.gs=0,this.age=0},i.prototype.tick=function(t){var e=this.owner;this.x+=Math.cos(this.angle)*this.speed*t,this.y+=Math.sin(this.angle)*this.speed*t,this.y+=this.gs*t,this.speed+=e.acc*t,this.size+=this.grow*t,this.gs+=e.g*t,this.age+=t,this.size<1?this.active=!1:(0!==e.lifeanglerandom&&(this.angle+=Math.random()*e.lifeanglerandom*t-e.lifeanglerandom*t/2),0!==e.lifespeedrandom&&(this.speed+=Math.random()*e.lifespeedrandom*t-e.lifespeedrandom*t/2),0!==e.lifeopacityrandom&&(this.opacity+=Math.random()*e.lifeopacityrandom*t-e.lifeopacityrandom*t/2,this.opacity<0?this.opacity=0:this.opacity>1&&(this.opacity=1)),e.destroymode<=1&&this.age>=e.timeout&&(this.active=!1),2===e.destroymode&&this.speed<=0&&(this.active=!1))},i.prototype.draw=function(t){var e=this.owner.opacity*this.opacity;if(0!==e){0===this.owner.destroymode&&(e*=1-this.age/this.owner.timeout),t.globalAlpha=e;var i=this.x-this.size/2,s=this.y-this.size/2;this.owner.runtime.pixel_rounding&&(i=i+.5|0,s=s+.5|0),t.drawImage(this.owner.type.texture_img,i,s,this.size,this.size)}},i.prototype.drawGL=function(t){var e=this.owner.opacity*this.opacity;0===this.owner.destroymode&&(e*=1-this.age/this.owner.timeout);var i=this.size,s=i*this.owner.particlescale,n=this.x-i/2,r=this.y-i/2;this.owner.runtime.pixel_rounding&&(n=n+.5|0,r=r+.5|0),s<1||0===e||(s<t.minPointSize||s>t.maxPointSize?(t.setOpacity(e),t.quad(n,r,n+i,r,n+i,r+i,n,r+i)):t.point(this.x,this.y,s,e))},i.prototype.left=function(){return this.x-this.size/2},i.prototype.right=function(){return this.x+this.size/2},i.prototype.top=function(){return this.y-this.size/2},i.prototype.bottom=function(){return this.y+this.size/2},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var s=t.Instance.prototype,n=[];function r(){}function o(){}function a(){}s.onCreate=function(){var t=this.properties;if(this.rate=t[0],this.spraycone=cr.to_radians(t[1]),this.spraytype=t[2],this.spraying=!0,this.initspeed=t[3],this.initsize=t[4],this.initopacity=t[5]/100,this.growrate=t[6],this.xrandom=t[7],this.yrandom=t[8],this.speedrandom=t[9],this.sizerandom=t[10],this.growrandom=t[11],this.acc=t[12],this.g=t[13],this.lifeanglerandom=t[14],this.lifespeedrandom=t[15],this.lifeopacityrandom=t[16],this.destroymode=t[17],this.timeout=t[18],this.particleCreateCounter=0,this.particlescale=1,this.particleBoxLeft=this.x,this.particleBoxTop=this.y,this.particleBoxRight=this.x,this.particleBoxBottom=this.y,this.add_bbox_changed_callback(function(t){t.bbox.set(t.particleBoxLeft,t.particleBoxTop,t.particleBoxRight,t.particleBoxBottom),t.bquad.set_from_rect(t.bbox),t.bbox_changed=!1,t.update_collision_cell(),t.update_render_cell()}),this.recycled||(this.particles=[]),this.runtime.tickMe(this),this.type.loadTextures(),1===this.spraytype)for(var e=0;e<this.rate;e++)this.allocateParticle().opacity=0;this.first_tick=!0},s.saveToJSON=function(){var t,e,i,s={r:this.rate,sc:this.spraycone,st:this.spraytype,s:this.spraying,isp:this.initspeed,isz:this.initsize,io:this.initopacity,gr:this.growrate,xr:this.xrandom,yr:this.yrandom,spr:this.speedrandom,szr:this.sizerandom,grnd:this.growrandom,acc:this.acc,g:this.g,lar:this.lifeanglerandom,lsr:this.lifespeedrandom,lor:this.lifeopacityrandom,dm:this.destroymode,to:this.timeout,pcc:this.particleCreateCounter,ft:this.first_tick,p:[]},n=s.p;for(t=0,e=this.particles.length;t<e;t++)i=this.particles[t],n.push([i.x,i.y,i.speed,i.angle,i.opacity,i.grow,i.size,i.gs,i.age]);return s},s.loadFromJSON=function(t){var e,i,s,r;this.rate=t.r,this.spraycone=t.sc,this.spraytype=t.st,this.spraying=t.s,this.initspeed=t.isp,this.initsize=t.isz,this.initopacity=t.io,this.growrate=t.gr,this.xrandom=t.xr,this.yrandom=t.yr,this.speedrandom=t.spr,this.sizerandom=t.szr,this.growrandom=t.grnd,this.acc=t.acc,this.g=t.g,this.lifeanglerandom=t.lar,this.lifespeedrandom=t.lsr,this.lifeopacityrandom=t.lor,this.destroymode=t.dm,this.timeout=t.to,this.particleCreateCounter=t.pcc,this.first_tick=t.ft,n.push.apply(n,this.particles),cr.clearArray(this.particles);var o=t.p;for(e=0,i=o.length;e<i;e++)s=this.allocateParticle(),r=o[e],s.x=r[0],s.y=r[1],s.speed=r[2],s.angle=r[3],s.opacity=r[4],s.grow=r[5],s.size=r[6],s.gs=r[7],s.age=r[8]},s.onDestroy=function(){n.push.apply(n,this.particles),cr.clearArray(this.particles)},s.allocateParticle=function(){var t;return n.length?(t=n.pop()).owner=this:t=new i(this),this.particles.push(t),t.active=!0,t},s.tick=function(){var t,e,i,s,r,o=this.runtime.getDt(this);if(0===this.spraytype&&this.spraying)for(this.particleCreateCounter+=o*this.rate,s=cr.floor(this.particleCreateCounter),this.particleCreateCounter-=s,t=0;t<s;t++)(i=this.allocateParticle()).init();for(this.particleBoxLeft=this.x,this.particleBoxTop=this.y,this.particleBoxRight=this.x,this.particleBoxBottom=this.y,t=0,r=0,e=this.particles.length;t<e;t++)i=this.particles[t],this.particles[r]=i,this.runtime.redraw=!0,1===this.spraytype&&this.first_tick&&i.init(),i.tick(o),i.active?(i.left()<this.particleBoxLeft&&(this.particleBoxLeft=i.left()),i.right()>this.particleBoxRight&&(this.particleBoxRight=i.right()),i.top()<this.particleBoxTop&&(this.particleBoxTop=i.top()),i.bottom()>this.particleBoxBottom&&(this.particleBoxBottom=i.bottom()),r++):n.push(i);cr.truncateArray(this.particles,r),this.set_bbox_changed(),this.first_tick=!1,1===this.spraytype&&0===this.particles.length&&this.runtime.DestroyInstance(this)},s.draw=function(t){var e,i,s,n=this.layer;for(e=0,i=this.particles.length;e<i;e++)(s=this.particles[e]).right()>=n.viewLeft&&s.bottom()>=n.viewTop&&s.left()<=n.viewRight&&s.top()<=n.viewBottom&&s.draw(t)},s.drawGL=function(t){this.particlescale=this.layer.getScale(),t.setTexture(this.type.webGL_texture);var e,i,s,n=this.layer;for(e=0,i=this.particles.length;e<i;e++)(s=this.particles[e]).right()>=n.viewLeft&&s.bottom()>=n.viewTop&&s.left()<=n.viewRight&&s.top()<=n.viewBottom&&s.drawGL(t)},r.prototype.IsSpraying=function(){return this.spraying},t.cnds=new r,o.prototype.SetSpraying=function(t){this.spraying=0!==t},o.prototype.SetEffect=function(t){this.blend_mode=t,this.compositeOp=cr.effectToCompositeOp(t),cr.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},o.prototype.SetRate=function(t){var e,i;if(this.rate=t,1===this.spraytype&&this.first_tick)if(t<this.particles.length)for(e=this.particles.length-t,i=0;i<e;i++)n.push(this.particles.pop());else if(t>this.particles.length)for(e=t-this.particles.length,i=0;i<e;i++)this.allocateParticle().opacity=0},o.prototype.SetSprayCone=function(t){this.spraycone=cr.to_radians(t)},o.prototype.SetInitSpeed=function(t){this.initspeed=t},o.prototype.SetInitSize=function(t){this.initsize=t},o.prototype.SetInitOpacity=function(t){this.initopacity=t/100},o.prototype.SetGrowRate=function(t){this.growrate=t},o.prototype.SetXRandomiser=function(t){this.xrandom=t},o.prototype.SetYRandomiser=function(t){this.yrandom=t},o.prototype.SetSpeedRandomiser=function(t){this.speedrandom=t},o.prototype.SetSizeRandomiser=function(t){this.sizerandom=t},o.prototype.SetGrowRateRandomiser=function(t){this.growrandom=t},o.prototype.SetParticleAcc=function(t){this.acc=t},o.prototype.SetGravity=function(t){this.g=t},o.prototype.SetAngleRandomiser=function(t){this.lifeanglerandom=t},o.prototype.SetLifeSpeedRandomiser=function(t){this.lifespeedrandom=t},o.prototype.SetOpacityRandomiser=function(t){this.lifeopacityrandom=t},o.prototype.SetTimeout=function(t){this.timeout=t},t.acts=new o,a.prototype.ParticleCount=function(t){t.set_int(this.particles.length)},a.prototype.Rate=function(t){t.set_float(this.rate)},a.prototype.SprayCone=function(t){t.set_float(cr.to_degrees(this.spraycone))},a.prototype.InitSpeed=function(t){t.set_float(this.initspeed)},a.prototype.InitSize=function(t){t.set_float(this.initsize)},a.prototype.InitOpacity=function(t){t.set_float(100*this.initopacity)},a.prototype.InitGrowRate=function(t){t.set_float(this.growrate)},a.prototype.XRandom=function(t){t.set_float(this.xrandom)},a.prototype.YRandom=function(t){t.set_float(this.yrandom)},a.prototype.InitSpeedRandom=function(t){t.set_float(this.speedrandom)},a.prototype.InitSizeRandom=function(t){t.set_float(this.sizerandom)},a.prototype.InitGrowRandom=function(t){t.set_float(this.growrandom)},a.prototype.ParticleAcceleration=function(t){t.set_float(this.acc)},a.prototype.Gravity=function(t){t.set_float(this.g)},a.prototype.ParticleAngleRandom=function(t){t.set_float(this.lifeanglerandom)},a.prototype.ParticleSpeedRandom=function(t){t.set_float(this.lifespeedrandom)},a.prototype.ParticleOpacityRandom=function(t){t.set_float(this.lifeopacityrandom)},a.prototype.Timeout=function(t){t.set_float(this.timeout)},t.exps=new a}();var jText="";if(cr.plugins_.SkymenSFPlusPLus=function(t){this.runtime=t},function(){var t=cr.plugins_.SkymenSFPlusPLus.prototype;t.onCreate=function(){},t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){this.is_family||(this.texture_img=new Image,this.texture_img.idtkLoadDisposed=!0,this.texture_img.src=this.texture_file,this.runtime.wait_for_textures.push(this.texture_img),this.webGL_texture=null)},e.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null)},e.onRestoreWebGLContext=function(){var t,e;if(!this.is_family&&this.instances.length)for(this.webGL_texture||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!1,this.runtime.linearSampling,this.texture_pixelformat)),t=0,e=this.instances.length;t<e;t++)this.instances[t].webGL_texture=this.webGL_texture},e.unloadTextures=function(){this.is_family||this.instances.length||!this.webGL_texture||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)},e.preloadCanvas2D=function(t){try{t.drawImage(this.texture_img,0,0)}catch(e){this.texture_img.onload=function(){t.drawImage(this.texture_img,0,0)}}},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var i=t.Instance.prototype;function s(t){return t.replace(/\s\s*$/,"")}i.onDestroy=function(){var t;p(this.lines),t=this.clipList,a(f,t,!1),function(t){a(m,t,!1)}(this.clipUV),cr.wipe(this.characterWidthList)},i.onCreate=function(){this.texture_img=this.type.texture_img,this.characterWidth=this.properties[0],this.characterHeight=this.properties[1],this.characterSet=this.properties[2],this.text=this.properties[3],this.characterScale=this.properties[4],this.visible=0===this.properties[5],this.clamp=0===this.properties[14],this.halign=this.clamp?cr.clamp(this.properties[6],0,100)/100:this.properties[6]/100,this.valign=this.clamp?cr.clamp(this.properties[7],0,100)/100:this.properties[7]/100,this.wrapbyword=0===this.properties[9],this.nowrap=2===this.properties[9],this.characterSpacing=this.properties[10],this.lineHeight=this.properties[11],this.textWidth=0,this.textHeight=0,this.charWidthJSON=this.properties[12],this.spaceWidth=this.properties[13],this.charPos={data:[0]},this.charPosProcessed=[[[0]]],this.lastValue=0,jText=this.charWidthJSON,this.recycled?(this.lines.length=0,cr.wipe(this.clipList),cr.wipe(this.clipUV),cr.wipe(this.characterWidthList)):(this.lines=[],this.clipList={},this.clipUV={},this.characterWidthList={});try{if(this.charWidthJSON)if(-1!==this.charWidthJSON.indexOf('""c2array""'))for(var t=(r=jQuery.parseJSON(this.charWidthJSON.replace(/""/g,'"'))).size[1],e=0;e<t;e++)for(var i=r.data[1][e][0],s=r.data[0][e][0],n=0;n<i.length;n++)this.characterWidthList[i.charAt(n)]=s;else{var r;for(t=(r=jQuery.parseJSON(this.charWidthJSON)).length,e=0;e<t;e++)for(i=r[e][1],s=r[e][0],n=0;n<i.length;n++)this.characterWidthList[i.charAt(n)]=s}-1!==this.spaceWidth&&(this.characterWidthList[" "]=this.spaceWidth)}catch(t){window.console&&window.console.log&&window.console.log("SpriteFont+ Failure: "+t)}this.text_changed=!0,this.lastwrapwidth=this.width,this.runtime.glwrap&&(this.type.webGL_texture||(this.type.webGL_texture=this.runtime.glwrap.loadTexture(this.type.texture_img,!1,this.runtime.linearSampling,this.type.texture_pixelformat)),this.webGL_texture=this.type.webGL_texture),this.SplitSheet()},i.saveToJSON=function(){var t={t:this.text,csc:this.characterScale,csp:this.characterSpacing,lh:this.lineHeight,tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick,ha:this.halign,va:this.valign,clamp:this.clamp,wbw:this.wrapbyword,nw:this.nowrap,charpos:this.charPos,charpospro:this.charPosProcessed,lastvalue:this.lastValue,cw:{}};for(var e in this.characterWidthList)t.cw[e]=this.characterWidthList[e];return t},i.loadFromJSON=function(t){for(var e in this.text=t.t,this.characterScale=t.csc,this.characterSpacing=t.csp,this.lineHeight=t.lh,this.textWidth=t.tw,this.textHeight=t.th,this.halign=t.ha,this.valign=t.va,this.clamp=t.clamp,this.nowrap=t.nw,this.wrapbyword=t.wbw,this.charPos=t.charpos,this.charPosProcessed=t.charpospro,this.lastValue=t.lastvalue,t.cw)this.characterWidthList[e]=t.cw[e];this.text_changed=!0,this.lastwrapwidth=this.width};var n=1e3;function r(t,e){return t.length?t.pop():new e}function o(t,e){t.length<n&&t.push(e)}function a(t,e,i){if(i){var s,n;for(s=0,n=e.length;s<n;s++)o(t,e[s]);e.length=0}else{var r;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o(t,e[r]),delete e[r])}}function h(t,e,i){var n,r=t.lines;i=s(i),e>=r.length&&r.push(l()),(n=r[e]).text=i,n.width=t.measureWidth(i),t.textWidth=cr.max(t.textWidth,n.width)}var c=[];function l(){return r(c,Object)}function u(t){o(c,t)}function p(t){a(c,t,!0)}function d(t,e,i,s,n,o){void 0===t[e]&&(t[e]=r(f,Object)),t[e].x=i,t[e].y=s,t[e].w=n,t[e].h=o}var f=[];function g(t,e,i,s,n,o){void 0===t[e]&&(t[e]=r(m,cr.rect)),t[e].left=i,t[e].top=s,t[e].right=n,t[e].bottom=o}var m=[];i.SplitSheet=function(){for(var t=this.texture_img,e=t.width,i=t.height,s=this.characterWidth,n=this.characterHeight,r=s/e,o=n/i,a=this.characterSet,h=Math.floor(e/s),c=Math.floor(i/n),l=0;l<a.length&&!(l>=h*c);l++){var u=l%h,p=Math.floor(l/h),f=a.charAt(l);this.runtime.glwrap?g(this.clipUV,f,u*r,p*o,(u+1)*r,(p+1)*o):d(this.clipList,f,u*s,p*n,s,n)}};var y=[];t.TokeniseWords=function(t){y.length=0;for(var e,i="",s=0;s<t.length;)if("\n"===(e=t.charAt(s)))i.length&&(y.push(i),i=""),y.push("\n"),++s;else if(" "===e||"\t"===e||"-"===e){do{i+=t.charAt(s),s++}while(s<t.length&&(" "===t.charAt(s)||"\t"===t.charAt(s)));y.push(i),i=""}else s<t.length&&(i+=e,s++);i.length&&y.push(i)},t.WordWrap=function(t){var e=t.text,i=t.lines;if(e&&e.length){var s=t.width;if(s<=2)p(i);else{var n=t.characterWidth,r=t.characterScale,o=t.characterSpacing;if(e.length*(n*r+o)-o<=s&&-1===e.indexOf("\n")){var a=t.measureWidth(e);if(a<=s)return p(i),i.push(l()),i[0].text=e,i[0].width=a,t.textWidth=a,void(t.textHeight=t.characterHeight*r+t.lineHeight)}t.wrapbyword;this.WrapText(t),t.textHeight=i.length*(t.characterHeight*r+t.lineHeight)}}else p(i)},t.WrapText=function(t){var e,i=t.wrapbyword,n=t.nowrap,r=t.text,o=t.lines,a=t.width;i?(this.TokeniseWords(r),e=y):e=n?[r]:r;var c,l,p="",d=0,f=!1;for(l=0;l<e.length;l++)if("\n"!==e[l]){if(f=!1,c=p,p+=e[l],t.measureWidth(s(p))>a){if(""===c)if(i){for(;t.measureWidth(s(p))>a;){for(var g=p,m="";t.measureWidth(s(g))>=a;)m=g[g.length-1]+m,g=g.slice(0,-1);h(t,d,g),p=m,d++}d--}else h(t,d,p),p="",f=!0;else for(h(t,d,c),p=e[l],c="";t.measureWidth(s(p))>a;){d++;for(g=p,m="";t.measureWidth(s(g))>=a;)m=g[g.length-1]+m,g=g.slice(0,-1);h(t,d,g),p=m}d++}}else!0===f?f=!1:(h(t,d,p),d++),p="";for(s(p).length&&(h(t,d,p),d++),l=d;l<o.length;l++)u(o[l]);o.length=d},i.measureWidth=function(t){for(var e=this.characterSpacing,i=t.length,s=0,n=0;n<i;n++)s+=this.getCharacterWidth(t.charAt(n))*this.characterScale+e;return s-=s>0?e:0},i.getCharacterWidth=function(t){var e=this.characterWidthList;return void 0!==e[t]?e[t]:this.characterWidth},i.rebuildText=function(){(this.text_changed||this.width!==this.lastwrapwidth)&&(this.textWidth=0,this.textHeight=0,this.type.plugin.WordWrap(this),this.text_changed=!1,this.lastwrapwidth=this.width)};var _=1e-5;i.draw=function(t,e){var i=this.texture_img;if(""!==this.text&&null!=i){if(this.rebuildText(),this.height<this.characterHeight*this.characterScale+this.lineHeight)return;t.globalAlpha=this.opacity;var s=this.x,n=this.y;this.runtime.pixel_rounding&&(s=s+.5|0,n=n+.5|0),t.save(),t.translate(s,n),t.rotate(this.angle);var r=this.angle,o=this.halign,a=this.valign,h=this.characterScale,c=this.characterHeight*h,l=this.lineHeight,u=this.characterSpacing,p=this.lines,d=this.textHeight,f=this.charPosProcessed,g=!1;f&&void 0!==f[0][2]&&(g=!0),0!==r&&(Math.cos(r),Math.sin(r));for(var m,y,v=a*cr.max(0,this.height-d),w=-this.hotspotX*this.width,x=-this.hotspotY*this.height,S=x+=v,T=(r=this.angle,0),C=0,O=0,k=1,A=0;A<p.length;A++){var E=p[A].text,I=p[A].width;m=w+o*cr.max(0,this.width-I),S+=l;for(var P=0;P<E.length;P++){var M=E.charAt(P),F=this.clipList[M];if(m+this.getCharacterWidth(M)*h>this.width+_)break;if(void 0!==F){g&&(void 0===f[T]?(C=0,O=0,y=r):(C=f[T][0]*Math.cos(r)-f[T][1]*Math.sin(r)||0,O=f[T][1]*Math.cos(r)-f[T][0]*Math.sin(r)||0,y=cr.to_radians(f[T][2])||0,k=f[T][3]/100||1));var L=0,D=0;t.globalAlpha=this.opacity*k;var R=b(this,this.texture_img,void 0===f[T]?"None":f[T][4],F,h,M);if(g&&0!==y){var B=m+this.getCharacterWidth(M)*h/2,j=S+c,N=Math.atan2(j,B)+Math.PI-y,V=Math.sqrt(Math.pow(-B,2)+Math.pow(-j,2));L=-B-Math.cos(N)*V,D=-j-Math.sin(N)*V;t.save(),t.rotate(y),t.translate(Math.round(m+C+L),Math.round(S+O+D)),R===this.texture_img?t.drawImage(this.texture_img,F.x,F.y,F.w,F.h,0,0,F.w*h,F.h*h):t.drawImage(R,0,0),t.restore()}else R===this.texture_img?t.drawImage(this.texture_img,F.x,F.y,F.w,F.h,Math.round(m+C+L),Math.round(S+O+D),F.w*h,F.h*h):t.drawImage(R,Math.round(m+C+L),Math.round(S+O+D))}m+=this.getCharacterWidth(M)*h+u,g&&T++}if((S+=c)+c+l>this.height)break}t.restore()}};var v=new cr.quad;function b(t,e,i,s,n,r){if(!i||"None"===i)return e;if(void 0!==t.cachedImages&&void 0!==t.cachedImages[r]&&void 0!==t.cachedImages[r][i])return t.cachedImages[r][i];var o,a,h,c=(o=s.w*n,a=s.h*n,(h=document.createElement("canvas")).width=o,h.height=a,h),l=c.getContext("2d");return l.fillStyle="black",l.fillRect(0,0,c.width,c.height),l.drawImage(e,s.x,s.y,s.w,s.h,0,0,s.w*n,s.h*n),l.globalCompositeOperation="multiply",l.fillStyle=i,l.fillRect(0,0,s.w*n,s.h*n),l.globalCompositeOperation="destination-in",l.drawImage(e,s.x,s.y,s.w,s.h,0,0,s.w*n,s.h*n),l.globalCompositeOperation="source-over",void 0===t.cachedImages&&(t.cachedImages={}),void 0===t.cachedImages[r]&&(t.cachedImages[r]={}),t.cachedImages[r][i]=c,c}function w(t,e,i){var s;s=t.tlx*e-t.tly*i,t.tly=t.tly*e+t.tlx*i,t.tlx=s,s=t.trx*e-t.try_*i,t.try_=t.try_*e+t.trx*i,t.trx=s,s=t.blx*e-t.bly*i,t.bly=t.bly*e+t.blx*i,t.blx=s,s=t.brx*e-t.bry*i,t.bry=t.bry*e+t.brx*i,t.brx=s}function x(){}function S(){}function T(){}i.drawGL=function(t){if(""!==this.text){if(this.rebuildText(),this.height<this.characterHeight*this.characterScale+this.lineHeight)return;this.update_bbox();var e=this.bquad,i=0,s=0;this.runtime.pixel_rounding&&(i=(this.x+.5|0)-this.x,s=(this.y+.5|0)-this.y);var n,r,o=this.angle,a=this.halign,h=this.valign,c=this.characterScale,l=this.characterHeight*c,u=this.lineHeight,p=this.characterSpacing,d=this.lines,f=this.textHeight,g=this.charPosProcessed,m=!1;g&&void 0!==g[0][2]&&(m=!0),0!==o&&(n=Math.cos(o),r=Math.sin(o));for(var y,x,S=h*cr.max(0,this.height-f),T=e.tlx+i,C=e.tly+s,O=S,k=0,A=0,E=0,I=0,P=0,M=1,F=0;F<d.length;F++){var L=d[F].text,D=d[F].width;y=a*cr.max(0,this.width-D),O+=u;for(var R=0;R<L.length;R++){var B=L.charAt(R),j=this.clipUV[B];if(void 0!==j){var N={x:j.left*this.texture_img.width,y:j.top*this.texture_img.height,w:j.right*this.texture_img.width-j.left*this.texture_img.width,h:j.bottom*this.texture_img.height-j.top*this.texture_img.height},V=void 0===g[k]?"None":g[k][4];if("None"!==V&&void 0!==this.cachedTextures&&void 0!==this.cachedTextures[B]&&void 0!==this.cachedTextures[B][V])t.setTexture(this.cachedTextures[B][V]),j={top:0,left:0,right:1,bottom:1};else if("None"!==V){var X=b(this,this.texture_img,V,N,1,B);if(X!=this.texture_img){var G=this.runtime.glwrap.loadTexture(X,!1,this.runtime.linearSampling,this.type.texture_pixelformat);void 0===this.cachedTextures&&(this.cachedTextures={}),void 0===this.cachedTextures[B]&&(this.cachedTextures[B]={}),this.cachedTextures[B][V]=G,t.setTexture(G),j={top:0,left:0,right:1,bottom:1}}else t.setTexture(this.webGL_texture)}else t.setTexture(this.webGL_texture)}if(y+this.getCharacterWidth(B)*c>this.width+_)break;if(m&&(void 0===g[k]?(A=0,E=0,x=o):(A=g[k][0]*Math.cos(o)-g[k][1]*Math.sin(o)||0,E=g[k][1]*Math.cos(o)-g[k][0]*Math.sin(o)||0,x=cr.to_radians(g[k][2])||0,M=void 0!==g[k][3]&&null!==g[k][3]?g[k][3]/100:1),0!==x&&(I=Math.cos(x),P=Math.sin(x))),void 0!==j){var W=this.characterWidth*c,z=this.characterHeight*c;if(v.tlx=y,v.tly=O,v.trx=y+W,v.try_=O,v.blx=y,v.bly=O+z,v.brx=y+W,v.bry=O+z,m&&0!==x){var U=y+this.getCharacterWidth(B)*c/2,Y=O+l,J=Math.atan2(Y,U)+Math.PI-x,H=Math.sqrt(Math.pow(-U,2)+Math.pow(-Y,2)),q=-U-Math.cos(J)*H,K=-Y-Math.sin(J)*H;v.offset(q,K),w(v,I,P)}0!==o&&w(v,n,r),v.offset(T,C),m&&v.offset(A,E),t.setOpacity(this.opacity*M),t.quadTex(v.tlx,v.tly,v.trx,v.try_,v.brx,v.bry,v.blx,v.bly,j)}y+=this.getCharacterWidth(B)*c+p,m&&k++}if((O+=l)+l+u>this.height)break}}},i.update=function(){this.runtime.redraw=!0,this.lastValue+=Math.abs(60*this.runtime.getDt(this)),this.charPosProcessed=this.computeWholeArray(this.charPos.data)},i.computeWholeArray=function(t){var e=[];if(void 0!==this.typewriterParams&&this.typewriterActive&&!this.firstFrame)for(var i=0;i<t.length;i++){var s=t[i],n=this.typeProgress[i][0],r=null===this.typewriterParams.value.x?this.compute(s[0],i):cr.lerp(this.typewriterParams.value.x,this.compute(s[0],i),n),o=null===this.typewriterParams.value.y?this.compute(s[1],i):cr.lerp(this.typewriterParams.value.y,this.compute(s[1],i),n),a=null===this.typewriterParams.value.a?this.compute(s[2],i):cr.lerp(this.typewriterParams.value.a,this.compute(s[2],i),n),h=null===this.typewriterParams.value.o?this.compute(s[3],i,!0):cr.lerp(this.typewriterParams.value.o,this.compute(s[3],i,!0),n);e.push([r,o,a,h,s[4]])}else for(i=0;i<t.length;i++){s=t[i];e.push([this.compute(s[0],i),this.compute(s[1],i),this.compute(s[2],i),this.compute(s[3],i,!0),s[4]])}return e},i.compute=function(t,e,i){if(i=void 0!==i&&i,this.hasBehavior()||void 0!==this.animOffset||(this.animOffset=1,this.defaultMagnitude=0,this.defaultSpeed=100),"number"==typeof t)return t;if("object"==typeof t&&1==t.length)return this.compute(t[0],e);if("string"!=typeof t)return 0;var s=t.split(" "),n=s[0].trim().toLowerCase(),r=0,o=this.defaultSpeed,a=0;switch(r=void 0===s[1]||""==s[1].trim()||isNaN(parseInt(s[1].trim()))?i?100:(0===this.defaultMagnitude?this.characterHeight:this.defaultMagnitude)/(n.startsWith("angle")?1:4):parseInt(s[1].trim()),o=void 0===s[2]||""==s[2].trim()||isNaN(parseInt(s[2].trim()))?this.defaultSpeed:this.defaultSpeed*parseInt(s[2].trim())/100,a=void 0===s[3]||""==s[3].trim()||isNaN(parseInt(s[3].trim()))?0:parseInt(s[3].trim()),n){case"wave":case"angle":return Math.sin(10*cr.to_radians(this.lastValue*o/100)+e*this.animOffset)*r+a;case"swing":return Math.cos(10*cr.to_radians(this.lastValue*o/100)+e*this.animOffset*(i?-1:1))*r+a;case"angle2":return Math.cos(10*cr.to_radians(this.lastValue*o/100)+e*this.animOffset)*r+a;case"shake":return(Math.random()-.5)*r+a;default:var h=parseInt(n);return isNaN(h)?i?100:0:h}},i.hasBehavior=function(){if(void 0!==this.sfdxbehavior)return this.sfdxbehavior;this.sfdxbehavior=!1;var t=this;return this.behavior_insts.forEach(function(e){cr.behaviors.SkymenSFPPP&&e.behavior instanceof cr.behaviors.SkymenSFPPP&&(t.sfdxbehavior=!0)}),this.sfdxbehavior},x.prototype.CompareText=function(t,e){return e?this.text==t:cr.equals_nocase(this.text,t)},t.cnds=new x,S.prototype.SetText=function(t){cr.is_number(t)&&t<1e9&&(t=Math.round(1e10*t)/1e10);var e=t.toString();this.text!==e&&(this.text=e,this.text_changed=!0,this.runtime.redraw=!0)},S.prototype.AppendText=function(t){cr.is_number(t)&&(t=Math.round(1e10*t)/1e10);var e=t.toString();e&&(this.text+=e,this.text_changed=!0,this.runtime.redraw=!0)},S.prototype.SetScale=function(t){t!==this.characterScale&&(this.characterScale=t,this.text_changed=!0,this.runtime.redraw=!0)},S.prototype.SetCharacterSpacing=function(t){t!==this.CharacterSpacing&&(this.characterSpacing=t,this.text_changed=!0,this.runtime.redraw=!0)},S.prototype.SetLineHeight=function(t){t!==this.lineHeight&&(this.lineHeight=t,this.text_changed=!0,this.runtime.redraw=!0)},i.SetCharWidth=function(t,e){var i=parseInt(e,10);this.characterWidthList[t]!==i&&(this.characterWidthList[t]=i,this.text_changed=!0,this.runtime.redraw=!0)},S.prototype.SetCharacterWidth=function(t,e){if(""!==t)for(var i=0;i<t.length;i++)this.SetCharWidth(t.charAt(i),e)},S.prototype.SetEffect=function(t){this.compositeOp=cr.effectToCompositeOp(t),cr.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},S.prototype.SetVerAl=function(t){this.clamp?this.valign=cr.clamp(t,0,100)/100:this.valign=t/100,this.text_changed=!0,this.runtime.redraw=!0},S.prototype.SetHorAl=function(t){this.clamp?this.halign=cr.clamp(t,0,100)/100:this.halign=t/100,this.text_changed=!0,this.runtime.redraw=!0},S.prototype.SetAl=function(t,e){this.clamp?(this.halign=cr.clamp(t,0,100)/100,this.valign=cr.clamp(e,0,100)/100):(this.halign=t/100,this.valign=e/100),this.text_changed=!0,this.runtime.redraw=!0},S.prototype.SetWrap=function(t){this.wrapbyword=0===t,this.nowrap=2===t,this.text_changed=!0,this.runtime.redraw=!0},S.prototype.SetClamp=function(t){this.clamp=0===t,this.clamp?(this.halign=cr.clamp(this.halign,0,1),this.valign=cr.clamp(this.valign,0,1)):(this.halign=this.halign,this.valign=this.valign),this.text_changed=!0,this.runtime.redraw=!0},S.prototype.SetCharPos=function(t){this.charPos!==JSON.parse(t)&&(this.charPos=JSON.parse(t),this.text_changed=!0,this.runtime.redraw=!0)},S.prototype.Redraw=function(){this.update()},S.prototype.LoadURL=function(t,e,i,s){var n=new Image,r=this;this.characterWidth=i>0?i:this.characterWidth,this.characterHeight=s>0?s:this.characterHeight,n.onload=function(){r.texture_img=n,r.runtime.glwrap?(r.has_own_texture&&r.webGL_texture&&r.runtime.glwrap.deleteTexture(r.webGL_texture),r.webGL_texture=r.runtime.glwrap.loadTexture(n,!0,r.runtime.linearSampling)):r.pattern=r.runtime.ctx.createPattern(n,"repeat"),r.has_own_texture=!0,r.runtime.redraw=!0,r.runtime.trigger(cr.plugins_.SkymenSFPlusPLus.prototype.cnds.OnURLLoaded,r)},"data:"!==t.substr(0,5)&&0===e&&(n.crossOrigin="anonymous"),this.runtime.setImageSrc(n,t)},t.acts=new S,T.prototype.CharacterWidth=function(t,e){t.set_int(this.getCharacterWidth(e))},T.prototype.CharacterHeight=function(t){t.set_int(this.characterHeight)},T.prototype.CharacterScale=function(t){t.set_float(this.characterScale)},T.prototype.CharacterSpacing=function(t){t.set_int(this.characterSpacing)},T.prototype.LineHeight=function(t){t.set_int(this.lineHeight)},T.prototype.Text=function(t){t.set_string(this.text)},T.prototype.TextWidth=function(t){this.rebuildText(),t.set_float(this.textWidth)},T.prototype.TextHeight=function(t){this.rebuildText(),t.set_float(this.textHeight)},T.prototype.FullTextWidth=function(t){t.set_float(this.measureWidth(this.text))},T.prototype.HAlign=function(t){t.set_float(this.halign)},T.prototype.VAlign=function(t){t.set_float(this.valign)},T.prototype.CharPos=function(t){t.set_string(this.charPos)},t.exps=new T}(),cr.plugins_.Sprite=function(t){this.runtime=t},function(){var t=cr.plugins_.Sprite.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;function i(){if(0===this.datauri.length){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var e=t.getContext("2d");this.spritesheeted?e.drawImage(this.texture_img,this.offx,this.offy,this.width,this.height,0,0,this.width,this.height):e.drawImage(this.texture_img,0,0,this.width,this.height),this.datauri=t.toDataURL("image/png")}return this.datauri}e.onCreate=function(){var t,e,s,n,r,o,a,h,c,l;if(!this.is_family)for(this.all_frames=[],this.has_loaded_textures=!1,t=0,e=this.animations.length;t<e;t++){for(r=this.animations[t],(a={}).name=r[0],a.speed=r[1],a.loop=r[2],a.repeatcount=r[3],a.repeatto=r[4],a.pingpong=r[5],a.sid=r[6],a.frames=[],s=0,n=r[7].length;s<n;s++)o=r[7][s],(h={}).texture_file=o[0],h.texture_filesize=o[1],h.offx=o[2],h.offy=o[3],h.width=o[4],h.height=o[5],h.duration=o[6],h.hotspotX=o[7],h.hotspotY=o[8],h.image_points=o[9],h.poly_pts=o[10],h.pixelformat=o[11],h.spritesheeted=0!==h.width,h.datauri="",h.getDataUri=i,(l={}).left=0,l.top=0,l.right=1,l.bottom=1,h.sheetTex=l,h.webGL_texture=null,(c=this.runtime.findWaitingTexture(o[0]))?h.texture_img=c:(h.texture_img=new Image,h.texture_img.cr_src=o[0],h.texture_img.cr_filesize=o[1],h.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(h.texture_img,o[0])),cr.seal(h),a.frames.push(h),this.all_frames.push(h);cr.seal(a),this.animations[t]=a}},e.updateAllCurrentTexture=function(){var t,e,i;for(t=0,e=this.instances.length;t<e;t++)(i=this.instances[t]).curWebGLTexture=i.curFrame.webGL_texture},e.onLostWebGLContext=function(){if(!this.is_family){var t,e,i;for(t=0,e=this.all_frames.length;t<e;++t)(i=this.all_frames[t]).texture_img.c2webGL_texture=null,i.webGL_texture=null;this.has_loaded_textures=!1,this.updateAllCurrentTexture()}},e.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length){var t,e,i;for(t=0,e=this.all_frames.length;t<e;++t)(i=this.all_frames[t]).webGL_texture=this.runtime.glwrap.loadTexture(i.texture_img,!1,this.runtime.linearSampling,i.pixelformat);this.updateAllCurrentTexture()}},e.loadTextures=function(){if(!this.is_family&&!this.has_loaded_textures&&this.runtime.glwrap){var t,e,i;for(t=0,e=this.all_frames.length;t<e;++t)(i=this.all_frames[t]).webGL_texture=this.runtime.glwrap.loadTexture(i.texture_img,!1,this.runtime.linearSampling,i.pixelformat);this.has_loaded_textures=!0}},e.unloadTextures=function(){if(!this.is_family&&!this.instances.length&&this.has_loaded_textures){var t,e,i;for(t=0,e=this.all_frames.length;t<e;++t)i=this.all_frames[t],this.runtime.glwrap.deleteTexture(i.webGL_texture),i.webGL_texture=null;this.has_loaded_textures=!1}};var s=[];e.preloadCanvas2D=function(t){var e,i,n;for(cr.clearArray(s),e=0,i=this.all_frames.length;e<i;++e)n=this.all_frames[e].texture_img,-1===s.indexOf(n)&&(t.drawImage(n,0,0),s.push(n))},t.Instance=function(t){this.type=t,this.runtime=t.runtime;var e=this.type.animations[0].frames[0].poly_pts;this.recycled?this.collision_poly.set_pts(e):this.collision_poly=new cr.CollisionPoly(e)};var n=t.Instance.prototype;function r(){}n.onCreate=function(){this.visible=0===this.properties[0],this.isTicking=!1,this.inAnimTrigger=!1,this.collisionsEnabled=0!==this.properties[3],this.cur_animation=this.getAnimationByName(this.properties[1])||this.type.animations[0],this.cur_frame=this.properties[2],this.cur_frame<0&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);var t,e,i,s,n,r,o,a,h=this.cur_animation.frames[this.cur_frame];for(this.collision_poly.set_pts(h.poly_pts),this.hotspotX=h.hotspotX,this.hotspotY=h.hotspotY,this.cur_anim_speed=this.cur_animation.speed,this.cur_anim_repeatto=this.cur_animation.repeatto,1===this.type.animations.length&&1===this.type.animations[0].frames.length||0===this.cur_anim_speed||(this.runtime.tickMe(this),this.isTicking=!0),this.recycled?this.animTimer.reset():this.animTimer=new cr.KahanAdder,this.frameStart=this.getNowTime(),this.animPlaying=!0,this.animRepeats=0,this.animForwards=!0,this.animTriggerName="",this.changeAnimName="",this.changeAnimFrom=0,this.changeAnimFrame=-1,this.type.loadTextures(),t=0,e=this.type.animations.length;t<e;t++)for(i=0,s=(n=this.type.animations[t]).frames.length;i<s;i++)0===(r=n.frames[i]).width&&(r.width=r.texture_img.width,r.height=r.texture_img.height),r.spritesheeted&&(a=r.texture_img,(o=r.sheetTex).left=r.offx/a.width,o.top=r.offy/a.height,o.right=(r.offx+r.width)/a.width,o.bottom=(r.offy+r.height)/a.height,0===r.offx&&0===r.offy&&r.width===a.width&&r.height===a.height&&(r.spritesheeted=!1));this.curFrame=this.cur_animation.frames[this.cur_frame],this.curWebGLTexture=this.curFrame.webGL_texture},n.saveToJSON=function(){var t={a:this.cur_animation.sid,f:this.cur_frame,cas:this.cur_anim_speed,fs:this.frameStart,ar:this.animRepeats,at:this.animTimer.sum,rt:this.cur_anim_repeatto};return this.animPlaying||(t.ap=this.animPlaying),this.animForwards||(t.af=this.animForwards),t},n.loadFromJSON=function(t){var e=this.getAnimationBySid(t.a);e&&(this.cur_animation=e),this.cur_frame=t.f,this.cur_frame<0&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1),this.cur_anim_speed=t.cas,this.frameStart=t.fs,this.animRepeats=t.ar,this.animTimer.reset(),this.animTimer.sum=t.at,this.animPlaying=!t.hasOwnProperty("ap")||t.ap,this.animForwards=!t.hasOwnProperty("af")||t.af,t.hasOwnProperty("rt")?this.cur_anim_repeatto=t.rt:this.cur_anim_repeatto=this.cur_animation.repeatto,this.curFrame=this.cur_animation.frames[this.cur_frame],this.curWebGLTexture=this.curFrame.webGL_texture,this.collision_poly.set_pts(this.curFrame.poly_pts),this.hotspotX=this.curFrame.hotspotX,this.hotspotY=this.curFrame.hotspotY},n.animationFinish=function(t){this.cur_frame=t?0:this.cur_animation.frames.length-1,this.animPlaying=!1,this.animTriggerName=this.cur_animation.name,this.inAnimTrigger=!0,this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnyAnimFinished,this),this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnimFinished,this),this.inAnimTrigger=!1,this.animRepeats=0},n.getNowTime=function(){return this.animTimer.sum},n.tick=function(){this.animTimer.add(this.runtime.getDt(this)),this.changeAnimName.length&&this.doChangeAnim(),this.changeAnimFrame>=0&&this.doChangeAnimFrame();var t,e=this.getNowTime(),i=this.cur_animation,s=i.frames[this.cur_frame],n=s.duration/this.cur_anim_speed;this.animPlaying&&e>=this.frameStart+n&&(this.animForwards?this.cur_frame++:this.cur_frame--,this.frameStart+=n,this.cur_frame>=i.frames.length&&(i.pingpong?(this.animForwards=!1,this.cur_frame=i.frames.length-2):i.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=i.repeatcount?this.animationFinish(!1):this.cur_frame=this.cur_anim_repeatto)),this.cur_frame<0&&(i.pingpong?(this.cur_frame=1,this.animForwards=!0,i.loop||(this.animRepeats++,this.animRepeats>=i.repeatcount&&this.animationFinish(!0))):i.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=i.repeatcount?this.animationFinish(!0):this.cur_frame=this.cur_anim_repeatto)),this.cur_frame<0?this.cur_frame=0:this.cur_frame>=i.frames.length&&(this.cur_frame=i.frames.length-1),e>this.frameStart+i.frames[this.cur_frame].duration/this.cur_anim_speed&&(this.frameStart=e),t=i.frames[this.cur_frame],this.OnFrameChanged(s,t),this.runtime.redraw=!0)},n.getAnimationByName=function(t){var e,i,s;for(e=0,i=this.type.animations.length;e<i;e++)if(s=this.type.animations[e],cr.equals_nocase(s.name,t))return s;return null},n.getAnimationBySid=function(t){var e,i,s;for(e=0,i=this.type.animations.length;e<i;e++)if((s=this.type.animations[e]).sid===t)return s;return null},n.doChangeAnim=function(){var t=this.cur_animation.frames[this.cur_frame],e=this.getAnimationByName(this.changeAnimName);this.changeAnimName="",e&&(cr.equals_nocase(e.name,this.cur_animation.name)&&this.animPlaying||(this.cur_animation=e,this.cur_anim_speed=e.speed,this.cur_anim_repeatto=e.repeatto,this.cur_frame<0&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1),1===this.changeAnimFrom&&(this.cur_frame=0),this.animPlaying=!0,this.frameStart=this.getNowTime(),this.animForwards=!0,this.OnFrameChanged(t,this.cur_animation.frames[this.cur_frame]),this.runtime.redraw=!0))},n.doChangeAnimFrame=function(){var t=this.cur_animation.frames[this.cur_frame],e=this.cur_frame;this.cur_frame=cr.floor(this.changeAnimFrame),this.cur_frame<0&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1),e!==this.cur_frame&&(this.OnFrameChanged(t,this.cur_animation.frames[this.cur_frame]),this.frameStart=this.getNowTime(),this.runtime.redraw=!0),this.changeAnimFrame=-1},n.OnFrameChanged=function(t,e){var i,s,n,r=t.width,o=t.height,a=e.width,h=e.height;for(r!=a&&(this.width*=a/r),o!=h&&(this.height*=h/o),this.hotspotX=e.hotspotX,this.hotspotY=e.hotspotY,this.collision_poly.set_pts(e.poly_pts),this.set_bbox_changed(),this.curFrame=e,this.curWebGLTexture=e.webGL_texture,i=0,s=this.behavior_insts.length;i<s;i++)(n=this.behavior_insts[i]).onSpriteFrameChanged&&n.onSpriteFrameChanged(t,e);this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnFrameChanged,this)},n.draw=function(t){t.globalAlpha=this.opacity;var e=this.curFrame,i=e.spritesheeted,s=e.texture_img,n=this.x,r=this.y,o=this.width,a=this.height;if(0===this.angle&&o>=0&&a>=0)n-=this.hotspotX*o,r-=this.hotspotY*a,this.runtime.pixel_rounding&&(n=Math.round(n),r=Math.round(r)),i?t.drawImage(s,e.offx,e.offy,e.width,e.height,n,r,o,a):t.drawImage(s,n,r,o,a);else{this.runtime.pixel_rounding&&(n=Math.round(n),r=Math.round(r)),t.save();var h=o>0?1:-1,c=a>0?1:-1;t.translate(n,r),1===h&&1===c||t.scale(h,c),t.rotate(this.angle*h*c);var l=0-this.hotspotX*cr.abs(o),u=0-this.hotspotY*cr.abs(a);i?t.drawImage(s,e.offx,e.offy,e.width,e.height,l,u,cr.abs(o),cr.abs(a)):t.drawImage(s,l,u,cr.abs(o),cr.abs(a)),t.restore()}},n.drawGL_earlyZPass=function(t){this.drawGL(t)},n.drawGL=function(t){t.setTexture(this.curWebGLTexture),t.setOpacity(this.opacity);var e=this.curFrame,i=this.bquad;if(this.runtime.pixel_rounding){var s=Math.round(this.x)-this.x,n=Math.round(this.y)-this.y;e.spritesheeted?t.quadTex(i.tlx+s,i.tly+n,i.trx+s,i.try_+n,i.brx+s,i.bry+n,i.blx+s,i.bly+n,e.sheetTex):t.quad(i.tlx+s,i.tly+n,i.trx+s,i.try_+n,i.brx+s,i.bry+n,i.blx+s,i.bly+n)}else e.spritesheeted?t.quadTex(i.tlx,i.tly,i.trx,i.try_,i.brx,i.bry,i.blx,i.bly,e.sheetTex):t.quad(i.tlx,i.tly,i.trx,i.try_,i.brx,i.bry,i.blx,i.bly)},n.getImagePointIndexByName=function(t){var e,i,s=this.curFrame;for(e=0,i=s.image_points.length;e<i;e++)if(cr.equals_nocase(t,s.image_points[e][0]))return e;return-1},n.getImagePoint=function(t,e){var i,s=this.curFrame,n=s.image_points;if(i=cr.is_string(t)?this.getImagePointIndexByName(t):t-1,(i=cr.floor(i))<0||i>=n.length)return e?this.x:this.y;var r=(n[i][1]-s.hotspotX)*this.width,o=n[i][2];o=(o-s.hotspotY)*this.height;var a=Math.cos(this.angle),h=Math.sin(this.angle),c=r*a-o*h;return o=o*a+r*h,r=c,r+=this.x,o+=this.y,e?r:o};var o=[];function a(t){t[0]=0,t[1]=0,t[2]=0,o.push(t)}function h(t,e){return t<e?t+","+e:e+","+t}function c(t,e,i,s){var n=e.uid,r=i.uid,a=h(n,r);if(t.hasOwnProperty(a))t[a][2]=s;else{var c=o.length?o.pop():[0,0,0];c[0]=n,c[1]=r,c[2]=s,t[a]=c}}function l(t,e,i){var s=h(e.uid,i.uid);t.hasOwnProperty(s)&&(a(t[s]),delete t[s])}var u=-2;function p(t,e,i){var s=h(e.uid,i.uid);return t.hasOwnProperty(s)?(u=t[s][2],!0):(u=-2,!1)}var d=[];r.prototype.OnCollision=function(t){if(!t)return!1;var e=this.runtime,i=e.getCurrentCondition(),s=i.type,n=null;i.extra.collmemory?n=i.extra.collmemory:(n={},i.extra.collmemory=n),i.extra.spriteCreatedDestroyCallback||(i.extra.spriteCreatedDestroyCallback=!0,e.addDestroyCallback(function(t){!function(t,e){var i,s,n=e.uid;for(i in t)t.hasOwnProperty(i)&&((s=t[i])[0]!==n&&s[1]!==n||(a(t[i]),delete t[i]))}(i.extra.collmemory,t)}));var r,o,h,f,g,m,y,_,v=s.getCurrentSol(),b=t.getCurrentSol(),w=v.getObjects(),x=this.runtime.tickcount,S=x-1,T=e.getCurrentEventStack().current_event;T.orblock;for(o=0;o<w.length;o++){for(h=w[o],b.select_all?(h.update_bbox(),this.runtime.getCollisionCandidates(h.layer,t,h.bbox,d),r=d,this.runtime.addRegisteredCollisionCandidates(h,t,r)):r=b.getObjects(),f=0;f<r.length;f++)g=r[f],e.testOverlap(h,g)||e.checkRegisteredCollision(h,g)?(_=!p(n,h,g)||u<S,c(n,h,g,x),_&&(e.pushCopySol(T.solModifiers),m=s.getCurrentSol(),y=t.getCurrentSol(),m.select_all=!1,y.select_all=!1,s===t?(m.instances.length=2,m.instances[0]=h,m.instances[1]=g,s.applySolToContainer()):(m.instances.length=1,y.instances.length=1,m.instances[0]=h,y.instances[0]=g,s.applySolToContainer(),t.applySolToContainer()),T.retrigger(),e.popSol(T.solModifiers))):l(n,h,g);cr.clearArray(d)}return!1};var f=null,g=new cr.ObjectSet,m=!1,y=[],_=new cr.rect(0,0,0,0);function v(t,e,i){if(!t)return!1;var s,n,r,o,a,h,c=0!==e||0!==i,l=!1,u=this.runtime.getCurrentCondition(),p=u.type,d=u.inverted,v=t.getCurrentSol(),b=this.runtime.getCurrentEventStack().current_event.orblock;for(v.select_all?(this.update_bbox(),_.copy(this.bbox),_.offset(e,i),this.runtime.getCollisionCandidates(this.layer,t,_,y),h=y):h=b?this.runtime.isCurrentConditionFirst()&&!v.else_instances.length&&v.instances.length?v.instances:v.else_instances:v.instances,f=t,m=p!==t&&!d,c&&(s=this.x,n=this.y,this.x+=e,this.y+=i,this.set_bbox_changed()),r=0,o=h.length;r<o;r++)if(a=h[r],this.runtime.testOverlap(this,a)){if(l=!0,d)break;p!==t&&g.add(a)}return c&&(this.x=s,this.y=n,this.set_bbox_changed()),cr.clearArray(y),l}function b(){}function w(){}e.finish=function(t){if(m){if(t){var e,i,s,n=this.runtime.getCurrentEventStack().current_event.orblock,r=f.getCurrentSol(),o=g.valuesRef();if(r.select_all){for(r.select_all=!1,cr.clearArray(r.instances),e=0,i=o.length;e<i;++e)r.instances[e]=o[e];if(n)for(cr.clearArray(r.else_instances),e=0,i=f.instances.length;e<i;++e)s=f.instances[e],g.contains(s)||r.else_instances.push(s)}else if(n){var a=r.instances.length;for(e=0,i=o.length;e<i;++e)r.instances[a+e]=o[e],cr.arrayFindRemove(r.else_instances,o[e])}else cr.shallowAssignArray(r.instances,o);f.applySolToContainer()}g.clear(),m=!1}},r.prototype.IsOverlapping=function(t){return v.call(this,t,0,0)},r.prototype.IsOverlappingOffset=function(t,e,i){return v.call(this,t,e,i)},r.prototype.IsAnimPlaying=function(t){return this.changeAnimName.length?cr.equals_nocase(this.changeAnimName,t):cr.equals_nocase(this.cur_animation.name,t)},r.prototype.CompareFrame=function(t,e){return cr.do_cmp(this.cur_frame,t,e)},r.prototype.CompareAnimSpeed=function(t,e){var i=this.animForwards?this.cur_anim_speed:-this.cur_anim_speed;return cr.do_cmp(i,t,e)},r.prototype.OnAnimFinished=function(t){return cr.equals_nocase(this.animTriggerName,t)},r.prototype.OnAnyAnimFinished=function(){return!0},r.prototype.OnFrameChanged=function(){return!0},r.prototype.IsMirrored=function(){return this.width<0},r.prototype.IsFlipped=function(){return this.height<0},r.prototype.OnURLLoaded=function(){return!0},r.prototype.IsCollisionEnabled=function(){return this.collisionsEnabled},t.cnds=new r,b.prototype.Spawn=function(t,e,i){if(t&&e){var s=this.runtime.createInstance(t,e,this.getImagePoint(i,!0),this.getImagePoint(i,!1));if(s){var n,r,o;if(void 0!==s.angle&&(s.angle=this.angle,s.set_bbox_changed()),this.runtime.isInOnDestroy++,this.runtime.trigger(Object.getPrototypeOf(t.plugin).cnds.OnCreated,s),s.is_contained)for(n=0,r=s.siblings.length;n<r;n++)o=s.siblings[n],this.runtime.trigger(Object.getPrototypeOf(o.type.plugin).cnds.OnCreated,o);this.runtime.isInOnDestroy--;var a,h=this.runtime.getCurrentAction(),c=!1;if((cr.is_undefined(h.extra.Spawn_LastExec)||h.extra.Spawn_LastExec<this.runtime.execcount)&&(c=!0,h.extra.Spawn_LastExec=this.runtime.execcount),t!=this.type&&((a=t.getCurrentSol()).select_all=!1,c?(cr.clearArray(a.instances),a.instances[0]=s):a.instances.push(s),s.is_contained))for(n=0,r=s.siblings.length;n<r;n++)(a=(o=s.siblings[n]).type.getCurrentSol()).select_all=!1,c?(cr.clearArray(a.instances),a.instances[0]=o):a.instances.push(o)}}},b.prototype.SetEffect=function(t){this.blend_mode=t,this.compositeOp=cr.effectToCompositeOp(t),cr.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},b.prototype.StopAnim=function(){this.animPlaying=!1},b.prototype.StartAnim=function(t){this.animPlaying=!0,this.frameStart=this.getNowTime(),1===t&&0!==this.cur_frame&&(this.changeAnimFrame=0,this.inAnimTrigger||this.doChangeAnimFrame()),this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)},b.prototype.SetAnim=function(t,e){this.changeAnimName=t,this.changeAnimFrom=e,this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0),this.inAnimTrigger||this.doChangeAnim()},b.prototype.SetAnimFrame=function(t){this.changeAnimFrame=t,this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0),this.inAnimTrigger||this.doChangeAnimFrame()},b.prototype.SetAnimSpeed=function(t){this.cur_anim_speed=cr.abs(t),this.animForwards=t>=0,this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)},b.prototype.SetAnimRepeatToFrame=function(t){(t=Math.floor(t))<0&&(t=0),t>=this.cur_animation.frames.length&&(t=this.cur_animation.frames.length-1),this.cur_anim_repeatto=t},b.prototype.SetMirrored=function(t){var e=cr.abs(this.width)*(0===t?-1:1);this.width!==e&&(this.width=e,this.set_bbox_changed())},b.prototype.SetFlipped=function(t){var e=cr.abs(this.height)*(0===t?-1:1);this.height!==e&&(this.height=e,this.set_bbox_changed())},b.prototype.SetScale=function(t){var e=this.curFrame,i=this.width<0?-1:1,s=this.height<0?-1:1,n=e.width*t*i,r=e.height*t*s;this.width===n&&this.height===r||(this.width=n,this.height=r,this.set_bbox_changed())},b.prototype.LoadURL=function(t,e,i){var s=new Image,n=this,r=this.curFrame;s.onload=function(){if(r.texture_img.src===s.src)return n.runtime.glwrap&&n.curFrame===r&&(n.curWebGLTexture=r.webGL_texture),0===e&&(n.width=s.width,n.height=s.height,n.set_bbox_changed()),n.runtime.redraw=!0,void n.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnURLLoaded,n);r.texture_img=s,r.offx=0,r.offy=0,r.width=s.width,r.height=s.height,r.spritesheeted=!1,r.datauri="",r.pixelformat=0,n.runtime.glwrap&&(r.webGL_texture&&n.runtime.glwrap.deleteTexture(r.webGL_texture),r.webGL_texture=n.runtime.glwrap.loadTexture(s,!1,n.runtime.linearSampling),n.curFrame===r&&(n.curWebGLTexture=r.webGL_texture),n.type.updateAllCurrentTexture()),0===e&&(n.width=s.width,n.height=s.height,n.set_bbox_changed()),n.runtime.redraw=!0,n.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnURLLoaded,n)},"data:"!==t.substr(0,5)&&0===i&&(s.crossOrigin="anonymous"),this.runtime.setImageSrc(s,t)},b.prototype.SetCollisions=function(t){this.collisionsEnabled!==(0!==t)&&(this.collisionsEnabled=0!==t,this.collisionsEnabled?this.set_bbox_changed():(this.collcells.right>=this.collcells.left&&this.type.collision_grid.update(this,this.collcells,null),this.collcells.set(0,0,-1,-1)))},t.acts=new b,w.prototype.AnimationFrame=function(t){t.set_int(this.cur_frame)},w.prototype.AnimationFrameCount=function(t){t.set_int(this.cur_animation.frames.length)},w.prototype.AnimationName=function(t){t.set_string(this.cur_animation.name)},w.prototype.AnimationSpeed=function(t){t.set_float(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed)},w.prototype.ImagePointX=function(t,e){t.set_float(this.getImagePoint(e,!0))},w.prototype.ImagePointY=function(t,e){t.set_float(this.getImagePoint(e,!1))},w.prototype.ImagePointCount=function(t){t.set_int(this.curFrame.image_points.length)},w.prototype.ImageWidth=function(t){t.set_float(this.curFrame.width)},w.prototype.ImageHeight=function(t){t.set_float(this.curFrame.height)},t.exps=new w}(),cr.plugins_.SyncStorage=function(t){this.runtime=t},function(){var t=cr.plugins_.SyncStorage.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}function n(){}e.onCreate=function(){this.data={},this.isStorageLoaded=!1,this.storageIndex=this.properties[1],this.isEncodingEnabled=!this.properties[3],this.headSalt=this.properties[4],this.tailSalt=this.properties[5],this.isLocalStorageLoaded=null,this.LS_Instance=null,this.LS_ProtoActions=null,this.lastErrorMsg=null},e.onDestroy=function(){},e.isLocalStorageReady=function(){if(this.isLocalStorageLoaded)return!0;if(!this.storageIndex)return!1;if(cr.plugins_.LocalStorage){var t,e;for(t in this.runtime.types)this.runtime.types.hasOwnProperty(t)&&this.runtime.types[t].plugin instanceof cr.plugins_.LocalStorage&&(e=this.runtime.types[t]);if(e)return this.LS_Instance=e.instances[0],this.LS_ProtoActions=cr.plugins_.LocalStorage.prototype.acts,this.isLocalStorageLoaded=!0,!0}return console.log("\n*\n*\n*\nERROR: LocalStorage plugin not found. You must add LocalStorage plugin to the project. It's a JS library for SyncStorage plugin.\n*\n*\n*\n"),!1},i.prototype.OnLoaded=function(){return!0},i.prototype.OnLoadError=function(){return!0},i.prototype.IsLoaded=function(){return this.isStorageLoaded},i.prototype.HasData=function(t){return this.hasData(t)},i.prototype.CompareData=function(t,e,i){return cr.do_cmp(this.data[t],e,i)},i.prototype.OnSave=function(){return!0},i.prototype.OnDataMissing=function(){return!0},t.cnds=new i,s.prototype.SetData=function(t,e){this.data[t]=e},s.prototype.SaveData=function(){this.isLocalStorageReady()&&this.LS_ProtoActions.SetItem.call(this.LS_Instance,this.storageIndex,this.isEncodingEnabled?this.encode(JSON.stringify(this.data)):JSON.stringify(this.data)),this.runtime.trigger(cr.plugins_.SyncStorage.prototype.cnds.OnSave,this)},s.prototype.LoadData=function(){if(!this.isLocalStorageReady())return this.lastErrorMsg='Could not load data from LocalStorage. Possible reasons: "LocalStorage IDX" property not set or LocalStorage plugin is not added to the project.',this.runtime.trigger(cr.plugins_.SyncStorage.prototype.cnds.OnLoadError,this),void(this.lastErrorMsg="");var t=this;localforage.getItem(this.storageIndex,function(e,i){e?(e?"string"==typeof e.message?e=e.message:"string"==typeof e.name?e=e.name:"string"==typeof e.data?e=e.data:"string"!=typeof e&&(e="unknown error"):e="unknown error",t.isStorageLoaded=!1,t.lastErrorMsg=e,t.runtime.trigger(cr.plugins_.SyncStorage.prototype.cnds.OnLoadError,t),t.lastErrorMsg=null):(null==i||""===i?(t.data={},t.runtime.trigger(cr.plugins_.SyncStorage.prototype.cnds.OnDataMissing,t)):t.data=t.isEncodingEnabled?JSON.parse(t.decode(i)):JSON.parse(i),t.isStorageLoaded=!0,t.runtime.trigger(cr.plugins_.SyncStorage.prototype.cnds.OnLoaded,t))})},s.prototype.ClearData=function(){this.data={}},s.prototype.RemoveData=function(t){void 0!==this.data[t]&&delete this.data[t]},s.prototype.LoadString=function(t){try{""==t?(this.data={},this.runtime.trigger(cr.plugins_.SyncStorage.prototype.cnds.OnDataMissing,this)):"{"===t.charAt(0)?this.data=JSON.parse(t):this.data=JSON.parse(this.decode(t)),this.runtime.trigger(cr.plugins_.SyncStorage.prototype.cnds.OnLoaded,this)}catch(t){this.lastErrorMsg=t.message,this.runtime.trigger(cr.plugins_.SyncStorage.prototype.cnds.OnLoadError,this),this.lastErrorMsg=""}},s.prototype.AddValue=function(t,e){this.hasData(t)||(this.data[t]=0),!isNaN(parseFloat(e))&&isFinite(e)&&(this.data[t]+=e)},s.prototype.SubtractValue=function(t,e){this.hasData(t)||(this.data[t]=0),!isNaN(parseFloat(e))&&isFinite(e)&&(this.data[t]-=e)},s.prototype.AppendValue=function(t,e){this.hasData(t)||(this.data[t]=""),"string"==typeof e&&(this.data[t]+=e)},s.prototype.PrependValue=function(t,e){this.hasData(t)||(this.data[t]=""),"string"==typeof e&&(this.data[t]=e+this.data[t])},t.acts=new s,n.prototype.GetData=function(t,e){t.set_any(this.data[e])},n.prototype.StorageIndex=function(t){t.set_string(this.storageIndex)},n.prototype.HasData=function(t,e){t.set_int(+this.hasData(e))},n.prototype.AsJSON=function(t){t.set_string(JSON.stringify(this.data))},n.prototype.AsString=function(t){t.set_string(this.isEncodingEnabled?this.encode(JSON.stringify(this.data)):JSON.stringify(this.data))},n.prototype.ErrorMsg=function(t){t.set_string(this.lastErrorMsg)},n.prototype.Get=function(t,e){t.set_any(this.data[e])},n.prototype.Has=function(t,e){t.set_int(+this.hasData(e))},e.encode=function(t){var e,i=r.encode(t);for(e=0;e<this.headSalt;e++)i=i.charAt(Math.floor(Math.random()*(i.length-1)))+i;for(e=0;e<this.tailSalt;e++)i+=i.charAt(Math.floor(Math.random()*(i.length-1)));return i},e.decode=function(t){var e=t.substring(this.headSalt);return e=e.substring(0,e.length-this.tailSalt),e=r.decode(e)},e.hasData=function(t){return!!this.data[t]},t.exps=new n;var r={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){var e,i,s,n,o,a,h,c="",l=0;for(t=r._utf8_encode(t);l<t.length;)n=(e=t.charCodeAt(l++))>>2,o=(3&e)<<4|(i=t.charCodeAt(l++))>>4,a=(15&i)<<2|(s=t.charCodeAt(l++))>>6,h=63&s,isNaN(i)?a=h=64:isNaN(s)&&(h=64),c=c+this._keyStr.charAt(n)+this._keyStr.charAt(o)+this._keyStr.charAt(a)+this._keyStr.charAt(h);return c},decode:function(t){var e,i,s,n,o,a,h="",c=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<t.length;)e=this._keyStr.indexOf(t.charAt(c++))<<2|(n=this._keyStr.indexOf(t.charAt(c++)))>>4,i=(15&n)<<4|(o=this._keyStr.indexOf(t.charAt(c++)))>>2,s=(3&o)<<6|(a=this._keyStr.indexOf(t.charAt(c++))),h+=String.fromCharCode(e),64!=o&&(h+=String.fromCharCode(i)),64!=a&&(h+=String.fromCharCode(s));return r._utf8_decode(h)},_utf8_encode:function(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var s=t.charCodeAt(i);s<128?e+=String.fromCharCode(s):s>127&&s<2048?(e+=String.fromCharCode(s>>6|192),e+=String.fromCharCode(63&s|128)):(e+=String.fromCharCode(s>>12|224),e+=String.fromCharCode(s>>6&63|128),e+=String.fromCharCode(63&s|128))}return e},_utf8_decode:function(t){for(var e="",i=0,s=0,n=0,r=0;i<t.length;)(s=t.charCodeAt(i))<128?(e+=String.fromCharCode(s),i++):s>191&&s<224?(n=t.charCodeAt(i+1),e+=String.fromCharCode((31&s)<<6|63&n),i+=2):(n=t.charCodeAt(i+1),r=t.charCodeAt(i+2),e+=String.fromCharCode((15&s)<<12|(63&n)<<6|63&r),i+=3);return e}}}(),cr.plugins_.TR_AdBlockDetector=function(t){this.runtime=t},function(){var t=cr.plugins_.TR_AdBlockDetector.prototype;function e(){}function i(){}t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime},t.Instance.prototype.onCreate=function(){this.adblock=!1;var t=this,e=new XMLHttpRequest;e.onreadystatechange=function(){4===this.readyState&&0===this.status&&(t.adblock=!1)},e.open("GET","https://api.adinplay.com/libs/aiptag/assets/adsbygoogle.js",!0),e.send()},e.prototype.IsBlocking=function(){return this.adblock},e.prototype.IsReady=function(){return!0},t.cnds=new e,t.acts=new function(){},i.prototype.IsBlocking=function(t){t.set_int(+this.adblock)},t.exps=new i}(),cr.plugins_.TR_ClockParser=function(t){this.runtime=t},function(){var t=cr.plugins_.TR_ClockParser.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}e.onCreate=function(){},e.onDestroy=function(){},t.cnds=new function(){},t.acts=new function(){},i.prototype.Minimal=function(t,e){e=parseInt(e,10);var i=Math.floor(e/3600),s=Math.floor((e-3600*i)/60),n=e-3600*i-60*s,r="";i>0&&(r+=(i<10?"0"+i:i)+":"),(i>0||s>0)&&(r+=(s<10?"0"+s:s)+":"),r+=n<10?"0"+n:n,t.set_string(r)},i.prototype.MMSS=function(t,e){e=parseInt(e,10);var i=Math.floor(e/60),s=e-60*i;i<10&&(i="0"+i),s<10&&(s="0"+s),t.set_string(i+":"+s)},i.prototype.HHMMSS=function(t,e){e=parseInt(e,10);var i=Math.floor(e/3600),s=Math.floor((e-3600*i)/60),n=e-3600*i-60*s;i<10&&(i="0"+i),s<10&&(s="0"+s),n<10&&(n="0"+n),t.set_string(i+":"+s+":"+n)},t.exps=new i}(),cr.plugins_.Text=function(t){this.runtime=t},function(){var t=cr.plugins_.Text.prototype;t.onCreate=function(){t.acts.SetWidth=function(t){this.width!==t&&(this.width=t,this.text_changed=!0,this.set_bbox_changed())}},t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){},e.onLostWebGLContext=function(){var t,e,i;if(!this.is_family)for(t=0,e=this.instances.length;t<e;t++)(i=this.instances[t]).mycanvas=null,i.myctx=null,i.mytex=null},t.Instance=function(t){this.type=t,this.runtime=t.runtime,this.recycled?cr.clearArray(this.lines):this.lines=[],this.text_changed=!0};var i=t.Instance.prototype,s={};i.onCreate=function(){this.text=this.properties[0],this.visible=0===this.properties[1],this.font=this.properties[2],this.color=this.properties[3],this.halign=this.properties[4],this.valign=this.properties[5],this.wrapbyword=0===this.properties[7],this.lastwidth=this.width,this.lastwrapwidth=this.width,this.lastheight=this.height,this.line_height_offset=this.properties[8],this.facename="",this.fontstyle="",this.ptSize=0,this.textWidth=0,this.textHeight=0,this.parseFont(),this.mycanvas=null,this.myctx=null,this.mytex=null,this.need_text_redraw=!1,this.last_render_tick=this.runtime.tickcount,this.recycled?this.rcTex.set(0,0,1,1):this.rcTex=new cr.rect(0,0,1,1),this.runtime.glwrap&&this.runtime.tickMe(this)},i.parseFont=function(){var t,e=this.font.split(" ");for(t=0;t<e.length;t++)if("pt"===e[t].substr(e[t].length-2,2)){for(this.ptSize=parseInt(e[t].substr(0,e[t].length-2)),this.pxHeight=Math.ceil(this.ptSize/72*96)+4,t>0&&(this.fontstyle=e[t-1]),this.facename=e[t+1],t+=2;t<e.length;t++)this.facename+=" "+e[t];break}},i.saveToJSON=function(){return{t:this.text,f:this.font,c:this.color,ha:this.halign,va:this.valign,wr:this.wrapbyword,lho:this.line_height_offset,fn:this.facename,fs:this.fontstyle,ps:this.ptSize,pxh:this.pxHeight,tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick}},i.loadFromJSON=function(t){this.text=t.t,this.font=t.f,this.color=t.c,this.halign=t.ha,this.valign=t.va,this.wrapbyword=t.wr,this.line_height_offset=t.lho,this.facename=t.fn,this.fontstyle=t.fs,this.ptSize=t.ps,this.pxHeight=t.pxh,this.textWidth=t.tw,this.textHeight=t.th,this.last_render_tick=t.lrt,this.text_changed=!0,this.lastwidth=this.width,this.lastwrapwidth=this.width,this.lastheight=this.height},i.tick=function(){if(this.runtime.glwrap&&this.mytex&&this.runtime.tickcount-this.last_render_tick>=300){var t=this.layer;this.update_bbox();var e=this.bbox;(e.right<t.viewLeft||e.bottom<t.viewTop||e.left>t.viewRight||e.top>t.viewBottom)&&(this.runtime.glwrap.deleteTexture(this.mytex),this.mytex=null,this.myctx=null,this.mycanvas=null)}},i.onDestroy=function(){this.myctx=null,this.mycanvas=null,this.runtime.glwrap&&this.mytex&&this.runtime.glwrap.deleteTexture(this.mytex),this.mytex=null},i.updateFont=function(){this.font=this.fontstyle+" "+this.ptSize.toString()+"pt "+this.facename,this.text_changed=!0,this.runtime.redraw=!0},i.draw=function(t,e){t.font=this.font,t.textBaseline="top",t.fillStyle=this.color,t.globalAlpha=e?1:this.opacity;var i=1;e&&(i=Math.abs(this.layer.getScale()),t.save(),t.scale(i,i)),(this.text_changed||this.width!==this.lastwrapwidth)&&(this.type.plugin.WordWrap(this.text,this.lines,t,this.width,this.wrapbyword),this.text_changed=!1,this.lastwrapwidth=this.width),this.update_bbox();var s=e?0:this.bquad.tlx,n=e?0:this.bquad.tly;this.runtime.pixel_rounding&&(s=s+.5|0,n=n+.5|0),0===this.angle||e||(t.save(),t.translate(s,n),t.rotate(this.angle),s=0,n=0);var r,o,a=n+this.height,h=this.pxHeight;for(h+=this.line_height_offset,1===this.valign?n+=Math.max(this.height/2-this.lines.length*h/2,0):2===this.valign&&(n+=Math.max(this.height-this.lines.length*h-2,0)),o=0;o<this.lines.length&&(r=s,1===this.halign?r=s+(this.width-this.lines[o].width)/2:2===this.halign&&(r=s+(this.width-this.lines[o].width)),t.fillText(this.lines[o].text,r,n),!((n+=h)>=a-h));o++);(0!==this.angle||e)&&t.restore(),this.last_render_tick=this.runtime.tickcount},i.drawGL=function(t){if(!(this.width<1||this.height<1)){var e=this.text_changed||this.need_text_redraw;this.need_text_redraw=!1;var i=this.layer.getScale(),s=this.layer.getAngle(),n=this.rcTex,r=i*this.width,o=i*this.height,a=Math.ceil(r),h=Math.ceil(o),c=Math.abs(a),l=Math.abs(h),u=this.runtime.draw_width/2,p=this.runtime.draw_height/2;this.myctx||(this.mycanvas=document.createElement("canvas"),this.mycanvas.width=c,this.mycanvas.height=l,this.lastwidth=c,this.lastheight=l,e=!0,this.myctx=this.mycanvas.getContext("2d")),c===this.lastwidth&&l===this.lastheight||(this.mycanvas.width=c,this.mycanvas.height=l,this.mytex&&(t.deleteTexture(this.mytex),this.mytex=null),e=!0),e&&(this.myctx.clearRect(0,0,c,l),this.draw(this.myctx,!0),this.mytex||(this.mytex=t.createEmptyTexture(c,l,this.runtime.linearSampling,this.runtime.isMobile)),t.videoToTexture(this.mycanvas,this.mytex,this.runtime.isMobile)),this.lastwidth=c,this.lastheight=l,t.setTexture(this.mytex),t.setOpacity(this.opacity),t.resetModelView(),t.translate(-u,-p),t.updateModelView();var d=this.bquad,f=this.layer.layerToCanvas(d.tlx,d.tly,!0,!0),g=this.layer.layerToCanvas(d.tlx,d.tly,!1,!0),m=this.layer.layerToCanvas(d.trx,d.try_,!0,!0),y=this.layer.layerToCanvas(d.trx,d.try_,!1,!0),_=this.layer.layerToCanvas(d.brx,d.bry,!0,!0),v=this.layer.layerToCanvas(d.brx,d.bry,!1,!0),b=this.layer.layerToCanvas(d.blx,d.bly,!0,!0),w=this.layer.layerToCanvas(d.blx,d.bly,!1,!0);if(this.runtime.pixel_rounding||0===this.angle&&0===s){var x=(f+.5|0)-f,S=(g+.5|0)-g;f+=x,g+=S,m+=x,y+=S,_+=x,v+=S,b+=x,w+=S}0===this.angle&&0===s?(y=g,_=m=f+a,b=f,w=v=g+h,n.right=1,n.bottom=1):(n.right=r/a,n.bottom=o/h),t.quadTex(f,g,m,y,_,v,b,w,n),t.resetModelView(),t.scale(i,i),t.rotateZ(-this.layer.getAngle()),t.translate((this.layer.viewLeft+this.layer.viewRight)/-2,(this.layer.viewTop+this.layer.viewBottom)/-2),t.updateModelView(),this.last_render_tick=this.runtime.tickcount}};var n=[];t.TokeniseWords=function(t){cr.clearArray(n);for(var e,i="",s=0;s<t.length;)if("\n"===(e=t.charAt(s)))i.length&&(n.push(i),i=""),n.push("\n"),++s;else if(" "===e||"\t"===e||"-"===e){do{i+=t.charAt(s),s++}while(s<t.length&&(" "===t.charAt(s)||"\t"===t.charAt(s)));n.push(i),i=""}else s<t.length&&(i+=e,s++);i.length&&n.push(i)};var r=[];function o(){return r.length?r.pop():{}}function a(t){r.push(t)}function h(t){var e,i;for(e=0,i=t.length;e<i;e++)a(t[e]);cr.clearArray(t)}function c(t){return t.length&&" "===t.charAt(t.length-1)?t.substring(0,t.length-1):t}function l(){}function u(){}function p(){}t.WordWrap=function(t,e,i,s,n){if(t&&t.length)if(s<=2)h(e);else{if(t.length<=100&&-1===t.indexOf("\n")){var r=i.measureText(t).width;if(r<=s)return h(e),e.push(o()),e[0].text=t,void(e[0].width=r)}this.WrapText(t,e,i,s,n)}else h(e)},t.WrapText=function(t,e,i,s,r){var h;r?(this.TokeniseWords(t),h=n):h=t;var l,u,p,d="",f=0;for(u=0;u<h.length;u++)"\n"!==h[u]?(l=d,d+=h[u],i.measureText(d).width>=s&&(f>=e.length&&e.push(o()),l=c(l),(p=e[f]).text=l,p.width=i.measureText(l).width,f++,d=h[u],r||" "!==d||(d=""))):(f>=e.length&&e.push(o()),d=c(d),(p=e[f]).text=d,p.width=i.measureText(d).width,f++,d="");for(d.length&&(f>=e.length&&e.push(o()),d=c(d),(p=e[f]).text=d,p.width=i.measureText(d).width,f++),u=f;u<e.length;u++)a(e[u]);e.length=f},l.prototype.CompareText=function(t,e){return e?this.text==t:cr.equals_nocase(this.text,t)},t.cnds=new l,u.prototype.SetText=function(t){cr.is_number(t)&&t<1e9&&(t=Math.round(1e10*t)/1e10);var e=t.toString();this.text!==e&&(this.text=e,this.text_changed=!0,this.runtime.redraw=!0)},u.prototype.AppendText=function(t){cr.is_number(t)&&(t=Math.round(1e10*t)/1e10);var e=t.toString();e&&(this.text+=e,this.text_changed=!0,this.runtime.redraw=!0)},u.prototype.SetFontFace=function(t,e){var i="";switch(e){case 1:i="bold";break;case 2:i="italic";break;case 3:i="bold italic"}t===this.facename&&i===this.fontstyle||(this.facename=t,this.fontstyle=i,this.updateFont())},u.prototype.SetFontSize=function(t){this.ptSize!==t&&(this.ptSize=t,this.pxHeight=Math.ceil(this.ptSize/72*96)+4,this.updateFont())},u.prototype.SetFontColor=function(t){var e="rgb("+cr.GetRValue(t).toString()+","+cr.GetGValue(t).toString()+","+cr.GetBValue(t).toString()+")";e!==this.color&&(this.color=e,this.need_text_redraw=!0,this.runtime.redraw=!0)},u.prototype.SetWebFont=function(t,e){if(this.runtime.isDomFree)cr.logexport("[Construct 2] Text plugin: 'Set web font' not supported on this platform - the action has been ignored");else{var i=this,n=function(){i.runtime.redraw=!0,i.text_changed=!0};if(s.hasOwnProperty(e)){var r="'"+t+"'";if(this.facename===r)return;this.facename=r,this.updateFont();for(var o=1;o<10;o++)setTimeout(n,100*o),setTimeout(n,1e3*o)}else{var a=document.createElement("link");a.href=e,a.rel="stylesheet",a.type="text/css",a.onload=n,document.getElementsByTagName("head")[0].appendChild(a),s[e]=!0,this.facename="'"+t+"'",this.updateFont();for(o=1;o<10;o++)setTimeout(n,100*o),setTimeout(n,1e3*o)}}},u.prototype.SetEffect=function(t){this.blend_mode=t,this.compositeOp=cr.effectToCompositeOp(t),cr.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},t.acts=new u,p.prototype.Text=function(t){t.set_string(this.text)},p.prototype.FaceName=function(t){t.set_string(this.facename)},p.prototype.FaceSize=function(t){t.set_int(this.ptSize)},p.prototype.TextWidth=function(t){var e,i,s,n=0;for(e=0,i=this.lines.length;e<i;e++)n<(s=this.lines[e].width)&&(n=s);t.set_int(n)},p.prototype.TextHeight=function(t){t.set_int(this.lines.length*(this.pxHeight+this.line_height_offset)-this.line_height_offset)},t.exps=new p}(),cr.plugins_.TextBox=function(t){this.runtime=t},function(){var t=cr.plugins_.TextBox.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,i=["text","password","email","number","tel","url"];function s(){}function n(){}function r(){}navigator.userAgent.indexOf("MSIE 9")>-1&&(i[2]="text",i[3]="text",i[4]="text",i[5]="text"),e.onCreate=function(){if(this.runtime.isDomFree)cr.logexport("[Construct 2] Textbox plugin not supported on this platform - the object will not be created");else{6===this.properties[7]?(this.elem=document.createElement("textarea"),jQuery(this.elem).css("resize","none")):(this.elem=document.createElement("input"),this.elem.type=i[this.properties[7]]),this.elem.id=this.properties[9],jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body"),this.elem.autocomplete="off",this.elem.value=this.properties[0],this.elem.placeholder=this.properties[1],this.elem.title=this.properties[2],this.elem.disabled=0===this.properties[4],this.elem.readOnly=1===this.properties[5],this.elem.spellcheck=1===this.properties[6],this.autoFontSize=0!==this.properties[8],this.element_hidden=!1,0===this.properties[3]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0);var t=function(t){return function(){t.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnTextChanged,t)}}(this);this.elem.oninput=t,-1!==navigator.userAgent.indexOf("MSIE")&&(this.elem.oncut=t),this.elem.onclick=function(t){return function(e){e.stopPropagation(),t.runtime.isInUserInputEvent=!0,t.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnClicked,t),t.runtime.isInUserInputEvent=!1}}(this),this.elem.ondblclick=function(t){return function(e){e.stopPropagation(),t.runtime.isInUserInputEvent=!0,t.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnDoubleClicked,t),t.runtime.isInUserInputEvent=!1}}(this),this.elem.addEventListener("touchstart",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchmove",function(t){t.stopPropagation()},!1),this.elem.addEventListener("touchend",function(t){t.stopPropagation()},!1),jQuery(this.elem).mousedown(function(t){t.stopPropagation()}),jQuery(this.elem).mouseup(function(t){t.stopPropagation()}),jQuery(this.elem).keydown(function(t){13!==t.which&&27!=t.which&&t.stopPropagation()}),jQuery(this.elem).keyup(function(t){13!==t.which&&27!=t.which&&t.stopPropagation()}),this.lastLeft=0,this.lastTop=0,this.lastRight=0,this.lastBottom=0,this.lastWinWidth=0,this.lastWinHeight=0,this.updatePosition(!0),this.runtime.tickMe(this)}},e.saveToJSON=function(){return{text:this.elem.value,placeholder:this.elem.placeholder,tooltip:this.elem.title,disabled:!!this.elem.disabled,readonly:!!this.elem.readOnly,spellcheck:!!this.elem.spellcheck}},e.loadFromJSON=function(t){this.elem.value=t.text,this.elem.placeholder=t.placeholder,this.elem.title=t.tooltip,this.elem.disabled=t.disabled,this.elem.readOnly=t.readonly,this.elem.spellcheck=t.spellcheck},e.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)},e.tick=function(){this.updatePosition()},e.updatePosition=function(t){if(!this.runtime.isDomFree){var e=this.layer.layerToCanvas(this.x,this.y,!0),i=this.layer.layerToCanvas(this.x,this.y,!1),s=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),n=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),r=this.runtime.width/this.runtime.devicePixelRatio,o=this.runtime.height/this.runtime.devicePixelRatio;if(!this.visible||!this.layer.visible||s<=0||n<=0||e>=r||i>=o)return this.element_hidden||jQuery(this.elem).hide(),void(this.element_hidden=!0);e<1&&(e=1),i<1&&(i=1),s>=r&&(s=r-1),n>=o&&(n=o-1);var a=window.innerWidth,h=window.innerHeight;if(t||this.lastLeft!==e||this.lastTop!==i||this.lastRight!==s||this.lastBottom!==n||this.lastWinWidth!==a||this.lastWinHeight!==h){this.lastLeft=e,this.lastTop=i,this.lastRight=s,this.lastBottom=n,this.lastWinWidth=a,this.lastWinHeight=h,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1);var c=Math.round(e)+jQuery(this.runtime.canvas).offset().left,l=Math.round(i)+jQuery(this.runtime.canvas).offset().top;jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:c,top:l}),jQuery(this.elem).width(Math.round(s-e)),jQuery(this.elem).height(Math.round(n-i)),this.autoFontSize&&jQuery(this.elem).css("font-size",this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em")}else this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1)}},e.draw=function(t){},e.drawGL=function(t){},s.prototype.CompareText=function(t,e){return!this.runtime.isDomFree&&(0===e?cr.equals_nocase(this.elem.value,t):this.elem.value===t)},s.prototype.OnTextChanged=function(){return!0},s.prototype.OnClicked=function(){return!0},s.prototype.OnDoubleClicked=function(){return!0},t.cnds=new s,n.prototype.SetText=function(t){this.runtime.isDomFree||(this.elem.value=t)},n.prototype.SetPlaceholder=function(t){this.runtime.isDomFree||(this.elem.placeholder=t)},n.prototype.SetTooltip=function(t){this.runtime.isDomFree||(this.elem.title=t)},n.prototype.SetVisible=function(t){this.runtime.isDomFree||(this.visible=0!==t)},n.prototype.SetEnabled=function(t){this.runtime.isDomFree||(this.elem.disabled=0===t)},n.prototype.SetReadOnly=function(t){this.runtime.isDomFree||(this.elem.readOnly=0===t)},n.prototype.SetFocus=function(){this.runtime.isDomFree||this.elem.focus()},n.prototype.SetBlur=function(){this.runtime.isDomFree||this.elem.blur()},n.prototype.SetCSSStyle=function(t,e){this.runtime.isDomFree||jQuery(this.elem).css(t,e)},n.prototype.ScrollToBottom=function(){this.runtime.isDomFree||(this.elem.scrollTop=this.elem.scrollHeight)},t.acts=new n,r.prototype.Text=function(t){this.runtime.isDomFree?t.set_string(""):t.set_string(this.elem.value)},t.exps=new r}(),cr.plugins_.TextModded=function(t){this.runtime=t},function(){var t=cr.plugins_.TextModded.prototype;t.onCreate=function(){t.acts.SetWidth=function(t){this.width!==t&&(this.width=t,this.text_changed=!0,this.set_bbox_changed())}},t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){},e.onLostWebGLContext=function(){var t,e,i;if(!this.is_family)for(t=0,e=this.instances.length;t<e;t++)(i=this.instances[t]).mycanvas=null,i.myctx=null,i.mytex=null},t.Instance=function(t){this.type=t,this.runtime=t.runtime,this.recycled?cr.clearArray(this.lines):this.lines=[],this.text_changed=!0};var i=t.Instance.prototype,s={};i.onCreate=function(){this.text=this.properties[0],this.visible=0===this.properties[1],this.font=this.properties[2],this.color=this.properties[3],this.clamp=0===this.properties[4],this.clamp?(this.halign=cr.clamp(this.properties[5],0,100),this.valign=cr.clamp(this.properties[6],0,100)):(this.halign=this.properties[5],this.valign=this.properties[6]),this.wrapbyword=0===this.properties[8],this.nowrap=2===this.properties[8],this.wrap=this.properties[8],this.lastwidth=this.width,this.lastwrapwidth=this.width,this.lastheight=this.height,this.line_height_offset=this.properties[9],this.facename="",this.fontstyle="",this.ptSize=0,this.textWidth=0,this.textHeight=0,this.parseFont(),this.mycanvas=null,this.myctx=null,this.mytex=null,this.need_text_redraw=!1,this.last_render_tick=this.runtime.tickcount,this.recycled?this.rcTex.set(0,0,1,1):this.rcTex=new cr.rect(0,0,1,1),this.runtime.glwrap&&this.runtime.tickMe(this)},i.parseFont=function(){var t,e=this.font.split(" ");for(t=0;t<e.length;t++)if("pt"===e[t].substr(e[t].length-2,2)){for(this.ptSize=parseInt(e[t].substr(0,e[t].length-2)),this.pxHeight=Math.ceil(this.ptSize/72*96)+4,t>0&&(this.fontstyle=e[t-1]),this.facename=e[t+1],t+=2;t<e.length;t++)this.facename+=" "+e[t];break}},i.saveToJSON=function(){return{t:this.text,f:this.font,c:this.color,ha:this.halign,va:this.valign,clamp:this.clamp,wr:this.wrapbyword,nw:this.nowrap,wrap:this.wrap,lho:this.line_height_offset,fn:this.facename,fs:this.fontstyle,ps:this.ptSize,pxh:this.pxHeight,tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick}},i.loadFromJSON=function(t){this.text=t.t,this.font=t.f,this.color=t.c,this.halign=t.ha,this.valign=t.va,this.clamp=t.clamp,this.wrapbyword=t.wr,this.nowrap=t.nw,this.wrap=t.wrap,this.line_height_offset=t.lho,this.facename=t.fn,this.fontstyle=t.fs,this.ptSize=t.ps,this.pxHeight=t.pxh,this.textWidth=t.tw,this.textHeight=t.th,this.last_render_tick=t.lrt,this.text_changed=!0,this.lastwidth=this.width,this.lastwrapwidth=this.width,this.lastheight=this.height},i.tick=function(){if(this.runtime.glwrap&&this.mytex&&this.runtime.tickcount-this.last_render_tick>=300){var t=this.layer;this.update_bbox();var e=this.bbox;(e.right<t.viewLeft||e.bottom<t.viewTop||e.left>t.viewRight||e.top>t.viewBottom)&&(this.runtime.glwrap.deleteTexture(this.mytex),this.mytex=null,this.myctx=null,this.mycanvas=null)}},i.onDestroy=function(){this.myctx=null,this.mycanvas=null,this.runtime.glwrap&&this.mytex&&this.runtime.glwrap.deleteTexture(this.mytex),this.mytex=null},i.updateFont=function(){this.font=this.fontstyle+" "+this.ptSize.toString()+"pt "+this.facename,this.text_changed=!0,this.runtime.redraw=!0},i.draw=function(t,e){t.font=this.font,t.textBaseline="top",t.fillStyle=this.color,t.globalAlpha=e?1:this.opacity;var i=1;e&&(i=Math.abs(this.layer.getScale()),t.save(),t.scale(i,i)),(this.text_changed||this.width!==this.lastwrapwidth)&&(this.type.plugin.WordWrap(this.text,this.lines,t,this.width,this.wrapbyword,this.nowrap),this.text_changed=!1,this.lastwrapwidth=this.width),this.update_bbox();var s=e?0:this.bquad.tlx,n=e?0:this.bquad.tly;this.runtime.pixel_rounding&&(s=s+.5|0,n=n+.5|0),0===this.angle||e||(t.save(),t.translate(s,n),t.rotate(this.angle),s=0,n=0);var r,o,a=n+this.height,h=this.pxHeight;h+=this.line_height_offset;var c=0;if(this.valign>50)c=2*(this.valign-50)/50;for(n+=Math.max(this.height*this.valign/100-this.lines.length*h*this.valign/100-c,0),o=0;o<this.lines.length&&(r=s+(this.width-this.lines[o].width)*this.halign/100,t.fillText(this.lines[o].text,r,n),!((n+=h)>=a-h));o++);(0!==this.angle||e)&&t.restore(),this.last_render_tick=this.runtime.tickcount},i.drawGL=function(t){if(!(this.width<1||this.height<1)){var e=this.text_changed||this.need_text_redraw;this.need_text_redraw=!1;var i=this.layer.getScale(),s=this.layer.getAngle(),n=this.rcTex,r=i*this.width,o=i*this.height,a=Math.ceil(r),h=Math.ceil(o),c=Math.abs(a),l=Math.abs(h),u=this.runtime.draw_width/2,p=this.runtime.draw_height/2;this.myctx||(this.mycanvas=document.createElement("canvas"),this.mycanvas.width=c,this.mycanvas.height=l,this.lastwidth=c,this.lastheight=l,e=!0,this.myctx=this.mycanvas.getContext("2d")),c===this.lastwidth&&l===this.lastheight||(this.mycanvas.width=c,this.mycanvas.height=l,this.mytex&&(t.deleteTexture(this.mytex),this.mytex=null),e=!0),e&&(this.myctx.clearRect(0,0,c,l),this.draw(this.myctx,!0),this.mytex||(this.mytex=t.createEmptyTexture(c,l,this.runtime.linearSampling,this.runtime.isMobile)),t.videoToTexture(this.mycanvas,this.mytex,this.runtime.isMobile)),this.lastwidth=c,this.lastheight=l,t.setTexture(this.mytex),t.setOpacity(this.opacity),t.resetModelView(),t.translate(-u,-p),t.updateModelView();var d=this.bquad,f=this.layer.layerToCanvas(d.tlx,d.tly,!0,!0),g=this.layer.layerToCanvas(d.tlx,d.tly,!1,!0),m=this.layer.layerToCanvas(d.trx,d.try_,!0,!0),y=this.layer.layerToCanvas(d.trx,d.try_,!1,!0),_=this.layer.layerToCanvas(d.brx,d.bry,!0,!0),v=this.layer.layerToCanvas(d.brx,d.bry,!1,!0),b=this.layer.layerToCanvas(d.blx,d.bly,!0,!0),w=this.layer.layerToCanvas(d.blx,d.bly,!1,!0);if(this.runtime.pixel_rounding||0===this.angle&&0===s){var x=(f+.5|0)-f,S=(g+.5|0)-g;f+=x,g+=S,m+=x,y+=S,_+=x,v+=S,b+=x,w+=S}0===this.angle&&0===s?(y=g,_=m=f+a,b=f,w=v=g+h,n.right=1,n.bottom=1):(n.right=r/a,n.bottom=o/h),t.quadTex(f,g,m,y,_,v,b,w,n),t.resetModelView(),t.scale(i,i),t.rotateZ(-this.layer.getAngle()),t.translate((this.layer.viewLeft+this.layer.viewRight)/-2,(this.layer.viewTop+this.layer.viewBottom)/-2),t.updateModelView(),this.last_render_tick=this.runtime.tickcount}};var n=[];t.TokeniseWords=function(t){cr.clearArray(n);for(var e,i="",s=0;s<t.length;)if("\n"===(e=t.charAt(s)))i.length&&(n.push(i),i=""),n.push("\n"),++s;else if(" "===e||"\t"===e||"-"===e){do{i+=t.charAt(s),s++}while(s<t.length&&(" "===t.charAt(s)||"\t"===t.charAt(s)));n.push(i),i=""}else s<t.length&&(i+=e,s++);i.length&&n.push(i)};var r=[];function o(){return r.length?r.pop():{}}function a(t){r.push(t)}function h(t){var e,i;for(e=0,i=t.length;e<i;e++)a(t[e]);cr.clearArray(t)}function c(t){return t.length&&" "===t.charAt(t.length-1)?t.substring(0,t.length-1):t}function l(){}function u(){}function p(){}t.WordWrap=function(t,e,i,s,n,r){if(t&&t.length)if(s<=2)h(e);else{if(t.length<=100&&-1===t.indexOf("\n"))if((a=i.measureText(t).width)<=s)return h(e),e.push(o()),e[0].text=t,void(e[0].width=a);if(r){var a=i.measureText(t).width;h(e),e.push(o()),e[0].text=t,e[0].width=a}else this.WrapText(t,e,i,s,n)}else h(e)},t.WrapText=function(t,e,i,s,r){var h;r?(this.TokeniseWords(t),h=n):h=t;var l,u,p,d="",f=0;for(u=0;u<h.length;u++)"\n"!==h[u]?(l=d,d+=h[u],i.measureText(d).width>=s&&(f>=e.length&&e.push(o()),l=c(l),(p=e[f]).text=l,p.width=i.measureText(l).width,f++,d=h[u],r||" "!==d||(d=""))):(f>=e.length&&e.push(o()),d=c(d),(p=e[f]).text=d,p.width=i.measureText(d).width,f++,d="");for(d.length&&(f>=e.length&&e.push(o()),d=c(d),(p=e[f]).text=d,p.width=i.measureText(d).width,f++),u=f;u<e.length;u++)a(e[u]);e.length=f},l.prototype.CompareText=function(t,e){return e?this.text==t:cr.equals_nocase(this.text,t)},t.cnds=new l,u.prototype.SetText=function(t){cr.is_number(t)&&t<1e9&&(t=Math.round(1e10*t)/1e10);var e=t.toString();this.text!==e&&(this.text=e,this.text_changed=!0,this.runtime.redraw=!0)},u.prototype.AppendText=function(t){cr.is_number(t)&&(t=Math.round(1e10*t)/1e10);var e=t.toString();e&&(this.text+=e,this.text_changed=!0,this.runtime.redraw=!0)},u.prototype.SetFontFace=function(t,e){var i="";switch(e){case 1:i="bold";break;case 2:i="italic";break;case 3:i="bold italic"}t===this.facename&&i===this.fontstyle||(this.facename=t,this.fontstyle=i,this.updateFont())},u.prototype.SetFontSize=function(t){this.ptSize!==t&&(this.ptSize=t,this.pxHeight=Math.ceil(this.ptSize/72*96)+4,this.updateFont())},u.prototype.SetFontColor=function(t){var e="rgb("+cr.GetRValue(t).toString()+","+cr.GetGValue(t).toString()+","+cr.GetBValue(t).toString()+")";e!==this.color&&(this.color=e,this.need_text_redraw=!0,this.runtime.redraw=!0)},u.prototype.SetHorAl=function(t){this.halign=this.clamp?cr.clamp(t,0,100):t,this.need_text_redraw=!0,this.runtime.redraw=!0},u.prototype.SetVerAl=function(t){this.valign=this.clamp?cr.clamp(t,0,100):t,this.need_text_redraw=!0,this.runtime.redraw=!0},u.prototype.SetAl=function(t,e){this.halign=this.clamp?cr.clamp(t,0,100):t,this.valign=this.clamp?cr.clamp(e,0,100):e,this.need_text_redraw=!0,this.runtime.redraw=!0},u.prototype.SetWrap=function(t){this.wrapbyword=0===t,this.nowrap=2===t,this.need_text_redraw=!0,this.runtime.redraw=!0,this.text_changed=!0},u.prototype.SetClamp=function(t){this.clamp=0===t,this.halign=this.clamp?cr.clamp(this.halign,0,100):this.halign,this.valign=this.clamp?cr.clamp(this.valign,0,100):this.valign,this.need_text_redraw=!0,this.runtime.redraw=!0,this.text_changed=!0},u.prototype.SetHotspot=function(t){this.SetHotspot(GetHotspot(t))},u.prototype.SetWebFont=function(t,e){if(this.runtime.isDomFree)cr.logexport("[Construct 2] Text plugin: 'Set web font' not supported on this platform - the action has been ignored");else{var i=this,n=function(){i.runtime.redraw=!0,i.text_changed=!0};if(s.hasOwnProperty(e)){var r="'"+t+"'";if(this.facename===r)return;this.facename=r,this.updateFont();for(var o=1;o<10;o++)setTimeout(n,100*o),setTimeout(n,1e3*o)}else{var a=document.createElement("link");a.href=e,a.rel="stylesheet",a.type="text/css",a.onload=n,document.getElementsByTagName("head")[0].appendChild(a),s[e]=!0,this.facename="'"+t+"'",this.updateFont();for(o=1;o<10;o++)setTimeout(n,100*o),setTimeout(n,1e3*o)}}},u.prototype.SetEffect=function(t){this.blend_mode=t,this.compositeOp=cr.effectToCompositeOp(t),cr.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},t.acts=new u,p.prototype.Text=function(t){t.set_string(this.text)},p.prototype.HAlign=function(t){t.set_int(this.halign)},p.prototype.VAlign=function(t){t.set_int(this.valign)},p.prototype.FaceName=function(t){t.set_string(this.facename)},p.prototype.FaceSize=function(t){t.set_int(this.ptSize)},p.prototype.LineHeight=function(t){t.set_int(this.pxHeight+this.line_height_offset)},p.prototype.TextWidth=function(t){var e,i,s,n=0;for(e=0,i=this.lines.length;e<i;e++)n<(s=this.lines[e].width)&&(n=s);t.set_int(n)},p.prototype.TextHeight=function(t){t.set_int(this.lines.length*(this.pxHeight+this.line_height_offset)-this.line_height_offset)},t.exps=new p}(),cr.plugins_.TiledBg=function(t){this.runtime=t},function(){var t=cr.plugins_.TiledBg.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){this.is_family||(this.texture_img=new Image,this.texture_img.cr_filesize=this.texture_filesize,this.runtime.waitForImageLoad(this.texture_img,this.texture_file),this.pattern=null,this.webGL_texture=null)},e.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null)},e.onRestoreWebGLContext=function(){var t,e;if(!this.is_family&&this.instances.length)for(this.webGL_texture||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat)),t=0,e=this.instances.length;t<e;t++)this.instances[t].webGL_texture=this.webGL_texture},e.loadTextures=function(){this.is_family||this.webGL_texture||!this.runtime.glwrap||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat))},e.unloadTextures=function(){this.is_family||this.instances.length||!this.webGL_texture||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)},e.preloadCanvas2D=function(t){t.drawImage(this.texture_img,0,0)},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var i=t.Instance.prototype;function s(){}function n(){}function r(){}i.onCreate=function(){this.visible=0===this.properties[0],this.rcTex=new cr.rect(0,0,0,0),this.has_own_texture=!1,this.texture_img=this.type.texture_img,this.runtime.glwrap?(this.type.loadTextures(),this.webGL_texture=this.type.webGL_texture):(this.type.pattern||(this.type.pattern=this.runtime.ctx.createPattern(this.type.texture_img,"repeat")),this.pattern=this.type.pattern)},i.afterLoad=function(){this.has_own_texture=!1,this.texture_img=this.type.texture_img},i.onDestroy=function(){this.runtime.glwrap&&this.has_own_texture&&this.webGL_texture&&(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)},i.draw=function(t){t.globalAlpha=this.opacity,t.save(),t.fillStyle=this.pattern;var e=this.x,i=this.y;this.runtime.pixel_rounding&&(e=Math.round(e),i=Math.round(i));var s=-this.hotspotX*this.width,n=-this.hotspotY*this.height,r=s%this.texture_img.width,o=n%this.texture_img.height;r<0&&(r+=this.texture_img.width),o<0&&(o+=this.texture_img.height),t.translate(e,i),t.rotate(this.angle),t.translate(r,o),t.fillRect(s-r,n-o,this.width,this.height),t.restore()},i.drawGL_earlyZPass=function(t){this.drawGL(t)},i.drawGL=function(t){t.setTexture(this.webGL_texture),t.setOpacity(this.opacity);var e=this.rcTex;e.right=this.width/this.texture_img.width,e.bottom=this.height/this.texture_img.height;var i=this.bquad;if(this.runtime.pixel_rounding){var s=Math.round(this.x)-this.x,n=Math.round(this.y)-this.y;t.quadTex(i.tlx+s,i.tly+n,i.trx+s,i.try_+n,i.brx+s,i.bry+n,i.blx+s,i.bly+n,e)}else t.quadTex(i.tlx,i.tly,i.trx,i.try_,i.brx,i.bry,i.blx,i.bly,e)},s.prototype.OnURLLoaded=function(){return!0},t.cnds=new s,n.prototype.SetEffect=function(t){this.blend_mode=t,this.compositeOp=cr.effectToCompositeOp(t),cr.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},n.prototype.LoadURL=function(t,e){var i=new Image,s=this;i.onload=function(){s.texture_img=i,s.runtime.glwrap?(s.has_own_texture&&s.webGL_texture&&s.runtime.glwrap.deleteTexture(s.webGL_texture),s.webGL_texture=s.runtime.glwrap.loadTexture(i,!0,s.runtime.linearSampling)):s.pattern=s.runtime.ctx.createPattern(i,"repeat"),s.has_own_texture=!0,s.runtime.redraw=!0,s.runtime.trigger(cr.plugins_.TiledBg.prototype.cnds.OnURLLoaded,s)},"data:"!==t.substr(0,5)&&0===e&&(i.crossOrigin="anonymous"),this.runtime.setImageSrc(i,t)},t.acts=new n,r.prototype.ImageWidth=function(t){t.set_float(this.texture_img.width)},r.prototype.ImageHeight=function(t){t.set_float(this.texture_img.height)},t.exps=new r}(),cr.plugins_.Touch=function(t){this.runtime=t},function(){var t=cr.plugins_.Touch.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime,this.touches=[],this.mouseDown=!1};var e=t.Instance.prototype,i={left:0,top:0};e.findTouch=function(t){var e,i;for(e=0,i=this.touches.length;e<i;e++)if(this.touches[e].id===t)return e;return-1};var s=0,n=0,r=0;function o(t){s=t.x,n=t.y,r=t.z}var a=[];function h(t,e,i,s){var n;return(n=a.length?a.pop():new l).init(t,e,i,s),n}function c(t){a.length<100&&a.push(t)}function l(){this.starttime=0,this.time=0,this.lasttime=0,this.startx=0,this.starty=0,this.x=0,this.y=0,this.lastx=0,this.lasty=0,this.id=0,this.startindex=0,this.triggeredHold=!1,this.tooFarForHold=!1}l.prototype.init=function(t,e,i,s){var n=cr.performance_now();this.time=n,this.lasttime=n,this.starttime=n,this.startx=t,this.starty=e,this.x=t,this.y=e,this.lastx=t,this.lasty=e,this.width=0,this.height=0,this.pressure=0,this.id=i,this.startindex=s,this.triggeredHold=!1,this.tooFarForHold=!1},l.prototype.update=function(t,e,i,s,n,r){this.lasttime=this.time,this.time=t,this.lastx=this.x,this.lasty=this.y,this.x=e,this.y=i,this.width=s,this.height=n,this.pressure=r,!this.tooFarForHold&&cr.distanceTo(this.startx,this.starty,this.x,this.y)>=15&&(this.tooFarForHold=!0)},l.prototype.maybeTriggerHold=function(t,e){this.triggeredHold||cr.performance_now()-this.starttime>=500&&!this.tooFarForHold&&cr.distanceTo(this.startx,this.starty,this.x,this.y)<15&&(this.triggeredHold=!0,t.trigger_index=this.startindex,t.trigger_id=this.id,t.getTouchIndex=e,t.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGesture,t),t.curTouchX=this.x,t.curTouchY=this.y,t.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGestureObject,t),t.getTouchIndex=0)};var u=-1e3,p=-1e3,d=-1e4;l.prototype.maybeTriggerTap=function(t,e){if(!this.triggeredHold){var i=cr.performance_now();i-this.starttime<=333&&!this.tooFarForHold&&cr.distanceTo(this.startx,this.starty,this.x,this.y)<15&&(t.trigger_index=this.startindex,t.trigger_id=this.id,t.getTouchIndex=e,i-d<=666&&cr.distanceTo(u,p,this.x,this.y)<25?(t.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGesture,t),t.curTouchX=this.x,t.curTouchY=this.y,t.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject,t),u=-1e3,p=-1e3,d=-1e4):(t.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGesture,t),t.curTouchX=this.x,t.curTouchY=this.y,t.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGestureObject,t),u=this.x,p=this.y,d=i),t.getTouchIndex=0)}},e.onCreate=function(){this.isWindows8=!(void 0===window.c2isWindows8||!window.c2isWindows8),this.orient_alpha=0,this.orient_beta=0,this.orient_gamma=0,this.acc_g_x=0,this.acc_g_y=0,this.acc_g_z=0,this.acc_x=0,this.acc_y=0,this.acc_z=0,this.curTouchX=0,this.curTouchY=0,this.trigger_index=0,this.trigger_id=0,this.trigger_permission=0,this.getTouchIndex=0,this.useMouseInput=0!==this.properties[0];var t=this.runtime.fullscreen_mode>0?document:this.runtime.canvas,e=document;this.runtime.isDirectCanvas?e=t=window.Canvas:this.runtime.isCocoonJs&&(e=t=window);var i=this;if("undefined"!=typeof PointerEvent?(t.addEventListener("pointerdown",function(t){i.onPointerStart(t)},!1),t.addEventListener("pointermove",function(t){i.onPointerMove(t)},!1),e.addEventListener("pointerup",function(t){i.onPointerEnd(t,!1)},!1),e.addEventListener("pointercancel",function(t){i.onPointerEnd(t,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1),document.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1),this.runtime.canvas.addEventListener("gesturehold",function(t){t.preventDefault()},!1),document.addEventListener("gesturehold",function(t){t.preventDefault()},!1))):window.navigator.msPointerEnabled?(t.addEventListener("MSPointerDown",function(t){i.onPointerStart(t)},!1),t.addEventListener("MSPointerMove",function(t){i.onPointerMove(t)},!1),e.addEventListener("MSPointerUp",function(t){i.onPointerEnd(t,!1)},!1),e.addEventListener("MSPointerCancel",function(t){i.onPointerEnd(t,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1),document.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1))):(t.addEventListener("touchstart",function(t){i.onTouchStart(t)},!1),t.addEventListener("touchmove",function(t){i.onTouchMove(t)},!1),e.addEventListener("touchend",function(t){i.onTouchEnd(t,!1)},!1),e.addEventListener("touchcancel",function(t){i.onTouchEnd(t,!0)},!1)),this.isWindows8){var s=function(t){var e=t.reading;i.acc_x=e.accelerationX,i.acc_y=e.accelerationY,i.acc_z=e.accelerationZ},n=function(t){var e=t.reading;i.orient_alpha=e.yawDegrees,i.orient_beta=e.pitchDegrees,i.orient_gamma=e.rollDegrees},r=Windows.Devices.Sensors.Accelerometer.getDefault();r&&(r.reportInterval=Math.max(r.minimumReportInterval,16),r.addEventListener("readingchanged",s));var a=Windows.Devices.Sensors.Inclinometer.getDefault();a&&(a.reportInterval=Math.max(a.minimumReportInterval,16),a.addEventListener("readingchanged",n)),document.addEventListener("visibilitychange",function(t){document.hidden||document.msHidden?(r&&r.removeEventListener("readingchanged",s),a&&a.removeEventListener("readingchanged",n)):(r&&r.addEventListener("readingchanged",s),a&&a.addEventListener("readingchanged",n))},!1)}else window.addEventListener("deviceorientation",function(t){i.orient_alpha=t.alpha||0,i.orient_beta=t.beta||0,i.orient_gamma=t.gamma||0},!1),window.addEventListener("devicemotion",function(t){t.accelerationIncludingGravity&&(i.acc_g_x=t.accelerationIncludingGravity.x||0,i.acc_g_y=t.accelerationIncludingGravity.y||0,i.acc_g_z=t.accelerationIncludingGravity.z||0),t.acceleration&&(i.acc_x=t.acceleration.x||0,i.acc_y=t.acceleration.y||0,i.acc_z=t.acceleration.z||0)},!1);this.useMouseInput&&!this.runtime.isDomFree&&(jQuery(document).mousemove(function(t){i.onMouseMove(t)}),jQuery(document).mousedown(function(t){i.onMouseDown(t)}),jQuery(document).mouseup(function(t){i.onMouseUp(t)})),!this.runtime.isiOS&&this.runtime.isCordova&&navigator.accelerometer&&navigator.accelerometer.watchAcceleration&&navigator.accelerometer.watchAcceleration(o,null,{frequency:40}),this.runtime.tick2Me(this)},e.onPointerMove=function(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){t.preventDefault&&t.preventDefault();var e=this.findTouch(t.pointerId),s=cr.performance_now();if(e>=0){var n=this.runtime.isDomFree?i:jQuery(this.runtime.canvas).offset(),r=this.touches[e];if(s-r.time<2)return;r.update(s,t.pageX-n.left,t.pageY-n.top,t.width||0,t.height||0,t.pressure||0)}}},e.onPointerStart=function(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){t.preventDefault&&cr.isCanvasInputEvent(t)&&t.preventDefault();var e=this.runtime.isDomFree?i:jQuery(this.runtime.canvas).offset(),s=t.pageX-e.left,n=t.pageY-e.top;cr.performance_now();this.trigger_index=this.touches.length,this.trigger_id=t.pointerId,this.touches.push(h(s,n,t.pointerId,this.trigger_index)),this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this),this.curTouchX=s,this.curTouchY=n,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this),this.runtime.isInUserInputEvent=!1}},e.onPointerEnd=function(t,e){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){t.preventDefault&&cr.isCanvasInputEvent(t)&&t.preventDefault();var i=this.findTouch(t.pointerId);this.trigger_index=i>=0?this.touches[i].startindex:-1,this.trigger_id=i>=0?this.touches[i].id:-1,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),i>=0&&(e||this.touches[i].maybeTriggerTap(this,i),c(this.touches[i]),this.touches.splice(i,1)),this.runtime.isInUserInputEvent=!1}},e.onTouchMove=function(t){t.preventDefault&&t.preventDefault();var e,s,n,r,o=cr.performance_now();for(e=0,s=t.changedTouches.length;e<s;e++){n=t.changedTouches[e];var a=this.findTouch(n.identifier);if(a>=0){var h=this.runtime.isDomFree?i:jQuery(this.runtime.canvas).offset();if(o-(r=this.touches[a]).time<2)continue;var c=2*(n.radiusX||n.webkitRadiusX||n.mozRadiusX||n.msRadiusX||0),l=2*(n.radiusY||n.webkitRadiusY||n.mozRadiusY||n.msRadiusY||0),u=n.force||n.webkitForce||n.mozForce||n.msForce||0;r.update(o,n.pageX-h.left,n.pageY-h.top,c,l,u)}}},e.onTouchStart=function(t){t.preventDefault&&cr.isCanvasInputEvent(t)&&t.preventDefault();var e,s,n,r=this.runtime.isDomFree?i:jQuery(this.runtime.canvas).offset();cr.performance_now();for(this.runtime.isInUserInputEvent=!0,e=0,s=t.changedTouches.length;e<s;e++)if(n=t.changedTouches[e],-1===this.findTouch(n.identifier)){var o=n.pageX-r.left,a=n.pageY-r.top;this.trigger_index=this.touches.length,this.trigger_id=n.identifier,this.touches.push(h(o,a,n.identifier,this.trigger_index)),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this),this.curTouchX=o,this.curTouchY=a,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this)}this.runtime.isInUserInputEvent=!1},e.onTouchEnd=function(t,e){var i,s,n,r;for(t.preventDefault&&cr.isCanvasInputEvent(t)&&t.preventDefault(),this.runtime.isInUserInputEvent=!0,i=0,s=t.changedTouches.length;i<s;i++)n=t.changedTouches[i],(r=this.findTouch(n.identifier))>=0&&(this.trigger_index=this.touches[r].startindex,this.trigger_id=this.touches[r].id,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),e||this.touches[r].maybeTriggerTap(this,r),c(this.touches[r]),this.touches.splice(r,1));this.runtime.isInUserInputEvent=!1},e.getAlpha=function(){return this.runtime.isCordova&&0===this.orient_alpha&&0!==r?90*r:this.orient_alpha},e.getBeta=function(){return this.runtime.isCordova&&0===this.orient_beta&&0!==n?90*n:this.orient_beta},e.getGamma=function(){return this.runtime.isCordova&&0===this.orient_gamma&&0!==s?90*s:this.orient_gamma};function f(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents||t.originalEvent&&t.originalEvent.sourceCapabilities&&t.originalEvent.sourceCapabilities.firesTouchEvents}function g(){}e.onMouseDown=function(t){if(!f(t)){var e={changedTouches:[{pageX:t.pageX,pageY:t.pageY,identifier:0}]};this.onTouchStart(e),this.mouseDown=!0}},e.onMouseMove=function(t){if(this.mouseDown&&!f(t)){var e={changedTouches:[{pageX:t.pageX,pageY:t.pageY,identifier:0}]};this.onTouchMove(e)}},e.onMouseUp=function(t){if(t.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&t.preventDefault(),this.runtime.had_a_click=!0,!f(t)){var e={changedTouches:[{pageX:t.pageX,pageY:t.pageY,identifier:0}]};this.onTouchEnd(e),this.mouseDown=!1}},e.tick2=function(){var t,e,i,s=cr.performance_now();for(t=0,e=this.touches.length;t<e;++t)(i=this.touches[t]).time<=s-50&&(i.lasttime=s),i.maybeTriggerHold(this,t)},g.prototype.OnTouchStart=function(){return!0},g.prototype.OnTouchEnd=function(){return!0},g.prototype.IsInTouch=function(){return this.touches.length},g.prototype.OnTouchObject=function(t){return!!t&&this.runtime.testAndSelectCanvasPointOverlap(t,this.curTouchX,this.curTouchY,!1)};var m=[];function y(){}function _(){}g.prototype.IsTouchingObject=function(t){if(!t)return!1;var e,i,s,n,r,o,a=t.getCurrentSol(),h=a.getObjects();for(s=0,n=h.length;s<n;s++){var c=h[s];for(c.update_bbox(),r=0,o=this.touches.length;r<o;r++){var l=this.touches[r];if(e=c.layer.canvasToLayer(l.x,l.y,!0),i=c.layer.canvasToLayer(l.x,l.y,!1),c.contains_pt(e,i)){m.push(c);break}}}return!!m.length&&(a.select_all=!1,cr.shallowAssignArray(a.instances,m),t.applySolToContainer(),cr.clearArray(m),!0)},g.prototype.CompareTouchSpeed=function(t,e,i){if((t=Math.floor(t))<0||t>=this.touches.length)return!1;var s=this.touches[t],n=cr.distanceTo(s.x,s.y,s.lastx,s.lasty),r=(s.time-s.lasttime)/1e3,o=0;return r>0&&(o=n/r),cr.do_cmp(o,e,i)},g.prototype.OrientationSupported=function(){return void 0!==window.DeviceOrientationEvent},g.prototype.MotionSupported=function(){return void 0!==window.DeviceMotionEvent},g.prototype.CompareOrientation=function(t,e,i){var s=0;return s=0===t?this.getAlpha():1===t?this.getBeta():this.getGamma(),cr.do_cmp(s,e,i)},g.prototype.CompareAcceleration=function(t,e,i){var s=0;return 0===t?s=this.acc_g_x:1===t?s=this.acc_g_y:2===t?s=this.acc_g_z:3===t?s=this.acc_x:4===t?s=this.acc_y:5===t&&(s=this.acc_z),cr.do_cmp(s,e,i)},g.prototype.OnNthTouchStart=function(t){return(t=Math.floor(t))===this.trigger_index},g.prototype.OnNthTouchEnd=function(t){return(t=Math.floor(t))===this.trigger_index},g.prototype.HasNthTouch=function(t){return t=Math.floor(t),this.touches.length>=t+1},g.prototype.OnHoldGesture=function(){return!0},g.prototype.OnTapGesture=function(){return!0},g.prototype.OnDoubleTapGesture=function(){return!0},g.prototype.OnHoldGestureObject=function(t){return!!t&&this.runtime.testAndSelectCanvasPointOverlap(t,this.curTouchX,this.curTouchY,!1)},g.prototype.OnTapGestureObject=function(t){return!!t&&this.runtime.testAndSelectCanvasPointOverlap(t,this.curTouchX,this.curTouchY,!1)},g.prototype.OnDoubleTapGestureObject=function(t){return!!t&&this.runtime.testAndSelectCanvasPointOverlap(t,this.curTouchX,this.curTouchY,!1)},g.prototype.OnPermissionGranted=function(t){return this.trigger_permission===t},g.prototype.OnPermissionDenied=function(t){return this.trigger_permission===t},t.cnds=new g,y.prototype.RequestPermission=function(t){var e=this,i=Promise.resolve(!0);0===t?window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission&&(i=window.DeviceOrientationEvent.requestPermission().then(function(t){return"granted"===t})):window.DeviceMotionEvent&&window.DeviceMotionEvent.requestPermission&&(i=window.DeviceMotionEvent.requestPermission().then(function(t){return"granted"===t})),i.then(function(i){e.trigger_permission=t,i?e.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnPermissionGranted,e):e.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnPermissionDenied,e)})},t.acts=new y,_.prototype.TouchCount=function(t){t.set_int(this.touches.length)},_.prototype.X=function(t,e){var i,s,n,r,o,a=this.getTouchIndex;a<0||a>=this.touches.length?t.set_float(0):cr.is_undefined(e)?(s=(i=this.runtime.getLayerByNumber(0)).scale,n=i.zoomRate,r=i.parallaxX,o=i.angle,i.scale=1,i.zoomRate=1,i.parallaxX=1,i.angle=0,t.set_float(i.canvasToLayer(this.touches[a].x,this.touches[a].y,!0)),i.scale=s,i.zoomRate=n,i.parallaxX=r,i.angle=o):(i=cr.is_number(e)?this.runtime.getLayerByNumber(e):this.runtime.getLayerByName(e))?t.set_float(i.canvasToLayer(this.touches[a].x,this.touches[a].y,!0)):t.set_float(0)},_.prototype.XAt=function(t,e,i){var s,n,r,o,a;(e=Math.floor(e))<0||e>=this.touches.length?t.set_float(0):cr.is_undefined(i)?(n=(s=this.runtime.getLayerByNumber(0)).scale,r=s.zoomRate,o=s.parallaxX,a=s.angle,s.scale=1,s.zoomRate=1,s.parallaxX=1,s.angle=0,t.set_float(s.canvasToLayer(this.touches[e].x,this.touches[e].y,!0)),s.scale=n,s.zoomRate=r,s.parallaxX=o,s.angle=a):(s=cr.is_number(i)?this.runtime.getLayerByNumber(i):this.runtime.getLayerByName(i))?t.set_float(s.canvasToLayer(this.touches[e].x,this.touches[e].y,!0)):t.set_float(0)},_.prototype.XForID=function(t,e,i){var s=this.findTouch(e);if(s<0)t.set_float(0);else{var n,r,o,a,h,c=this.touches[s];cr.is_undefined(i)?(r=(n=this.runtime.getLayerByNumber(0)).scale,o=n.zoomRate,a=n.parallaxX,h=n.angle,n.scale=1,n.zoomRate=1,n.parallaxX=1,n.angle=0,t.set_float(n.canvasToLayer(c.x,c.y,!0)),n.scale=r,n.zoomRate=o,n.parallaxX=a,n.angle=h):(n=cr.is_number(i)?this.runtime.getLayerByNumber(i):this.runtime.getLayerByName(i))?t.set_float(n.canvasToLayer(c.x,c.y,!0)):t.set_float(0)}},_.prototype.Y=function(t,e){var i,s,n,r,o,a=this.getTouchIndex;a<0||a>=this.touches.length?t.set_float(0):cr.is_undefined(e)?(s=(i=this.runtime.getLayerByNumber(0)).scale,n=i.zoomRate,r=i.parallaxY,o=i.angle,i.scale=1,i.zoomRate=1,i.parallaxY=1,i.angle=0,t.set_float(i.canvasToLayer(this.touches[a].x,this.touches[a].y,!1)),i.scale=s,i.zoomRate=n,i.parallaxY=r,i.angle=o):(i=cr.is_number(e)?this.runtime.getLayerByNumber(e):this.runtime.getLayerByName(e))?t.set_float(i.canvasToLayer(this.touches[a].x,this.touches[a].y,!1)):t.set_float(0)},_.prototype.YAt=function(t,e,i){var s,n,r,o,a;(e=Math.floor(e))<0||e>=this.touches.length?t.set_float(0):cr.is_undefined(i)?(n=(s=this.runtime.getLayerByNumber(0)).scale,r=s.zoomRate,o=s.parallaxY,a=s.angle,s.scale=1,s.zoomRate=1,s.parallaxY=1,s.angle=0,t.set_float(s.canvasToLayer(this.touches[e].x,this.touches[e].y,!1)),s.scale=n,s.zoomRate=r,s.parallaxY=o,s.angle=a):(s=cr.is_number(i)?this.runtime.getLayerByNumber(i):this.runtime.getLayerByName(i))?t.set_float(s.canvasToLayer(this.touches[e].x,this.touches[e].y,!1)):t.set_float(0)},_.prototype.YForID=function(t,e,i){var s=this.findTouch(e);if(s<0)t.set_float(0);else{var n,r,o,a,h,c=this.touches[s];cr.is_undefined(i)?(r=(n=this.runtime.getLayerByNumber(0)).scale,o=n.zoomRate,a=n.parallaxY,h=n.angle,n.scale=1,n.zoomRate=1,n.parallaxY=1,n.angle=0,t.set_float(n.canvasToLayer(c.x,c.y,!1)),n.scale=r,n.zoomRate=o,n.parallaxY=a,n.angle=h):(n=cr.is_number(i)?this.runtime.getLayerByNumber(i):this.runtime.getLayerByName(i))?t.set_float(n.canvasToLayer(c.x,c.y,!1)):t.set_float(0)}},_.prototype.AbsoluteX=function(t){this.touches.length?t.set_float(this.touches[0].x):t.set_float(0)},_.prototype.AbsoluteXAt=function(t,e){(e=Math.floor(e))<0||e>=this.touches.length?t.set_float(0):t.set_float(this.touches[e].x)},_.prototype.AbsoluteXForID=function(t,e){var i=this.findTouch(e);if(i<0)t.set_float(0);else{var s=this.touches[i];t.set_float(s.x)}},_.prototype.AbsoluteY=function(t){this.touches.length?t.set_float(this.touches[0].y):t.set_float(0)},_.prototype.AbsoluteYAt=function(t,e){(e=Math.floor(e))<0||e>=this.touches.length?t.set_float(0):t.set_float(this.touches[e].y)},_.prototype.AbsoluteYForID=function(t,e){var i=this.findTouch(e);if(i<0)t.set_float(0);else{var s=this.touches[i];t.set_float(s.y)}},_.prototype.SpeedAt=function(t,e){if((e=Math.floor(e))<0||e>=this.touches.length)t.set_float(0);else{var i=this.touches[e],s=cr.distanceTo(i.x,i.y,i.lastx,i.lasty),n=(i.time-i.lasttime)/1e3;n<=0?t.set_float(0):t.set_float(s/n)}},_.prototype.SpeedForID=function(t,e){var i=this.findTouch(e);if(i<0)t.set_float(0);else{var s=this.touches[i],n=cr.distanceTo(s.x,s.y,s.lastx,s.lasty),r=(s.time-s.lasttime)/1e3;r<=0?t.set_float(0):t.set_float(n/r)}},_.prototype.AngleAt=function(t,e){if((e=Math.floor(e))<0||e>=this.touches.length)t.set_float(0);else{var i=this.touches[e];t.set_float(cr.to_degrees(cr.angleTo(i.lastx,i.lasty,i.x,i.y)))}},_.prototype.AngleForID=function(t,e){var i=this.findTouch(e);if(i<0)t.set_float(0);else{var s=this.touches[i];t.set_float(cr.to_degrees(cr.angleTo(s.lastx,s.lasty,s.x,s.y)))}},_.prototype.Alpha=function(t){t.set_float(this.getAlpha())},_.prototype.Beta=function(t){t.set_float(this.getBeta())},_.prototype.Gamma=function(t){t.set_float(this.getGamma())},_.prototype.AccelerationXWithG=function(t){t.set_float(this.acc_g_x)},_.prototype.AccelerationYWithG=function(t){t.set_float(this.acc_g_y)},_.prototype.AccelerationZWithG=function(t){t.set_float(this.acc_g_z)},_.prototype.AccelerationX=function(t){t.set_float(this.acc_x)},_.prototype.AccelerationY=function(t){t.set_float(this.acc_y)},_.prototype.AccelerationZ=function(t){t.set_float(this.acc_z)},_.prototype.TouchIndex=function(t){t.set_int(this.trigger_index)},_.prototype.TouchID=function(t){t.set_float(this.trigger_id)},_.prototype.WidthForID=function(t,e){var i=this.findTouch(e);if(i<0)t.set_float(0);else{var s=this.touches[i];t.set_float(s.width)}},_.prototype.HeightForID=function(t,e){var i=this.findTouch(e);if(i<0)t.set_float(0);else{var s=this.touches[i];t.set_float(s.height)}},_.prototype.PressureForID=function(t,e){var i=this.findTouch(e);if(i<0)t.set_float(0);else{var s=this.touches[i];t.set_float(s.pressure)}},t.exps=new _}(),void 0===window)var window=void 0===window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window;var __CONSTRUCT2_RUNTIME2__=!0,__CONSTRUCT3_RUNTIME2__=!1,__CONSTRUCT3_RUNTIME3__=!1,__DEBUG__=!1;function flood_fill(t,e,i,s,n,r){if(!(s<0||s>e||n<0||n>i)){var o=$("<div></div>").css("background-color",r).css("background-color");"transparent"==o&&(o="rgb(0,0,0)"),o=o.slice(4,-1).split(",");var a=o[0],h=o[1],c=o[2],l=t[g=4*(n*e+s)],u=t[g+1],p=t[g+2];if(a!=l||h!=u||c!=p)for(var d=[[s,n]];d.length;){var f,g;for(f=d.pop(),s=f[0],n=f[1],g=4*(n*e+s);n-- >=0&&y(g);)g-=4*e;g+=4*e,++n;var m=[];for(m[-1]=!1,m[1]=!1;n++<i-1&&y(g);)_(g),s>0&&v(-1),s<e-1&&v(1),g+=4*e}}function y(e){return l==t[e]&&u==t[e+1]&&p==t[e+2]}function _(e){t[e]=a,t[e+1]=h,t[e+2]=c,t[e+3]=255}function v(t){y(g+4*t)?m[t]||(d.push([s+t,n]),m[t]=!0):m[t]&&(m[t]=!1)}}cr.plugins_.ValerypopoffJSPlugin=function(t){this.runtime=t},function(){var t=cr.plugins_.ValerypopoffJSPlugin.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var i=t.Instance.prototype;i.onCreate=function(){function t(t,e){if(void 0!==document){var i=document.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",e),i.onreadystatechange=function(){"complete"==this.readyState&&t.sciptsToLoad--},i.onload=function(){t.sciptsToLoad--},i.onerror=function(){t.ShowError({debug_caller:"Including '"+e+"' script to the page",caller_name:"Including '"+e+"' script to the page",error_message:"Probably file not found"})},document.getElementsByTagName("head")[0].appendChild(i)}else t.ShowError({debug_caller:"Including '"+e+"' script to the page",caller_name:"Including '"+e+"' script to the page",error_message:"'document' is not defined. You're probably launching the game in a Worker. Workers are not supported yet. Export project with 'Use worker' option unchecked in the 'Advanced' section of the 'Project properties' panel."})}if(this.returnValue=void 0,this.sciptsToLoad=0,this.Aliases={},this.construct_compare_function_prefix="ConstructCompare_",this.AliasDotpartsCache={count:0,max_count:4096,Dotparts:{},AliasNames:{},AliasTrailers:{},IsAlias:{}},this.NonAliasDotpartsCache={count:0,max_count:2048,Dotparts:{}},""!=this.properties[0]){var e=[];e=__CONSTRUCT2_RUNTIME2__?this.properties[0].split(";"):this.properties[0].split(/[;\n\r]/);for(var i=0;i<e.length;i++)if(e[i]=e[i].trim(),0!=e[i].length&&(this.sciptsToLoad++,__CONSTRUCT2_RUNTIME2__&&t(this,e[i]),__CONSTRUCT3_RUNTIME2__&&t(this,this.runtime.getLocalFileUrl(e[i])),__CONSTRUCT3_RUNTIME3__)){var s=this;void 0!==s._runtime.GetAssetManager().LoadProjectFileUrl?s._runtime.GetAssetManager().LoadProjectFileUrl(e[i]).then(function(e){t(s,e)},function(t){s.ShowError({debug_caller:"Including '"+e[i]+"' script to the page",caller_name:"Including '"+e[i]+"' script to the page",error_message:t.message})}).catch(function(t){s.ShowError({debug_caller:"Including '"+e[i]+"' script to the page",caller_name:"Including '"+e[i]+"' script to the page",error_message:t.message})}):t(s,s._runtime.GetAssetManager().GetLocalFileUrl(e[i]))}}},i.draw=function(t){},i.drawGL=function(t){};var s=function(t){return/^[$A-Z_][0-9A-Z_$]*$/i.test(t)},n=function(t){for(var e=[],i=0,s=0,r=0,o=t.length;r<o;r++)"["!=t[r]?"]"!=t[r]?"."==t[r]&&i==s&&e.push(r):s++:i++;var a=[],h=e.length-1;return e.forEach(function(i,s,n){var r=e[s-1],o=t.substring(r+1,i);""!=o&&a.push(o),s==h&&""!=(o=t.substring(i+1))&&a.push(o)}),0==a.length&&a.push(t),a.forEach(function(t,e,i){"["==t[0]&&(i[e]=n(t.substring(1,t.length-1)))}),a},r=function(t,e){return t=t.replace(/#[0-9]+/g,function(t){var i=e[t.substr(1)];return"string"==typeof i?"'"+i+"'":i})},o=function(t,e){var i=t+"(";if(e)for(var s=0,n=e.length;s<n;++s)"string"==typeof e[s]?i=i+"'"+e[s]+"'":i+=e[s],s!=e.length-1&&(i+=",");return i+=")"},a={Value(t,e){var i=e[0];e.splice(0,1);var s=this.ParseJS(i,!0,t);if(!s.error){var n=void 0;try{n=s.end}catch(e){var r={debug_caller:"Value",caller_name:t,"show-alias-expression":s.alias_found,alias_expression:s.trimmed_code,error_message:e.message};return this.ShowError(r),void ret.set_any(void 0)}return"function"==typeof s.end&&(n=this.CallJSfunction(i,e,!1,t,s)),n}ret.set_any(void 0)},CallJSfunction:function(t,e,i,s,n){if(void 0===i&&(i=!0),void 0===s&&(s="'Call function' action"),void 0===n)var r=this.ParseJS(t,!0,s);else r=n;if(!r.error){if(t.indexOf("(")>=0||t.indexOf(")")>=0){var a={debug_caller:"CallJSfunction",caller_name:s,error_message:"'"+r.trimmed_code+"' must be a function name, not a function call. Remove parentheses."};return r.alias_found&&(a["show-alias-expression"]=!0,a.alias_expression=r.trimmed_code),void this.ShowError(a)}var h=void 0;try{h=r.end.apply(r.context,e)}catch(i){i instanceof TypeError&&i.message.indexOf("apply")>=0&&i.message.indexOf("undefined")>=0&&(i.message=t+" is undefined");a={debug_caller:"CallJSfunction",caller_name:s,error_message:i.message};return r.alias_found?(a["show-alias-expression"]=!0,a.alias_expression=o(r.trimmed_code,e),a["show-code"]=!0,a.code=o(this.Aliases[r.alias_name].js+r.alias_trailer,e)):(a["show-code"]=!0,a.code=o(r.trimmed_code,e)),void this.ShowError(a)}return i&&(this.returnValue=h),h}},CallAlias:function(t,e,i,s){void 0===i&&(i=!0),void 0===s&&(s="'Call alias' action");var n=this.ParseJS(t,!0,s);if(!n.error)return this.CallJSfunction(this.Aliases[n.alias_name].js+n.alias_trailer,e,i,s,n)},ShowError:function(t){var e="ValerypopoffJS plugin: Error in "+t.caller_name+"\n";e+="--------------------- \n",__DEBUG__&&(e+="DEBUG CALLER: "+t.debug_caller+"\n",e+="--------------------- \n"),t["show-alias-expression"]&&(e+="Alias expression: "+t.alias_expression+"\n",e+="--------------------- \n"),t["show-code"]&&(e+="JS code: "+t.code+"\n",e+="--------------------- \n"),e+=t.error_message,console.error(e)},Resolve:function(t,e,i,n,r){for(var o=window,a=o,h="",c=0,l=t.length;c<l;c++){if("object"==typeof(h=t[c])){var u=this.Resolve(h,e,i,n,r);if(u.error)return{error:!0};h=u.end;try{a=a[h]}catch(t){var p={debug_caller:"Resolve",caller_name:e,error_message:t.message,"show-code":!0,code:i};return n&&(p["show-alias-expression"]=!0,p.code=this.Aliases[n].js+r,p.alias_expression=i),this.ShowError(p),{error:!0}}}else try{o==window?s(h)?a=a[h]:("'"==h[0]&&(h=h.substring(1,h.length-1)),a=h):a=a[h]}catch(t){p={debug_caller:"Resolve",caller_name:e,error_message:t.message,"show-code":!0,code:i};return n&&(p["show-alias-expression"]=!0,p.code=this.Aliases[n].js+r,p.alias_expression=i),this.ShowError(p),{error:!0}}c<l-1&&(o=a)}return{error:!1,context:o,end:a,endname:h}},ParseJS:function(t,e,i){var s=!1,r=void 0,o=void 0,a=[],h=void 0,c=t.trim().replace(/\s*([\.\[\]])\s*/g,"$1");if((h=this.AliasDotpartsCache).Dotparts[c])a=h.Dotparts[c],h.IsAlias[c]&&(s=!0,r=h.AliasNames[c],o=h.AliasTrailers[c]);else{if(r=c.split(/[\.\[]/)[0],o=c.substring(r.length),this.Aliases[r]?(s=!0,a=n(o?this.Aliases[r].dotstring+o.split("[").join(".["):this.Aliases[r].dotstring)):(r=void 0,o=void 0,a=n(c.split("[").join(".["))),h.count>=h.max_count)for(var l in h.Dotparts)if(delete h.Dotparts[l],h.IsAlias[l]&&(delete h.AliasNames[l],delete h.AliasTrailers[l],delete h.IsAlias[l]),h.count--,h.count<=h.max_count)break;h.Dotparts[c]=a,s&&(h.AliasNames[c]=r,h.AliasTrailers[c]=o,h.IsAlias[c]=!0),h.count++}var u=this.Resolve(a,i,c,r,o);return{error:u.error,end:u.end,endname:u.endname,context:u.context,trimmed_code:c,alias_found:s,alias_name:r,alias_trailer:o}}};for(var h in a)i[h]=a[h];function c(){}var l={C2CompareFunctionReturnValue:function(t,e,i,s){switch(e){case 2:e=4;break;case 3:e=5;break;case 4:e=2;break;case 5:e=3}return this.CNDS.CompareFunctionReturnValue.call(this,i,s,e,t)},C2CompareAliasCallReturnValue:function(t,e,i,s){switch(e){case 2:e=4;break;case 3:e=5;break;case 4:e=2;break;case 5:e=3}return this.CNDS.CompareAliasCallReturnValue.call(this,i,s,e,t)},C2CompareExecReturnWithParams:function(t,e,i,s){switch(e){case 2:e=4;break;case 3:e=5;break;case 4:e=2;break;case 5:e=3}return this.CNDS.CompareExecReturnWithParams.call(this,i,s,e,t)},C2CompareValue:function(t,e,i,s){switch(e){case 2:e=4;break;case 3:e=5;break;case 4:e=2;break;case 5:e=3}return this.CNDS.CompareValue.call(this,i,s,e,t)},CompareExecReturnWithParams:function(t,e,i,s){var n=void 0,o="'Compare JS code Completion value' condition";e.length&&(t=r(t,e));try{n=eval(t)}catch(e){var a={debug_caller:"CompareExecReturnWithParams",caller_name:o,error_message:e.message,"show-code":!0,code:t};return void this.ShowError(a)}return"boolean"==typeof n&&(n=n?1:0),cr.do_cmp(n,i,s)},CompareFunctionReturnValue:function(t,e,i,s){var n=void 0;return"boolean"==typeof(n=this.CallJSfunction(t,e,!1,"'Compare Function return value' condition"))&&(n=n?1:0),cr.do_cmp(n,i,s)},CompareStoredReturnValue:function(t,e){var i=this.returnValue;return"boolean"==typeof i&&(i=i?1:0),cr.do_cmp(i,t,e)},AllScriptsLoaded:function(){return this.sciptsToLoad<=0},CompareValue:function(t,e,i,s){var n=void 0;return"boolean"==typeof(n=this.Value("'Compare Value' condition",[].concat(t,e)))&&(n=n?1:0),cr.do_cmp(n,i,s)},CompareAliasValue:function(t,e,i){var s="'Compare alias' condition",n=this.ParseJS(t,!0,"'Set alias' action");if(n.alias_found){if(!n.error){var r=n.context[this.construct_compare_function_prefix+n.endname];if(!r||"object"!=typeof n.context){var o=n.end;return"boolean"==typeof o&&(o=o?1:0),cr.do_cmp(o,e,i)}try{return r.call(n.context,e,i)}catch(t){a={debug_caller:"CompareAliasValue",caller_name:s,"show-alias-expression":!0,alias_expression:n.trimmed_code,error_message:"Error in user defined '"+this.construct_compare_function_prefix+n.endname+"' function: "+t.message};return void this.ShowError(a)}}}else{var a={debug_caller:"CompareAliasValue",caller_name:s,error_message:"No such alias '"+t+"'"};this.ShowError(a)}},CompareAliasCallReturnValue:function(t,e,i,s){var n=void 0;return"boolean"==typeof(n=this.CallAlias(t,e,!1,"'Compare Alias Call return value' condition"))&&(n=n?1:0),cr.do_cmp(n,i,s)}};for(var h in l)c.prototype[h]=l[h];function u(){}t.cnds=new c;var p={ExecuteJSWithParams:function(t,e){var i="'Execute JS code' action";this.returnValue=void 0,t=t.replace(/#[0-9]+/g,function(t){var i=e[t.substr(1)];return"string"==typeof i?"'"+i+"'":i});try{this.returnValue=eval(t)}catch(e){return void this.ShowError({debug_caller:"ExecuteJSWithParams",caller_name:i,"show-code":!0,code:t,error_message:e.message})}},CallJSfunction:function(t,e,i,s,n){this.CallJSfunction(t,e,i,s,n)},SetValue:function(t,e){var i="'Set value' action",s=this.ParseJS(t,!0,i);if(!s.error)try{s.context[s.endname]=e}catch(o){var n=t+"=";"string"==typeof e?n=n+"'"+e+"'":n+=e;var r={debug_caller:"SetValue",caller_name:i,"show-alias-expression":s.alias_found,alias_expression:s.trimmed_code,"show-code":!0,code:n,error_message:o.message};return void this.ShowError(r)}},Call:function(t,e,i,s){this.CallJSfunction(t,e,!0,"'Call' action")},InitAlias:function(t,e){var i="'Init alias' action";if(t=t.trim(),0!=(e=e.trim()).length)if(t.indexOf(".")>=0||t.indexOf("[")>=0||t.indexOf("]")>=0){n={debug_caller:"InitAlias",caller_name:i,error_message:"Alias name must not contain '.', '[' or ']' signs: '"+t+"'"};this.ShowError(n)}else if(null==this.Aliases[t]){var s=new Object;s.js=e,s.dotstring=e.split("[").join(".["),this.Aliases[t]=s}else{n={debug_caller:"InitAlias",caller_name:i,error_message:"Alias '"+t+"' already exists"};this.ShowError(n)}else{var n={debug_caller:"InitAlias",caller_name:i,error_message:"Javascript string of alias '"+t+"' must not be empty."};this.ShowError(n)}},SetAlias:function(t,e){var i="'Set alias' action",s=this.ParseJS(t,!0,"'Set alias' action");if(s.alias_found){if(!s.error)try{s.context[s.endname]=e}catch(o){var n=t+"=";"string"==typeof e?n=n+"'"+e+"'":n+=e;r={debug_caller:"SetAlias",caller_name:i,"show-alias-expression":!0,alias_expression:s.trimmed_code,"show-code":!0,code:n,error_message:o.message};return void this.ShowError(r)}}else{var r={debug_caller:"SetAlias",caller_name:i,error_message:"No such alias '"+s.trimmed_code+"'"};this.ShowError(r)}},CallAlias:function(t,e,i,s){this.CallAlias(t,e,i,s)}};for(var h in p)u.prototype[h]=p[h];function d(){}t.acts=new u;var f={JSCodeValue:function(){var t=Array.prototype.slice.call(arguments),e;if(__CONSTRUCT3_RUNTIME3__)e={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{e=t[0];for(var i=0;i<t.length-1;i++)t[i]=t[i+1];t.pop()}var s=t[0],n="'JSCodeValue' expression",o=s;t.splice(0,1),t.length&&(o=r(o,t));var a=void 0;try{a=eval(o)}catch(t){return this.ShowError({debug_caller:"JSCodeValue",caller_name:n,"show-code":!0,code:o,error_message:t.message}),void e.set_any(void 0)}if("boolean"==typeof a){if(e.set_any(a?1:0),__CONSTRUCT3_RUNTIME3__)return a?1:0}else if(e.set_any(a),__CONSTRUCT3_RUNTIME3__)return a},StoredReturnValue:function(){var t,e=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)t={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{t=e[0];for(var i=0;i<e.length-1;i++)e[i]=e[i+1];e.pop()}if("boolean"==typeof this.returnValue){if(t.set_any(this.returnValue?1:0),__CONSTRUCT3_RUNTIME3__)return this.returnValue?1:0}else if(t.set_any(this.returnValue),__CONSTRUCT3_RUNTIME3__)return this.returnValue},FunctionReturnValue:function(){var t,e=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)t={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{t=e[0];for(var i=0;i<e.length-1;i++)e[i]=e[i+1];e.pop()}var s=e[0],n="'FunctionReturnValue' expression",r=this.ParseJS(s,!1,n);if(e.splice(0,1),r.error)t.set_any(void 0);else{var o;if("boolean"==typeof(o=this.CallJSfunction(s,e,!1,n,r))){if(t.set_any(o?1:0),__CONSTRUCT3_RUNTIME3__)return o?1:0}else if(t.set_any(o),__CONSTRUCT3_RUNTIME3__)return o}},Value:function(){var t,e=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)t={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{t=e[0];for(var i=0;i<e.length-1;i++)e[i]=e[i+1];e.pop()}var s=this.Value("'Value' expression",e);if("boolean"==typeof s){if(t.set_any(s?1:0),__CONSTRUCT3_RUNTIME3__)return s?1:0}else if(t.set_any(s),__CONSTRUCT3_RUNTIME3__)return s},AliasValue:function(){var t,e=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)t={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{t=e[0];for(var i=0;i<e.length-1;i++)e[i]=e[i+1];e.pop()}var s=e[0],n="'AliasValue' expression",r=this.ParseJS(s,!0,n);if(!r.alias_found){var o={debug_caller:"AliasValue",caller_name:n,error_message:"No such alias '"+r.trimmed_code+"'"};return this.ShowError(o),void t.set_any(void 0)}if(r.error)t.set_any(void 0);else{var a=void 0;try{a=r.end}catch(e){o={debug_caller:"AliasValue",caller_name:n,"show-alias-expression":!0,alias_expression:r.trimmed_code,error_message:e.message};return this.ShowError(o),void t.set_any(void 0)}if("boolean"==typeof a){if(t.set_any(a?1:0),__CONSTRUCT3_RUNTIME3__)return a?1:0}else if(t.set_any(a),__CONSTRUCT3_RUNTIME3__)return a}},AliasCallReturnValue:function(){var t,e=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)t={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{t=e[0];for(var i=0;i<e.length-1;i++)e[i]=e[i+1];e.pop()}var s=e[0],n="'AliasCallValue' expression",r=this.ParseJS(s,!0,n);if(e.splice(0,1),!r.alias_found){var o={debug_caller:"AliasCallValue",caller_name:n,error_message:"No such alias '"+r.trimmed_code+"'"};return this.ShowError(o),void t.set_any(void 0)}if(r.error)t.set_any(void 0);else{var a;if("boolean"==typeof(a=this.CallJSfunction(s,e,!1,n,r))){if(t.set_any(a?1:0),__CONSTRUCT3_RUNTIME3__)return a?1:0}else if(t.set_any(a),__CONSTRUCT3_RUNTIME3__)return a}}};for(var h in f)d.prototype[h]=f[h];t.exps=new d,i.EXPS=t.exps,i.CNDS=t.cnds,i.ACTS=t.acts}(),cr.plugins_.aekiro_model=function(t){this.runtime=t},function(){var t=cr.plugins_.aekiro_model.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(t,e){return null!=t&&null!=e&&(t==e||(t.slice(0,e.length+1)==e+"."||e.slice(0,t.length+1)==t+"."))}e.onCreate=function(){if(this.tag=this.properties[0],this.lang_root=this.properties[1],this.hashtable={},this.currentEntry=this.hashtable,this.exp_CurKey="",this.exp_CurValue=0,this.exp_Loopindex=0,this.uiType="model",this.linkedBehaviors=[],this.linkedBehaviors_lastResetTick=0,this.linkedLabels=[],this.linkedLabels_lastResetTick=0,this.lang_code="",this.hashtable={},this.tag){if(!cr.proui)throw new Error("ProUI Plugin not found. Please add it to the project.");cr.proui.addTag(this.tag,this)}this.proui=cr.proui,this.model_plugin=cr.plugins_.aekiro_model.prototype;var t=this;window.aekiro_model_value_set=function(e,i,s){var n=t.proui.tags[e];t.model_plugin.acts.SetValueByKeyString.call(n,i,s)},window.aekiro_model_json_set=function(e,i,s){var n=t.proui.tags[e];t.model_plugin.acts.SetJSONByKeyString.call(n,i,s)},window.aekiro_model=function(e,i,s){var n=t.proui.tags[e];t.model_plugin.acts[i].apply(n,s)}},e.registerBehavior=function(t){this.runtime.extra.notRegister||(this.runtime.changelayout&&this.linkedBehaviors_lastResetTick!=this.runtime.tickcount&&(this.linkedBehaviors.length=0,this.linkedBehaviors_lastResetTick=this.runtime.tickcount),this.linkedBehaviors.push(t))},e.registerLabel=function(t){this.runtime.extra.notRegister||(this.runtime.changelayout&&this.linkedLabels_lastResetTick!=this.runtime.tickcount&&(this.linkedLabels.length=0,this.linkedLabels_lastResetTick=this.runtime.tickcount),this.linkedLabels.push(t))},e.unregisterBehavior=function(t){this.removeFromArray(this.linkedBehaviors,t)},e.unregisterLabel=function(t){this.removeFromArray(this.linkedLabels,t)},e.removeFromArray=function(t,e){for(var i=0,s=t.length;i<s;i++)if(t[i]==e)return void t.splice(i,1)},e.notifyBehaviorModels=function(t,e){var s=null;e&&(s=e.except);var n=this.linkedBehaviors;if(n.length)for(var r=0,o=n.length;r<o;r++)n[r]!=s?("root"==t||"root"==n[r].modelKey||i(n[r].modelKey,t))&&n[r].setElementValue(this.getValue(n[r].modelKey),e):console.log("except :"+s.inst.uid)},e.updateLabels=function(){var t,e,i=this.linkedLabels;if(i&&(e=this.lang_root?this.lang_root+"."+this.lang_code:this.lang_code,t=this.getValue(e)))for(var s=0,n=i.length;s<n;s++)null!=(t=this.getValue(e+"."+i[s].modelKey))&&i[s]._setValue(t)},e.getLocalisedLabel=function(t){var e;return e=this.lang_root?this.lang_root+"."+this.lang_code:this.lang_code,this.getValue(e+"."+t)},e.cleanAll=function(){var t;for(t in this.hashtable)delete this.hashtable[t];this.currentEntry=this.hashtable},e.getEntry=function(t,e){var i,s=e||this.hashtable;if(!t||""===t||"root"==t||0==t.length)return s;"string"==typeof t&&(t=t.split("."));for(var n=0,o=t.length;n<o;n++){if(i=t[n],r(s)){var a=parseInt(i);if(a<0||a>=s.length)throw console.error("MODEL %s: setting item %s while array only have %s !",this.uid,a,s.length),"err"}null!=s[i]&&"object"==typeof s[i]||(s[i]={}),s=s[i]}return s},e.getValue=function(t,e){var i,s=e||this.hashtable;if(!t||""===t||"root"==t||0==t.length)return s;"string"==typeof t&&(t=t.split("."));for(var n=0,r=t.length;n<r;n++){if(i=t[n],!s.hasOwnProperty(i))return;s=s[i]}return s},e.setValue=function(t,e,i){if(""===t||0===t.length)null!==e&&"object"==typeof e&&(null==i?this.hashtable=e:i=e);else{null==i&&(i=this.hashtable),"string"==typeof t&&(t=t.split("."));var s=t.pop();try{var n=this.getEntry(t,i)}catch(t){throw"err"}if(r(n)){var o=parseInt(s);if(o<0||o>=n.length)return void console.error("MODEL %s: setting item %s while array only have %s !",this.uid,o,n.length)}n[s]=e}},e.removeKey=function(t){if(""===t||0===t.length)this.cleanAll();else{if("string"==typeof t&&(t=t.split(".")),void 0===this.getValue(t))return;var e=t.pop(),i=this.getEntry(t);if(r(i)){if(e<0||e>=i.length)return;e===i.length-1?i.pop():0===e?i.shift():i.splice(e,1)}else delete i[e]}};var s=function(t){if(null==t)return-1;if("number"==typeof t||"string"==typeof t)return 0;if(null!=t.length)return t.length;var e,i=0;for(e in t)i+=1;return i},n=function(t,e){return!0===t?1:!1===t?0:null==t||null==t?null!=e&&null!=e?e:0:"object"==typeof t?JSON.stringify(t):t},r=function(t){return t instanceof Array};function o(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function a(){}function h(){}function c(){}e.saveToJSON=function(){return{d:this.hashtable}},e.loadFromJSON=function(t){this.hashtable=t.d},e.onDestroy=function(){},t.cnds=new a,a.prototype.ForEachItem=function(t){var e=this.getEntry(t),i=this.runtime.getCurrentEventStack(),s=i.current_event,n=i.isModifierAfterCnds();for(t in this.exp_Loopindex=-1,e)n&&this.runtime.pushCopySol(s.solModifiers),this.exp_CurKey=t,this.exp_CurValue=e[t],this.exp_Loopindex++,s.retrigger(),n&&this.runtime.popSol(s.solModifiers);return this.exp_CurKey="",this.exp_CurValue=0,!1},a.prototype.KeyExists=function(t){return""!=t&&void 0!==this.getValue(t)},a.prototype.IsEmpty=function(t){var e=this.getEntry(t);return s(e)<=0},t.acts=new h,h.prototype.SetValueByKeyString=function(t,e,i){if(""!=t&&"root"!=t){try{this.setValue(t,e)}catch(t){return}i||(i={}),i.op=4,i.key=t,i.value=e,this.notifyBehaviorModels(t,i)}else console.error("MODEL %s: You can't set the root to a simple value !",this.tag)},h.prototype.SetJSONByKeyString=function(t,e){if(null===(i=e)||"function"!=typeof i&&"object"!=typeof i)try{e=JSON.parse(e)}catch(i){return console.error("MODEL %s: SetJSONByKeyString() **** The json you are trying to set is not valid !"),console.error("key = %s",t),console.error("value = %s",e),void console.error("********************* ")}var i;try{this.setValue(t,e)}catch(t){return}this.notifyBehaviorModels(t,{op:2})},h.prototype.AddToValueByKeyString=function(t,e,i){if(""!==t){var s=t.split("."),n=this.getValue(s)||0;try{this.setValue(s,n+e)}catch(t){return}i||(i={}),e=this.getValue(t)||0,i.op=4,i.key=t,i.value=e,this.notifyBehaviorModels(t,i)}},h.prototype.PushValue=function(t,e){var i=this.getEntry(t);(null==i||o(i))&&(this.setValue(t,[]),i=this.getEntry(t)),r(i)?(i.push(e),this.notifyBehaviorModels(t,{op:1})):console.log("not an array")},h.prototype.PushJSON=function(t,e){try{e=JSON.parse(e)}catch(t){return void console.error("MODEL PLugin: The json you are trying to push is not valid !")}h.prototype.PushValue.call(this,t,e)},h.prototype.InsertValue=function(t,e,i){var s=this.getEntry(t);(null==s||o(s))&&(this.setValue(t,[]),s=this.getEntry(t)),r(s)?s.length<i?console.error("MODEL PLugin: Can't insert item at %s while array only has %s !",i,s.length):(s.splice(i,0,e),this.notifyBehaviorModels(t,{op:3,idx:i})):console.log(this.hashtable)},h.prototype.InsertJSON=function(t,e,i){try{e=JSON.parse(e)}catch(t){return void console.error("MODEL PLugin: The json you are trying to insert is not valid !")}h.prototype.InsertValue.call(this,t,e,i)},h.prototype.RemoveItemByIndex=function(t,e){var i=this.getEntry(t);null!=i&&!o(i)&&r(i)?e<0||e>=i.length||(e===i.length-1?i.pop():0===e?i.shift():i.splice(e,1),this.notifyBehaviorModels(t,{op:-1,idx:e})):console.log("The value at key = "+t+" is empty or not an array")},h.prototype.RemoveByKeyString=function(t){this.removeKey(t),this.notifyBehaviorModels(t)},h.prototype.CleanAll=function(){this.cleanAll(),this.notifyBehaviorModels("root")},h.prototype.StringToHashTable=function(t){if(""!=t){try{this.hashtable=JSON.parse(t)}catch(t){return void console.error("MODEL PLugin: The json you are trying to load is not valid !",t)}this.notifyBehaviorModels("root",{op:2})}else this.cleanAll()},h.prototype.SetLanguage=function(t){this.lang_code=t,this.updateLabels()},t.exps=new c,c.prototype.at=function(t,e,i){e=e.split(".");var s=n(this.getValue(e),i);t.set_any(s)},c.prototype.arrayValueByValue=function(t,e,i,s,o,a){var h=this.getValue(e),c=0;if(!r(h))return console.log("not an array"),void t.set_any(c);for(var l=0,u=h.length;l<u;l++)if(this.getValue(i,h[l])==s){c=this.getValue(o,h[l]);break}c=n(c,a),t.set_any(c)},c.prototype.curKey=function(t){t.set_string(this.exp_CurKey)},c.prototype.curValue=function(t,e,i){var s=this.getValue(e,this.exp_CurValue);s=n(s,i),t.set_any(s)},c.prototype.loopindex=function(t){t.set_int(this.exp_Loopindex)},c.prototype.asJSON=function(t){var e=JSON.stringify(this.hashtable);t.set_string(e)},c.prototype.makeJSON=function(t){var e={};if(arguments.length>1){var i,s=arguments.length;for(i=1;i<s;i+=2)e[arguments[i]]=arguments[i+1]}t.set_string(JSON.stringify(e))},c.prototype.makeArray=function(t){var e=[];if(arguments.length>1){var i,s=arguments.length;for(i=1;i<s;i++)e.push(arguments[i])}t.set_string(JSON.stringify(e))},c.prototype.pop=function(t,e,i){var s,r=this.getEntry(e);s=null==r?0:null==i||i===r.length-1?r.pop():r.splice(i,1),t.set_any(n(s))},c.prototype.shift=function(t,e){var i,s=this.getEntry(e);i=null==s?0:s.shift(),t.set_any(n(i))},c.prototype.itemCnt=function(t,e){var i=s(this.getValue(e));t.set_int(i)}}(),cr.plugins_.aekiro_proui2=function(t){this.runtime=t},function(){var t=cr.plugins_.aekiro_proui2.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime,this.touches=[],this.mouseDown=!1,this.touchDown=!1,this.cursor={x:null,y:null},this._callbackObjs={},this._callbackObjs.touch=[],this._callbackObjs.wheel=[],this.handled=!1};var e=t.Instance.prototype,i={left:0,top:0};e.findTouch=function(t){var e,i;for(e=0,i=this.touches.length;e<i;e++)if(this.touches[e].id===t)return e;return-1};var s=[];function n(t,e,i,n){var r;return(r=s.length?s.pop():new o).init(t,e,i,n),r}function r(t){s.length<100&&s.push(t)}function o(){this.starttime=0,this.time=0,this.lasttime=0,this.startx=0,this.starty=0,this.x=0,this.y=0,this.lastx=0,this.lasty=0,this.id=0,this.startindex=0,this.triggeredHold=!1,this.tooFarForHold=!1}o.prototype.init=function(t,e,i,s){var n=cr.performance_now();this.time=n,this.lasttime=n,this.starttime=n,this.startx=t,this.starty=e,this.x=t,this.y=e,this.lastx=t,this.lasty=e,this.width=0,this.height=0,this.pressure=0,this.id=i,this.startindex=s,this.triggeredHold=!1,this.tooFarForHold=!1},o.prototype.update=function(t,e,i,s,n,r){this.lasttime=this.time,this.time=t,this.lastx=this.x,this.lasty=this.y,this.x=e,this.y=i,this.width=s,this.height=n,this.pressure=r,!this.tooFarForHold&&cr.distanceTo(this.startx,this.starty,this.x,this.y)>=15&&(this.tooFarForHold=!0)};var a=-1e3,h=-1e3,c=-1e4;function l(t,e){var i,s;for(i=0,s=t.behavior_insts.length;i<s;i++)if(t.behavior_insts[i]instanceof e.Instance)return t.behavior_insts[i];return null}o.prototype.maybeTriggerTap=function(t,e){if(!this.triggeredHold){var i=cr.performance_now();i-this.starttime<=333&&!this.tooFarForHold&&cr.distanceTo(this.startx,this.starty,this.x,this.y)<15&&(t.trigger_index=this.startindex,t.trigger_id=this.id,t.getTouchIndex=e,i-c<=666&&cr.distanceTo(a,h,this.x,this.y)<25?(t.curTouchX=this.x,t.curTouchY=this.y,a=-1e3,h=-1e3,c=-1e4):(t.curTouchX=this.x,t.curTouchY=this.y,a=this.x,h=this.y,c=i),t.getTouchIndex=0)}},e.onCreate=function(){this.isWindows8=!(void 0===window.c2isWindows8||!window.c2isWindows8),this.curTouchX=0,this.curTouchY=0,this.trigger_index=0,this.trigger_id=0,this.getTouchIndex=0,this.useMouseInput=!0;var t=this.runtime.fullscreen_mode>0?document:this.runtime.canvas,e=document;this.runtime.isDirectCanvas?e=t=window.Canvas:this.runtime.isCocoonJs&&(e=t=window);var i=this;if("undefined"!=typeof PointerEvent?(t.addEventListener("pointerdown",function(t){i.onPointerStart(t)},!1),t.addEventListener("pointermove",function(t){i.onPointerMove(t)},!1),e.addEventListener("pointerup",function(t){i.onPointerEnd(t,!1)},!1),e.addEventListener("pointercancel",function(t){i.onPointerEnd(t,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1),document.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1),this.runtime.canvas.addEventListener("gesturehold",function(t){t.preventDefault()},!1),document.addEventListener("gesturehold",function(t){t.preventDefault()},!1))):window.navigator.msPointerEnabled?(t.addEventListener("MSPointerDown",function(t){i.onPointerStart(t)},!1),t.addEventListener("MSPointerMove",function(t){i.onPointerMove(t)},!1),e.addEventListener("MSPointerUp",function(t){i.onPointerEnd(t,!1)},!1),e.addEventListener("MSPointerCancel",function(t){i.onPointerEnd(t,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1),document.addEventListener("MSGestureHold",function(t){t.preventDefault()},!1))):(t.addEventListener("touchstart",function(t){i.onTouchStart(t)},!1),t.addEventListener("touchmove",function(t){i.onTouchMove(t)},!1),e.addEventListener("touchend",function(t){i.onTouchEnd(t,!1)},!1),e.addEventListener("touchcancel",function(t){i.onTouchEnd(t,!0)},!1)),this.useMouseInput&&!this.runtime.isDomFree&&(jQuery(document).mousemove(function(t){i.onMouseMove(t)}),jQuery(document).mousedown(function(t){i.onMouseDown(t)}),jQuery(document).mouseup(function(t){i.onMouseUp(t)})),!this.runtime.isDomFree){var s=function(t){i.onWheel(t)};document.addEventListener("mousewheel",s,!1),document.addEventListener("DOMMouseScroll",s,!1)}this.runtime.tick2Me(this),this.enable=!0,this.lastTouchX=null,this.lastTouchY=null,cr.proui=this,this.cssURL=this.properties[0],this.fontFamily=this.properties[1],this.defaultSoundTag=this.properties[2],this.useHowler=0===this.properties[3],this.firstFrame=!0;this.runtime;this.toBeDestroyed=[],this.currentDialogs=[],this.currentDialogs_lastResetTick=0,this.tags={},this.tags_lastResetTick=0,this.scrollViews={},this.iter=0,this.notRegister=!1,this.areInputsActive=!0},e.getIter=function(){return this.iter++,this.iter},e.setNoRegister=function(){},e.addTag=function(t,e){this.runtime.extra||(this.runtime.extra={}),!this.runtime.extra.notRegister&&t&&(this.tags.hasOwnProperty(t)?console.error("PROUI: Tag %s already exist !",t):this.tags[t]=e)},e.removeTag=function(t){delete this.tags[t]},e.addDialog=function(t){this.runtime.changelayout&&this.currentDialogs_lastResetTick!=this.runtime.tickcount&&(this.currentDialogs.length=0,this.currentDialogs_lastResetTick=this.runtime.tickcount),this.currentDialogs.push(t)},e.isModalDialogOpened=function(){for(var t=0;t<this.currentDialogs.length;t++)if(this.currentDialogs[t].isModal)return!0;return!1},e.removeDialog=function(t){this.removeFromArray(this.currentDialogs,t)},e.removeFromArray=function(t,e){for(var i=0,s=t.length;i<s;i++)if(t[i]==e)return void t.splice(i,1)},e.clearDestroyList=function(){for(var t=this.toBeDestroyed,e=0,i=t.length;e<i;e++)this.runtime.DestroyInstance(t[e]);t.length=0},e.playAudio=function(t){if(this.useHowler)this.getDependency(cr.plugins_.skymenhowlerjs,"howler"),this.howler?cr.plugins_.skymenhowlerjs.prototype.acts.PlayByName.call(this.howler,t,this.defaultSoundTag):console.error("ProUI: Please add the Howler plugin to the project.");else if(this.getDependency(cr.plugins_.Audio,"audio"),this.audio){var e={val:0,set_float(t){e.val=t}};cr.plugins_.Audio.prototype.exps.Volume.call(this.audio,e,this.defaultSoundTag);var i=e.val;cr.plugins_.Audio.prototype.acts.PlayByName.call(this.audio,0,t,0,i,this.defaultSoundTag)}else console.error("ProUI: Please add the Audio plugin to the project.")},e.getDependency=function(t,e){if(null!=this[e])return this[e];if(t){var i,s,n=this.runtime.types;for(i in n)if((s=n[i].instances[0])instanceof t.prototype.Instance)return this[e]=s,this[e];this[e]||console.error("ProUI: Can not find "+e+" object.")}else console.error("ProUI: Can not find the "+e+" object.")},e.isTypeValid=function(t,e,i){for(var s=0,n=e.length;s<n;s++)if(!!e[s]&&t.type.plugin instanceof e[s])return;throw new Error(i)},e.runCallback=function(t,e){if(""!=t){var i=e.split(","),s=window.c2_callFunction;s?s(t,i):console.error("ProUI : Please add the Function plugin to the project.")}},e.validateSimpleValue=function(t,e){return!0===t?1:!1===t?0:null==t||null==t||"object"==typeof t?null!=e&&null!=e?e:0:t},e.HookMe=function(t,e){for(var i,s=0,n=e.length;s<n;s++)i=e[s],this._callbackObjs[i].push(t)},e.UnHookMe=function(t,e){for(var i,s=0,n=e.length;s<n;s++)i=e[s],cr.arrayFindRemove(this._callbackObjs[i],t)};var u=function(t,e){for(var i,s,n,r,o=this.my_instances.valuesRef(),a=0,h=o.length;a<h;a++)(i=o[a])&&i.layer.visible&&i.visible&&(n=i.layer.canvasToLayer(t,e,!0),r=i.layer.canvasToLayer(t,e,!1),i.update_bbox(),(s=l(i,this)).OnAnyTouchStart&&s.OnAnyTouchStart(),i.contains_pt(n,r)&&s.OnTouchStart&&s.OnTouchStart(n,r))},p=function(t,e){for(var i,s,n,r,o=this.my_instances.valuesRef(),a=0,h=o.length;a<h;a++)(i=o[a])&&i.layer.visible&&i.visible&&(n=i.layer.canvasToLayer(t,e,!0),r=i.layer.canvasToLayer(t,e,!1),i.update_bbox(),s=l(i,this),i.contains_pt(n,r)&&s.OnTouchMove&&s.OnTouchMove(n,r))},d=function(t,e){for(var i,s,n,r,o=this.my_instances.valuesRef(),a=0,h=o.length;a<h;a++)(i=o[a])&&(n=i.layer.canvasToLayer(t,e,!0),r=i.layer.canvasToLayer(t,e,!1),(s=l(i,this)).OnAnyTouchEnd&&s.OnAnyTouchEnd(n,r))},f=function(t){for(var e,i,s=this.my_instances.valuesRef(),n=0,r=s.length;n<r;n++)(e=s[n])&&(i=l(e,this)).OnWheel&&i.OnWheel(t)};function g(){}function m(){}e.onWheel=function(t){var e=t.wheelDelta?t.wheelDelta:t.detail?-t.detail:0;this.triggerDir=e<0?0:1,this.handled=!1,this.runtime.isInUserInputEvent=!0;for(var i=0,s=this._callbackObjs.wheel.length;i<s;i++)this.handled=!0,f.call(this._callbackObjs.wheel[i],this.triggerDir);this.runtime.isInUserInputEvent=!1,this.handled&&cr.isCanvasInputEvent(t)&&t.preventDefault()},e.onPointerMove=function(t){if(this.enable&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){t.preventDefault&&t.preventDefault();var e=this.findTouch(t.pointerId),s=cr.performance_now();if(e>=0){var n=this.runtime.isDomFree?i:jQuery(this.runtime.canvas).offset(),r=this.touches[e];if(s-r.time<2)return;r.update(s,t.pageX-n.left,t.pageY-n.top,t.width||0,t.height||0,t.pressure||0);var o,a=t.pageX-n.left,h=t.pageY-n.top,c=this._callbackObjs.touch.length;for(o=0;o<c;o++)p.call(this._callbackObjs.touch[o],a,h)}}},e.onPointerStart=function(t){if(this.enable&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){t.preventDefault&&cr.isCanvasInputEvent(t)&&t.preventDefault();var e=this.runtime.isDomFree?i:jQuery(this.runtime.canvas).offset(),s=t.pageX-e.left,r=t.pageY-e.top;cr.performance_now();this.trigger_index=this.touches.length,this.trigger_id=t.pointerId,this.touches.push(n(s,r,t.pointerId,this.trigger_index)),this.runtime.isInUserInputEvent=!0,this.curTouchX=s,this.curTouchY=r;var o,a=this._callbackObjs.touch.length;for(o=0;o<a;o++)u.call(this._callbackObjs.touch[o],this.curTouchX,this.curTouchY);this.runtime.isInUserInputEvent=!1}},e.onPointerEnd=function(t,e){if(this.enable&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType){t.preventDefault&&cr.isCanvasInputEvent(t)&&t.preventDefault();var i=this.findTouch(t.pointerId);this.trigger_index=i>=0?this.touches[i].startindex:-1,this.trigger_id=i>=0?this.touches[i].id:-1,this.runtime.isInUserInputEvent=!0,i>=0&&(this.lastTouchX=this.touches[i].x,this.lastTouchY=this.touches[i].y);var s,n=this._callbackObjs.touch.length;for(s=0;s<n;s++)d.call(this._callbackObjs.touch[s],this.lastTouchX,this.lastTouchY);i>=0&&(e||this.touches[i].maybeTriggerTap(this,i),r(this.touches[i]),this.touches.splice(i,1)),this.runtime.isInUserInputEvent=!1}},e.onTouchMove=function(t){if(this.enable){t.preventDefault&&t.preventDefault();var e,s,n,r,o,a=cr.performance_now(),h=this._callbackObjs.touch.length;for(e=0,s=t.changedTouches.length;e<s;e++){n=t.changedTouches[e];var c=this.findTouch(n.identifier);if(c>=0){var l=this.runtime.isDomFree?i:jQuery(this.runtime.canvas).offset();if(a-(r=this.touches[c]).time<2)continue;var u=2*(n.radiusX||n.webkitRadiusX||n.mozRadiusX||n.msRadiusX||0),d=2*(n.radiusY||n.webkitRadiusY||n.mozRadiusY||n.msRadiusY||0),f=n.force||n.webkitForce||n.mozForce||n.msForce||0;r.update(a,n.pageX-l.left,n.pageY-l.top,u,d,f);var g=n.pageX-l.left,m=n.pageY-l.top;for(o=0;o<h;o++)p.call(this._callbackObjs.touch[o],g,m)}}}},e.onTouchStart=function(t){if(this.enable){t.preventDefault&&cr.isCanvasInputEvent(t)&&t.preventDefault();var e,s,r,o=this.runtime.isDomFree?i:jQuery(this.runtime.canvas).offset();cr.performance_now();this.runtime.isInUserInputEvent=!0;var a,h=this._callbackObjs.touch.length;for(e=0,s=t.changedTouches.length;e<s;e++)if(r=t.changedTouches[e],-1===this.findTouch(r.identifier)){var c=r.pageX-o.left,l=r.pageY-o.top;for(this.trigger_index=this.touches.length,this.trigger_id=r.identifier,this.touches.push(n(c,l,r.identifier,this.trigger_index)),a=0;a<h;a++)u.call(this._callbackObjs.touch[a],c,l)}this.runtime.isInUserInputEvent=!1}},e.onTouchEnd=function(t,e){if(this.enable){var i,s,n,o;t.preventDefault&&cr.isCanvasInputEvent(t)&&t.preventDefault(),this.runtime.isInUserInputEvent=!0;var a,h=this._callbackObjs.touch.length;for(i=0,s=t.changedTouches.length;i<s;i++)if(n=t.changedTouches[i],(o=this.findTouch(n.identifier))>=0){for(this.trigger_index=this.touches[o].startindex,this.trigger_id=this.touches[o].id,this.lastTouchX=this.touches[o].x,this.lastTouchY=this.touches[o].y,a=0;a<h;a++)d.call(this._callbackObjs.touch[a],this.lastTouchX,this.lastTouchY);e||this.touches[o].maybeTriggerTap(this,o),r(this.touches[o]),this.touches.splice(o,1)}this.runtime.isInUserInputEvent=!1}},e.updateCursor=function(t){var e=this.runtime.isDomFree?i:jQuery(this.runtime.canvas).offset();this.cursor.x=t.pageX-e.left,this.cursor.y=t.pageY-e.top},e.onMouseDown=function(t){if(this.enable){this.updateCursor(t),this.mouseDown=!0,t.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&t.preventDefault();var e=this.findTouch(0);-1!==e&&(r(this.touches[e]),cr.arrayRemove(this.touches,e));var i={changedTouches:[{pageX:t.pageX,pageY:t.pageY,identifier:0}]};this.onTouchStart(i)}},e.onMouseMove=function(t){if(this.enable&&(this.updateCursor(t),this.mouseDown)){var e={changedTouches:[{pageX:t.pageX,pageY:t.pageY,identifier:0}]};this.onTouchMove(e)}},e.onMouseUp=function(t){if(this.enable){this.updateCursor(t),this.mouseDown=!1,t.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&t.preventDefault(),this.runtime.had_a_click=!0;var e={changedTouches:[{pageX:t.pageX,pageY:t.pageY,identifier:0}]};this.onTouchEnd(e)}},e.tick2=function(){if(this.enable){var t,e,i,s=cr.performance_now();for(t=0,e=this.touches.length;t<e;++t)(i=this.touches[t]).time<=s-50&&(i.lasttime=s);this.lastTouchX=null,this.lastTouchY=null}},g.prototype.IsDialogOpened=function(){return this.currentDialogs.length},t.cnds=new g,t.acts=new m,m.prototype.SetInputEnabled=function(t){this.enable=1==t},t.exps=new function(){},e.TouchCount=function(t){t.set_int(this.touches.length)},e.X=function(t){var e,i,s,n,r,o,a=this.getTouchIndex;return a<0||a>=this.touches.length?e=0:(cr.is_undefined(t)?(s=(i=this.runtime.getLayerByNumber(0)).scale,n=i.zoomRate,r=i.parallaxX,o=i.angle,i.scale=1,i.zoomRate=1,i.parallaxX=1,i.angle=0,e=i.canvasToLayer(this.touches[a].x,this.touches[a].y,!0),i.scale=s,i.zoomRate=n,i.parallaxX=r,i.angle=o):e=(i=cr.is_number(t)?this.runtime.getLayerByNumber(t):this.runtime.getLayerByName(t))?i.canvasToLayer(this.touches[a].x,this.touches[a].y,!0):0,e)},e.XAt=function(t,e,i){var s,n,r,o,a;(e=Math.floor(e))<0||e>=this.touches.length?t.set_float(0):cr.is_undefined(i)?(n=(s=this.runtime.getLayerByNumber(0)).scale,r=s.zoomRate,o=s.parallaxX,a=s.angle,s.scale=1,s.zoomRate=1,s.parallaxX=1,s.angle=0,t.set_float(s.canvasToLayer(this.touches[e].x,this.touches[e].y,!0)),s.scale=n,s.zoomRate=r,s.parallaxX=o,s.angle=a):(s=cr.is_number(i)?this.runtime.getLayerByNumber(i):this.runtime.getLayerByName(i))?t.set_float(s.canvasToLayer(this.touches[e].x,this.touches[e].y,!0)):t.set_float(0)},e.XForID=function(t,e,i){var s=this.findTouch(e);if(s<0)t.set_float(0);else{var n,r,o,a,h,c=this.touches[s];cr.is_undefined(i)?(r=(n=this.runtime.getLayerByNumber(0)).scale,o=n.zoomRate,a=n.parallaxX,h=n.angle,n.scale=1,n.zoomRate=1,n.parallaxX=1,n.angle=0,t.set_float(n.canvasToLayer(c.x,c.y,!0)),n.scale=r,n.zoomRate=o,n.parallaxX=a,n.angle=h):(n=cr.is_number(i)?this.runtime.getLayerByNumber(i):this.runtime.getLayerByName(i))?t.set_float(n.canvasToLayer(c.x,c.y,!0)):t.set_float(0)}},e.Y=function(t){var e,i,s,n,r,o,a=this.getTouchIndex;if(!(a<0||a>=this.touches.length))return cr.is_undefined(t)?(s=(i=this.runtime.getLayerByNumber(0)).scale,n=i.zoomRate,r=i.parallaxY,o=i.angle,i.scale=1,i.zoomRate=1,i.parallaxY=1,i.angle=0,e=i.canvasToLayer(this.touches[a].x,this.touches[a].y,!1),i.scale=s,i.zoomRate=n,i.parallaxY=r,i.angle=o):e=(i=cr.is_number(t)?this.runtime.getLayerByNumber(t):this.runtime.getLayerByName(t))?i.canvasToLayer(this.touches[a].x,this.touches[a].y,!1):0,e;e=0},e.YAt=function(t,e,i){var s,n,r,o,a;(e=Math.floor(e))<0||e>=this.touches.length?t.set_float(0):cr.is_undefined(i)?(n=(s=this.runtime.getLayerByNumber(0)).scale,r=s.zoomRate,o=s.parallaxY,a=s.angle,s.scale=1,s.zoomRate=1,s.parallaxY=1,s.angle=0,t.set_float(s.canvasToLayer(this.touches[e].x,this.touches[e].y,!1)),s.scale=n,s.zoomRate=r,s.parallaxY=o,s.angle=a):(s=cr.is_number(i)?this.runtime.getLayerByNumber(i):this.runtime.getLayerByName(i))?t.set_float(s.canvasToLayer(this.touches[e].x,this.touches[e].y,!1)):t.set_float(0)},e.YForID=function(t,e,i){var s=this.findTouch(e);if(s<0)t.set_float(0);else{var n,r,o,a,h,c=this.touches[s];cr.is_undefined(i)?(r=(n=this.runtime.getLayerByNumber(0)).scale,o=n.zoomRate,a=n.parallaxY,h=n.angle,n.scale=1,n.zoomRate=1,n.parallaxY=1,n.angle=0,t.set_float(n.canvasToLayer(c.x,c.y,!1)),n.scale=r,n.zoomRate=o,n.parallaxY=a,n.angle=h):(n=cr.is_number(i)?this.runtime.getLayerByNumber(i):this.runtime.getLayerByName(i))?t.set_float(n.canvasToLayer(c.x,c.y,!1)):t.set_float(0)}},e.AbsoluteX=function(t){this.touches.length?t.set_float(this.touches[0].x):t.set_float(0)},e.AbsoluteXAt=function(t,e){(e=Math.floor(e))<0||e>=this.touches.length?t.set_float(0):t.set_float(this.touches[e].x)},e.AbsoluteXForID=function(t,e){var i=this.findTouch(e);if(i<0)t.set_float(0);else{var s=this.touches[i];t.set_float(s.x)}},e.AbsoluteY=function(t){this.touches.length?t.set_float(this.touches[0].y):t.set_float(0)},e.AbsoluteYAt=function(t,e){(e=Math.floor(e))<0||e>=this.touches.length?t.set_float(0):t.set_float(this.touches[e].y)},e.AbsoluteYForID=function(t,e){var i=this.findTouch(e);if(i<0)t.set_float(0);else{var s=this.touches[i];t.set_float(s.y)}},e.IsInTouch=function(){return this.touches.length>0},e.CursorX=function(t){return null==this.cursor.x?null:(cr.is_undefined(t)?(s=(i=this.runtime.getLayerByNumber(0)).scale,n=i.zoomRate,r=i.parallaxX,o=i.angle,i.scale=1,i.zoomRate=1,i.parallaxX=1,i.angle=0,e=i.canvasToLayer(this.cursor.x,this.cursor.y,!0),i.scale=s,i.zoomRate=n,i.parallaxX=r,i.angle=o):e=(i=cr.is_number(t)?this.runtime.getLayerByNumber(t):this.runtime.getLayerByName(t))?i.canvasToLayer(this.cursor.x,this.cursor.y,!0):0,e);var e,i,s,n,r,o},e.CursorY=function(t){return null==this.cursor.y?null:(cr.is_undefined(t)?(s=(i=this.runtime.getLayerByNumber(0)).scale,n=i.zoomRate,r=i.parallaxX,o=i.angle,i.scale=1,i.zoomRate=1,i.parallaxX=1,i.angle=0,e=i.canvasToLayer(this.cursor.x,this.cursor.y,!1),i.scale=s,i.zoomRate=n,i.parallaxX=r,i.angle=o):e=(i=cr.is_number(t)?this.runtime.getLayerByNumber(t):this.runtime.getLayerByName(t))?i.canvasToLayer(this.cursor.x,this.cursor.y,!1):0,e);var e,i,s,n,r,o},e.CursorAbsoluteX=function(){return this.cursor.x},e.CursorAbsoluteY=function(){return this.cursor.y}}(),cr.plugins_.c2canvas=function(t){this.runtime=t},function(){var t=cr.plugins_.c2canvas.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){this.is_family||(this.texture_img=new Image,this.texture_img.src=this.texture_file,this.texture_img.cr_filesize=this.texture_filesize,this.runtime.wait_for_textures.push(this.texture_img))},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,i=["lighter","xor","copy","destination-over","source-in","destination-in","source-out","destination-out","source-atop","destination-atop"];e.effectToCompositeOp=function(t){return t<=0||t>=11?"source-over":i[t-1]},e.updateBlend=function(t){var e=this.runtime.gl;if(e)switch(this.srcBlend=e.ONE,this.destBlend=e.ONE_MINUS_SRC_ALPHA,t){case 1:this.srcBlend=e.ONE,this.destBlend=e.ONE;break;case 2:break;case 3:this.srcBlend=e.ONE,this.destBlend=e.ZERO;break;case 4:this.srcBlend=e.ONE_MINUS_DST_ALPHA,this.destBlend=e.ONE;break;case 5:this.srcBlend=e.DST_ALPHA,this.destBlend=e.ZERO;break;case 6:this.srcBlend=e.ZERO,this.destBlend=e.SRC_ALPHA;break;case 7:this.srcBlend=e.ONE_MINUS_DST_ALPHA,this.destBlend=e.ZERO;break;case 8:this.srcBlend=e.ZERO,this.destBlend=e.ONE_MINUS_SRC_ALPHA;break;case 9:this.srcBlend=e.DST_ALPHA,this.destBlend=e.ONE_MINUS_SRC_ALPHA;break;case 10:this.srcBlend=e.ONE_MINUS_DST_ALPHA,this.destBlend=e.SRC_ALPHA}},e.onCreate=function(){this.visible=0===this.properties[0],this.compositeOp=this.effectToCompositeOp(this.properties[1]),this.updateBlend(this.properties[1]),this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.ctx=this.canvas.getContext("2d"),this.ctx.drawImage(this.type.texture_img,0,0,this.width,this.height),this.tCanvas=document.createElement("canvas"),this.tCtx=this.tCanvas.getContext("2d"),this.update_tex=!0,this.rcTex=new cr.rect(0,0,0,0)},e.onDestroy=function(){},e.saveToJSON=function(){return{canvas_w:this.canvas.width,canvas_h:this.canvas.height,image:this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height).data}},e.loadFromJSON=function(t){for(var e=this.canvas.width=t.canvas_w,i=this.canvas.height=t.canvas_h,s=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height).data,n=0;n<i;++n)for(var r=0;r<e;++r)for(var o=4*(n*e+r),a=0;a<4;++a)s[o+a]=t.image[o+a]},e.draw_instances=function(t,e){for(var i in t)0==t[i].visible&&0==this.runtime.testOverlap(this,t[i])||(e.save(),e.scale(this.canvas.width/this.width,this.canvas.height/this.height),e.rotate(-this.angle),e.translate(-this.bquad.tlx,-this.bquad.tly),e.globalCompositeOperation=t[i].compositeOp,void 0!==t[i].type.pattern&&void 0!==t[i].type.texture_img&&(t[i].pattern=e.createPattern(t[i].type.texture_img,"repeat")),t[i].draw(e),e.restore())},e.draw=function(t){t.save(),t.globalAlpha=this.opacity,t.globalCompositeOperation=this.compositeOp;var e=this.x,i=this.y;this.runtime.pixel_rounding&&(e=Math.round(e),i=Math.round(i)),t.translate(e,i),t.rotate(this.angle),t.drawImage(this.canvas,0-this.hotspotX*this.width,0-this.hotspotY*this.height,this.width,this.height),t.restore()},e.drawGL=function(t){t.setBlend(this.srcBlend,this.destBlend),this.update_tex&&(this.tex&&t.deleteTexture(this.tex),this.tex=t.loadTexture(this.canvas,!1,this.runtime.linearSampling),this.update_tex=!1),t.setTexture(this.tex),t.setOpacity(this.opacity);var e=this.bquad;if(this.runtime.pixel_rounding){var i=Math.round(this.x)-this.x,s=Math.round(this.y)-this.y;t.quad(e.tlx+i,e.tly+s,e.trx+i,e.try_+s,e.brx+i,e.bry+s,e.blx+i,e.bly+s)}else t.quad(e.tlx,e.tly,e.trx,e.try_,e.brx,e.bry,e.blx,e.bly)},t.cnds={};t.cnds;t.acts={};var s=t.acts;s.SetEffect=function(t){this.compositeOp=this.effectToCompositeOp(t),this.runtime.redraw=!0,this.update_tex=!0},s.DrawPoint=function(t,e,i){var s=this.ctx;s.fillStyle=i,s.fillRect(t,e,1,1),this.runtime.redraw=!0,this.update_tex=!0},s.ResizeCanvas=function(t,e){this.canvas.width=t,this.canvas.height=e,this.runtime.redraw=!0,this.update_tex=!0},s.PasteObject=function(t){var e=this.ctx;this.update_bbox();var i,s=t.getCurrentSol();i=s.select_all?s.type.instances:s.instances,this.draw_instances(i,e),this.runtime.redraw=!0,this.update_tex=!0},s.PasteLayer=function(t){if(!t||!t.visible)return!1;var e=this.ctx;this.update_bbox(),this.tCanvas.width=this.canvas.width,this.tCanvas.height=this.canvas.height;var i=this.tCtx;i.clearRect(0,0,this.tCanvas.width,this.tCanvas.height),this.draw_instances(t.instances,i),e.drawImage(this.tCanvas,0,0,this.width,this.height),this.runtime.redraw=!0,this.update_tex=!0},s.DrawBox=function(t,e,i,s,n){this.ctx.fillStyle=n,this.ctx.fillRect(t,e,i,s),this.runtime.redraw=!0,this.update_tex=!0},s.DrawLine=function(t,e,i,s,n,r){var o=this.ctx;o.strokeStyle=n,o.lineWidth=r,o.beginPath(),o.moveTo(t,e),o.lineTo(i,s),o.stroke(),this.runtime.redraw=!0,this.update_tex=!0},s.ClearCanvas=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.runtime.redraw=!0,this.update_tex=!0},s.FillColor=function(t){this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.runtime.redraw=!0,this.update_tex=!0},s.fillGradient=function(t,e,i){var s,n=this.ctx,r=this.canvas.width,o=this.canvas.height;switch(t){case 0:s=n.createLinearGradient(0,0,r,0);break;case 1:s=n.createLinearGradient(0,0,0,o);break;case 2:s=n.createLinearGradient(0,0,r,o);break;case 3:s=n.createLinearGradient(r,0,0,o);break;case 4:s=n.createRadialGradient(r/2,o/2,0,r/2,o/2,Math.sqrt(r*r+o*o)/2)}try{s.addColorStop(0,e)}catch(t){s.addColorStop(0,"black")}try{s.addColorStop(1,i)}catch(t){s.addColorStop(1,"black")}this.ctx.fillStyle=s,this.ctx.fillRect(0,0,r,o),this.runtime.redraw=!0,this.update_tex=!0},s.beginPath=function(){this.ctx.beginPath()},s.drawPath=function(t,e){var i=this.ctx;i.strokeStyle=t,i.lineWidth=e,i.stroke(),this.runtime.redraw=!0,this.update_tex=!0},s.setLineSettings=function(t,e){var i=this.ctx;i.lineCap=["butt","round","square"][t],i.lineJoin=["round","bevel","milet"][e]},s.fillPath=function(t){this.ctx.fillStyle=t,this.ctx.fill(),this.runtime.redraw=!0,this.update_tex=!0},s.moveTo=function(t,e){this.ctx.moveTo(t,e)},s.lineTo=function(t,e){this.ctx.lineTo(t,e)},s.arc=function(t,e,i,s,n,r){this.ctx.arc(t,e,i,cr.to_radians(s),cr.to_radians(n),1==r)},s.drawCircle=function(t,e,i,s,n){var r=this.ctx;r.strokeStyle=s,r.lineWidth=n,r.beginPath(),r.arc(t,e,i,0,cr.to_radians(360),!0),r.stroke(),this.runtime.redraw=!0,this.update_tex=!0},s.bezierCurveTo=function(t,e,i,s,n,r){this.ctx.bezierCurveTo(t,e,i,s,n,r)},s.quadraticCurveTo=function(t,e,i,s){this.ctx.quadraticCurveTo(t,e,i,s)},s.rectPath=function(t,e,i,s){this.ctx.rect(t,e,i,s)},s.FloodFill=function(t,e,i){var s=this.ctx,n=s.getImageData(0,0,this.canvas.width,this.canvas.height);flood_fill(n.data,this.canvas.width,this.canvas.height,t,e,i),s.putImageData(n,0,0),this.runtime.redraw=!0,this.update_tex=!0},s.setLineDash=function(t,e){var i=[t,e];this.ctx.setLineDash(i)},t.exps={};var n=t.exps;n.rgbaAt=function(t,e,i){var s=this.ctx.getImageData(e,i,1,1).data;t.set_string("rgba("+s[0]+","+s[1]+","+s[2]+","+s[3]/255+")")},n.redAt=function(t,e,i){var s=this.ctx.getImageData(e,i,1,1).data;t.set_int(s[0])},n.greenAt=function(t,e,i){var s=this.ctx.getImageData(e,i,1,1).data;t.set_int(s[1])},n.blueAt=function(t,e,i){var s=this.ctx.getImageData(e,i,1,1).data;t.set_int(s[2])},n.alphaAt=function(t,e,i){var s=this.ctx.getImageData(e,i,1,1).data;t.set_int(100*s[3]/255)},n.imageUrl=function(t){t.set_string(this.canvas.toDataURL())},n.AsJSON=function(t){t.set_string(JSON.stringify({c2array:!0,size:[1,1,this.canvas.width*this.canvas.height*4],data:[[this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height).data]]}))}}(),cr.plugins_.filechooser=function(t){this.runtime=t},function(){var t=cr.plugins_.filechooser.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype,i=window.URL||window.webkitURL||window.mozURL||window.msURL;e.onCreate=function(){if(this.runtime.isDomFree)cr.logexport("[Construct 2] File Chooser plugin not supported on this platform - the object will not be created");else{this.elem=document.createElement("input"),this.elem.type="file",this.elem.setAttribute("accept",this.properties[0]),0!==this.properties[1]&&this.elem.setAttribute("multiple",""),this.elem.id=this.properties[3],jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body"),this.element_hidden=!1,0===this.properties[2]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0);var t=this;this.elem.onchange=function(){t.runtime.trigger(cr.plugins_.filechooser.prototype.cnds.OnChanged,t)},this.lastLeft=0,this.lastTop=0,this.lastRight=0,this.lastBottom=0,this.lastWinWidth=0,this.lastWinHeight=0,this.updatePosition(!0),this.runtime.tickMe(this)}},e.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)},e.tick=function(){this.updatePosition()};function s(){}function n(){}function r(){}function o(t,e){return t?(e=Math.floor(e))<0||e>=t.length?null:t[e]:null}e.updatePosition=function(t){if(!this.runtime.isDomFree){var e=this.layer.layerToCanvas(this.x,this.y,!0),i=this.layer.layerToCanvas(this.x,this.y,!1),s=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),n=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),r=this.runtime.width/this.runtime.devicePixelRatio,o=this.runtime.height/this.runtime.devicePixelRatio;if(!this.visible||!this.layer.visible||s<=0||n<=0||e>=r||i>=o)return this.element_hidden||jQuery(this.elem).hide(),void(this.element_hidden=!0);e<1&&(e=1),i<1&&(i=1),s>=r&&(s=r-1),n>=o&&(n=o-1);var a=window.innerWidth,h=window.innerHeight;if(t||this.lastLeft!==e||this.lastTop!==i||this.lastRight!==s||this.lastBottom!==n||this.lastWinWidth!==a||this.lastWinHeight!==h){this.lastLeft=e,this.lastTop=i,this.lastRight=s,this.lastBottom=n,this.lastWinWidth=a,this.lastWinHeight=h,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1);var c=Math.round(e)+jQuery(this.runtime.canvas).offset().left,l=Math.round(i)+jQuery(this.runtime.canvas).offset().top;jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:c,top:l}),jQuery(this.elem).width(Math.round(s-e)),jQuery(this.elem).height(Math.round(n-i))}else this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1)}},e.draw=function(t){},e.drawGL=function(t){},s.prototype.OnChanged=function(){return!0},t.cnds=new s,n.prototype.SetVisible=function(t){this.runtime.isDomFree||(this.visible=0!==t)},n.prototype.SetCSSStyle=function(t,e){this.runtime.isDomFree||jQuery(this.elem).css(t,e)},n.prototype.ReleaseFile=function(t){this.runtime.isDomFree||i&&i.revokeObjectURL&&i.revokeObjectURL(t)},t.acts=new n,r.prototype.FileCount=function(t){t.set_int(this.runtime.isDomFree?0:this.elem.files.length||0)},r.prototype.FileNameAt=function(t,e){var i=this.runtime.isDomFree?null:o(this.elem.files,e);t.set_string(i&&i.name||"")},r.prototype.FileSizeAt=function(t,e){var i=this.runtime.isDomFree?null:o(this.elem.files,e);t.set_int(i&&i.size||0)},r.prototype.FileTypeAt=function(t,e){var i=this.runtime.isDomFree?null:o(this.elem.files,e);t.set_string(i&&i.type||"")},r.prototype.FileURLAt=function(t,e){var s=this.runtime.isDomFree?null:o(this.elem.files,e);s?s.c2url?t.set_string(s.c2url):i&&i.createObjectURL?(s.c2url=i.createObjectURL(s),t.set_string(s.c2url)):t.set_string(""):t.set_string("")},t.exps=new r}(),cr.plugins_.gamepad=function(t){this.runtime=t},function(){var t=cr.plugins_.gamepad.prototype,e=!1;t.Type=function(t){this.plugin=t,this.runtime=t.runtime,e=!!(navigator.getGamepads||navigator.webkitGetGamepads||navigator.mozGetGamepads||navigator.gamepads||navigator.webkitGamepads||navigator.MozGamepads||window.cr_getGamepads)},t.Type.prototype.onCreate=function(){};var i=null,s=null,n=new Array(16),r=new Array(16),o=new Array(16),a="",h="";function c(t){var e;if(!r[t])for(r[t]=new Array(20),e=0;e<20;++e)r[t][e]=0;return r[t]}function l(t){var e;if(!o[t])for(o[t]=new Array(20),e=0;e<20;++e)o[t][e]=0;return o[t]}function u(t){var e,i=c(t),s=l(t);for(e=0;e<20;++e)s[e]=i[e]}function p(t){r[t]=null,o[t]=null}var d=16,f=null,g={};function m(t,e,i,s){return e?t>=s.length?-1:cr.is_number(s[t])?s[t]+d:s[t]:t>=i.length?-1:i[t]}g.windows={},g.windows.firefox={};var y=[0,1,2,3,4,5,8,9,10,11],_=[0,1,[7,6],2,3,[14,15],[12,13]];g.windows.firefox.xbox360=function(t,e){return m(t,e,y,_)};var v=[2,0,1,3,4,6,5,7,8,9],b=[0,1,2,3,[14,15],[12,13]];function w(t,e){return e?t>=4?-1:t+d:t>=16?-1:t}function x(t){if(!f)return w;var e="",i=t.toLowerCase();return i.indexOf("xbox 360")>-1?e="xbox360":i.indexOf("logitech dual action")>-1&&(e="logitechdualaction"),f[e]||w}function S(t){n[t.gamepad.index]=t.gamepad,i.trigger(cr.plugins_.gamepad.prototype.cnds.OnGamepadConnected,s)}function T(t){i.trigger(cr.plugins_.gamepad.prototype.cnds.OnGamepadDisconnected,s),n[t.gamepad.index]=null}g.windows.firefox.logitechdualaction=function(t,e){return m(t,e,v,b)},t.Instance=function(t){this.type=t,this.runtime=t.runtime,i=this.runtime,s=this};var C=t.Instance.prototype;function O(){}function k(){}C.onCreate=function(){this.deadzone=this.properties[0],this.lastButton=0;var t=navigator.userAgent;a="windows",/mac/i.test(t)&&(a="mac"),f=g[a],h="chrome",/firefox/i.test(t)&&(h="firefox"),f&&(f=f[h]),window.addEventListener("webkitgamepadconnected",S,!1),window.addEventListener("webkitgamepaddisconnected",T,!1),window.addEventListener("MozGamepadConnected",S,!1),window.addEventListener("MozGamepadDisconnected",T,!1),window.addEventListener("gamepadconnected",S,!1),window.addEventListener("gamepaddisconnected",T,!1),this.runtime.tickMe(this),this.activeControllers=[]},C.tick=function(){this.activeControllers.length=0;var t=null,e=!1;if(navigator.getGamepads?t=navigator.getGamepads():navigator.webkitGetGamepads?t=navigator.webkitGetGamepads():navigator.mozGetGamepads?t=navigator.mozGetGamepads():navigator.msGetGamepads?t=navigator.msGetGamepads():this.runtime.isWindows8Capable&&window.cr_getGamepads?(t=window.cr_getGamepads(),e=!0):t=navigator.gamepads||navigator.webkitGamepads||navigator.MozGamepads||n,t){var i,s,r,o,a,h,d;for(i=0,s=t.length;i<s;i++){var f=t[i];if(f){var g=c(i),m=l(i);for(u(i),a=e?w:x(f.id),r=0,o=f.buttons.length;r<o;r++)(h=a(r,!1,d=void 0!==f.buttons[r].value?f.buttons[r].value:f.buttons[r]))>=0&&h<20&&(g[h]=100*d,g[h]>=50&&m[h]<50&&(this.lastButton=h));for(r=0,o=f.axes.length;r<o;r++)h=a(r,!0,d=f.axes[r]),cr.is_number(h)?h>=0&&h<20&&(g[h]=100*d):(g[h[0]]=0,g[h[1]]=0,d<=0?g[h[0]]=Math.abs(100*d):g[h[1]]=Math.abs(100*d));this.activeControllers.push(f)}else p(i)}for(;i<20;++i)p(i)}},C.saveToJSON=function(){return{lastButton:this.lastButton}},C.loadFromJSON=function(t){this.lastButton=t.lastButton},O.prototype.SupportsGamepad=function(){return e},O.prototype.OnGamepadConnected=function(){return!0},O.prototype.OnGamepadDisconnected=function(){return!0},O.prototype.IsButtonDown=function(t,e){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var i=c(t);if(!i)return!1;var s=i[e]>=50;return s&&(this.lastButton=e),s},O.prototype.OnButtonDown=function(t,e){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var i=c(t),s=l(t);if(!i||!s)return!1;var n=i[e]>=50&&s[e]<50;return n&&(this.lastButton=e),n},O.prototype.OnButtonUp=function(t,e){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var i=c(t),s=l(t);if(!i||!s)return!1;var n=i[e]<50&&s[e]>=50;return n&&(this.lastButton=e),n},O.prototype.HasGamepads=function(){return this.activeControllers.length>0},O.prototype.CompareAxis=function(t,e,i,s){if(t=Math.floor(t),e=Math.floor(e),t<0||t>=this.activeControllers.length)return!1;var n=c(t);if(n){var r=n[e+d],o=0;return o=e%2==0?n[e+d+1]:n[e+d-1],Math.sqrt(r*r+o*o)<=this.deadzone&&(r=0),cr.do_cmp(r,i,s)}},O.prototype.OnAnyButtonDown=function(t){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var e,i,s=c(t),n=l(t);if(!s||!n)return!1;for(e=0,i=s.length;e<i;e++)if(s[e]>=50&&n[e]<50)return this.lastButton=e,!0;return!1},O.prototype.OnAnyButtonUp=function(t){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var e,i,s=c(t),n=l(t);if(!s||!n)return!1;for(e=0,i=s.length;e<i;e++)if(s[e]<50&&n[e]>=50)return this.lastButton=e,!0;return!1},O.prototype.IsButtonIndexDown=function(t,e){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var i=c(t);if(!i)return!1;if((e=Math.floor(e))<0||e>=i.length)return!1;var s=i[e]>=50;return s&&(this.lastButton=e),s},O.prototype.OnButtonIndexDown=function(t,e){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var i=c(t),s=l(t);if(!i||!s)return!1;if((e=Math.floor(e))<0||e>=i.length)return!1;var n=i[e]>=50&&s[e]<50;return n&&(this.lastButton=e),n},O.prototype.OnButtonIndexUp=function(t,e){if((t=Math.floor(t))<0||t>=this.activeControllers.length)return!1;var i=c(t),s=l(t);if(!i||!s)return!1;if((e=Math.floor(e))<0||e>=i.length)return!1;var n=i[e]<50&&s[e]>=50;return n&&(this.lastButton=e),n},t.cnds=new O,t.acts=new function(){},k.prototype.GamepadCount=function(t){t.set_int(this.activeControllers.length)},k.prototype.GamepadID=function(t,e){e<0||e>=this.activeControllers.length?t.set_string(""):t.set_string(this.activeControllers[e].id)},k.prototype.GamepadAxes=function(t,e){if(e<0||e>=this.activeControllers.length)t.set_string("");else{var i,s,n=this.activeControllers[e].axes,r="";for(i=0,s=n.length;i<s;i++)r+="Axis "+i+": "+Math.round(100*n[i])+"\n";t.set_string(r)}},k.prototype.GamepadButtons=function(t,e){if(e<0||e>=this.activeControllers.length)t.set_string("");else{var i,s,n,r=this.activeControllers[e].buttons,o="";for(i=0,s=r.length;i<s;i++)n=void 0!==r[i].value?r[i].value:r[i],o+="Button "+i+": "+Math.round(100*n)+"\n";t.set_string(o)}},k.prototype.RawButton=function(t,e,i){if(e=Math.floor(e),i=Math.floor(i),e<0||e>=this.activeControllers.length)t.set_float(0);else{var s=this.activeControllers[e].buttons;!s||i<0||i>=s.length?t.set_float(0):void 0!==s[i].value?t.set_float(s[i].value):t.set_float(s[i])}},k.prototype.RawAxis=function(t,e,i){if(e=Math.floor(e),i=Math.floor(i),e<0||e>=this.activeControllers.length)t.set_float(0);else{var s=this.activeControllers[e].axes;!s||i<0||i>=s.length?t.set_float(0):t.set_float(s[i])}},k.prototype.RawButtonCount=function(t,e){(e=Math.floor(e))<0||e>=this.activeControllers.length?t.set_int(0):t.set_int(this.activeControllers[e].buttons.length)},k.prototype.RawAxisCount=function(t,e){(e=Math.floor(e))<0||e>=this.activeControllers.length?t.set_int(0):t.set_int(this.activeControllers[e].axes.length)},k.prototype.Button=function(t,e,i){if(e=Math.floor(e),i=Math.floor(i),e<0||e>=this.activeControllers.length)t.set_float(0);else{var s=c(e);!s||i<0||i>=d?t.set_float(0):t.set_float(s[i])}},k.prototype.Axis=function(t,e,i){if(e=Math.floor(e),i=Math.floor(i),e<0||e>=this.activeControllers.length)t.set_float(0);else{var s=c(e);if(!s||i<0||i>=4)t.set_float(0);else{var n=s[i+d],r=0;r=i%2==0?s[i+d+1]:s[i+d-1],Math.sqrt(n*n+r*r)<=this.deadzone&&(n=0),t.set_float(n)}}},k.prototype.LastButton=function(t){t.set_int(this.lastButton)},t.exps=new k}(),cr.plugins_.hmmg_layoutTransition_v2=function(t){this.runtime=t},function(){var t=cr.plugins_.hmmg_layoutTransition_v2.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}e.onCreate=function(){var t=this.properties[0]||null;null!=t&&t>0&&$("head").append("<style>.animated,animated.hinge,.animated.flipOutX,.animated.flipOutY,.animated.bounceIn,.animated.bounceOut,.animated.flipOutXX,.animated.flipInXX,.animated.flipInYY,.animated.flipOutYY{-webkit-animation-duration: "+t+"s !important;animation-duration: "+t+"s !important;}</style>")},e.onDestroy=function(){},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.draw=function(t){},e.drawGL=function(t){},i.prototype.isTransitionReady=function(){return!0},i.prototype.didTransitionStart=function(){return!0},i.prototype.didTransitionFinish=function(){return!0},t.cnds=new i,s.prototype.prepareTransition=function(){var t=this.properties[1],e=Math.floor(t/65536),i=Math.floor(t/256)%256;t="rgb("+e+","+i+","+t%256+")";var s,n,r=this;s=function(){r.runtime.trigger(cr.plugins_.hmmg_layoutTransition_v2.prototype.cnds.isTransitionReady,r)},n=function(e){if(null==$("#fakeCanvas")[0]){var i=$("#c2canvasdiv"),n=$("<div id='fakeCanvas'><img src='"+e+"' height='"+i.height()+"' width='"+i.width()+"'/><div></div></div>"),r=$("<div id='fakeBody'></div>"),o=parseFloat(i.css("margin-left"));r.css({top:i.offset().top,left:i.offset().left,width:i.width(),height:i.height(),"background-color":t}),i.addClass("prepared").find(" > :not(canvas)").each(function(){$(this).css("left",$(this).offset().left-o+"px")}),r.appendTo(document.body).append(i).append(n),s&&s()}},r.runtime.doCanvasSnapshot("image/jpeg",1),setTimeout(function(){n(r.runtime.snapshotData)},50)},s.prototype.startTransition=function(t){var e=$("#fakeBody"),i=e.find("#c2canvasdiv"),s=e.find("#fakeCanvas"),n=this;function r(){e.remove(),i.appendTo(document.body).removeClass("prepared"),n.runtime.trigger(cr.plugins_.hmmg_layoutTransition_v2.prototype.cnds.didTransitionFinish,n)}n.runtime.trigger(cr.plugins_.hmmg_layoutTransition_v2.prototype.cnds.didTransitionStart,n),14==t?(i.addClass("hidden"),s.addClass("animated rotateOut").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){s.addClass("hidden")}),i.removeClass("hidden").addClass("animated rotateIn").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){i.removeClass("animated rotateIn"),r()})):13==t?(s.addClass("animated rollOut").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){s.addClass("hidden")}),i.addClass("animated rollIn").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){i.removeClass("animated rollIn"),r()})):12==t?(s.addClass("animated zoomOut").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){s.addClass("hidden")}),i.addClass("animated zoomIn").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){i.removeClass("animated zoomIn"),r()})):11==t?(i.addClass("hidden"),s.addClass("animated fadeOut").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){s.addClass("hidden"),i.removeClass("hidden").addClass("animated fadeIn").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){i.removeClass("animated fadeIn"),r()})})):10==t?(i.addClass("hidden"),s.addClass("animated fadeOut").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){s.addClass("hidden")}),i.removeClass("hidden").addClass("animated fadeIn").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){i.removeClass("animated fadeIn"),r()})):9==t?(i.addClass("hidden"),s.addClass("animated flipOutYY").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){s.addClass("hidden"),i.removeClass("hidden").addClass("animated flipInYY").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){i.removeClass("animated flipInYY"),r()})})):8==t?(i.addClass("hidden"),s.addClass("animated flipOutXX").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){s.addClass("hidden"),i.removeClass("hidden").addClass("animated flipInXX").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){i.removeClass("animated flipInXX"),r()})})):7==t?i.addClass("animated slideInRight").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){r(),i.removeClass("animated slideInRight")}):6==t?i.addClass("animated slideInLeft").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){r(),i.removeClass("animated slideInLeft")}):5==t?i.addClass("animated slideInDown").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){r(),i.removeClass("animated slideInDown")}):4==t?i.addClass("animated slideInUp").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){r(),i.removeClass("animated slideInUp")}):3==t?(i.addClass("animated slideInRight").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){r(),i.removeClass("animated slideInRight"),s.removeClass("animated slideOutLeft")}),s.addClass("animated slideOutLeft")):2==t?(i.addClass("animated slideInLeft").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){r(),s.removeClass("animated slideOutRight"),i.removeClass("animated slideInLeft")}),s.addClass("animated slideOutRight")):1==t?(i.addClass("animated slideInDown").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){r(),s.removeClass("animated slideOutDown"),i.removeClass("animated slideInDown")}),s.addClass("animated slideOutDown")):0==t&&(i.addClass("animated slideInUp").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){r(),s.removeClass("animated slideOutUp"),i.removeClass("animated slideInUp")}),s.addClass("animated slideOutUp"))},t.acts=new s,t.exps=new function(){}}(),Math.sign=Math.sign||function(t){return 0===(t=+t)||isNaN(t)?Number(t):t>0?1:-1},cr.plugins_.jcw_trace=function(t){this.runtime=t},function(){var t=cr.plugins_.jcw_trace.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){this.obstacleTypes=[]},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.dx=0,this.dy=0,this.bounds=new cr.rect(0,0,0,0),this.t=0,this.hit=!1,this.hitx=0,this.hity=0,this.uid=-1,this.normalang=0,cr.seal(this)}var s=i.prototype;function n(t,e,i,s,n,r){return(s-e)*(n-i)-(i-t)*(r-s)>=0?0:1}function r(t,e,i,s){var n=1/t.dx,r=1/t.dy,o=Math.sign(n),a=Math.sign(r),h=(e.left+e.right)/2,c=(e.top+e.bottom)/2,l=(e.right-e.left)/2+i,u=(e.bottom-e.top)/2+s,p=(h-o*l-t.x1)*n,d=(c-a*u-t.y1)*r,f=(h+o*l-t.x1)*n,g=(c+a*u-t.y1)*r;if(p>g||d>f)return!1;var m=p>d?p:d,y=f<g?f:g;return!(m>=t.t||y<=0)&&(t.t=Math.max(m,0),t.hit=!0,t.normalang=p>d?Math.atan2(0,-o):Math.atan2(-a,0),!0)}function o(t,e,i,s,n,r,o,a){var h=o-n,c=a-r,l=c*(i-t)-h*(s-e);return 0===l?0:((n-t)*c+(e-r)*h)/l}function a(t,e,i,s){var r,a,h,c,l,u,p,d,f,g=e.pts_cache;if(e.contains_pt(t.x1-i,t.y1-s))return t.t=0,t.hit=!0,t.normalang=Math.atan2(-t.dy,-t.dx),!0;var m=!1;for(r=0,a=e.pts_count;r<a;r++)c=(r+1)%a*2,u=g[h=2*r]+i,p=g[h+1]+s,d=g[c]+i,f=g[c+1]+s,cr.segments_intersect(t.x1,t.y1,t.x2,t.y2,u,p,d,f)&&(l=o(t.x1,t.y1,t.x2,t.y2,u,p,d,f))<t.t&&(m=!0,t.t=l,t.hit=!0,0===n(t.x1,t.y1,u,p,d,f)?t.normalang=Math.atan2(u-d,f-p):t.normalang=Math.atan2(d-u,p-f));return m}s.CalcHitPos=function(t){if(this.hitx=this.x1+this.dx*this.t,this.hity=this.y1+this.dy*this.t,0!==t){var e=Math.atan2(-this.dy,-this.dx);this.hitx+=Math.cos(e)*t,this.hity+=Math.sin(e)*t}},s.GetReflectAng=function(){return 2*this.normalang-Math.atan2(-this.dy,-this.dx)};var h=[],c=new cr.rect(0,0,0,0);function l(t,e){if(e&&e.collisionsEnabled&&(e.update_bbox(),e.bbox.intersects_rect(t.bounds))){var i=!1;if(e.tilemap_exists)i=function(t,e){var i,s,n,o;e.getCollisionRectCandidates(t.bounds,h);var l=e.x,u=e.y,p=!1;for(i=0,s=h.length;i<s;++i)o=(n=h[i]).rc,t.bounds.intersects_rect_off(o,l,u)&&(c.copy(o),c.offset(l,u),n.poly?a(t,n.poly,c.left,c.top)&&(p=!0):r(t,c,0,0)&&(p=!0));return cr.clearArray(h),p}(t,e);else if(e.collision_poly&&!e.collision_poly.is_empty()){var s=e.collision_poly;s.cache_poly(e.width,e.height,e.angle),i=a(t,s,e.x,e.y)}else i=0===e.angle?r(t,e.bbox,0,0):function(t,e){var i,s,n,r,a,h,c=!1;if(e.contains_pt(t.x1,t.y1))return t.t=0,t.hit=!0,t.normalang=Math.atan2(-t.dy,-t.dx),!0;for(i=0;i<4;i++)n=e.at(i,!0),r=e.at(i,!1),a=e.at(i+1,!0),h=e.at(i+1,!1),cr.segments_intersect(t.x1,t.y1,t.x2,t.y2,n,r,a,h)&&(s=o(t.x1,t.y1,t.x2,t.y2,n,r,a,h))<t.t&&(c=!0,t.t=s,t.hit=!0,t.normalang=Math.atan2(n-a,h-r));return c}(t,e.bquad);i&&(t.uid=e.uid)}}function u(t,e,i,s){if(e&&e.collisionsEnabled&&(e.update_bbox(),e.bbox.intersects_rect(t.bounds))){var n=!1;if(e.tilemap_exists);else if(e.collision_poly&&!e.collision_poly.is_empty()){e.collision_poly.cache_poly(e.width,e.height,e.angle)}else 0===e.angle&&(n=r(t,e.bbox,i,s));n&&(t.uid=e.uid)}}e.onCreate=function(){this.obstacleMode=this.properties[0],this.useCollisionCells=0!==this.properties[1],this.padding=cr.clamp(this.properties[2],0,1),this.tr=new i},e.onDestroy=function(){},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){};var p=[];function d(){}function f(){}function g(){}e.GetOverlapCandidates=function(){var t,e,i=this.tr;if(0===this.obstacleMode)if(this.useCollisionCells)this.runtime.getSolidCollisionCandidates(null,i.bounds,p);else{var s=this.runtime.getSolidBehavior();s&&cr.appendArray(p,s.my_instances.valuesRef())}else if(this.useCollisionCells)this.runtime.getTypesCollisionCandidates(null,this.type.obstacleTypes,i.bounds,p);else for(t=0,e=this.type.obstacleTypes.length;t<e;++t)cr.appendArray(p,this.type.obstacleTypes[t].instances)},d.prototype.Hit=function(){return this.tr.hit},t.cnds=new d,f.prototype.AddObstacle=function(t){var e=this.type.obstacleTypes;if(-1===e.indexOf(t)){var i,s,n;for(i=0,s=e.length;i<s;i++)if((n=e[i]).is_family&&-1!==n.members.indexOf(t))return;e.push(t)}},f.prototype.ClearObstacles=function(){cr.clearArray(this.type.obstacleTypes)},f.prototype.TraceLine=function(t,e,i,s){var n,r,o,a=this.tr;if(a.x1=t,a.y1=e,a.x2=i,a.y2=s,a.dx=i-t,a.dy=s-e,a.bounds.set(t,e,i,s),a.bounds.normalize(),a.t=1,a.hit=!1,this.GetOverlapCandidates(),0===this.obstacleMode)for(n=0,r=p.length;n<r;++n)(o=p[n]).extra.solidEnabled&&l(a,o);else for(n=0,r=p.length;n<r;++n)l(a,o=p[n]);cr.clearArray(p),a.hit?a.CalcHitPos(this.padding):(a.hitx=i,a.hity=s,a.uid=-1,a.normalang=Math.atan2(-a.dy,-a.dx))},f.prototype.TraceBox=function(t,e,i,s,n,r){var o,a,h,c=n/2,l=r/2,d=this.tr;if(d.x1=t,d.y1=e,d.x2=i,d.y2=s,d.dx=i-t,d.dy=s-e,d.bounds.set(t,e,i,s),d.bounds.normalize(),d.bounds.left-=c,d.bounds.right+=c,d.bounds.top-=l,d.bounds.bottom+=l,d.t=1,d.hit=!1,this.GetOverlapCandidates(),0===this.obstacleMode)for(o=0,a=p.length;o<a;++o)(h=p[o]).extra.solidEnabled&&u(d,h,c,l);else for(o=0,a=p.length;o<a;++o)u(d,h=p[o],c,l);cr.clearArray(p),d.hit?d.CalcHitPos(this.padding):(d.hitx=i,d.hity=s,d.uid=-1,d.normalang=Math.atan2(-d.dy,-d.dx))},t.acts=new f,g.prototype.HitUID=function(t){t.set_int(this.tr.uid)},g.prototype.HitX=function(t){t.set_float(this.tr.hitx)},g.prototype.HitY=function(t){t.set_float(this.tr.hity)},g.prototype.NormalAngle=function(t){t.set_float(cr.to_degrees(this.tr.normalang))},g.prototype.ReflectAngle=function(t){t.set_float(cr.to_degrees(this.tr.GetReflectAng()))},g.prototype.HitFrac=function(t){t.set_float(this.tr.t)},t.exps=new g}(),cr.plugins_.rojoPaster=function(t){this.runtime=t},function(){var t=cr.plugins_.rojoPaster.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(t,e,i){for(var s=[[0,1,2],[2,3,0]],n=0;n<2;n++){var r=s[n],o=i[r[0]].x,a=i[r[1]].x,h=i[r[2]].x,c=i[r[0]].y,l=i[r[1]].y,u=i[r[2]].y,p=i[r[0]].u,d=i[r[1]].u,f=i[r[2]].u,g=i[r[0]].v,m=i[r[1]].v,y=i[r[2]].v;t.save(),t.beginPath(),t.moveTo(o,c),t.lineTo(a,l),t.lineTo(h,u),t.closePath(),t.clip();var _=p*m+g*f+d*y-m*f-g*d-p*y,v=o*m+g*h+a*y-m*h-g*a-o*y,b=p*a+o*f+d*h-a*f-o*d-p*h,w=p*m*h+g*a*f+o*d*y-o*m*f-g*d*h-p*a*y,x=c*m+g*u+l*y-m*u-g*l-c*y,S=p*l+c*f+d*u-l*f-c*d-p*u,T=p*m*u+g*l*f+c*d*y-c*m*f-g*d*u-p*l*y;t.transform(v/_,x/_,b/_,S/_,w/_,T/_),t.drawImage(e,0,0),t.restore()}}function n(){}e.onCreate=function(){this.visible=0===this.properties[0],this.resx=this.width,this.resy=this.height,this.verts=[{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0}],this.points=null,this.canvas2textureNextTick=0;var t=this.runtime.glwrap;t?(this.texture=t.createEmptyTexture(this.resx,this.resy,this.runtime.linearSampling,!1),this.temp_texture=t.createEmptyTexture(this.resx,this.resy,this.runtime.linearSampling,!1),this.quadtex=t.createEmptyTexture(1,1,this.runtime.linearSampling,!1),t.setTexture(null),t.setRenderingToTexture(this.quadtex),t.clear(0,0,0,1),t.setRenderingToTexture(null),this.quadblend=new Object,this.quadblend.srcBlend=t.gl.ONE,this.quadblend.destBlend=t.gl.ONE_MINUS_SRC_ALPHA):(this.canvas=document.createElement("canvas"),this.canvas.width=this.resx,this.canvas.height=this.resy,this.ctx=this.canvas.getContext("2d"),this.runtime.linearSampling||(this.ctx.mozImageSmoothingEnabled=!1,this.ctx.webkitImageSmoothingEnabled=!1,this.ctx.msImageSmoothingEnabled=!1,this.ctx.imageSmoothingEnabled=!1),this.fill="black")},e.onDestroy=function(){this.texture&&(this.runtime.glwrap.deleteTexture(this.texture),this.runtime.glwrap.deleteTexture(this.quadtex),this.runtime.glwrap.deleteTexture(this.temp_texture)),this.texture=null,this.quadtex=null,this.temp_texture=null,this.canvas=null,this.ctx=null},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.grabCanvas=function(){var t=this.runtime.glwrap,e=this.runtime.canvas;if(t){if(null==this.type.plugin.canvasflip){var i=document.createElement("canvas");i.width=1,i.height=2,(l=i.getContext("experimental-webgl")).clearColor(1,1,1,1),l.clear(l.COLOR_BUFFER_BIT);var s=l.createProgram(),n=l.createShader(l.VERTEX_SHADER);l.shaderSource(n,"attribute vec3 pos;void main() {gl_Position = vec4(pos, 1.0);}"),l.compileShader(n),l.attachShader(s,n);var r=l.createShader(l.FRAGMENT_SHADER);l.shaderSource(r,"void main() {gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);}"),l.compileShader(r),l.attachShader(s,r),l.linkProgram(s),l.useProgram(s),l.bindBuffer(l.ARRAY_BUFFER,l.createBuffer()),l.bufferData(l.ARRAY_BUFFER,new Float32Array([-1,-1,0,1,-1,0,-1,0,0,1,0,0]),l.STATIC_DRAW);var o=l.getAttribLocation(s,"pos");l.enableVertexAttribArray(o),l.vertexAttribPointer(o,3,l.FLOAT,!1,0,0),l.drawArrays(l.TRIANGLE_STRIP,0,4);var a=l.createTexture();l.bindTexture(l.TEXTURE_2D,a),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,l.canvas),l.bindTexture(l.TEXTURE_2D,null);var h=l.createFramebuffer();l.bindFramebuffer(l.FRAMEBUFFER,h),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,a,0);var c=new Uint8Array(8);l.readPixels(0,0,1,2,l.RGBA,l.UNSIGNED_BYTE,c),l.bindFramebuffer(l.FRAMEBUFFER,null),this.type.plugin.canvasflip=0==c[0],l.deleteTexture(a)}var l=t.gl;this.texture.c2width==e.width&&this.texture.c2height==e.height||(t.deleteTexture(this.texture),this.texture=null),null==this.texture&&(this.texture=t.createEmptyTexture(e.width,e.height,this.runtime.linearSampling,this.runtime.isMobile)),this.type.plugin.canvasflip&&t.gl.pixelStorei(t.gl.UNPACK_FLIP_Y_WEBGL,!0),t.videoToTexture(e,this.texture,this.runtime.isMobile),t.gl.pixelStorei(t.gl.UNPACK_FLIP_Y_WEBGL,!1)}else this.canvas.width=e.width,this.canvas.height=e.height,this.ctx.drawImage(e,0,0,e.width,e.height)},e.draw=function(t){t.globalAlpha=this.opacity,t.save(),t.translate(this.x,this.y);var e=this.width>0?1:-1,i=this.height>0?1:-1;1===e&&1===i||t.scale(e,i),t.rotate(this.angle*e*i),t.drawImage(this.canvas,0-this.hotspotX*cr.abs(this.width),0-this.hotspotY*cr.abs(this.height),cr.abs(this.width),cr.abs(this.height)),t.restore()},e.drawGL=function(t){t.setTexture(this.texture),t.setOpacity(this.opacity);var e=this.bquad;t.quad(e.tlx,e.tly,e.trx,e.try_,e.brx,e.bry,e.blx,e.bly)},t.cnds=new function(){},i.prototype.SetEffect=function(t){this.compositeOp=cr.effectToCompositeOp(t),cr.setGLBlend(this,t,this.runtime.gl),this.runtime.redraw=!0},i.prototype.PasteObject=function(t){var e,i,s,n,r=t.getCurrentSol();e=r.select_all?r.type.instances:r.instances,this.update_bbox();var o=this.runtime.glwrap;if(o){if(!this.texture)return;var a=o.width,h=o.height;o.setSize(this.resx,this.resy),o.setTexture(null),o.setRenderingToTexture(this.texture),o.resetModelView(),o.scale(this.resx/this.width,-this.resy/this.height),o.rotateZ(-this.angle),o.translate((this.bbox.left+this.bbox.right)/-2,(this.bbox.top+this.bbox.bottom)/-2),o.updateModelView();var c,l,u=0,p=0;for(s=0,n=e.length;s<n;s++)if(this!=(i=e[s])&&i.visible&&0!==i.width&&0!==i.height&&(i.update_bbox(),this.bbox.intersects_rect(i.bbox)))if(i.uses_shaders)for(c=0,l=i.active_effect_types.length;c<l;++c)o.setTexture(null),o.setRenderingToTexture(this.temp_texture),o.clear(0,0,0,0),u=i.active_effect_types[c].shaderindex,p=i.active_effect_types[c].index,o.switchProgram(u),o.setBlend(i.srcBlend,i.destBlend),o.setProgramParameters(this.temp_texture,1/i.width,1/i.height,0,1,1,0,1,0,0,0,.5,.5,this.runtime.kahanTime.sum,i.effect_params[p]),i.drawGL(o),o.switchProgram(0),o.setTexture(null),o.setRenderingToTexture(this.texture),o.setTexture(this.temp_texture),o.resetModelView(),o.scale(this.resx,-this.resy),o.translate(-.5,-.5),o.updateModelView(),o.setOpacity(i.opacity),o.setAlphaBlend(),o.quad(0,0,1,0,1,1,0,1),o.resetModelView(),o.scale(this.resx/this.width,-this.resy/this.height),o.rotateZ(-this.angle),o.translate((this.bbox.left+this.bbox.right)/-2,(this.bbox.top+this.bbox.bottom)/-2),o.updateModelView();else o.switchProgram(0),o.setBlend(i.srcBlend,i.destBlend),i.drawGL(o);o.setRenderingToTexture(null),o.setSize(a,h)}else{var d=this.ctx;for(s=0,n=e.length;s<n;s++)(i=e[s]).update_bbox(),0==i.visible&&0==this.runtime.testOverlap(this,i)||(d.save(),d.scale(this.canvas.width/this.width,this.canvas.height/this.height),d.rotate(-this.angle),d.translate(-this.bquad.tlx,-this.bquad.tly),d.globalCompositeOperation=i.compositeOp,i.draw(d),d.restore())}this.runtime.redraw=!0},i.prototype.ClearColor=function(t,e,i,s){t=cr.clamp(t,0,255),e=cr.clamp(e,0,255),i=cr.clamp(i,0,255),s=cr.clamp(s,0,100);var n=this.runtime.glwrap;n?(n.setTexture(null),n.setRenderingToTexture(this.texture),n.clear(t/255,e/255,i/255,s/100),n.setRenderingToTexture(null)):(this.ctx.fillStyle="rgba("+parseInt(t)+","+parseInt(e)+","+parseInt(i)+","+s/100+")",this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)),this.runtime.redraw=!0},i.prototype.SetResolution=function(t,e){this.resx=t,this.resy=e;var i=this.runtime.glwrap;i?(this.texture&&(i.deleteTexture(this.texture),i.deleteTexture(this.temp_texture)),this.texture=i.createEmptyTexture(t,e,this.runtime.linearSampling,!1),this.temp_texture=i.createEmptyTexture(t,e,this.runtime.linearSampling,!1)):(this.canvas.width=t,this.canvas.height=e),this.runtime.redraw=!0},i.prototype.QuadColor=function(t,e,i,s){t=cr.clamp(t,0,255),e=cr.clamp(e,0,255),i=cr.clamp(i,0,255),s=cr.clamp(s,0,100);var n=this.runtime.glwrap;n?(n.setTexture(null),n.setRenderingToTexture(this.quadtex),n.clear(t/255,e/255,i/255,s/100),n.setRenderingToTexture(null)):this.fill="rgba("+parseInt(t)+","+parseInt(e)+","+parseInt(i)+","+s/100+")"},i.prototype.DrawQuad=function(t,e,i,s,n,r,o,a,h){this.update_bbox();var c=this.runtime.glwrap;if(c){c.setTexture(null),c.setRenderingToTexture(this.texture);var l=c.width,u=c.height;c.setSize(this.resx,this.resy),c.resetModelView(),c.scale(this.resx/this.width,-this.resy/this.height),c.rotateZ(-this.angle),c.translate((this.bbox.left+this.bbox.right)/-2,(this.bbox.top+this.bbox.bottom)/-2),c.updateModelView(),c.setTexture(this.quadtex),c.setOpacity(1),cr.setGLBlend(this.quadblend,h,c.gl),c.setBlend(this.quadblend.srcBlend,this.quadblend.destBlend),c.quad(t,e,i,s,n,r,o,a),c.setRenderingToTexture(null),c.setSize(l,u)}else{var p=this.ctx;p.save(),p.scale(this.canvas.width/this.width,this.canvas.height/this.height),p.rotate(-this.angle),p.translate(-this.bquad.tlx,-this.bquad.tly),p.globalCompositeOperation=cr.effectToCompositeOp(h),p.globalAlpha=1,p.fillStyle=this.fill,p.beginPath(),p.moveTo(t,e),p.lineTo(i,s),p.lineTo(n,r),p.lineTo(o,a),p.closePath(),p.fill(),p.restore()}this.runtime.redraw=!0},i.prototype.DrawTexQuad=function(t,e,i,n,r,o,a,h,c,l,u){var p=u.getFirstPicked();if(p){var d=p.curFrame,f=null,g=null;d||(p.canvas&&(f=p.canvas),p.tex&&(g=p.tex),p.texture&&(g=p.texture),p.texture_img&&(f=p.texture_img,g=p.webGL_texture)),this.update_bbox();var m=this.runtime.glwrap;if(m&&(d||g)){m.setTexture(null),m.setRenderingToTexture(this.texture);var y=m.width,_=m.height;m.setSize(this.resx,this.resy),m.resetModelView(),m.scale(this.resx/this.width,-this.resy/this.height),m.rotateZ(-this.angle),m.translate((this.bbox.left+this.bbox.right)/-2,(this.bbox.top+this.bbox.bottom)/-2),m.updateModelView(),m.setOpacity(l/100),cr.setGLBlend(this.quadblend,c,m.gl),m.setBlend(this.quadblend.srcBlend,this.quadblend.destBlend),d?(m.setTexture(p.curWebGLTexture),d.spritesheeted?m.quadTex(t,e,i,n,r,o,a,h,d.sheetTex):m.quad(t,e,i,n,r,o,a,h)):(m.setTexture(g),m.quad(t,e,i,n,r,o,a,h)),m.setRenderingToTexture(null),m.setSize(y,_)}else if(d||f){var v=this.ctx,b=null;v.save(),v.scale(this.canvas.width/this.width,this.canvas.height/this.height),v.rotate(-this.angle),v.translate(-this.bquad.tlx,-this.bquad.tly),v.globalCompositeOperation=cr.effectToCompositeOp(c),v.globalAlpha=l/100,this.points||(this.points=[new Object,new Object,new Object,new Object]),b=d?d.texture_img:f,d&&d.spritesheeted?(this.points[0].x=t,this.points[0].y=e,this.points[0].u=d.offx,this.points[0].v=d.offy,this.points[1].x=i,this.points[1].y=n,this.points[1].u=d.offx+d.width,this.points[1].v=d.offy,this.points[2].x=r,this.points[2].y=o,this.points[2].u=d.offx+d.width,this.points[2].v=d.offy+d.height,this.points[3].x=a,this.points[3].y=h,this.points[3].u=d.offx,this.points[3].v=d.offy+d.height):(this.points[0].x=t,this.points[0].y=e,this.points[0].u=0,this.points[0].v=0,this.points[1].x=i,this.points[1].y=n,this.points[1].u=b.width,this.points[1].v=0,this.points[2].x=r,this.points[2].y=o,this.points[2].u=b.width,this.points[2].v=b.height,this.points[3].x=a,this.points[3].y=h,this.points[3].u=0,this.points[3].v=b.height),s(v,b,this.points),v.restore()}this.runtime.redraw=!0}},i.prototype.setVertice=function(t,e,i,s,n){(t|=0)<0||t>3||(this.verts[t].x=e,this.verts[t].y=i,this.verts[t].u=s,this.verts[t].v=n)},i.prototype.DrawSubTexQuad=function(t,e,i){var n=i.getFirstPicked();if(n){var r=this.verts[0].x,o=this.verts[0].y,a=this.verts[0].u,h=this.verts[0].v,c=this.verts[1].x,l=this.verts[1].y,u=this.verts[1].u,p=this.verts[1].v,d=this.verts[2].x,f=this.verts[2].y,g=this.verts[2].u,m=this.verts[2].v,y=this.verts[3].x,_=this.verts[3].y,v=this.verts[3].u,b=this.verts[3].v,w=n.curFrame,x=null,S=null;w||(n.canvas&&(x=n.canvas),n.tex&&(S=n.tex),n.texture&&(S=n.texture),n.texture_img&&(x=n.texture_img,S=n.webGL_texture)),this.update_bbox();var T=this.runtime.glwrap;if(T&&(w||S)){T.setTexture(null),T.setRenderingToTexture(this.texture);var C=T.width,O=T.height;if(T.setSize(this.resx,this.resy),T.resetModelView(),T.scale(this.resx/this.width,-this.resy/this.height),T.rotateZ(-this.angle),T.translate((this.bbox.left+this.bbox.right)/-2,(this.bbox.top+this.bbox.bottom)/-2),T.updateModelView(),T.setOpacity(e/100),cr.setGLBlend(this.quadblend,t,T.gl),T.setBlend(this.quadblend.srcBlend,this.quadblend.destBlend),w)if(T.setTexture(n.curWebGLTexture),w.spritesheeted){var k=w.sheetTex;k.width=k.right-k.left,k.height=k.bottom-k.top,T.quadTexUV(r,o,c,l,d,f,y,_,k.left+a*k.width,k.top+h*k.height,k.left+u*k.width,k.top+p*k.height,k.left+g*k.width,k.top+m*k.height,k.left+v*k.width,k.top+b*k.height)}else T.quadTexUV(r,o,c,l,d,f,y,_,a,h,u,p,g,m,v,b);else T.setTexture(S),T.quadTexUV(r,o,c,l,d,f,y,_,a,h,u,p,g,m,v,b);T.setRenderingToTexture(null),T.setSize(C,O)}else if(w||x){var A=this.ctx,E=null;A.save(),A.scale(this.canvas.width/this.width,this.canvas.height/this.height),A.rotate(-this.angle),A.translate(-this.bquad.tlx,-this.bquad.tly),A.globalCompositeOperation=cr.effectToCompositeOp(t),A.globalAlpha=e/100,this.points||(this.points=[new Object,new Object,new Object,new Object]),E=w?w.texture_img:x,w&&w.spritesheeted?(this.points[0].x=r,this.points[0].y=o,this.points[0].u=w.offx+a*w.width,this.points[0].v=w.offy+h*w.height,this.points[1].x=c,this.points[1].y=l,this.points[1].u=w.offx+u*w.width,this.points[1].v=w.offy+p*w.height,this.points[2].x=d,this.points[2].y=f,this.points[2].u=w.offx+g*w.width,this.points[2].v=w.offy+m*w.height,this.points[3].x=y,this.points[3].y=_,this.points[3].u=w.offx+v*w.width,this.points[3].v=w.offy+b*w.height):(this.points[0].x=r,this.points[0].y=o,this.points[0].u=a*E.width,this.points[0].v=h*E.height,this.points[1].x=c,this.points[1].y=l,this.points[1].u=u*E.width,this.points[1].v=p*E.height,this.points[2].x=d,this.points[2].y=f,this.points[2].u=g*E.width,this.points[2].v=m*E.height,this.points[3].x=y,this.points[3].y=_,this.points[3].u=v*E.width,this.points[3].v=b*E.height),s(A,E,this.points),A.restore()}this.runtime.redraw=!0}},i.prototype.LoadImage=function(t,e){var i=this,s=new Image;s.onload=function(){i.resx=s.width,i.resy=s.height;var t=i.runtime.glwrap;t?(t.deleteTexture(this.texture),t.deleteTexture(this.temp_texture),i.texture=t.loadTexture(s,!1,i.runtime.linearSampling)):(i.canvas.width=s.width,i.canvas.height=s.height,i.ctx.drawImage(s,0,0,s.width,s.height)),0===e&&(i.width=s.width,i.height=s.height,i.set_bbox_changed()),i.runtime.redraw=!0},"data:"!==t.substr(0,5)&&(s.crossOrigin="anonymous"),s.src=t},i.prototype.LoadCanvas=function(){this.grabCanvas(),this.runtime.redraw=!0},t.acts=new i,n.prototype.imageUrl=function(t){var e=this.runtime.glwrap;if(e){var i=e.gl,s=this.resx,n=this.resy;e.present();var r=i.createFramebuffer();i.bindFramebuffer(i.FRAMEBUFFER,r),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this.texture,0);var o=s*n*4,a=new Uint8Array(o);i.readPixels(0,0,s,n,i.RGBA,i.UNSIGNED_BYTE,a);for(var h,c,l,u,p=0;p<o;p+=4)h=a[p]/255,c=a[p+1]/255,l=a[p+2]/255,u=a[p+3]/255,a[p]=h/u*255,a[p+1]=c/u*255,a[p+2]=l/u*255;i.bindFramebuffer(i.FRAMEBUFFER,null),i.deleteFramebuffer(r);var d=document.createElement("canvas");d.width=s,d.height=n;var f=d.getContext("2d"),g=f.createImageData(s,n);g.data.set(a),f.putImageData(g,0,0),t.set_string(d.toDataURL())}else t.set_string(this.canvas.toDataURL())},n.prototype.getresx=function(t){t.set_float(this.resx)},n.prototype.getresy=function(t){t.set_float(this.resy)},t.exps=new n}(),cr.plugins_.sirg_notifications=function(t){this.runtime=t},function(){var t=cr.plugins_.sirg_notifications.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(t){switch(t){case 0:return"top-right";case 1:return"top-left";case 2:return"bottom-left";case 3:return"bottom-right"}return"bottom-right"}function s(t){switch(t){case 0:return"slow";case 1:return"medium";case 2:return"fast"}return"slow"}function n(t){switch(t){case 0:return"";case 1:return"gritter-light";case 2:return"gritter-success";case 3:return"gritter-info";case 4:return"gritter-warning";case 5:return"gritter-error";case 6:return"gritter-red";case 7:return"gritter-yellow";case 8:return"gritter-blue";case 9:return"gritter-green"}return""}function r(){}function o(){}e.onCreate=function(){this.position=i(this.properties[0]),this.fade_in_speed=s(this.properties[1]),this.fade_out_speed=s(this.properties[2]),this.time=this.properties[3],this.max_number=this.properties[4],this.param_sticky=0===this.properties[5],this.param_style=this.properties[6],this.curr_tag="",jQuery.extend(jQuery.gritter.options,{position:this.position,fade_in_speed:this.fade_in_speed,fade_out_speed:this.fade_out_speed,time:this.time,max_to_display:this.max_number})},e.onDestroy=function(){},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},e.draw=function(t){},e.drawGL=function(t){},r.prototype.OnNotificationClicked=function(t){return cr.equals_nocase(t,this.curr_tag)},t.cnds=new r,o.prototype.AddNotification=function(t,e,i,s,r,o){jQuery.gritter.add({title:t,text:e,image:i,sticky:s,time:o,class_name:n(r)})},o.prototype.DeleteAllNotifications=function(){jQuery.gritter.removeAll()},o.prototype.AddSimpleNotification=function(t,e,i){jQuery.gritter.add({title:t,text:e,image:i,sticky:this.param_sticky,class_name:n(this.param_style)})},o.prototype.AddNotificationClickable=function(t,e,i,s,r,o,a,h){var c=this;c.curr_tag=t,jQuery.gritter.add({title:e,text:i,image:s,sticky:r,time:a,class_name:"gritter-clickable gritter-id-"+t+" "+n(o),close_on_click:h}),jQuery(".gritter-id-"+t).click(function(){return c.runtime.trigger(cr.plugins_.sirg_notifications.prototype.cnds.OnNotificationClicked,c),!1})},o.prototype.SetPosition=function(t){this.position=i(t),jQuery.gritter.options.position=this.position},t.acts=new o,t.exps=new function(){}}(),cr.plugins_.skymen_minifunctioncallback=function(t){this.runtime=t},function(){var t=cr.plugins_.skymen_minifunctioncallback.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}e.onCreate=function(){},e.draw=function(t){},e.drawGL=function(t){},e.getArgs=function(t,e,i){if(""==t)return[];""==i&&(i="a");var s=t.split(e),n=i.split(e),r=0;if(s.length>n.length){r=s.length-n.length;for(var o=0;o<r;o++)n.push("a")}for(o=0;o<s.length;o++){var a=n[o].trim().charAt(0).toLowerCase();"s"!=a&&"a"!=a&&"n"!=a&&console.warn("The type of the given number doesn't exist. Please use Number, String or Any. Note that the type only needs to start with n, a or s, and is not case sensitive, so using a single letter is ok."),"n"==a&&(s[o]=parseFloat(s[o].trim()))}return s},t.cnds=new function(){},i.prototype.Callback=function(t,e,i,s){var n=this.getArgs(i,e,s);c2_callFunction&&c2_callFunction(t,n)},t.acts=new i,s.prototype.Callback=function(t,e,i,s,n){var r=pushFuncStack();r.name=e.toLowerCase(),r.retVal=0,cr.clearArray(r.params),r.params=this.getArgs(s,i,n);var o=this.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,this,r.name);isInPreview&&!o&&console.warn("[Construct 2] Function object: expression Function.Call('"+e+"' ...) was used, but no event was triggered. Is the function call spelt incorrectly or no longer used?"),popFuncStack(),t.set_any(r.retVal)},t.exps=new s}(),cr.plugins_.skymen_siteLock=function(t){this.runtime=t},function(){var t=cr.plugins_.skymen_siteLock.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(t){for(var e,i,s="",n=-1;++n<t.length;)e=t.charCodeAt(n),i=n+1<t.length?t.charCodeAt(n+1):0,55296<=e&&e<=56319&&56320<=i&&i<=57343&&(e=65536+((1023&e)<<10)+(1023&i),n++),e<=127?s+=String.fromCharCode(e):e<=2047?s+=String.fromCharCode(192|e>>>6&31,128|63&e):e<=65535?s+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):e<=2097151&&(s+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return s}function s(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e}function n(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var i=1732584193,s=-271733879,n=-1732584194,r=271733878,u=0;u<t.length;u+=16){var p=i,d=s,f=n,g=r;i=o(i,s,n,r,t[u+0],7,-680876936),r=o(r,i,s,n,t[u+1],12,-389564586),n=o(n,r,i,s,t[u+2],17,606105819),s=o(s,n,r,i,t[u+3],22,-1044525330),i=o(i,s,n,r,t[u+4],7,-176418897),r=o(r,i,s,n,t[u+5],12,1200080426),n=o(n,r,i,s,t[u+6],17,-1473231341),s=o(s,n,r,i,t[u+7],22,-45705983),i=o(i,s,n,r,t[u+8],7,1770035416),r=o(r,i,s,n,t[u+9],12,-1958414417),n=o(n,r,i,s,t[u+10],17,-42063),s=o(s,n,r,i,t[u+11],22,-1990404162),i=o(i,s,n,r,t[u+12],7,1804603682),r=o(r,i,s,n,t[u+13],12,-40341101),n=o(n,r,i,s,t[u+14],17,-1502002290),i=a(i,s=o(s,n,r,i,t[u+15],22,1236535329),n,r,t[u+1],5,-165796510),r=a(r,i,s,n,t[u+6],9,-1069501632),n=a(n,r,i,s,t[u+11],14,643717713),s=a(s,n,r,i,t[u+0],20,-373897302),i=a(i,s,n,r,t[u+5],5,-701558691),r=a(r,i,s,n,t[u+10],9,38016083),n=a(n,r,i,s,t[u+15],14,-660478335),s=a(s,n,r,i,t[u+4],20,-405537848),i=a(i,s,n,r,t[u+9],5,568446438),r=a(r,i,s,n,t[u+14],9,-1019803690),n=a(n,r,i,s,t[u+3],14,-187363961),s=a(s,n,r,i,t[u+8],20,1163531501),i=a(i,s,n,r,t[u+13],5,-1444681467),r=a(r,i,s,n,t[u+2],9,-51403784),n=a(n,r,i,s,t[u+7],14,1735328473),i=h(i,s=a(s,n,r,i,t[u+12],20,-1926607734),n,r,t[u+5],4,-378558),r=h(r,i,s,n,t[u+8],11,-2022574463),n=h(n,r,i,s,t[u+11],16,1839030562),s=h(s,n,r,i,t[u+14],23,-35309556),i=h(i,s,n,r,t[u+1],4,-1530992060),r=h(r,i,s,n,t[u+4],11,1272893353),n=h(n,r,i,s,t[u+7],16,-155497632),s=h(s,n,r,i,t[u+10],23,-1094730640),i=h(i,s,n,r,t[u+13],4,681279174),r=h(r,i,s,n,t[u+0],11,-358537222),n=h(n,r,i,s,t[u+3],16,-722521979),s=h(s,n,r,i,t[u+6],23,76029189),i=h(i,s,n,r,t[u+9],4,-640364487),r=h(r,i,s,n,t[u+12],11,-421815835),n=h(n,r,i,s,t[u+15],16,530742520),i=c(i,s=h(s,n,r,i,t[u+2],23,-995338651),n,r,t[u+0],6,-198630844),r=c(r,i,s,n,t[u+7],10,1126891415),n=c(n,r,i,s,t[u+14],15,-1416354905),s=c(s,n,r,i,t[u+5],21,-57434055),i=c(i,s,n,r,t[u+12],6,1700485571),r=c(r,i,s,n,t[u+3],10,-1894986606),n=c(n,r,i,s,t[u+10],15,-1051523),s=c(s,n,r,i,t[u+1],21,-2054922799),i=c(i,s,n,r,t[u+8],6,1873313359),r=c(r,i,s,n,t[u+15],10,-30611744),n=c(n,r,i,s,t[u+6],15,-1560198380),s=c(s,n,r,i,t[u+13],21,1309151649),i=c(i,s,n,r,t[u+4],6,-145523070),r=c(r,i,s,n,t[u+11],10,-1120210379),n=c(n,r,i,s,t[u+2],15,718787259),s=c(s,n,r,i,t[u+9],21,-343485551),i=l(i,p),s=l(s,d),n=l(n,f),r=l(r,g)}return Array(i,s,n,r)}function r(t,e,i,s,n,r){return l((o=l(l(e,t),l(s,r)))<<(a=n)|o>>>32-a,i);var o,a}function o(t,e,i,s,n,o,a){return r(e&i|~e&s,t,e,n,o,a)}function a(t,e,i,s,n,o,a){return r(e&s|i&~s,t,e,n,o,a)}function h(t,e,i,s,n,o,a){return r(e^i^s,t,e,n,o,a)}function c(t,e,i,s,n,o,a){return r(i^(e|~s),t,e,n,o,a)}function l(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function u(){}e.onCreate=function(){this.sites=this.properties[0].split(" "),this.hash=0===this.properties[1],this.key=this.properties[2],this.order=0===this.properties[3]},e.SiteLock=function(){var t,e=this.key,i=this.getGameSite();if(this.hash&&this.order){for(var s=0;s<this.sites.length;s++){var n=this.sites[s];if(e=this.key+s,n===(t=this.hex_hmac_md5(e,i)))return!1}return!0}return this.hash?(t=this.hex_hmac_md5(e,i),!this.sites.includes(t)):!this.sites.includes(i)},e.hex_hmac_md5=function(t,e){return this.rstr2hex(function(t,e){var i=s(t);i.length>16&&(i=n(i,8*t.length));for(var r=Array(16),o=Array(16),a=0;a<16;a++)r[a]=909522486^i[a],o[a]=1549556828^i[a];var h=n(r.concat(s(e)),512+8*e.length);return function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e}(n(o.concat(h),640))}(i(t),i(e)))},e.rstr2hex=function(t){try{this.hexcase}catch(t){this.hexcase=0}for(var e,i=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",s="",n=0;n<t.length;n++)e=t.charCodeAt(n),s+=i.charAt(e>>>4&15)+i.charAt(15&e);return s},e.getGameSite=function(){try{return new URL(document.referrer).hostname}catch(t){return new URL(document.location).hostname}},u.prototype.SiteLock=function(){return this.SiteLock()},t.cnds=new u,t.acts=new function(){},t.exps=new function(){}}(),cr.plugins_.skymen_skinsCore=function(t){this.runtime=t},function(){var t=cr.plugins_.skymen_skinsCore.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}function n(){}e.onCreate=function(){this.skins={},this.lastSkin,this.lastSubSkin,this.curSkin,this.curSubSkin,this.tag=this.properties[0],this.instances=[],this.init=!1,null==cr.SkymenSkinCore&&(cr.SkymenSkinCore={}),cr.SkymenSkinCore[this.tag]=this},e.draw=function(t){},e.drawGL=function(t){},e.addInstance=function(t){this.instances.push(t)},i.prototype.IsEmpty=function(){return 0===Object.keys(this.skins).length&&this.skins.constructor===Object},i.prototype.HasSkin=function(t){return null!=this.skins[t]},i.prototype.HasSubSkin=function(t,e){return null!=this.skins[t]&&null!=this.skins[t][e]},i.prototype.OnSkin=function(t){return t==this.lastSkin},i.prototype.OnSubSkin=function(t,e){return t==this.lastSkin&&e==this.lastSubskin},i.prototype.OnAnySkin=function(){return!0},i.prototype.OnAnySubSkin=function(t){return t==this.lastSkin},i.prototype.OnAnySubAnySkin=function(){return!0},e.doForEachTrigger=function(t){this.runtime.pushCopySol(t.solModifiers),t.retrigger(),this.runtime.popSol(t.solModifiers)},i.prototype.ForEachSkin=function(){var t=this.runtime.getCurrentEventStack().current_event;return self=this,Object.keys(this.skins).forEach(function(e){self.curSkin=e,self.doForEachTrigger(t)}),!1},i.prototype.ForEachSubSkin=function(t){var e=this.runtime.getCurrentEventStack().current_event;return self=this,null==this.skins[t]||Object.keys(this.skins[t]).forEach(function(t){self.curSubSkin=t,self.doForEachTrigger(e)}),!1},t.cnds=new i,s.prototype.AddSkin=function(t,e,i,s,n){if(null==this.skins[e]&&(this.skins[e]={}),0==i)for(var r=0;r<t.animations.length;r++){s=t.animations[r].name;this.skins[e][s]={type:t,anim:s}}else this.skins[e][n]={type:t,anim:s}},s.prototype.AddSubSkin=function(t,e,i,s){null==this.skins[e]&&(this.skins[e]={}),this.skins[e][i]={type:t,anim:s}},s.prototype.RemoveSkin=function(t){null!=this.skins[t]&&delete this.skins[t]},s.prototype.RemoveSubSkin=function(t,e){null!=this.skins[t]&&null!=this.skins[t][e]&&delete this.skins[t][e]},s.prototype.Init=function(){if(!this.init){for(var t=0;t<this.instances.length;t++)this.instances[t].updateSkin();this.init=!0}},t.acts=new s,n.prototype.CurSkin=function(t){t.set_string(this.curSkin)},n.prototype.CurSubSkin=function(t){t.set_string(this.curSubSkin)},n.prototype.LastSkin=function(t){t.set_string(this.lastSkin)},n.prototype.LastSubSkin=function(t){t.set_string(this.lastSubSkin)},n.prototype.RandomSkin=function(t){var e=Object.keys(this.skins),i=e[e.length*Math.random()|0];"string"==typeof i?t.set_string(i):t.set_string("")},n.prototype.RandomSubSkin=function(t,e){if(this.skins[e]){var i=Object.keys(this.skins[e]),s=i[i.length*Math.random()|0];"string"==typeof s?t.set_string(s):t.set_string("")}else console.warn("The skin "+e+" doesn't exist"),t.set_string("")},t.exps=new n}();var HowlerAudioPlayer=globalThis.HowlerWrapper;cr.plugins_.skymenhowlerjs=function(t){this.runtime=t},function(){var t=cr.plugins_.skymenhowlerjs.prototype;t.Type=function(t){this.plugin=t,this.runtime=t.runtime,HowlerAudioPlayer.init(()=>this.runtime.files_subfolder)},t.Type.prototype.onCreate=function(){},t.Instance=function(t){this.type=t,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}function n(){}e.onCreate=function(){},e.saveToJSON=function(){},e.loadFromJSON=function(t){},e.onDestroy=function(){},e.tick=function(){},e.draw=function(t){},e.drawGL=function(t){},i.prototype.IsPlaying=function(t){return""===t.trim()?HowlerAudioPlayer.isPlaying():HowlerAudioPlayer.isPlaying(t)},t.cnds=new i,s.prototype.Play=function(t,e,i,s){""===e.trim()?HowlerAudioPlayer.play(t[0],null,1===i,1===s):HowlerAudioPlayer.play(t[0],e,1===i,1===s)},s.prototype.PlayByName=function(t,e,i,s){""===e.trim()?HowlerAudioPlayer.play(t,null,1===i,1===s):HowlerAudioPlayer.play(t,e,1===i,1===s)},s.prototype.Stop=function(t){""===t.trim()?HowlerAudioPlayer.stop():HowlerAudioPlayer.stop(t)},s.prototype.Mute=function(t){""===t.trim()?HowlerAudioPlayer.setMuted(!0):HowlerAudioPlayer.setMuted(!0,t)},s.prototype.Unmute=function(t){""===t.trim()?HowlerAudioPlayer.setMuted(!1):HowlerAudioPlayer.setMuted(!1,t)},s.prototype.Volume=function(t,e){""===e.trim()?HowlerAudioPlayer.setVolume(t):HowlerAudioPlayer.setVolume(t,e)},s.prototype.LinearVolume=function(t,e){""===e.trim()?HowlerAudioPlayer.setLinearVolume(t):HowlerAudioPlayer.setLinearVolume(t,e)},s.prototype.Load=function(t,e,i){""===e.trim()?HowlerAudioPlayer.load(t[0],null,1===i):HowlerAudioPlayer.load(t[0],e,1===i)},s.prototype.Unload=function(t,e){""===e.trim()?HowlerAudioPlayer.unload(t[0]):HowlerAudioPlayer.unload(t[0],e)},s.prototype.LoadByName=function(t,e,i){""===e.trim()?HowlerAudioPlayer.load(t,null,1===i):HowlerAudioPlayer.load(t,e,1===i)},s.prototype.UnloadByName=function(t,e){""===e.trim()?HowlerAudioPlayer.unload(t):HowlerAudioPlayer.unload(t,e)},t.acts=new s,n.prototype.Volume=function(t,e){""===e.trim()?t.set_float(HowlerAudioPlayer.getVolume()):t.set_float(HowlerAudioPlayer.getVolume(e))},n.prototype.MasterVolume=function(t){t.set_float(HowlerAudioPlayer.getVolume(group))},n.prototype.LinearVolume=function(t,e){""===e.trim()?t.set_float(HowlerAudioPlayer.getLinearVolume()):t.set_float(HowlerAudioPlayer.getLinearVolume(e))},n.prototype.MasterVolume=function(t){t.set_float(HowlerAudioPlayer.getLinearVolume(group))},t.exps=new n}(),cr.behaviors.Anchor=function(t){this.runtime=t},function(){var t=cr.behaviors.Anchor.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}e.onCreate=function(){this.anch_left=this.properties[0],this.anch_top=this.properties[1],this.anch_right=this.properties[2],this.anch_bottom=this.properties[3],this.inst.update_bbox(),this.xleft=this.inst.bbox.left,this.ytop=this.inst.bbox.top,this.xright=this.runtime.original_width-this.inst.bbox.left,this.ybottom=this.runtime.original_height-this.inst.bbox.top,this.rdiff=this.runtime.original_width-this.inst.bbox.right,this.bdiff=this.runtime.original_height-this.inst.bbox.bottom,this.enabled=0!==this.properties[4]},e.saveToJSON=function(){return{xleft:this.xleft,ytop:this.ytop,xright:this.xright,ybottom:this.ybottom,rdiff:this.rdiff,bdiff:this.bdiff,enabled:this.enabled}},e.loadFromJSON=function(t){this.xleft=t.xleft,this.ytop=t.ytop,this.xright=t.xright,this.ybottom=t.ybottom,this.rdiff=t.rdiff,this.bdiff=t.bdiff,this.enabled=t.enabled},e.tick=function(){if(this.enabled){var t,e=this.inst.layer,i=this.inst,s=this.inst.bbox;0===this.anch_left?(i.update_bbox(),0!==(t=e.viewLeft+this.xleft-s.left)&&(i.x+=t,i.set_bbox_changed())):1===this.anch_left&&(i.update_bbox(),0!==(t=e.viewRight-this.xright-s.left)&&(i.x+=t,i.set_bbox_changed())),0===this.anch_top?(i.update_bbox(),0!==(t=e.viewTop+this.ytop-s.top)&&(i.y+=t,i.set_bbox_changed())):1===this.anch_top&&(i.update_bbox(),0!==(t=e.viewBottom-this.ybottom-s.top)&&(i.y+=t,i.set_bbox_changed())),1===this.anch_right&&(i.update_bbox(),0!==(t=e.viewRight-this.rdiff-s.right)&&(i.width+=t,i.width<0&&(i.width=0),i.set_bbox_changed())),1===this.anch_bottom&&(i.update_bbox(),0!==(t=e.viewBottom-this.bdiff-s.bottom)&&(i.height+=t,i.height<0&&(i.height=0),i.set_bbox_changed()))}},t.cnds=new function(){},i.prototype.SetEnabled=function(t){this.enabled&&0===t?this.enabled=!1:this.enabled||0===t||(this.inst.update_bbox(),this.xleft=this.inst.bbox.left,this.ytop=this.inst.bbox.top,this.xright=this.runtime.original_width-this.inst.bbox.left,this.ybottom=this.runtime.original_height-this.inst.bbox.top,this.rdiff=this.runtime.original_width-this.inst.bbox.right,this.bdiff=this.runtime.original_height-this.inst.bbox.bottom,this.enabled=!0)},t.acts=new i,t.exps=new function(){}}(),cr.behaviors.Bullet=function(t){this.runtime=t},function(){var t=cr.behaviors.Bullet.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}function n(){}e.onCreate=function(){var t=this.properties[0];this.acc=this.properties[1],this.g=this.properties[2],this.bounceOffSolid=0!==this.properties[3],this.setAngle=0!==this.properties[4],this.dx=Math.cos(this.inst.angle)*t,this.dy=Math.sin(this.inst.angle)*t,this.lastx=this.inst.x,this.lasty=this.inst.y,this.lastKnownAngle=this.inst.angle,this.travelled=0,this.enabled=0!==this.properties[5]},e.saveToJSON=function(){return{acc:this.acc,g:this.g,dx:this.dx,dy:this.dy,lx:this.lastx,ly:this.lasty,lka:this.lastKnownAngle,t:this.travelled,e:this.enabled}},e.loadFromJSON=function(t){this.acc=t.acc,this.g=t.g,this.dx=t.dx,this.dy=t.dy,this.lastx=t.lx,this.lasty=t.ly,this.lastKnownAngle=t.lka,this.travelled=t.t,this.enabled=t.e},e.tick=function(){if(this.enabled){var t,e,i,s,n=this.runtime.getDt(this.inst);this.inst.angle!==this.lastKnownAngle&&(this.setAngle&&(t=cr.distanceTo(0,0,this.dx,this.dy),this.dx=Math.cos(this.inst.angle)*t,this.dy=Math.sin(this.inst.angle)*t),this.lastKnownAngle=this.inst.angle),0!==this.acc&&(t=cr.distanceTo(0,0,this.dx,this.dy),e=0===this.dx&&0===this.dy?this.inst.angle:cr.angleTo(0,0,this.dx,this.dy),(t+=this.acc*n)<0&&(t=0),this.dx=Math.cos(e)*t,this.dy=Math.sin(e)*t),0!==this.g&&(this.dy+=this.g*n),this.lastx=this.inst.x,this.lasty=this.inst.y,0===this.dx&&0===this.dy||(this.inst.x+=this.dx*n,this.inst.y+=this.dy*n,this.travelled+=cr.distanceTo(0,0,this.dx*n,this.dy*n),this.setAngle&&(this.inst.angle=cr.angleTo(0,0,this.dx,this.dy),this.inst.set_bbox_changed(),this.lastKnownAngle=this.inst.angle),this.inst.set_bbox_changed(),this.bounceOffSolid&&(i=this.runtime.testOverlapSolid(this.inst))&&(this.runtime.registerCollision(this.inst,i),t=cr.distanceTo(0,0,this.dx,this.dy),s=this.runtime.calculateSolidBounceAngle(this.inst,this.lastx,this.lasty),this.dx=Math.cos(s)*t,this.dy=Math.sin(s)*t,this.inst.x+=this.dx*n,this.inst.y+=this.dy*n,this.inst.set_bbox_changed(),this.setAngle&&(this.inst.angle=s,this.lastKnownAngle=s,this.inst.set_bbox_changed()),this.runtime.pushOutSolid(this.inst,this.dx/t,this.dy/t,Math.max(2.5*t*n,30))||this.runtime.pushOutSolidNearest(this.inst,100)))}},i.prototype.CompareSpeed=function(t,e){return cr.do_cmp(cr.distanceTo(0,0,this.dx,this.dy),t,e)},i.prototype.CompareTravelled=function(t,e){return cr.do_cmp(this.travelled,t,e)},t.cnds=new i,s.prototype.SetSpeed=function(t){var e=cr.angleTo(0,0,this.dx,this.dy);this.dx=Math.cos(e)*t,this.dy=Math.sin(e)*t},s.prototype.SetAcceleration=function(t){this.acc=t},s.prototype.SetGravity=function(t){this.g=t},s.prototype.SetAngleOfMotion=function(t){t=cr.to_radians(t);var e=cr.distanceTo(0,0,this.dx,this.dy);this.dx=Math.cos(t)*e,this.dy=Math.sin(t)*e},s.prototype.Bounce=function(t){if(t){var e=t.getFirstPicked(this.inst);if(e){var i=this.runtime.getDt(this.inst),s=cr.distanceTo(0,0,this.dx,this.dy),n=this.runtime.calculateSolidBounceAngle(this.inst,this.lastx,this.lasty,e);this.dx=Math.cos(n)*s,this.dy=Math.sin(n)*s,this.inst.x+=this.dx*i,this.inst.y+=this.dy*i,this.inst.set_bbox_changed(),this.setAngle&&(this.inst.angle=n,this.lastKnownAngle=n,this.inst.set_bbox_changed()),0!==s&&(this.bounceOffSolid?this.runtime.pushOutSolid(this.inst,this.dx/s,this.dy/s,Math.max(2.5*s*i,30))||this.runtime.pushOutSolidNearest(this.inst,100):this.runtime.pushOut(this.inst,this.dx/s,this.dy/s,Math.max(2.5*s*i,30),e))}}},s.prototype.SetDistanceTravelled=function(t){this.travelled=t},s.prototype.SetEnabled=function(t){this.enabled=1===t},t.acts=new s,n.prototype.Speed=function(t){var e=cr.distanceTo(0,0,this.dx,this.dy);e=cr.round6dp(e),t.set_float(e)},n.prototype.Acceleration=function(t){t.set_float(this.acc)},n.prototype.AngleOfMotion=function(t){t.set_float(cr.to_degrees(cr.angleTo(0,0,this.dx,this.dy)))},n.prototype.DistanceTravelled=function(t){t.set_float(this.travelled)},n.prototype.Gravity=function(t){t.set_float(this.g)},t.exps=new n}(),cr.behaviors.Fade=function(t){this.runtime=t},function(){var t=cr.behaviors.Fade.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}function n(){}e.onCreate=function(){this.activeAtStart=1===this.properties[0],this.setMaxOpacity=!1,this.fadeInTime=this.properties[1],this.waitTime=this.properties[2],this.fadeOutTime=this.properties[3],this.destroy=this.properties[4],this.stage=this.activeAtStart?0:3,this.recycled?this.stageTime.reset():this.stageTime=new cr.KahanAdder,this.maxOpacity=this.inst.opacity?this.inst.opacity:1,this.activeAtStart&&(0===this.fadeInTime?(this.stage=1,0===this.waitTime&&(this.stage=2)):(this.inst.opacity=0,this.runtime.redraw=!0))},e.saveToJSON=function(){return{fit:this.fadeInTime,wt:this.waitTime,fot:this.fadeOutTime,s:this.stage,st:this.stageTime.sum,mo:this.maxOpacity}},e.loadFromJSON=function(t){this.fadeInTime=t.fit,this.waitTime=t.wt,this.fadeOutTime=t.fot,this.stage=t.s,this.stageTime.reset(),this.stageTime.sum=t.st,this.maxOpacity=t.mo},e.tick=function(){this.stageTime.add(this.runtime.getDt(this.inst)),0===this.stage&&(this.inst.opacity=this.stageTime.sum/this.fadeInTime*this.maxOpacity,this.runtime.redraw=!0,this.inst.opacity>=this.maxOpacity&&(this.inst.opacity=this.maxOpacity,this.stage=1,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnFadeInEnd,this.inst))),1===this.stage&&this.stageTime.sum>=this.waitTime&&(this.stage=2,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnWaitEnd,this.inst)),2===this.stage&&0!==this.fadeOutTime&&(this.inst.opacity=this.maxOpacity-this.stageTime.sum/this.fadeOutTime*this.maxOpacity,this.runtime.redraw=!0,this.inst.opacity<0&&(this.inst.opacity=0,this.stage=3,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnFadeOutEnd,this.inst),1===this.destroy&&this.runtime.DestroyInstance(this.inst)))},e.doStart=function(){this.stage=0,this.stageTime.reset(),0===this.fadeInTime?(this.stage=1,0===this.waitTime&&(this.stage=2)):(this.inst.opacity=0,this.runtime.redraw=!0)},i.prototype.OnFadeOutEnd=function(){return!0},i.prototype.OnFadeInEnd=function(){return!0},i.prototype.OnWaitEnd=function(){return!0},t.cnds=new i,s.prototype.StartFade=function(){this.activeAtStart||this.setMaxOpacity||(this.maxOpacity=this.inst.opacity?this.inst.opacity:1,this.setMaxOpacity=!0),3===this.stage&&this.doStart()},s.prototype.RestartFade=function(){this.doStart()},s.prototype.SetFadeInTime=function(t){t<0&&(t=0),this.fadeInTime=t},s.prototype.SetWaitTime=function(t){t<0&&(t=0),this.waitTime=t},s.prototype.SetFadeOutTime=function(t){t<0&&(t=0),this.fadeOutTime=t},t.acts=new s,n.prototype.FadeInTime=function(t){t.set_float(this.fadeInTime)},n.prototype.WaitTime=function(t){t.set_float(this.waitTime)},n.prototype.FadeOutTime=function(t){t.set_float(this.fadeOutTime)},t.exps=new n}(),cr.behaviors.LOS=function(t){this.runtime=t},function(){var t=cr.behaviors.LOS.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){this.obstacleTypes=[]},e.findLosBehavior=function(t){var e,i,s;for(e=0,i=t.behavior_insts.length;e<i;++e)if((s=t.behavior_insts[e])instanceof cr.behaviors.LOS.prototype.Instance&&s.type===this)return s;return null},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var i=t.Instance.prototype;i.onCreate=function(){this.obstacleMode=this.properties[0],this.range=this.properties[1],this.cone=cr.to_radians(this.properties[2]),this.useCollisionCells=0!==this.properties[3]},i.onDestroy=function(){},i.saveToJSON=function(){var t,e,i={r:this.range,c:this.cone,t:[]};for(t=0,e=this.type.obstacleTypes.length;t<e;t++)i.t.push(this.type.obstacleTypes[t].sid);return i},i.loadFromJSON=function(t){var e,i,s;for(this.range=t.r,this.cone=t.c,cr.clearArray(this.type.obstacleTypes),e=0,i=t.t.length;e<i;e++)(s=this.runtime.getObjectTypeBySid(t.t[e]))&&this.type.obstacleTypes.push(s)},i.tick=function(){};var s=[],n=new cr.rect(0,0,0,0);function r(){}i.hasLOSto=function(t,e){var i=this.inst.x,r=this.inst.y,o=this.inst.angle;if(this.inst.width<0&&(o+=Math.PI),cr.distanceTo(i,r,t,e)>this.range)return!1;var a,h,c,l,u=cr.angleTo(i,r,t,e);if(cr.angleDiff(o,u)>this.cone/2)return!1;if(n.set(i,r,t,e),n.normalize(),0===this.obstacleMode){for(this.useCollisionCells?this.runtime.getSolidCollisionCandidates(this.inst.layer,n,s):(l=this.runtime.getSolidBehavior())&&cr.appendArray(s,l.my_instances.valuesRef()),a=0,h=s.length;a<h;++a)if((c=s[a]).extra.solidEnabled&&c!==this.inst&&this.runtime.testSegmentOverlap(i,r,t,e,c))return cr.clearArray(s),!1}else{if(this.useCollisionCells)this.runtime.getTypesCollisionCandidates(this.inst.layer,this.type.obstacleTypes,n,s);else for(a=0,h=this.type.obstacleTypes.length;a<h;++a)cr.appendArray(s,this.type.obstacleTypes[a].instances);for(a=0,h=s.length;a<h;++a)if((c=s[a])!==this.inst&&this.runtime.testSegmentOverlap(i,r,t,e,c))return cr.clearArray(s),!1}return cr.clearArray(s),!0};var o=new cr.ObjectSet,a=new cr.ObjectSet;function h(){}function c(){}r.prototype.HasLOSToObject=function(t){if(!t)return!1;var e,i,s,n,r,h,c,l,u=this.runtime.getCurrentConditionObjectType().getCurrentSol(),p=t.getCurrentSol(),d=u.getObjects(),f=p.getObjects();u.select_all&&cr.clearArray(u.else_instances),p.select_all&&cr.clearArray(p.else_instances);var g=this.runtime.getCurrentCondition().inverted;for(e=0,s=d.length;e<s;++e){for(r=d[e],l=!1,h=this.findLosBehavior(r),i=0,n=f.length;i<n;++i)r!==(c=f[i])&&cr.xor(h.hasLOSto(c.x,c.y),g)&&(l=!0,a.add(c));l&&o.add(r)}var m=o.valuesRef(),y=a.valuesRef();return u.select_all=!1,p.select_all=!1,cr.shallowAssignArray(u.instances,m),cr.shallowAssignArray(p.instances,y),o.clear(),a.clear(),u.hasObjects()},r.prototype.HasLOSToPosition=function(t,e){return this.hasLOSto(t,e)},t.cnds=new r,h.prototype.SetRange=function(t){this.range=t},h.prototype.SetCone=function(t){this.cone=cr.to_radians(t)},h.prototype.AddObstacle=function(t){var e=this.type.obstacleTypes;if(-1===e.indexOf(t)){var i,s,n;for(i=0,s=e.length;i<s;i++)if((n=e[i]).is_family&&-1!==n.members.indexOf(t))return;e.push(t)}},h.prototype.ClearObstacles=function(){cr.clearArray(this.type.obstacleTypes)},t.acts=new h,c.prototype.Range=function(t){t.set_float(this.range)},c.prototype.ConeOfView=function(t){t.set_float(cr.to_degrees(this.cone))},t.exps=new c}(),cr.behaviors.Persist=function(t){this.runtime=t},function(){var t=cr.behaviors.Persist.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){this.myProperty=this.properties[0]},e.onDestroy=function(){},e.tick=function(){this.runtime.getDt(this.inst)},t.cnds=new function(){},t.acts=new function(){},t.exps=new function(){}}(),cr.behaviors.Platform=function(t){this.runtime=t},function(){var t=cr.behaviors.Platform.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){};t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,this.leftkey=!1,this.rightkey=!1,this.jumpkey=!1,this.jumped=!1,this.doubleJumped=!1,this.canDoubleJump=!1,this.ignoreInput=!1,this.simleft=!1,this.simright=!1,this.simjump=!1,this.lastFloorObject=null,this.loadFloorObject=-1,this.lastFloorX=0,this.lastFloorY=0,this.floorIsJumpthru=!1,this.animMode=0,this.fallthrough=0,this.firstTick=!0,this.dx=0,this.dy=0};var e=t.Instance.prototype;function i(){}function s(){}function n(){}e.updateGravity=function(){this.downx=Math.cos(this.ga),this.downy=Math.sin(this.ga),this.rightx=Math.cos(this.ga-Math.PI/2),this.righty=Math.sin(this.ga-Math.PI/2),this.downx=cr.round6dp(this.downx),this.downy=cr.round6dp(this.downy),this.rightx=cr.round6dp(this.rightx),this.righty=cr.round6dp(this.righty),this.g1=this.g,this.g<0&&(this.downx*=-1,this.downy*=-1,this.g=Math.abs(this.g))},e.onCreate=function(){this.maxspeed=this.properties[0],this.acc=this.properties[1],this.dec=this.properties[2],this.jumpStrength=this.properties[3],this.g=this.properties[4],this.g1=this.g,this.maxFall=this.properties[5],this.enableDoubleJump=0!==this.properties[6],this.jumpSustain=this.properties[7]/1e3,this.defaultControls=1===this.properties[8],this.enabled=0!==this.properties[9],this.wasOnFloor=!1,this.wasOverJumpthru=this.runtime.testOverlapJumpThru(this.inst),this.loadOverJumpthru=-1,this.sustainTime=0,this.ga=cr.to_radians(90),this.updateGravity();var t=this;this.defaultControls&&!this.runtime.isDomFree&&(jQuery(document).keydown(function(e){t.onKeyDown(e)}),jQuery(document).keyup(function(e){t.onKeyUp(e)})),this.recycled||(this.myDestroyCallback=function(e){t.onInstanceDestroyed(e)}),this.runtime.addDestroyCallback(this.myDestroyCallback),this.inst.extra.isPlatformBehavior=!0},e.saveToJSON=function(){return{ii:this.ignoreInput,lfx:this.lastFloorX,lfy:this.lastFloorY,lfo:this.lastFloorObject?this.lastFloorObject.uid:-1,am:this.animMode,en:this.enabled,fall:this.fallthrough,ft:this.firstTick,dx:this.dx,dy:this.dy,ms:this.maxspeed,acc:this.acc,dec:this.dec,js:this.jumpStrength,g:this.g,g1:this.g1,mf:this.maxFall,wof:this.wasOnFloor,woj:this.wasOverJumpthru?this.wasOverJumpthru.uid:-1,ga:this.ga,edj:this.enableDoubleJump,cdj:this.canDoubleJump,dj:this.doubleJumped,sus:this.jumpSustain}},e.loadFromJSON=function(t){this.ignoreInput=t.ii,this.lastFloorX=t.lfx,this.lastFloorY=t.lfy,this.loadFloorObject=t.lfo,this.animMode=t.am,this.enabled=t.en,this.fallthrough=t.fall,this.firstTick=t.ft,this.dx=t.dx,this.dy=t.dy,this.maxspeed=t.ms,this.acc=t.acc,this.dec=t.dec,this.jumpStrength=t.js,this.g=t.g,this.g1=t.g1,this.maxFall=t.mf,this.wasOnFloor=t.wof,this.loadOverJumpthru=t.woj,this.ga=t.ga,this.enableDoubleJump=t.edj,this.canDoubleJump=t.cdj,this.doubleJumped=t.dj,this.jumpSustain=t.sus,this.leftkey=!1,this.rightkey=!1,this.jumpkey=!1,this.jumped=!1,this.simleft=!1,this.simright=!1,this.simjump=!1,this.sustainTime=0,this.updateGravity()},e.afterLoad=function(){-1===this.loadFloorObject?this.lastFloorObject=null:this.lastFloorObject=this.runtime.getObjectByUID(this.loadFloorObject),-1===this.loadOverJumpthru?this.wasOverJumpthru=null:this.wasOverJumpthru=this.runtime.getObjectByUID(this.loadOverJumpthru)},e.onInstanceDestroyed=function(t){this.lastFloorObject==t&&(this.lastFloorObject=null)},e.onDestroy=function(){this.lastFloorObject=null,this.runtime.removeDestroyCallback(this.myDestroyCallback)},e.onKeyDown=function(t){switch(t.which){case 38:t.preventDefault(),this.jumpkey=!0;break;case 37:t.preventDefault(),this.leftkey=!0;break;case 39:t.preventDefault(),this.rightkey=!0}},e.onKeyUp=function(t){switch(t.which){case 38:t.preventDefault(),this.jumpkey=!1,this.jumped=!1;break;case 37:t.preventDefault(),this.leftkey=!1;break;case 39:t.preventDefault(),this.rightkey=!1}},e.onWindowBlur=function(){this.leftkey=!1,this.rightkey=!1,this.jumpkey=!1},e.getGDir=function(){return this.g<0?-1:1},e.isOnFloor=function(){var t,e,i,s=null,n=null,r=this.inst.x,o=this.inst.y;if(this.inst.x+=this.downx,this.inst.y+=this.downy,this.inst.set_bbox_changed(),this.lastFloorObject&&this.runtime.testOverlap(this.inst,this.lastFloorObject)&&(!this.runtime.typeHasBehavior(this.lastFloorObject.type,cr.behaviors.solid)||this.lastFloorObject.extra.solidEnabled))return this.inst.x=r,this.inst.y=o,this.inst.set_bbox_changed(),this.lastFloorObject;if((s=this.runtime.testOverlapSolid(this.inst))||0!==this.fallthrough||(n=this.runtime.testOverlapJumpThru(this.inst,!0)),this.inst.x=r,this.inst.y=o,this.inst.set_bbox_changed(),s)return this.runtime.testOverlap(this.inst,s)?null:(this.floorIsJumpthru=!1,s);if(n&&n.length){for(t=0,i=0,e=n.length;t<e;t++)n[i]=n[t],this.runtime.testOverlap(this.inst,n[t])||i++;if(i>=1)return this.floorIsJumpthru=!0,n[0]}return null},e.tick=function(){},e.posttick=function(){var t,e,i,s,n,r,o,a,h,c,l=this.runtime.getDt(this.inst);this.jumpkey||this.simjump||(this.jumped=!1);var u=this.leftkey||this.simleft,p=this.rightkey||this.simright,d=this.jumpkey||this.simjump,f=d&&!this.jumped;if(this.simleft=!1,this.simright=!1,this.simjump=!1,this.enabled){this.ignoreInput&&(u=!1,p=!1,d=!1,f=!1),d||(this.sustainTime=0);var g=this.lastFloorObject,m=!1;this.firstTick&&((this.runtime.testOverlapSolid(this.inst)||this.runtime.testOverlapJumpThru(this.inst))&&this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,4,!0),this.firstTick=!1),!g||0!==this.dy||g.y===this.lastFloorY&&g.x===this.lastFloorX||(t=g.x-this.lastFloorX,e=g.y-this.lastFloorY,this.inst.x+=t,this.inst.y+=e,this.inst.set_bbox_changed(),this.lastFloorX=g.x,this.lastFloorY=g.y,m=!0,this.runtime.testOverlapSolid(this.inst)&&this.runtime.pushOutSolid(this.inst,-t,-e,2.5*Math.sqrt(t*t+e*e)));var y=this.isOnFloor(),_=this.runtime.testOverlapSolid(this.inst);if(_){var v=Math.abs(this.inst.width),b=Math.abs(this.inst.height);if(this.inst.extra.inputPredicted)this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,10,!1);else if(this.runtime.pushOutSolidAxis(this.inst,-this.downx,-this.downy,b/8))this.runtime.registerCollision(this.inst,_);else if(this.runtime.pushOutSolidAxis(this.inst,this.rightx,this.righty,v/2))this.runtime.registerCollision(this.inst,_);else if(this.runtime.pushOutSolidAxis(this.inst,this.downx,this.downy,b/2))this.runtime.registerCollision(this.inst,_);else{if(!this.runtime.pushOutSolidNearest(this.inst,Math.max(v,b)/2))return;this.runtime.registerCollision(this.inst,_)}}y?(this.doubleJumped=!1,this.canDoubleJump=!1,this.dy>0&&(this.wasOnFloor||(this.runtime.pushInFractional(this.inst,-this.downx,-this.downy,y,16),this.wasOnFloor=!0),this.dy=0),g!=y?(this.lastFloorObject=y,this.lastFloorX=y.x,this.lastFloorY=y.y,this.runtime.registerCollision(this.inst,y)):m&&(_=this.runtime.testOverlapSolid(this.inst))&&(this.runtime.registerCollision(this.inst,_),0!==t&&(t>0?this.runtime.pushOutSolid(this.inst,-this.rightx,-this.righty):this.runtime.pushOutSolid(this.inst,this.rightx,this.righty)),this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy))):d||(this.canDoubleJump=!0),(y&&f||!y&&this.enableDoubleJump&&d&&this.canDoubleJump&&!this.doubleJumped)&&(h=this.inst.x,c=this.inst.y,this.inst.x-=this.downx,this.inst.y-=this.downy,this.inst.set_bbox_changed(),this.runtime.testOverlapSolid(this.inst)?f=!1:(this.sustainTime=this.jumpSustain,this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnJump,this.inst),this.animMode=2,this.dy=-this.jumpStrength,f=!0,y?this.jumped=!0:this.doubleJumped=!0),this.inst.x=h,this.inst.y=c,this.inst.set_bbox_changed()),y||(d&&this.sustainTime>0?(this.dy=-this.jumpStrength,this.sustainTime-=l):(this.lastFloorObject=null,this.dy+=this.g*l,this.dy>this.maxFall&&(this.dy=this.maxFall)),f&&(this.jumped=!0)),this.wasOnFloor=!!y,u==p&&(this.dx<0?(this.dx+=this.dec*l,this.dx>0&&(this.dx=0)):this.dx>0&&(this.dx-=this.dec*l,this.dx<0&&(this.dx=0))),u&&!p&&(this.dx>0?this.dx-=(this.acc+this.dec)*l:this.dx-=this.acc*l),p&&!u&&(this.dx<0?this.dx+=(this.acc+this.dec)*l:this.dx+=this.acc*l),this.dx>this.maxspeed?this.dx=this.maxspeed:this.dx<-this.maxspeed&&(this.dx=-this.maxspeed);var w=!1;if(0!==this.dx){h=this.inst.x,c=this.inst.y,t=this.dx*l*this.rightx,e=this.dx*l*this.righty,this.inst.x+=this.rightx*(this.dx>1?1:-1)-this.downx,this.inst.y+=this.righty*(this.dx>1?1:-1)-this.downy,this.inst.set_bbox_changed();var x=!1,S=this.runtime.testOverlapSolid(this.inst);if(this.inst.x=h+t,this.inst.y=c+e,this.inst.set_bbox_changed(),!(i=this.runtime.testOverlapSolid(this.inst))&&y&&(i=this.runtime.testOverlapJumpThru(this.inst))&&(this.inst.x=h,this.inst.y=c,this.inst.set_bbox_changed(),this.runtime.testOverlap(this.inst,i)?(i=null,x=!1):x=!0,this.inst.x=h+t,this.inst.y=c+e,this.inst.set_bbox_changed()),i){var T=Math.abs(this.dx*l)+2;S||!this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,T,x,i)?(this.runtime.registerCollision(this.inst,i),T=Math.max(Math.abs(this.dx*l*2.5),30),this.runtime.pushOutSolid(this.inst,this.rightx*(this.dx<0?1:-1),this.righty*(this.dx<0?1:-1),T,!1)?!y||x||this.floorIsJumpthru||(h=this.inst.x,c=this.inst.y,this.inst.x+=this.downx,this.inst.y+=this.downy,this.runtime.testOverlapSolid(this.inst)&&this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,3,!1)||(this.inst.x=h,this.inst.y=c,this.inst.set_bbox_changed())):(this.inst.x=h,this.inst.y=c,this.inst.set_bbox_changed()),x||(this.dx=0)):!S&&!f&&Math.abs(this.dy)<Math.abs(this.jumpStrength/4)&&(this.dy=0,y||(w=!0))}else{var C=this.isOnFloor();y&&!C?(s=Math.ceil(Math.abs(this.dx*l))+2,h=this.inst.x,c=this.inst.y,this.inst.x+=this.downx*s,this.inst.y+=this.downy*s,this.inst.set_bbox_changed(),this.runtime.testOverlapSolid(this.inst)||this.runtime.testOverlapJumpThru(this.inst)?this.runtime.pushOutSolid(this.inst,-this.downx,-this.downy,s+2,!0):(this.inst.x=h,this.inst.y=c,this.inst.set_bbox_changed())):C&&(!y&&this.floorIsJumpthru&&(this.lastFloorObject=C,this.lastFloorX=C.x,this.lastFloorY=C.y,this.dy=0,w=!0),0===this.dy&&this.runtime.pushInFractional(this.inst,-this.downx,-this.downy,C,16))}}if(0!==this.dy){h=this.inst.x,c=this.inst.y,this.inst.x+=this.dy*l*this.downx,this.inst.y+=this.dy*l*this.downy;var O=this.inst.x,k=this.inst.y;this.inst.set_bbox_changed();var A=!1;if(!(_=this.runtime.testOverlapSolid(this.inst))&&this.dy>0&&!y){if((n=this.fallthrough>0?null:this.runtime.testOverlapJumpThru(this.inst,!0))&&n.length){if(this.wasOverJumpthru){for(this.inst.x=h,this.inst.y=c,this.inst.set_bbox_changed(),r=0,a=0,o=n.length;r<o;r++)n[a]=n[r],this.runtime.testOverlap(this.inst,n[r])||a++;n.length=a,this.inst.x=O,this.inst.y=k,this.inst.set_bbox_changed()}n.length>=1&&(_=n[0])}A=!!_}if(_){this.runtime.registerCollision(this.inst,_),this.sustainTime=0;T=A?Math.abs(this.dy*l*2.5+10):Math.max(Math.abs(this.dy*l*2.5+10),30);this.runtime.pushOutSolid(this.inst,this.downx*(this.dy<0?1:-1),this.downy*(this.dy<0?1:-1),T,A,_)?(this.lastFloorObject=_,this.lastFloorX=_.x,this.lastFloorY=_.y,this.floorIsJumpthru=A,A&&(w=!0),this.dy=0):(this.inst.x=h,this.inst.y=c,this.inst.set_bbox_changed(),this.wasOnFloor=!0,A||(this.dy=0))}}3!==this.animMode&&this.dy>0&&!y&&(this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnFall,this.inst),this.animMode=3),(y||w)&&this.dy>=0&&(3===this.animMode||w||f&&0===this.dy?(this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnLand,this.inst),0===this.dx&&0===this.dy?this.animMode=0:this.animMode=1):(0!==this.animMode&&0===this.dx&&0===this.dy&&(this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnStop,this.inst),this.animMode=0),1===this.animMode||0===this.dx&&0===this.dy||f||(this.runtime.trigger(cr.behaviors.Platform.prototype.cnds.OnMove,this.inst),this.animMode=1))),this.fallthrough>0&&this.fallthrough--,this.wasOverJumpthru=this.runtime.testOverlapJumpThru(this.inst)}},i.prototype.IsMoving=function(){return 0!==this.dx||0!==this.dy},i.prototype.CompareSpeed=function(t,e){var i=Math.sqrt(this.dx*this.dx+this.dy*this.dy);return cr.do_cmp(i,t,e)},i.prototype.IsOnFloor=function(){if(0!==this.dy)return!1;var t,e,i,s,n=null,r=this.inst.x,o=this.inst.y;if(this.inst.x+=this.downx,this.inst.y+=this.downy,this.inst.set_bbox_changed(),(t=this.runtime.testOverlapSolid(this.inst))||0!==this.fallthrough||(n=this.runtime.testOverlapJumpThru(this.inst,!0)),this.inst.x=r,this.inst.y=o,this.inst.set_bbox_changed(),t)return!this.runtime.testOverlap(this.inst,t);if(n&&n.length){for(e=0,s=0,i=n.length;e<i;e++)n[s]=n[e],this.runtime.testOverlap(this.inst,n[e])||s++;if(s>=1)return!0}return!1},i.prototype.IsByWall=function(t){var e,i=this.inst.x,s=this.inst.y;return 0===t?(this.inst.x-=2*this.rightx,this.inst.y-=2*this.righty):(this.inst.x+=2*this.rightx,this.inst.y+=2*this.righty),this.inst.set_bbox_changed(),this.runtime.testOverlapSolid(this.inst)?(this.inst.x-=3*this.downx,this.inst.y-=3*this.downy,this.inst.set_bbox_changed(),e=this.runtime.testOverlapSolid(this.inst),this.inst.x=i,this.inst.y=s,this.inst.set_bbox_changed(),e):(this.inst.x=i,this.inst.y=s,this.inst.set_bbox_changed(),!1)},i.prototype.IsJumping=function(){return this.dy<0},i.prototype.IsFalling=function(){return this.dy>0},i.prototype.OnJump=function(){return!0},i.prototype.OnFall=function(){return!0},i.prototype.OnStop=function(){return!0},i.prototype.OnMove=function(){return!0},i.prototype.OnLand=function(){return!0},i.prototype.IsDoubleJumpEnabled=function(){return this.enableDoubleJump},t.cnds=new i,s.prototype.SetIgnoreInput=function(t){this.ignoreInput=t},s.prototype.SetMaxSpeed=function(t){this.maxspeed=t,this.maxspeed<0&&(this.maxspeed=0)},s.prototype.SetAcceleration=function(t){this.acc=t,this.acc<0&&(this.acc=0)},s.prototype.SetDeceleration=function(t){this.dec=t,this.dec<0&&(this.dec=0)},s.prototype.SetJumpStrength=function(t){this.jumpStrength=t,this.jumpStrength<0&&(this.jumpStrength=0)},s.prototype.SetGravity=function(t){this.g1!==t&&(this.g=t,this.updateGravity(),this.runtime.testOverlapSolid(this.inst)&&(this.runtime.pushOutSolid(this.inst,this.downx,this.downy,10),this.inst.x+=2*this.downx,this.inst.y+=2*this.downy,this.inst.set_bbox_changed()),this.lastFloorObject=null)},s.prototype.SetMaxFallSpeed=function(t){this.maxFall=t,this.maxFall<0&&(this.maxFall=0)},s.prototype.SimulateControl=function(t){switch(t){case 0:this.simleft=!0;break;case 1:this.simright=!0;break;case 2:this.simjump=!0}},s.prototype.SetVectorX=function(t){this.dx=t},s.prototype.SetVectorY=function(t){this.dy=t},s.prototype.SetGravityAngle=function(t){t=cr.to_radians(t),t=cr.clamp_angle(t),this.ga!==t&&(this.ga=t,this.updateGravity(),this.lastFloorObject=null)},s.prototype.SetEnabled=function(t){this.enabled!==(1===t)&&(this.enabled=1===t,this.enabled||(this.lastFloorObject=null))},s.prototype.FallThrough=function(){var t=this.inst.x,e=this.inst.y;this.inst.x+=this.downx,this.inst.y+=this.downy,this.inst.set_bbox_changed();var i=this.runtime.testOverlapJumpThru(this.inst,!1);this.inst.x=t,this.inst.y=e,this.inst.set_bbox_changed(),i&&(this.fallthrough=3,this.lastFloorObject=null)},s.prototype.SetDoubleJumpEnabled=function(t){this.enableDoubleJump=0!==t},s.prototype.SetJumpSustain=function(t){this.jumpSustain=t/1e3},t.acts=new s,n.prototype.Speed=function(t){t.set_float(Math.sqrt(this.dx*this.dx+this.dy*this.dy))},n.prototype.MaxSpeed=function(t){t.set_float(this.maxspeed)},n.prototype.Acceleration=function(t){t.set_float(this.acc)},n.prototype.Deceleration=function(t){t.set_float(this.dec)},n.prototype.JumpStrength=function(t){t.set_float(this.jumpStrength)},n.prototype.Gravity=function(t){t.set_float(this.g)},n.prototype.GravityAngle=function(t){t.set_float(cr.to_degrees(this.ga))},n.prototype.MaxFallSpeed=function(t){t.set_float(this.maxFall)},n.prototype.MovingAngle=function(t){t.set_float(cr.to_degrees(Math.atan2(this.dy,this.dx)))},n.prototype.VectorX=function(t){t.set_float(this.dx)},n.prototype.VectorY=function(t){t.set_float(this.dy)},n.prototype.JumpSustain=function(t){t.set_float(1e3*this.jumpSustain)},t.exps=new n}(),cr.behaviors.Rex_Zigzag=function(t){this.runtime=t},function(){var t=cr.behaviors.Rex_Zigzag.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime};var e=t.Type.prototype;e.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var i=t.Instance.prototype,s=function(t,e){switch(t){case"F":t="M";break;case"B":t="M",e=-e;break;case"R":t="R";break;case"L":t="R",e=-e;break;case"W":break;default:return null}return{cmd:t,param:e}},n=function(t){var e=""!=t?eval("("+t+")"):null;return e},r=[null,null],o=function(t){var e,i,s=t.indexOf("[");return-1!=s?(i=t.slice(s),e=t.slice(0,s)):(i="",e=t),r[0]=e,r[1]=i,r},a=function(t){var e,i,r,a,h,c,l=[],u=t.split(/;|\n/),p=u.length;for(e=0;e<p;e++)2==(i=(c=o(u[e]))[0].replace(/(^\s*)|(\s*$)/g,"").replace(/(\s+)/g," ").split(" ")).length&&(r=i[0].toUpperCase(),a=parseFloat(i[1]),(h=s(r,a))&&(h.speed=n(c[1]),l.push(h)));return l};function h(){}i.onCreate=function(){this.activated=this.properties[0],this.isRun=1==this.properties[1];var t=1==this.properties[2],e=1==this.properties[12],i=1==this.properties[13],s=1==this.properties[14];this.currentCmd=null,this.inst.xOffset=0,this.inst.yOffset=0,this.isMyCall=!1;var n=t?this.inst.angle:cr.to_clamped_radians(this.properties[11]);this.inst.angleOffset=n,this.recycled||(this.positionData={x:0,y:0,a:0}),this.positionData.x=s?0:this.inst.x,this.positionData.y=s?0:this.inst.y,this.positionData.a=n,this.recycled?this.CmdQueue.Init(this.properties[3]):this.CmdQueue=new d(this.properties[3]),this.recycled?this.CmdMove.Init(this.inst,this.properties[5],this.properties[6],this.properties[7],e,i,s):this.CmdMove=new g(this.inst,this.properties[5],this.properties[6],this.properties[7],e,i,s),this.recycled?this.CmdRotate.Init(this.inst,t,this.properties[8],this.properties[9],this.properties[10],e,i,s):this.CmdRotate=new y(this.inst,t,this.properties[8],this.properties[9],this.properties[10],e,i,s),this.recycled?this.CmdWait.Init(i):this.CmdWait=new S(i),this.recycled||(this.cmdMap={M:this.CmdMove,R:this.CmdRotate,W:this.CmdWait}),this.AddCommandString(this.properties[4])},i.tick=function(){if(0!=this.activated&&this.isRun)for(var t,e=this.runtime.getDt(this.inst);e;){if(null==this.currentCmd){if(this.currentCmd=this.CmdQueue.GetCmd(),null==this.currentCmd){this.isRun=!1,this.isMyCall=!0,this.runtime.trigger(cr.behaviors.Rex_Zigzag.prototype.cnds.OnCmdQueueFinish,this.inst),this.isMyCall=!1;break}(t=this.cmdMap[this.currentCmd.cmd]).CmdInit(this.positionData,this.currentCmd.param,this.currentCmd.speed),this.isMyCall=!0,this.runtime.trigger(cr.behaviors.Rex_Zigzag.prototype.cnds.OnCmdStart,this.inst),this.isMyCall=!1}else t=this.cmdMap[this.currentCmd.cmd];e=t.Tick(e),t.isDone&&(this.isMyCall=!0,this.runtime.trigger(cr.behaviors.Rex_Zigzag.prototype.cnds.OnCmdFinish,this.inst),this.isMyCall=!1,this.currentCmd=null)}},i.AddCommand=function(t,e){this.CmdQueue.Push(s(t,e))},i.AddCommandString=function(t){""!=t&&this.CmdQueue.PushList(a(t))},i.saveToJSON=function(){return{en:this.activated,ir:this.isRun,ps:this.positionData,cq:this.CmdQueue.saveToJSON(),cc:this.currentCmd,cm:this.CmdMove.saveToJSON(),cr:this.CmdRotate.saveToJSON(),cw:this.CmdWait.saveToJSON()}},i.loadFromJSON=function(t){(this.activated=t.en,this.isRun=t.ir,this.positionData=t.ps,this.CmdQueue.loadFromJSON(t.cq),this.currentCmd=t.cc,this.CmdMove.loadFromJSON(t.cm),this.CmdRotate.loadFromJSON(t.cr),this.CmdWait.loadFromJSON(t.cw),null!=this.currentCmd)&&(this.cmdMap[this.currentCmd.cmd].target=this.positionData)},t.cnds=new h,h.prototype.CompareMovSpeed=function(t,e){return cr.do_cmp(this.CmdMove.currentSpeed,t,e)},h.prototype.CompareRotSpeed=function(t,e){return cr.do_cmp(this.CmdRotate.currentSpeed,t,e)};var c=function(t,e){if(null==t)return!1;var i;switch(e){case 0:i="M"==t.cmd&&t.param>=0;break;case 1:i="M"==t.cmd&&t.param<0;break;case 2:i="R"==t.cmd&&t.param>=0;break;case 3:i="R"==t.cmd&&t.param<0;break;case 4:i="W"==t.cmd;break;default:i=!0}return i};function l(){}h.prototype.IsCmd=function(t){return c(this.currentCmd,t)},h.prototype.OnCmdQueueFinish=function(){return this.isMyCall},h.prototype.OnCmdStart=function(t){return c(this.currentCmd,t)&&this.isMyCall},h.prototype.OnCmdFinish=function(t){return c(this.currentCmd,t)&&this.isMyCall},t.acts=new l,l.prototype.SetActivated=function(t){this.activated=t},l.prototype.Start=function(){this.currentCmd=null,this.isRun=!0,this.CmdQueue.Reset(),this.positionData.x=this.CmdMove.absoluteMode?0:this.inst.x,this.positionData.y=this.CmdMove.absoluteMode?0:this.inst.y,this.CmdRotate.rotatable&&(this.positionData.a=this.inst.angle)},l.prototype.Stop=function(){this.currentCmd=null,this.isRun=!1},l.prototype.SetMaxMovSpeed=function(t){this.CmdMove.move.max=t},l.prototype.SetMovAcceleration=function(t){this.CmdMove.move.acc=t},l.prototype.SetMovDeceleration=function(t){this.CmdMove.move.dec=t},l.prototype.SetMaxRotSpeed=function(t){this.CmdRotate.move.max=t},l.prototype.SetRotAcceleration=function(t){this.CmdRotate.move.acc=t},l.prototype.SetRotDeceleration=function(t){this.CmdRotate.move.dec=t},l.prototype.SetRepeatCount=function(t){this.CmdQueue.repeatCount=t,this.CmdQueue.repeatCountSave=t},l.prototype.CleanCmdQueue=function(){this.CmdQueue.CleanAll()};var u=["F","B","R","L","W"];function p(){}l.prototype.AddCmd=function(t,e){this.AddCommand(u[t],e)},l.prototype.AddCmdString=function(t){this.AddCommandString(t)},l.prototype.SetRotatable=function(t){this.CmdRotate.rotatable=1==t},l.prototype.SetMovingAngle=function(t){var e=cr.to_clamped_radians(t);this.CmdMove.absoluteMode?this.inst.angleOffset=e:(this.positionData.a=e,this.CmdRotate.rotatable&&(this.inst.angle=e,this.inst.set_bbox_changed()))},l.prototype.SetPrecise=function(t){var e=1==t;this.CmdMove.preciseMode=e,this.CmdRotate.preciseMode=e},l.prototype.SetAbsolute=function(t){var e=1==t;this.CmdMove.absoluteMode=e,this.CmdRotate.absoluteMode=e},t.exps=new p,p.prototype.Activated=function(t){t.set_int(this.activated)},p.prototype.MovSpeed=function(t){t.set_float(this.CmdMove.currentSpeed)},p.prototype.MaxMovSpeed=function(t){t.set_float(this.CmdMove.move.max)},p.prototype.MovAcc=function(t){t.set_float(this.CmdMove.move.acc)},p.prototype.MovDec=function(t){t.set_float(this.CmdMove.move.dec)},p.prototype.RotSpeed=function(t){t.set_float(this.CmdRotate.currentSpeed)},p.prototype.MaxRotSpeed=function(t){t.set_float(this.CmdRotate.move.max)},p.prototype.RotAcc=function(t){t.set_float(this.CmdRotate.move.acc)},p.prototype.RotDec=function(t){t.set_float(this.CmdRotate.move.dec)},p.prototype.Rotatable=function(t){t.set_int(this.CmdRotate.rotatable)},p.prototype.RepCnt=function(t){t.set_int(this.CmdQueue.repeatCountSave)},p.prototype.CmdIndex=function(t){t.set_int(this.CmdQueue.currentCmdQueueIndex)},p.prototype.MovAngle=function(t){var e;c(this.currentCmd,2)||c(this.currentCmd,3)?(e=this.CmdRotate.currentAngleDeg)<0&&(e=360+e):e=cr.to_clamped_degrees(this.positionData.a),t.set_float(e)},p.prototype.OffAngle=function(t){var e=this.CmdRotate.rotatable?cr.to_clamped_degrees(this.inst.angleOffset):0;"number"==typeof e?t.set_float(e):t.set_float(0)},p.prototype.OffX=function(t){var e=this.inst.xOffset;"number"==typeof e?t.set_float(e):t.set_float(0)},p.prototype.OffY=function(t){var e=this.inst.yOffset;"number"==typeof e?t.set_float(e):t.set_float(0)};var d=function(t){this.Init(t)},f=d.prototype;f.Init=function(t){this.CleanAll(),this.repeatCount=t,this.repeatCountSave=t},f.CleanAll=function(){this.queueIndex=0,this.currentCmdQueueIndex=-1,this.queue=[]},f.Reset=function(){this.repeatCount=this.repeatCountSave,this.queueIndex=0,this.currentCmdQueueIndex=-1},f.Push=function(t){this.queue.push(t)},f.PushList=function(t){this.queue.push.apply(this.queue,t)},f.GetCmd=function(){var t;t=this.queue[this.queueIndex],this.currentCmdQueueIndex=this.queueIndex;var e=this.queueIndex+1;return e>=this.queue.length?1!=this.repeatCount?(this.queueIndex=0,this.repeatCount-=1):this.queueIndex=-1:this.queueIndex=e,t},f.saveToJSON=function(){return{i:this.queueIndex,cci:this.currentCmdQueueIndex,q:this.queue,rptsv:this.repeatCountSave,rpt:this.repeatCount}},f.loadFromJSON=function(t){this.queueIndex=t.i,this.currentCmdQueueIndex=t.cci,this.queue=t.q,this.repeatCountSave=t.rptsv,this.repeatCount=t.rpt};var g=function(t,e,i,s,n,r,o){this.Init(t,e,i,s,n,r,o)},m=g.prototype;m.Init=function(t,e,i,s,n,r,o){this.inst=t,this.move={max:e,acc:i,dec:s},this.isDone=!0,this.preciseMode=n,this.continuedMode=r,this.absoluteMode=o,this.currentSpeed=0},m.CmdInit=function(t,e,i){var s;this.target=t,this.dir=e>=0,this.remainDistance=Math.abs(e),this.isDone=!1,s=this.absoluteMode?this.inst.angleOffset:t.a,t.x+=e*Math.cos(s),t.y+=e*Math.sin(s),i&&x.apply(this,i),v.call(this,null)},m.Tick=function(t){var e,i=b.call(this,t);if(this.remainDistance-=i,this.remainDistance<=0||this.currentSpeed<=0){if(this.isDone=!0,this.preciseMode)this.absoluteMode?(this.inst.xOffset=this.target.x,this.inst.yOffset=this.target.y):(this.inst.x=this.target.x,this.inst.y=this.target.y);else{var s=this.target.a;i+=this.remainDistance,this.dir||(i=-i),this.absoluteMode?(this.inst.xOffset+=i*Math.cos(s),this.inst.yOffset+=i*Math.sin(s),this.target.x=this.inst.xOffset,this.target.y=this.inst.yOffset):(this.inst.x+=i*Math.cos(s),this.inst.y+=i*Math.sin(s),this.target.x=this.inst.x,this.target.y=this.inst.y)}e=this.continuedMode?w.call(this):0}else{s=this.absoluteMode?this.inst.angleOffset:this.target.a,this.dir||(i=-i),this.absoluteMode?(this.inst.xOffset+=i*Math.cos(s),this.inst.yOffset+=i*Math.sin(s)):(this.inst.x+=i*Math.cos(s),this.inst.y+=i*Math.sin(s)),e=0}return this.absoluteMode||this.inst.set_bbox_changed(),e},m.saveToJSON=function(){return{v:this.move,id:this.isDone,pm:this.preciseMode,cspd:this.currentSpeed,offx:this.inst.xOffset,offy:this.inst.yOffset,abs:this.absoluteMode,dir:this.dir,rd:this.remainDistance}},m.loadFromJSON=function(t){this.move=t.v,this.isDone=t.id,this.preciseMode=t.pm,this.currentSpeed=t.cspd,this.dir=t.dir,this.remainDistance=t.rd,this.absoluteMode=t.abs,this.inst.xOffset=t.offx,this.inst.yOffset=t.offy};var y=function(t,e,i,s,n,r,o,a){this.Init(t,e,i,s,n,r,o,a)},_=y.prototype;_.Init=function(t,e,i,s,n,r,o,a){this.inst=t,this.rotatable=e,this.move={max:i,acc:s,dec:n},this.isDone=!0,this.isZeroDtMode=i>=36e3&&0==s&&0==n,this.preciseMode=r,this.continuedMode=o,this.absoluteMode=a,this.currentAngleDeg=e?cr.to_clamped_degrees(t.angle):0,this.currentSpeed=0},_.CmdInit=function(t,e,i){this.target=t,this.currentAngleDeg=cr.to_clamped_degrees(t.a),this.targetAngleDeg=this.currentAngleDeg+e,this.dir=e>=0;var s=cr.to_clamped_radians(this.targetAngleDeg);this.remainDistance=Math.abs(e),this.isDone=!1,t.a=s,i&&x.apply(this,i),v.call(this,null)},_.Tick=function(t){var e,i;if(this.isZeroDtMode)e=t,this.isDone=!0,i=this.target.a,this.currentAngleDeg=this.targetAngleDeg;else{var s=b.call(this,t);this.remainDistance-=s,this.remainDistance<=0||this.currentSpeed<=0?(this.isDone=!0,this.preciseMode?(i=this.target.a,this.currentAngleDeg=this.targetAngleDeg):(s+=this.remainDistance,this.currentAngleDeg+=this.dir?s:-s,i=cr.to_clamped_radians(this.currentAngleDeg),this.target.a=i),e=1==this.continuedMode?w.call(this):0):(this.currentAngleDeg+=this.dir?s:-s,i=cr.to_clamped_radians(this.currentAngleDeg),e=0)}return this.absoluteMode?this.inst.angleOffset=i:this.rotatable&&(this.inst.angle=i,this.inst.set_bbox_changed()),e},_.saveToJSON=function(){return{ra:this.rotatable,v:this.move,id:this.isDone,izm:this.isZeroDtMode,pm:this.preciseMode,cad:this.currentAngleDeg,cspd:this.currentSpeed,abs:this.absoluteMode,offa:this.inst.angleOffset,tad:this.targetAngleDeg,dir:this.dir,rd:this.remainDistance}},_.loadFromJSON=function(t){this.rotatable=t.ra,this.move=t.v,this.isDone=t.id,this.isZeroDtMode=t.izm,this.preciseMode=t.pm,this.currentAngleDeg=t.cad,this.currentSpeed=t.cspd,this.absoluteMode=t.abs,this.inst.angleOffset=t.offa,this.targetAngleDeg=t.tad,this.dir=t.dir,this.remainDistance=t.rd};var v=function(t){var e=this.move;null!=t?this.currentSpeed=t>e.max?e.max:t:e.acc>0?this.currentSpeed=0:this.currentSpeed=e.max},b=function(t){var e=this.move,i=!1;0!=e.dec&&(i=this.currentSpeed*this.currentSpeed/(2*e.dec)>=this.remainDistance);var s=i?-e.dec:e.acc;return 0!=s&&v.call(this,this.currentSpeed+s*t),this.currentSpeed*t},w=function(){var t;return this.move.acc>0||this.move.dec>0?(v.call(this,0),t=0):t=-this.remainDistance/this.currentSpeed,t},x=function(t,e,i){null!=t&&(this.move.max=t),null!=e&&(this.move.acc=e),null!=i&&(this.move.dec=i)},S=function(t){this.Init(t)},T=S.prototype;T.Init=function(t){this.isDone=!0,this.continuedMode=t},T.CmdInit=function(t,e){this.remainDistance=e,this.isDone=!1,this.target=t},T.Tick=function(t){var e;return this.remainDistance-=t,this.remainDistance<=0?(e=this.continuedMode?-this.remainDistance:0,this.isDone=!0):e=0,e},T.saveToJSON=function(){return{id:this.isDone,rd:this.remainDistance}},T.loadFromJSON=function(t){this.isDone=t.id,this.remainDistance=t.rd}}(),cr.behaviors.Rex_pushOutSolid=function(t){this.runtime=t},function(){var t=cr.behaviors.Rex_pushOutSolid.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){this.obstacleTypes=[]},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){this.enabled=1===this.properties[0],this.obstacleMode=this.properties[1],this.maxDist=100},e.onDestroy=function(){},e.tick=function(){this.enabled&&this.pushOutNearest(this.getCandidates(),this.maxDist)};var i=[];function s(){}e.getCandidates=function(){if(i.length=0,0===this.obstacleMode){var t=this.runtime.getSolidBehavior();t&&cr.appendArray(i,t.my_instances.valuesRef())}else{var e,s=this.type.obstacleTypes,n=s.length;for(e=0;e<n;e++)cr.appendArray(i,s[e].instances)}return i},e.pushOutNearest=function(t,e){var i=this.inst,s=0,n=i.x,r=i.y,o=0,a=0,h=0,c=this.get_first_overlap_inst(t);if(!c)return!0;for(;s<=e;){switch(o){case 0:a=0,h=-1,s++;break;case 1:a=1,h=-1;break;case 2:a=1,h=0;break;case 3:a=1,h=1;break;case 4:a=0,h=1;break;case 5:a=-1,h=1;break;case 6:a=-1,h=0;break;case 7:a=-1,h=-1}if(o=(o+1)%8,i.x=cr.floor(n+a*s),i.y=cr.floor(r+h*s),i.set_bbox_changed(),!(c=this.get_first_overlap_inst(t,c)))return!0}return i.x=n,i.y=r,i.set_bbox_changed(),!1},e.pushOut=function(t,e,i,s){var n,r,o=this.inst,a=0,h=o.x,c=o.y,l=this.get_first_overlap_inst(t);if(!l)return!0;for(;a<=s;)if(a++,n=cr.floor(h+e*a),r=cr.floor(c+i*a),!(o.x===n&&o.y===r||(o.x=n,o.y=r,o.set_bbox_changed(),l=this.get_first_overlap_inst(t,l))))return!0;return o.x=h,o.y=c,o.set_bbox_changed(),!1},e.get_first_overlap_inst=function(t,e){if(e&&this.runtime.testOverlap(this.inst,e))return e;var i,s=t.length;for(i=0;i<s;i++)if(this.runtime.testOverlap(this.inst,t[i]))return t[i];return null},e.saveToJSON=function(){var t,e,i=[];for(t=0,e=this.type.obstacleTypes.length;t<e;t++)i.push(this.type.obstacleTypes[t].sid);return{en:this.enabled,obs:i}},e.loadFromJSON=function(t){this.enabled=t.en,cr.clearArray(this.type.obstacleTypes);var e,i,s,n=t.obs;for(e=0,i=n.length;e<i;e++)(s=this.runtime.getObjectTypeBySid(n[e]))&&this.type.obstacleTypes.push(s)},t.cnds=new function(){},t.acts=new s,s.prototype.SetEnabled=function(t){this.enabled=1===t},s.prototype.AddObstacle=function(t){if(t){var e=this.type.obstacleTypes;if(-1===e.indexOf(t)){var i,s,n;for(i=0,s=e.length;i<s;i++)if((n=e[i]).is_family&&-1!==n.members.indexOf(t))return;e.push(t)}}},s.prototype.ClearObstacles=function(){this.type.obstacleTypes.length=0},s.prototype.PushOutNearest=function(t){this.pushOutNearest(this.getCandidates(),t)},s.prototype.PushOutAngle=function(t,e){t=cr.to_radians(t);var i=Math.cos(t),s=Math.sin(t);this.pushOut(this.getCandidates(),i,s,e)},s.prototype.PushOutToPos=function(t,e){var i=t-this.inst.x,s=e-this.inst.y,n=Math.sqrt(i*i+s*s),r=Math.atan2(s,i),o=Math.cos(r),a=Math.sin(r);this.pushOut(this.getCandidates(),o,a,n)},t.exps=new function(){}}(),cr.behaviors.Sin=function(t){this.runtime=t},function(){var t=cr.behaviors.Sin.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,this.i=0};var e=t.Instance.prototype,i=2*Math.PI,s=Math.PI/2,n=3*Math.PI/2;function r(){}function o(){}function a(){}e.onCreate=function(){this.active=1===this.properties[0],this.movement=this.properties[1],this.wave=this.properties[2],this.period=this.properties[3],this.period+=Math.random()*this.properties[4],0===this.period?this.i=0:(this.i=this.properties[5]/this.period*i,this.i+=Math.random()*this.properties[6]/this.period*i),this.mag=this.properties[7],this.mag+=Math.random()*this.properties[8],this.initialValue=0,this.initialValue2=0,this.ratio=0,5===this.movement&&(this.mag=cr.to_radians(this.mag)),this.init()},e.saveToJSON=function(){return{i:this.i,a:this.active,mv:this.movement,w:this.wave,p:this.period,mag:this.mag,iv:this.initialValue,iv2:this.initialValue2,r:this.ratio,lkv:this.lastKnownValue,lkv2:this.lastKnownValue2}},e.loadFromJSON=function(t){this.i=t.i,this.active=t.a,this.movement=t.mv,this.wave=t.w,this.period=t.p,this.mag=t.mag,this.initialValue=t.iv,this.initialValue2=t.iv2||0,this.ratio=t.r,this.lastKnownValue=t.lkv,this.lastKnownValue2=t.lkv2||0},e.init=function(){switch(this.movement){case 0:this.initialValue=this.inst.x;break;case 1:this.initialValue=this.inst.y;break;case 2:this.initialValue=this.inst.width,this.ratio=this.inst.height/this.inst.width;break;case 3:this.initialValue=this.inst.width;break;case 4:this.initialValue=this.inst.height;break;case 5:this.initialValue=this.inst.angle;break;case 6:this.initialValue=this.inst.opacity;break;case 7:this.initialValue=0;break;case 8:this.initialValue=this.inst.x,this.initialValue2=this.inst.y}this.lastKnownValue=this.initialValue,this.lastKnownValue2=this.initialValue2},e.waveFunc=function(t){switch(t%=i,this.wave){case 0:return Math.sin(t);case 1:return t<=s?t/s:t<=n?1-2*(t-s)/Math.PI:(t-n)/s-1;case 2:return 2*t/i-1;case 3:return-2*t/i+1;case 4:return t<Math.PI?-1:1}return 0},e.tick=function(){var t=this.runtime.getDt(this.inst);this.active&&0!==t&&(0===this.period?this.i=0:(this.i+=t/this.period*i,this.i=this.i%i),this.updateFromPhase())},e.updateFromPhase=function(){switch(this.movement){case 0:this.inst.x!==this.lastKnownValue&&(this.initialValue+=this.inst.x-this.lastKnownValue),this.inst.x=this.initialValue+this.waveFunc(this.i)*this.mag,this.lastKnownValue=this.inst.x;break;case 1:this.inst.y!==this.lastKnownValue&&(this.initialValue+=this.inst.y-this.lastKnownValue),this.inst.y=this.initialValue+this.waveFunc(this.i)*this.mag,this.lastKnownValue=this.inst.y;break;case 2:this.inst.width=this.initialValue+this.waveFunc(this.i)*this.mag,this.inst.height=this.inst.width*this.ratio;break;case 3:this.inst.width=this.initialValue+this.waveFunc(this.i)*this.mag;break;case 4:this.inst.height=this.initialValue+this.waveFunc(this.i)*this.mag;break;case 5:this.inst.angle!==this.lastKnownValue&&(this.initialValue=cr.clamp_angle(this.initialValue+(this.inst.angle-this.lastKnownValue))),this.inst.angle=cr.clamp_angle(this.initialValue+this.waveFunc(this.i)*this.mag),this.lastKnownValue=this.inst.angle;break;case 6:this.inst.opacity=this.initialValue+this.waveFunc(this.i)*this.mag/100,this.inst.opacity<0?this.inst.opacity=0:this.inst.opacity>1&&(this.inst.opacity=1);break;case 8:this.inst.x!==this.lastKnownValue&&(this.initialValue+=this.inst.x-this.lastKnownValue),this.inst.y!==this.lastKnownValue2&&(this.initialValue2+=this.inst.y-this.lastKnownValue2),this.inst.x=this.initialValue+Math.cos(this.inst.angle)*this.waveFunc(this.i)*this.mag,this.inst.y=this.initialValue2+Math.sin(this.inst.angle)*this.waveFunc(this.i)*this.mag,this.lastKnownValue=this.inst.x,this.lastKnownValue2=this.inst.y}this.inst.set_bbox_changed()},e.onSpriteFrameChanged=function(t,e){switch(this.movement){case 2:this.initialValue*=e.width/t.width,this.ratio=e.height/e.width;break;case 3:this.initialValue*=e.width/t.width;break;case 4:this.initialValue*=e.height/t.height}},r.prototype.IsActive=function(){return this.active},r.prototype.CompareMovement=function(t){return this.movement===t},r.prototype.ComparePeriod=function(t,e){return cr.do_cmp(this.period,t,e)},r.prototype.CompareMagnitude=function(t,e){return 5===this.movement?cr.do_cmp(this.mag,t,cr.to_radians(e)):cr.do_cmp(this.mag,t,e)},r.prototype.CompareWave=function(t){return this.wave===t},t.cnds=new r,o.prototype.SetActive=function(t){this.active=1===t},o.prototype.SetPeriod=function(t){this.period=t},o.prototype.SetMagnitude=function(t){this.mag=t,5===this.movement&&(this.mag=cr.to_radians(this.mag))},o.prototype.SetMovement=function(t){5===this.movement&&5!==t&&(this.mag=cr.to_degrees(this.mag)),this.movement=t,this.init()},o.prototype.SetWave=function(t){this.wave=t},o.prototype.SetPhase=function(t){this.i=t*i%i,this.updateFromPhase()},o.prototype.UpdateInitialState=function(){this.init()},t.acts=new o,a.prototype.CyclePosition=function(t){t.set_float(this.i/i)},a.prototype.Period=function(t){t.set_float(this.period)},a.prototype.Magnitude=function(t){5===this.movement?t.set_float(cr.to_degrees(this.mag)):t.set_float(this.mag)},a.prototype.Value=function(t){t.set_float(this.waveFunc(this.i)*this.mag)},t.exps=new a}(),cr.behaviors.SkymenPin=function(t){this.runtime=t},function(){var t=cr.behaviors.SkymenPin.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}function n(){}e.onCreate=function(){this.pinObject=null,this.pinObjectUid=-1,this.pinAngle=0,this.pinDist=0,this.myStartAngle=0,this.theirStartAngle=0,this.lastKnownAngle=0,this.mode=0,this.runOnTick=0==this.properties[0];var t=this;this.recycled||(this.myDestroyCallback=function(e){t.onInstanceDestroyed(e)}),this.runtime.addDestroyCallback(this.myDestroyCallback)},e.saveToJSON=function(){return{uid:this.pinObject?this.pinObject.uid:-1,pa:this.pinAngle,pd:this.pinDist,msa:this.myStartAngle,tsa:this.theirStartAngle,lka:this.lastKnownAngle,m:this.mode}},e.loadFromJSON=function(t){this.pinObjectUid=t.uid,this.pinAngle=t.pa,this.pinDist=t.pd,this.myStartAngle=t.msa,this.theirStartAngle=t.tsa,this.lastKnownAngle=t.lka,this.mode=t.m},e.afterLoad=function(){-1===this.pinObjectUid?this.pinObject=null:this.pinObject=this.runtime.getObjectByUID(this.pinObjectUid),this.pinObjectUid=-1},e.onInstanceDestroyed=function(t){this.pinObject==t&&(this.pinObject=null)},e.onDestroy=function(){this.pinObject=null,this.runtime.removeDestroyCallback(this.myDestroyCallback)},e.tick=function(){if(this.pinObject&&this.runOnTick){this.lastKnownAngle!==this.inst.angle&&(this.myStartAngle=cr.clamp_angle(this.myStartAngle+(this.inst.angle-this.lastKnownAngle)));var t=this.inst.x,e=this.inst.y;if(3===this.mode||4===this.mode){var i=cr.distanceTo(this.inst.x,this.inst.y,this.pinObject.x,this.pinObject.y);if(i>this.pinDist||4===this.mode&&i<this.pinDist){var s=cr.angleTo(this.pinObject.x,this.pinObject.y,this.inst.x,this.inst.y);t=this.pinObject.x+Math.cos(s)*this.pinDist,e=this.pinObject.y+Math.sin(s)*this.pinDist}}else t=this.pinObject.x+Math.cos(this.pinObject.angle+this.pinAngle)*this.pinDist,e=this.pinObject.y+Math.sin(this.pinObject.angle+this.pinAngle)*this.pinDist;var n=cr.clamp_angle(this.myStartAngle+(this.pinObject.angle-this.theirStartAngle));this.lastKnownAngle=n,0!==this.mode&&1!==this.mode&&3!==this.mode&&4!==this.mode||this.inst.x===t&&this.inst.y===e||(this.inst.x=t,this.inst.y=e,this.inst.set_bbox_changed()),0!==this.mode&&2!==this.mode||this.inst.angle===n||(this.inst.angle=n,this.inst.set_bbox_changed())}},e.tick2=function(){if(this.pinObject&&!this.runOnTick){this.lastKnownAngle!==this.inst.angle&&(this.myStartAngle=cr.clamp_angle(this.myStartAngle+(this.inst.angle-this.lastKnownAngle)));var t=this.inst.x,e=this.inst.y;if(3===this.mode||4===this.mode){var i=cr.distanceTo(this.inst.x,this.inst.y,this.pinObject.x,this.pinObject.y);if(i>this.pinDist||4===this.mode&&i<this.pinDist){var s=cr.angleTo(this.pinObject.x,this.pinObject.y,this.inst.x,this.inst.y);t=this.pinObject.x+Math.cos(s)*this.pinDist,e=this.pinObject.y+Math.sin(s)*this.pinDist}}else t=this.pinObject.x+Math.cos(this.pinObject.angle+this.pinAngle)*this.pinDist,e=this.pinObject.y+Math.sin(this.pinObject.angle+this.pinAngle)*this.pinDist;var n=cr.clamp_angle(this.myStartAngle+(this.pinObject.angle-this.theirStartAngle));this.lastKnownAngle=n,0!==this.mode&&1!==this.mode&&3!==this.mode&&4!==this.mode||this.inst.x===t&&this.inst.y===e||(this.inst.x=t,this.inst.y=e,this.inst.set_bbox_changed()),0!==this.mode&&2!==this.mode||this.inst.angle===n||(this.inst.angle=n,this.inst.set_bbox_changed())}},i.prototype.IsPinned=function(){return!!this.pinObject},t.cnds=new i,s.prototype.Pin=function(t,e){if(t){var i=t.getFirstPicked(this.inst);i&&(this.pinObject=i,this.pinAngle=cr.angleTo(i.x,i.y,this.inst.x,this.inst.y)-i.angle,this.pinDist=cr.distanceTo(i.x,i.y,this.inst.x,this.inst.y),this.myStartAngle=this.inst.angle,this.lastKnownAngle=this.inst.angle,this.theirStartAngle=i.angle,this.mode=e)}},s.prototype.Unpin=function(){this.pinObject=null},t.acts=new s,n.prototype.PinnedUID=function(t){t.set_int(this.pinObject?this.pinObject.uid:-1)},t.exps=new n}(),cr.behaviors.SkymenPolarCoordinates=function(t){this.runtime=t},function(){var t=cr.behaviors.SkymenPolarCoordinates.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}function n(){}e.onCreate=function(){this.Enabled=0==this.properties[4],this.Radius=this.properties[2],this.Angle=this.properties[3],this.OriginX=this.properties[0],this.OriginY=this.properties[1],this.ud=!1,this.Enabled&&this.update()},e.onDestroy=function(){},e.saveToJSON=function(){return{DX:this.Radius,DY:this.Angle,OX:this.OriginX,OY:this.OriginY,Enabled:this.Enabled}},e.loadFromJSON=function(t){this.Radius=t.DX,this.Angle=t.DY,this.OriginX=t.OX,this.OriginY=t.OY,this.Enabled=t.Enabled,this.update()},e.update=function(t=1){0===t&&(this.Radius=this.inst.x,this.Angle=this.inst.y),this.ud=!0},e.tick=function(){this.Angle>359&&(this.Angle=this.Angle%360),this.ud&&(this.inst.x=this.OriginX+Math.cos(this.Angle*Math.PI/180)*this.Radius,this.inst.y=this.OriginY+Math.sin(this.Angle*Math.PI/180)*this.Radius,this.inst.set_bbox_changed(),this.ud=!1)},e.tick2=function(){},i.prototype.IsEnabled=function(){return this.Enabled},i.prototype.CompareRadius=function(t,e){return cr.do_cmp(this.Radius,t,e)},i.prototype.CompareAngle=function(t,e){return cr.do_cmp(this.Angle,t,e)},i.prototype.CompareOriginX=function(t,e){return cr.do_cmp(this.OriginX,t,e)},i.prototype.CompareOriginY=function(t,e){return cr.do_cmp(this.OriginY,t,e)},t.cnds=new i,s.prototype.SetEnabled=function(t){0===t?(this.Enabled=!0,this.update()):this.Enabled=!1},s.prototype.SetRadius=function(t){this.Enabled&&(this.Radius=t,this.update())},s.prototype.SetAngle=function(t){this.Enabled&&(this.Angle=t,this.update())},s.prototype.SetDeltaPos=function(t,e){this.Enabled&&(this.Radius=t,this.Angle=e,this.update())},s.prototype.SetOriginX=function(t){this.Enabled&&(this.OriginX=t,this.update())},s.prototype.SetOriginY=function(t){this.Enabled&&(this.OriginY=t,this.update())},s.prototype.SetOriginPos=function(t,e){this.Enabled&&(this.OriginX=t,this.OriginY=e,this.update())},s.prototype.Update=function(t){this.update(t)},t.acts=new s,n.prototype.Radius=function(t){t.set_float(this.Radius)},n.prototype.Angle=function(t){t.set_float(this.Angle)},n.prototype.DeltaX=function(t){t.set_float(this.Radius)},n.prototype.DeltaY=function(t){t.set_float(this.Angle)},n.prototype.OriginX=function(t){t.set_float(this.OriginX)},n.prototype.OriginY=function(t){t.set_float(this.OriginY)},n.prototype.CarToPolRad=function(t,e,i,s,n){e-=s,i-=n;var r=Math.sqrt(Math.pow(e,2)+Math.pow(i,2));t.set_float(r)},n.prototype.CarToPolAngle=function(t,e,i,s,n){e-=s,i-=n;var r=180*Math.atan2(i,e)/Math.PI;t.set_float(r)},n.prototype.PolToCarX=function(t,e,i,s){var n=s+Math.cos(i*Math.PI/180)*e;n=Math.floor(1e3*n)/1e3;t.set_float(n)},n.prototype.PolToCarY=function(t,e,i,s){var n=s+Math.sin(i*Math.PI/180)*e;n=Math.floor(1e3*n)/1e3;t.set_float(n)},n.prototype.Status=function(t){this.Enabled?t.set_string("Enabled"):t.set_string("Disabled")},t.exps=new n}(),cr.behaviors.SkymenSkin=function(t){this.runtime=t},function(){var t=cr.behaviors.SkymenSkin.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}function n(){}e.onCreate=function(){this.skinBaseTag=this.properties[0],null==cr.SkymenSkinCore?alert("Skin base plugin needed, please create it."):null==cr.SkymenSkinCore[this.skinBaseTag]?alert("Skin base with tag "+this.skinBaseTag+" cannot be found."):(this.skinBase=cr.SkymenSkinCore[this.skinBaseTag],this.skinBase.addInstance(this)),this.skinTag=this.properties[1],this.subSkinTag=this.properties[2],this.oldSkinTag=this.properties[1],this.oldSubSkinTag=this.properties[2],this.syncWithAnim=0===this.properties[3]||2===this.properties[3],this.syncWithFrame=1===this.properties[3]||2===this.properties[3],this.default=0===this.properties[4],this.hideDefault=0===this.properties[5],this.imagePoint=this.properties[6],this.syncZOrder=0===this.properties[7],this.syncSize=1===this.properties[8],this.syncScale=2===this.properties[8],this.firstFrame=!0,this.widthRatio=1,this.heightRatio=1,this.lastLayout=this.runtime.running_layout,this.object=null,this.inst.behaviorSkins||(this.inst.behaviorSkins=[]);var t=!1;for(let e=0;e<this.inst.behaviorSkins.length;e++){this===this.inst.behaviorSkins[e]&&(t=!0,this.behaviorId=e)}t||(this.behaviorId=this.inst.behaviorSkins.length,this.inst.behaviorSkins.push(this)),this.skinBase.init&&this.updateSkin()},e.onDestroy=function(){this.destroy()},e.saveToJSON=function(){return{skinTag:this.skinTag,subSkinTag:this.subSkinTag,oldSkinTag:this.oldSkinTag,oldSubSkinTag:this.oldSubSkinTag,syncWithAnim:this.syncWithAnim,syncWithFrame:this.syncWithFrame,default:this.default,hideDefault:this.hideDefault,imagePoint:this.imagePoint,syncZOrder:this.syncZOrder,syncSize:this.syncSize,syncScale:this.syncScale,firstFrame:this.firstFrame,skinBaseTag:this.skinBaseTag,behaviorId:this.behaviorId}},e.loadFromJSON=function(t){this.skinTag=t.skinTag,this.subSkinTag=t.subSkinTag,this.oldSkinTag=t.oldSkinTag,this.oldSubSkinTag=t.oldSubSkinTag,this.syncWithAnim=t.syncWithAnim,this.syncWithFrame=t.syncWithFrame,this.default=t.default,this.hideDefault=t.hideDefault,this.imagePoint=t.imagePoint,this.syncZOrder=t.syncZOrder,this.firstFrame=t.firstFrame,this.skinBaseTag=t.skinBaseTag,this.behaviorId=t.behaviorId,this.syncSize=t.syncSize,this.syncScale=t.syncScale},e.tick=function(){this.firstFrame&&(this.syncWithAnim&&(this.subSkinTag=this.inst.cur_animation.name,this.oldsubSkinTag=this.inst.cur_animation.name),this.firstFrame=!1)},e.tick2=function(){if(null!=this.object){var t=this.inst.getImagePoint(this.imagePoint,!0),e=this.inst.getImagePoint(this.imagePoint,!1),i=this.inst.angle,s=this.inst.cur_animation.name;if(this.syncSize||this.syncScale)this.object.width!=this.inst.width*this.widthRatio&&(this.object.width=this.inst.width*this.widthRatio),this.object.height!=this.inst.height*this.heightRatio&&(this.object.height=this.inst.height*this.heightRatio);else{var n=this.inst.width<0,r=this.object.width<0,o=this.inst.height<0,a=this.object.height<0;n!=r&&(this.object.width=cr.abs(this.object.width)*(n?-1:1)),o!=a&&(this.object.height=cr.abs(this.object.height)*(o?-1:1))}var h=this.inst;if(0!=this.behaviorId){for(var c=this.behaviorId-1;c>=0&&null==this.inst.behaviorSkins[c].object;)c--;c>=0&&(h=this.inst.behaviorSkins[c].object)}this.syncZOrder&&this.object.get_zindex()!==h.get_zindex()+1&&this.setZorder(),this.object.x!=t&&(this.object.x=t),this.object.y!=e&&(this.object.y=e),this.object.angle!=i&&(this.object.angle=i),this.object.set_bbox_changed(),this.syncWithAnim&&this.subSkinTag!=s&&(this.subSkinTag=s),this.syncWithFrame&&this.inst.cur_frame!=this.object.cur_frame&&cr.plugins_.Sprite.prototype.acts.SetAnimFrame.call(this.object,this.inst.cur_frame),this.skinTag==this.oldSkinTag&&this.subSkinTag==this.oldSubSkinTag||(this.oldSkinTag=this.skinTag,this.oldSubSkinTag=this.subSkinTag,this.updateSkin())}},e.updateSkin=function(){if(this.default)return null!=this.object&&this.destroy(),void(this.hideDefault&&!this.inst.visible&&(this.inst.visible=!0,this.runtime.redraw=!0));if(this.hideDefault&&this.inst.visible&&(this.inst.visible=!1,this.runtime.redraw=!0),null==this.object){if(this.inst&&this.inst.cur_animation){var t=this.inst.cur_animation.name;this.syncWithAnim&&this.subSkinTag!=t&&(this.subSkinTag=t)}var e=this.getType(this.skinTag,this.subSkinTag);if(null==e)return console.warn("Cannot assign subskin "+this.subSkinTag+" of skin "+this.skinTag+" because it doesn't exist. Reverting back to default."),this.default=!0,void this.updateSkin();this.syncWithAnim&&(this.subSkinTag=this.inst.cur_animation.name),this.object=this.inst.runtime.createInstance(e,this.inst.layer);t=this.getAnim(this.skinTag,this.subSkinTag);if(cr.plugins_.Sprite.prototype.acts.SetAnim.call(this.object,t,0),this.syncWithFrame&&cr.plugins_.Sprite.prototype.acts.SetAnimSpeed.call(this.object,0),this.setZorder(),cr.plugins_.Sprite.prototype.acts.SetCollisions.call(this.object,0),this.syncScale){let t=this.object.type.animations.find(t=>t.name===this.object.type.default_instance[5][4]);t=t||this.object.type.animations[0],this.widthRatio=this.inst.width/Math.abs(this.inst.width)*this.object.type.default_instance[0][3]/t.frames[0].width*this.object.cur_animation.frames[0].width/this.inst.width,this.heightRatio=this.inst.height/Math.abs(this.inst.height)*this.object.type.default_instance[0][4]/t.frames[0].height*this.object.cur_animation.frames[0].height/this.inst.height}else this.syncSize&&(this.widthRatio=1,this.heightRatio=1,this.object.width=this.inst.width,this.object.height=this.inst.height)}else{if(this.object.type!=this.getType(this.skinTag,this.subSkinTag))return this.destroy(),void this.updateSkin();this.syncWithAnim&&(this.subSkinTag=this.inst.cur_animation.name),t=this.getAnim(this.skinTag,this.subSkinTag),cr.plugins_.Sprite.prototype.acts.SetAnim.call(this.object,t,0),this.syncWithFrame&&cr.plugins_.Sprite.prototype.acts.SetAnimSpeed.call(this.object,0),this.syncZOrder&&this.setZorder(),cr.plugins_.Sprite.prototype.acts.SetCollisions.call(this.object,0)}},e.destroy=function(){if(null!==this.object){if(this.object.behaviorSkins)for(var t=0;t<this.object.behaviorSkins.length;t++)this.object.behaviorSkins[t].destroy();this.runtime.DestroyInstance(this.object),this.object=null}},e.setZorder=function(){var t=this.inst;if(0!=this.behaviorId){for(var e=this.behaviorId-1;e>=0&&null==this.inst.behaviorSkins[e].object;)e--;e>=0&&(t=this.inst.behaviorSkins[e].object)}this.object.layer.index!==t.layer.index&&(this.object.layer.removeFromInstanceList(this.object,!0),this.object.layer=t.layer,t.layer.appendToInstanceList(this.object,!0)),this.object.layer.moveInstanceAdjacent(this.object,t,!0),this.runtime.redraw=!0},e.getType=function(t,e){return null==this.skinBase.skins[t]||null==this.skinBase.skins[t][e]?null:this.skinBase.skins[t][e].type},e.getAnim=function(t,e){return null==this.skinBase.skins[t]||null==this.skinBase.skins[t][e]?null:this.skinBase.skins[t][e].anim},i.prototype.IsDefault=function(){return this.default},i.prototype.IsSkin=function(t){return this.skinTag==t},i.prototype.IsSubSkin=function(t){return this.subSkinTag==t},i.prototype.IsDefaultHidden=function(){return this.hideDefault},t.cnds=new i,s.prototype.SetSkin=function(t){this.default&&(this.default=!1),this.skinTag=t,this.updateSkin()},s.prototype.SetSubSkin=function(t){this.subSkinTag=t,this.updateSkin()},s.prototype.Setup=function(t,e){this.default=!1,this.skinTag=t,this.subSkinTag=e,this.updateSkin()},s.prototype.UseDefault=function(){this.default=!0,this.updateSkin()},s.prototype.HideDefault=function(t){this.hideDefault=1===t,this.updateSkin()},s.prototype.SetImagePoint=function(t){this.imagePoint=t},s.prototype.SyncMode=function(t){this.syncWithAnim=0===t||2===t,this.syncWithFrame=1===t||2===t,this.syncWithAnim&&(this.subSkinTag=this.inst.cur_animation.name)},s.prototype.SyncZOrder=function(t){this.syncZOrder=0===t},s.prototype.UpdateZOrder=function(){this.object&&this.setZorder()},t.acts=new s,n.prototype.Skin=function(t){t.set_string(this.skinTag)},n.prototype.SubSkin=function(t){t.set_string(this.subSkinTag)},n.prototype.SkinBaseTag=function(t){t.set_string(this.skinBaseTag)},t.exps=new n}(),cr.behaviors.Timer=function(t){this.runtime=t},function(){var t=cr.behaviors.Timer.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}function n(){}e.onCreate=function(){this.timers={}},e.onDestroy=function(){cr.wipe(this.timers)},e.saveToJSON=function(){var t,e,i={};for(t in this.timers)this.timers.hasOwnProperty(t)&&(e=this.timers[t],i[t]={c:e.current.sum,t:e.total.sum,d:e.duration,r:e.regular});return i},e.loadFromJSON=function(t){var e;for(e in this.timers={},t)t.hasOwnProperty(e)&&(this.timers[e]={current:new cr.KahanAdder,total:new cr.KahanAdder,duration:t[e].d,regular:t[e].r},this.timers[e].current.sum=t[e].c,this.timers[e].total.sum=t[e].t)},e.tick=function(){var t,e,i=this.runtime.getDt(this.inst);for(t in this.timers)this.timers.hasOwnProperty(t)&&((e=this.timers[t]).current.add(i),e.total.add(i))},e.tick2=function(){var t,e;for(t in this.timers)this.timers.hasOwnProperty(t)&&(e=this.timers[t]).current.sum>=e.duration&&(e.regular?e.current.sum-=e.duration:delete this.timers[t])},i.prototype.OnTimer=function(t){t=t.toLowerCase();var e=this.timers[t];return!!e&&e.current.sum>=e.duration},t.cnds=new i,s.prototype.StartTimer=function(t,e,i){this.timers[i.toLowerCase()]={current:new cr.KahanAdder,total:new cr.KahanAdder,duration:t,regular:1===e}},s.prototype.StopTimer=function(t){t=t.toLowerCase(),this.timers.hasOwnProperty(t)&&delete this.timers[t]},t.acts=new s,n.prototype.CurrentTime=function(t,e){var i=this.timers[e.toLowerCase()];t.set_float(i?i.current.sum:0)},n.prototype.TotalTime=function(t,e){var i=this.timers[e.toLowerCase()];t.set_float(i?i.total.sum:0)},n.prototype.Duration=function(t,e){var i=this.timers[e.toLowerCase()];t.set_float(i?i.duration:0)},t.exps=new n}(),cr.behaviors.Turret=function(t){this.runtime=t},function(){var t=cr.behaviors.Turret.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){this.targetTypes=[]},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;e.onCreate=function(){this.range=this.properties[0],this.rateOfFire=this.properties[1],this.rotateEnabled=0!==this.properties[2],this.rotateSpeed=cr.to_radians(this.properties[3]),this.targetMode=this.properties[4],this.predictiveAim=0!==this.properties[5],this.projectileSpeed=this.properties[6],this.enabled=0!==this.properties[7],this.useCollisionCells=0!==this.properties[8],this.lastCheckTime=0,this.fireTimeCount=this.rateOfFire,this.currentTarget=null,this.loadTargetUid=-1,this.oldTargetX=0,this.oldTargetY=0,this.lastSpeeds=[0,0,0,0],this.speedsCount=0,this.firstTickWithTarget=!0;var t=this;this.recycled||(this.myDestroyCallback=function(e){t.onInstanceDestroyed(e)}),this.runtime.addDestroyCallback(this.myDestroyCallback)},e.saveToJSON=function(){var t,e,i={r:this.range,rof:this.rateOfFire,re:this.rotateEnabled,rs:this.rotateSpeed,tm:this.targetMode,pa:this.predictiveAim,ps:this.projectileSpeed,en:this.enabled,lct:this.lastCheckTime,ftc:this.fireTimeCount,target:this.currentTarget?this.currentTarget.uid:-1,ox:this.oldTargetX,oy:this.oldTargetY,ls:this.lastSpeeds,sc:this.speedsCount,targs:[]};for(t=0,e=this.type.targetTypes.length;t<e;t++)i.targs.push(this.type.targetTypes[t].sid);return i},e.loadFromJSON=function(t){var e,i,s;for(this.range=t.r,this.rateOfFire=t.rof,this.rotateEnabled=t.re,this.rotateSpeed=t.rs,this.targetMode=t.tm,this.predictiveAim=t.pa,this.projectileSpeed=t.ps,this.enabled=t.en,this.lastCheckTime=t.lct,this.fireTimeCount=t.ftc||0,this.loadTargetUid=t.target,this.oldTargetX=t.ox,this.oldTargetY=t.oy,this.lastSpeeds=t.ls,this.speedsCount=t.sc,cr.clearArray(this.type.targetTypes),e=0,i=t.targs.length;e<i;e++)(s=this.runtime.getObjectTypeBySid(t.targs[e]))&&this.type.targetTypes.push(s)},e.afterLoad=function(){-1===this.loadTargetUid?this.currentTarget=null:this.currentTarget=this.runtime.getObjectByUID(this.loadTargetUid)},e.onInstanceDestroyed=function(t){this.currentTarget==t&&(this.currentTarget=null)},e.onDestroy=function(){this.currentTarget=null,this.runtime.removeDestroyCallback(this.myDestroyCallback)},e.addSpeed=function(t){this.speedsCount<4?(this.lastSpeeds[this.speedsCount]=t,this.speedsCount++):(this.lastSpeeds.shift(),this.lastSpeeds.push(t))},e.getSpeed=function(){for(var t=0,e=0;e<this.speedsCount;e++)t+=this.lastSpeeds[e];return t/this.speedsCount},e.isInRange=function(t){var e=this.inst,i=t.x-e.x,s=t.y-e.y;return i*i+s*s<=this.range*this.range};var i=new cr.rect(0,0,0,0),s=[];function n(){}function r(){}function o(){}e.lookForFirstTarget=function(){var t,e,n;if(i.left=this.inst.x-this.range,i.top=this.inst.y-this.range,i.right=this.inst.x+this.range,i.bottom=this.inst.y+this.range,this.useCollisionCells)this.runtime.getTypesCollisionCandidates(null,this.type.targetTypes,i,s);else for(t=0,e=this.type.targetTypes.length;t<e;++t)cr.appendArray(s,this.type.targetTypes[t].instances);for(t=0,e=s.length;t<e;++t)if(n=s[t],this.isInRange(n))return this.currentTarget=n,void cr.clearArray(s);cr.clearArray(s)},e.lookForNearestTarget=function(){var t,e,n,r,o,a,h=this.inst.x,c=this.inst.y,l=this.range*this.range;if(this.currentTarget=null,i.left=h-this.range,i.top=c-this.range,i.right=h+this.range,i.bottom=c+this.range,this.useCollisionCells)this.runtime.getTypesCollisionCandidates(null,this.type.targetTypes,i,s);else for(t=0,e=this.type.targetTypes.length;t<e;++t)cr.appendArray(s,this.type.targetTypes[t].instances);for(t=0,e=s.length;t<e;++t)(r=(o=h-(n=s[t]).x)*o+(a=c-n.y)*a)<l&&(this.currentTarget=n,l=r);s.length=0},e.tick=function(){var t=this.runtime.getDt(this.inst),e=this.runtime.kahanTime.sum,i=this.inst;if(this.enabled){if(this.currentTarget&&!this.isInRange(this.currentTarget)&&(this.currentTarget=null,this.speedsCount=0,this.firstTickWithTarget=!0),e>=this.lastCheckTime+.1)if(this.lastCheckTime=e,0!==this.targetMode||this.currentTarget){if(1===this.targetMode){var s=this.currentTarget;this.lookForNearestTarget(),this.currentTarget&&this.currentTarget!==s&&(this.speedsCount=0,this.firstTickWithTarget=!0,this.oldTargetX=this.currentTarget.x,this.oldTargetY=this.currentTarget.y,this.runtime.trigger(cr.behaviors.Turret.prototype.cnds.OnTargetAcquired,this.inst))}}else this.lookForFirstTarget(),this.currentTarget&&(this.speedsCount=0,this.firstTickWithTarget=!0,this.oldTargetX=this.currentTarget.x,this.oldTargetY=this.currentTarget.y,this.runtime.trigger(cr.behaviors.Turret.prototype.cnds.OnTargetAcquired,this.inst));if(this.fireTimeCount+=t,this.currentTarget){var n=cr.angleTo(i.x,i.y,this.currentTarget.x,this.currentTarget.y);if(this.predictiveAim){var r=i.x,o=i.y,a=this.currentTarget.x,h=this.currentTarget.y,c=cr.angleTo(a,h,this.oldTargetX,this.oldTargetY);this.firstTickWithTarget||this.addSpeed(cr.distanceTo(a,h,this.oldTargetX,this.oldTargetY)/t);var l=this.getSpeed(),u=h-o,p=a-r,d=(l*Math.sin(c)*(r-a)-l*Math.cos(c)*(o-h))/this.projectileSpeed,f=Math.asin(d/Math.sqrt(u*u+p*p))-Math.atan2(u,-p)+Math.PI;isNaN(f)||(n=f)}this.rotateEnabled&&(i.angle=cr.angleRotate(i.angle,n,this.rotateSpeed*t),i.set_bbox_changed()),this.fireTimeCount>=this.rateOfFire&&(!this.rotateEnabled||cr.to_degrees(cr.angleDiff(i.angle,n))<=.1)&&(!this.predictiveAim||this.speedsCount>=4)&&(this.fireTimeCount-=this.rateOfFire,this.fireTimeCount>=this.rateOfFire&&(this.fireTimeCount=0),this.runtime.trigger(cr.behaviors.Turret.prototype.cnds.OnShoot,this.inst)),this.currentTarget&&(this.oldTargetX=this.currentTarget.x,this.oldTargetY=this.currentTarget.y),this.firstTickWithTarget=!1}this.fireTimeCount>this.rateOfFire&&(this.fireTimeCount=this.rateOfFire)}},n.prototype.HasTarget=function(){return!!this.currentTarget},n.prototype.OnShoot=function(){return!0},n.prototype.OnTargetAcquired=function(){return!0},t.cnds=new n,r.prototype.AcquireTarget=function(t){if(t){var e,i,s,n=t.getCurrentSol().getObjects();for(e=0,i=n.length;e<i;++e)if(s=n[e],this.currentTarget!==s&&this.isInRange(s)){this.currentTarget=s,this.speedsCount=0,this.firstTickWithTarget=!0,this.oldTargetX=this.currentTarget.x,this.oldTargetY=this.currentTarget.y,this.runtime.trigger(cr.behaviors.Turret.prototype.cnds.OnTargetAcquired,this.inst);break}}},r.prototype.AddTarget=function(t){var e=this.type.targetTypes;if(-1===e.indexOf(t)){var i,s,n;for(i=0,s=e.length;i<s;i++)if((n=e[i]).is_family&&-1!==n.members.indexOf(t))return;e.push(t)}},r.prototype.ClearTargets=function(){cr.clearArray(this.type.targetTypes)},r.prototype.UnacquireTarget=function(){this.currentTarget=null,this.speedsCount=0,this.firstTickWithTarget=!0},r.prototype.SetEnabled=function(t){this.enabled=0!==t},r.prototype.SetRange=function(t){this.range=t},r.prototype.SetRateOfFire=function(t){this.rateOfFire=t},r.prototype.SetRotate=function(t){this.rotateEnabled=0!==t},r.prototype.SetRotateSpeed=function(t){this.rotateSpeed=cr.to_radians(t)},r.prototype.SetTargetMode=function(t){this.targetMode=t},r.prototype.SetPredictiveAim=function(t){this.predictiveAim=0!==t},r.prototype.SetProjectileSpeed=function(t){this.projectileSpeed=t},t.acts=new r,o.prototype.TargetUID=function(t){t.set_int(this.currentTarget?this.currentTarget.uid:0)},o.prototype.Range=function(t){t.set_float(this.range)},o.prototype.RateOfFire=function(t){t.set_float(this.rateOfFire)},o.prototype.RotateSpeed=function(t){t.set_float(cr.to_degrees(this.rotateSpeed))},t.exps=new o}(),cr.behaviors.aekiro_bind=function(t){this.runtime=t},function(){var t=cr.behaviors.aekiro_bind.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){if(this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,!cr.proui)throw new Error("ProUI Plugin not found. Please add it to the project.")};var e=t.Instance.prototype;function i(){}function s(){}e.onCreate=function(){this.proui=cr.proui,this.isInstanceOfText=!!cr.plugins_.Text&&this.inst.type.plugin instanceof cr.plugins_.Text,this.isInstanceOfSpriteFont=!!cr.plugins_.Spritefont2&&this.inst.type.plugin instanceof cr.plugins_.Spritefont2,this.isInstanceOfSpriteFontPlus=!!cr.plugins_.SkymenSFPlusPLus&&this.inst.type.plugin instanceof cr.plugins_.SkymenSFPlusPLus,this.isInstanceOfSprite=!!cr.plugins_.Sprite&&this.inst.type.plugin instanceof cr.plugins_.Sprite,this.isInstanceOfPaster=!!cr.plugins_.rojoPaster&&this.inst.type.plugin instanceof cr.plugins_.rojoPaster,this.bind_key=this.properties[0],this.bind_property=this.properties[1],this.firstFrame=!0,this.inst.proui_bind=this,this.index=-1,this.deepKey="",this.model=null},e.updateGridViewModel=function(t,e){this.model&&this.deepKey&&(console.log(this.deepKey+"***"+t),cr.plugins_.aekiro_model.prototype.acts.SetValueByKeyString.call(this.model,this.deepKey,t,e))},e.setValue=function(t){if(this.bind_key)if(0==this.bind_property&&this.inst._proui&&this.inst._proui._setValue)this.inst._proui._setValue(t);else if(1==this.bind_property&&(this.isInstanceOfText||this.isInstanceOfSpriteFont||this.isInstanceOfSpriteFontPlus))this.inst.type.plugin.acts.SetText.call(this.inst,t);else if(2==this.bind_property&&this.isInstanceOfSprite){var e=0;isNaN(t)||(e=parseInt(t)),this.inst.type.plugin.acts.SetAnimFrame.apply(this.inst,[e])}else if(3==this.bind_property&&this.isInstanceOfSprite){var i=String(t);this.inst.type.plugin.acts.SetAnim.apply(this.inst,[i])}else 4==this.bind_property&&(this.isInstanceOfSprite||this.isInstanceOfPaster)&&this.inst.type.plugin.acts.LoadImage.call(this.inst,t,1)},e.tick=function(){},e.onDestroy=function(){},e.saveToJSON=function(){return{bind_key:this.bind_key,bind_property:this.bind_property}},e.loadFromJSON=function(t){this.bind_key=t.bind_key,this.bind_property=t.bind_property},i.prototype.IsIndex=function(t){return t==this.index},t.cnds=new i,t.acts=new function(){},s.prototype.index=function(t){t.set_int(this.index)},t.exps=new s}(),cr.behaviors.aekiro_button=function(t){this.runtime=t},function(){var t=cr.behaviors.aekiro_button.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){if(this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,!cr.proui)throw new Error("ProUI Plugin not found. Please add it to the project.");this.behavior.isHooked||(cr.proui.HookMe(this.behavior,["touch"]),this.behavior.isHooked=!0)};var e=t.Instance.prototype;function i(){}function s(){}e.onCreate=function(){this.proui=cr.proui,this.proui.isTypeValid(this.inst,[cr.plugins_.Sprite,cr.plugins_.NinePatch,cr.plugins_.TiledBg],"Pro UI: Button behavior is only applicable to Sprite, 9-patch or tiled backgrounds objects."),this.isInstanceOfSprite=!!cr.plugins_.Sprite&&this.inst.type.plugin instanceof cr.plugins_.Sprite,this.isEnabled=this.properties[0],this.frame_hover=isNaN(parseInt(this.properties[1]))?-1:parseInt(this.properties[1]),this.frame_clicked=isNaN(parseInt(this.properties[2]))?-1:parseInt(this.properties[2]),this.frame_disabled=isNaN(parseInt(this.properties[3]))?-1:parseInt(this.properties[3]),this.clickSound=this.properties[4],this.clickAnimation=this.properties[5],this.hoverSound=this.properties[6],this.hoverAnimation=this.properties[7],this.callbackName=this.properties[8],this.callbackParams=this.properties[9],this.firstFrame=!0,this.uiType="button",this.inst.uiType="button",this.inst._proui=this,this.state=0,this.onTouchStarted=!1,this.onMouseEnterFlag=!1,this.callbacks=[],this.onCreateInit()},e.onCreateInit=function(){this.setClickAnimations(),this.setHoverAnimations(),this.useStates=!0,this.frame_hover<0&&this.frame_clicked<0&&this.frame_disabled<0&&(this.useStates=!1)},e.setClickAnimations=function(){this.tween=new TWEEN.Tween(this.inst),1==this.clickAnimation?this.tween.easing(TWEEN.Easing.Quadratic.Out).to({width:1.2*this.inst.width,height:1.2*this.inst.height},200):2==this.clickAnimation?this.tween.easing(TWEEN.Easing.Elastic.Out).to({width:1.2*this.inst.width,height:1.2*this.inst.height},500):3==this.clickAnimation?this.tween.easing(TWEEN.Easing.Quadratic.Out).to({y:this.inst.y+this.inst.height/10},100):4==this.clickAnimation?this.tween.easing(TWEEN.Easing.Quadratic.Out).to({y:this.inst.y-this.inst.height/10},100):5==this.clickAnimation?this.tween.easing(TWEEN.Easing.Quadratic.Out).to({x:this.inst.x-this.inst.width/10},100):6==this.clickAnimation&&this.tween.easing(TWEEN.Easing.Quadratic.Out).to({x:this.inst.x+this.inst.width/10},100)},e.setHoverAnimations=function(){this.tween_hover=new TWEEN.Tween(this.inst),1==this.hoverAnimation?this.tween_hover.easing(TWEEN.Easing.Quadratic.Out).to({width:1.1*this.inst.width,height:1.1*this.inst.height},200):2==this.hoverAnimation?this.tween_hover.easing(TWEEN.Easing.Elastic.Out).to({width:1.1*this.inst.width,height:1.1*this.inst.height},500):3==this.hoverAnimation?this.tween_hover.easing(TWEEN.Easing.Quadratic.Out).to({y:this.inst.y+this.inst.height/10},100):4==this.hoverAnimation?this.tween_hover.easing(TWEEN.Easing.Quadratic.Out).to({y:this.inst.y-this.inst.height/10},100):5==this.hoverAnimation?this.tween_hover.easing(TWEEN.Easing.Quadratic.Out).to({x:this.inst.x-this.inst.width/13},100):6==this.hoverAnimation&&this.tween_hover.easing(TWEEN.Easing.Quadratic.Out).to({x:this.inst.x+this.inst.width/13},100)},e.updateView=function(){this.useStates&&this.isInstanceOfSprite&&(this.isEnabled?2==this.state&&this.frame_clicked>=0?cr.plugins_.Sprite.prototype.acts.SetAnimFrame.call(this.inst,this.frame_clicked):1==this.state&&this.frame_hover>=0?cr.plugins_.Sprite.prototype.acts.SetAnimFrame.call(this.inst,this.frame_hover):0==this.state&&this.frame_normal>=0&&cr.plugins_.Sprite.prototype.acts.SetAnimFrame.call(this.inst,this.frame_normal):this.frame_disabled>=0?cr.plugins_.Sprite.prototype.acts.SetAnimFrame.call(this.inst,this.frame_disabled):this.isInsideScrollView||cr.plugins_.Sprite.prototype.acts.SetAnimFrame.call(this.inst,this.frame_normal))},e.OnTouchStart=function(){if(this.isClickable()&&this.isInsideScrollView()&&!this.onTouchStarted){var t=this.proui.scrollViews["l"+this.inst.layer.index];t&&Math.sqrt(Math.pow(t.scroll.dx,2)+Math.pow(t.scroll.dy,2))>5||(this.onTouchStarted=!0,2!=this.state&&this.clickAnimation>0&&this.tween.start(),this.state=2,this.updateView(),this.clickSound&&this.proui.playAudio(this.clickSound))}},e.OnAnyTouchEnd=function(t,e){this.onTouchStarted&&this.OnTouchEnd(t,e),this.onTouchStarted=!1},e.OnTouchEnd=function(t,e){if(this.inst.update_bbox(),this.inst.contains_pt(t,e)){this.runtime.isMobile?this.state=0:this.state=1,this.updateView(),this.proui.runCallback(this.callbackName,this.callbackParams);for(var i=0,s=this.callbacks.length;i<s;i++)this.callbacks[i]();this.runtime.trigger(cr.behaviors.aekiro_button.prototype.cnds.OnClicked,this.inst)}else this.state=0,this.updateView();this.clickAnimation>0&&this.tween.reverse()},e.isMouseOver=function(){if(this.onTouchStarted){var t=this.proui.scrollViews["l"+this.inst.layer.index];t&&Math.sqrt(Math.pow(t.scroll.dx,2)+Math.pow(t.scroll.dy,2))>5&&(this.onTouchStarted=!1,this.state=0,this.updateView(),this.clickAnimation>0&&this.tween.reverse())}var e=this.proui.CursorX(this.inst.layer.index),i=this.proui.CursorY(this.inst.layer.index);return this.inst.update_bbox(),this.inst.contains_pt(e,i)},e.OnMouseEnter=function(){this.isClickable()&&(this.state=1,this.updateView(),this.hoverAnimation>0&&this.tween_hover.start(),this.hoverSound&&this.proui.playAudio(this.hoverSound),this.runtime.trigger(cr.behaviors.aekiro_button.prototype.cnds.OnMouseEnter,this.inst))},e.OnMouseLeave=function(){this.state=0,this.updateView(),this.hoverAnimation>0&&this.tween_hover.reverse(),this.runtime.trigger(cr.behaviors.aekiro_button.prototype.cnds.OnMouseLeave,this.inst)},e.isInTouch=function(){var t=this.proui.X(this.inst.layer.index),e=this.proui.Y(this.inst.layer.index);return this.inst.update_bbox(),this.inst.contains_pt(t,e)},e.setEnabled=function(t){this.isEnabled=t,this.updateView()},e.isInsideScrollView=function(){var t,e,i=!0,s=this.proui.scrollViews["l"+this.inst.layer.index];s&&(this.runtime.isMobile?(t=this.proui.X(this.inst.layer.index),e=this.proui.Y(this.inst.layer.index)):(t=this.proui.CursorX(this.inst.layer.index),e=this.proui.CursorY(this.inst.layer.index)),s.inst.update_bbox(),i=s.inst.contains_pt(t,e));return i},e.isClickable=function(){for(var t=this.inst.layer.visible&&this.inst.visible,e=!1,i=0,s=this.proui.currentDialogs.length;i<s;i++)if(this.inst.layer.index<this.proui.currentDialogs[i].inst.layer.index){e=!0;break}return t&&this.isEnabled&&!e},e.tick=function(){var t;this.firstFrame&&(this.firstFrame=!1,this.useStates&&(this.inst.cur_anim_speed=0),this.frame_normal=this.inst.cur_frame,this.updateView(),this.lastY=this.proui.CursorY(this.inst.layer.index),this.lastX=this.proui.CursorX(this.inst.layer.index)),this.tween.isPlaying&&(t=1e3*this.runtime.getDt(this.inst),this.tween.update(t),this.inst.set_bbox_changed()),this.tween_hover.isPlaying&&(t=1e3*this.runtime.getDt(this.inst),this.tween_hover.update(t),this.inst.set_bbox_changed()),this.isClickable()&&(this.isMouseOver()&&this.isInsideScrollView()?!this.onMouseEnterFlag&&(Math.abs(this.lastY-this.proui.CursorY(this.inst.layer.index))>10||Math.abs(this.lastX-this.proui.CursorX(this.inst.layer.index))>10)&&(this.onMouseEnterFlag=!0,this.OnMouseEnter(),this.lastY=this.proui.CursorY(this.inst.layer.index),this.lastX=this.proui.CursorX(this.inst.layer.index)):this.onMouseEnterFlag&&(!this.isInsideScrollView()||Math.abs(this.lastY-this.proui.CursorY(this.inst.layer.index))>10||Math.abs(this.lastX-this.proui.CursorX(this.inst.layer.index))>10)&&(this.onMouseEnterFlag=!1,this.OnMouseLeave(),this.lastY=this.proui.CursorY(this.inst.layer.index),this.lastX=this.proui.CursorX(this.inst.layer.index)))},e.onDestroy=function(){},e.saveToJSON=function(){return{isEnabled:this.isEnabled,clickSound:this.clickSound,clickAnimation:this.clickAnimation,hoverSound:this.hoverSound,hoverAnimation:this.hoverAnimation,callbackName:this.callbackName,callbackParams:this.callbackParams,frame_hover:this.frame_hover,frame_clicked:this.frame_clicked,frame_disabled:this.frame_disabled}},e.loadFromJSON=function(t){this.isEnabled=t.isEnabled,this.clickSound=t.clickSound,this.clickAnimation=t.clickAnimation,this.hoverSound=t.hoverSound,this.hoverAnimation=t.hoverAnimation,this.callbackName=t.callbackName,this.callbackParams=t.callbackParams,this.frame_hover=t.frame_hover,this.frame_clicked=t.frame_clicked,this.frame_disabled=t.frame_disabled,this.onCreateInit()},i.prototype.OnMouseEnter=function(){return!0},i.prototype.OnMouseLeave=function(){return!0},i.prototype.OnClicked=function(){return!0},i.prototype.IsEnabled=function(){return this.isEnabled},t.cnds=new i,s.prototype.setEnabled=function(t){this.setEnabled(t)},t.acts=new s,t.exps=new function(){}}(),cr.behaviors.aekiro_checkbox=function(t){this.runtime=t},function(){var t=cr.behaviors.aekiro_checkbox.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){if(this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,!cr.proui)throw new Error("ProUI Plugin not found. Please add it to the project.");this.behavior.isHooked||(cr.proui.HookMe(this.behavior,["touch"]),this.behavior.isHooked=!0)};var e=t.Instance.prototype;function i(){}function s(){}function n(){}e.onCreate=function(){this.proui=cr.proui,this.proui.isTypeValid(this.inst,[cr.plugins_.Sprite],"Pro UI: Checkbox behavior is only applicable to Sprite objects."),this.isEnabled=this.properties[0],this.value=this.properties[1],this.frames_normal=this.properties[2],this.frames_hover=this.properties[3],this.frames_disabled=this.properties[4],this.clickSound=this.properties[5],this.clickAnimation=this.properties[6],this.hoverSound=this.properties[7],this.hoverAnimation=this.properties[8],this.callbackName=this.properties[9],this.callbackParams=this.properties[10],this.firstFrame=!0,this.uiType="checkbox",this.inst.uiType="checkbox",this.inst._proui=this,this.firstSetValue=!1,this.state=0,this.onTouchStarted=!1,this.onMouseEnterFlag=!1,this.compParent=this,this.onCreateInit()},e.onCreateInit=function(){this.setFrames(),this.setClickAnimations(),this.setHoverAnimations()},e.setFrames=function(){var t=this.frames_normal.split(",");this.frame_normal_uncheck=isNaN(parseInt(t[0]))?-1:parseInt(t[0]),this.frame_normal_check=isNaN(parseInt(t[1]))?-1:parseInt(t[1]);var e=this.frames_hover.split(",");this.frame_hover_uncheck=isNaN(parseInt(e[0]))?-1:parseInt(e[0]),this.frame_hover_check=isNaN(parseInt(e[1]))?-1:parseInt(e[1]);var i=this.frames_disabled.split(",");this.frame_disabled_uncheck=isNaN(parseInt(i[0]))?-1:parseInt(i[0]),this.frame_disabled_check=isNaN(parseInt(i[1]))?-1:parseInt(i[1])},e.setClickAnimations=function(){this.tween=new TWEEN.Tween(this.inst),1==this.clickAnimation?this.tween.easing(TWEEN.Easing.Quadratic.Out).to({width:1.2*this.inst.width,height:1.2*this.inst.height},200):2==this.clickAnimation?this.tween.easing(TWEEN.Easing.Elastic.Out).to({width:1.2*this.inst.width,height:1.2*this.inst.height},500):3==this.clickAnimation?this.tween.easing(TWEEN.Easing.Quadratic.Out).to({y:this.inst.y+this.inst.height/10},100):4==this.clickAnimation?this.tween.easing(TWEEN.Easing.Quadratic.Out).to({y:this.inst.y-this.inst.height/10},100):5==this.clickAnimation?this.tween.easing(TWEEN.Easing.Quadratic.Out).to({x:this.inst.x-this.inst.width/10},100):6==this.clickAnimation&&this.tween.easing(TWEEN.Easing.Quadratic.Out).to({x:this.inst.x+this.inst.width/10},100)},e.setHoverAnimations=function(){this.tween_hover=new TWEEN.Tween(this.inst),1==this.hoverAnimation?this.tween_hover.easing(TWEEN.Easing.Quadratic.Out).to({width:1.1*this.inst.width,height:1.1*this.inst.height},200):2==this.hoverAnimation?this.tween_hover.easing(TWEEN.Easing.Elastic.Out).to({width:1.1*this.inst.width,height:1.1*this.inst.height},500):3==this.hoverAnimation?this.tween_hover.easing(TWEEN.Easing.Quadratic.Out).to({y:this.inst.y+this.inst.height/10},100):4==this.hoverAnimation?this.tween_hover.easing(TWEEN.Easing.Quadratic.Out).to({y:this.inst.y-this.inst.height/10},100):5==this.hoverAnimation?this.tween_hover.easing(TWEEN.Easing.Quadratic.Out).to({x:this.inst.x-this.inst.width/13},100):6==this.hoverAnimation&&this.tween_hover.easing(TWEEN.Easing.Quadratic.Out).to({x:this.inst.x+this.inst.width/13},100)},e.setValue=function(t){if(this.firstSetValue=!0,this._setValue(t)){var e=this.inst.proui_model;e&&e.setModelValue(t,{except:this.compParent}),this.inst.proui_bind&&this.inst.proui_bind.updateGridViewModel(t,{except:this.compParent})}},e._setValue=function(t){return null!=t&&(t=this.proui.validateSimpleValue(t,0),t=cr.clamp(t,0,1),this.value!=t&&(this.value=t,this.updateView(),!0))},e.updateFromModel=function(){var t=this.inst.proui_model;if(t){var e=t.getFromModel();if(null==e)return;e=this.proui.validateSimpleValue(e,0),e=cr.clamp(e,0,1),this.value!=e&&(this.value=e)}},e.updateView=function(){this.value?(cr.plugins_.Sprite.prototype.acts.SetAnimFrame.apply(this.inst,[this.frame_normal_check]),this.isEnabled?1==this.state&&this.frame_hover_check>=0&&cr.plugins_.Sprite.prototype.acts.SetAnimFrame.apply(this.inst,[this.frame_hover_check]):this.frame_disabled_check>=0&&cr.plugins_.Sprite.prototype.acts.SetAnimFrame.apply(this.inst,[this.frame_disabled_check])):(cr.plugins_.Sprite.prototype.acts.SetAnimFrame.apply(this.inst,[this.frame_normal_uncheck]),this.isEnabled?1==this.state&&this.frame_hover_uncheck>=0&&cr.plugins_.Sprite.prototype.acts.SetAnimFrame.apply(this.inst,[this.frame_hover_uncheck]):this.frame_disabled_uncheck>=0&&cr.plugins_.Sprite.prototype.acts.SetAnimFrame.apply(this.inst,[this.frame_disabled_uncheck]))},e.setEnabled=function(t){this.isEnabled=t,this.updateView()},e.OnTouchStart=function(){if(this.isClickable()&&this.isInsideScrollView()&&!this.onTouchStarted){var t=this.proui.scrollViews["l"+this.inst.layer.index];t&&Math.sqrt(Math.pow(t.scroll.dx,2)+Math.pow(t.scroll.dy,2))>5||(this.onTouchStarted=!0,2!=this.state&&this.clickAnimation>0&&this.tween.start(),this.state=2,this.clickSound&&this.proui.playAudio(this.clickSound))}},e.OnAnyTouchEnd=function(t,e){this.onTouchStarted&&this.OnTouchEnd(t,e),this.onTouchStarted=!1},e.OnTouchEnd=function(t,e){this.inst.update_bbox(),this.inst.contains_pt(t,e)?(this.runtime.isMobile?this.state=0:this.state=1,this.setValue(1-this.value),this.updateView(),this.proui.runCallback(this.callbackName,this.callbackParams),this.runtime.trigger(cr.behaviors.aekiro_checkbox.prototype.cnds.OnClicked,this.inst)):(this.state=0,this.updateView()),this.clickAnimation>0&&this.tween.reverse()},e.isMouseOver=function(){if(this.onTouchStarted){var t=this.proui.scrollViews["l"+this.inst.layer.index];t&&Math.sqrt(Math.pow(t.scroll.dx,2)+Math.pow(t.scroll.dy,2))>5&&(this.onTouchStarted=!1,this.state=0,this.updateView(),this.clickAnimation>0&&this.tween.reverse())}var e=this.proui.CursorX(this.inst.layer.index),i=this.proui.CursorY(this.inst.layer.index);return this.inst.update_bbox(),this.inst.contains_pt(e,i)},e.OnMouseEnter=function(){this.isClickable()&&(this.state=1,this.updateView(),this.hoverAnimation>0&&this.tween_hover.start(),this.hoverSound&&this.proui.playAudio(this.hoverSound),this.runtime.trigger(cr.behaviors.aekiro_checkbox.prototype.cnds.OnMouseEnter,this.inst))},e.OnMouseLeave=function(){this.state=0,this.updateView(),this.hoverAnimation>0&&this.tween_hover.reverse(),this.runtime.trigger(cr.behaviors.aekiro_checkbox.prototype.cnds.OnMouseLeave,this.inst)},e.isInTouch=function(){var t=this.proui.X(this.inst.layer.index),e=this.proui.Y(this.inst.layer.index);return this.inst.update_bbox(),this.inst.contains_pt(t,e)},e.isInsideScrollView=function(){var t,e,i=!0,s=this.proui.scrollViews["l"+this.inst.layer.index];s&&(this.runtime.isMobile?(t=this.proui.X(this.inst.layer.index),e=this.proui.Y(this.inst.layer.index)):(t=this.proui.CursorX(this.inst.layer.index),e=this.proui.CursorY(this.inst.layer.index)),s.inst.update_bbox(),i=s.inst.contains_pt(t,e));return i},e.isClickable=function(){for(var t=this.inst.layer.visible&&this.inst.visible,e=!1,i=0,s=this.proui.currentDialogs.length;i<s;i++)if(this.inst.layer.index<this.proui.currentDialogs[i].inst.layer.index){e=!0;break}return t&&this.isEnabled&&!e},e.tick=function(){var t;this.firstFrame&&(this.firstFrame=!1,this.inst.cur_anim_speed=0,this.firstSetValue||this.updateFromModel(),this.updateView(),this.lastY=this.proui.CursorY(this.inst.layer.index),this.lastX=this.proui.CursorX(this.inst.layer.index)),this.tween.isPlaying&&(t=1e3*this.runtime.getDt(this.inst),this.tween.update(t),this.inst.set_bbox_changed()),this.tween_hover.isPlaying&&(t=1e3*this.runtime.getDt(this.inst),this.tween_hover.update(t),this.inst.set_bbox_changed()),this.isClickable()&&(this.isMouseOver()&&this.isInsideScrollView()?!this.onMouseEnterFlag&&(Math.abs(this.lastY-this.proui.CursorY(this.inst.layer.index))>10||Math.abs(this.lastX-this.proui.CursorX(this.inst.layer.index))>10)&&(this.onMouseEnterFlag=!0,this.OnMouseEnter(),this.lastY=this.proui.CursorY(this.inst.layer.index),this.lastX=this.proui.CursorX(this.inst.layer.index)):this.onMouseEnterFlag&&(!this.isInsideScrollView()||Math.abs(this.lastY-this.proui.CursorY(this.inst.layer.index))>10||Math.abs(this.lastX-this.proui.CursorX(this.inst.layer.index))>10)&&(this.onMouseEnterFlag=!1,this.OnMouseLeave(),this.lastY=this.proui.CursorY(this.inst.layer.index),this.lastX=this.proui.CursorX(this.inst.layer.index)))},e.onDestroy=function(){},e.saveToJSON=function(){return{isEnabled:this.isEnabled,clickSound:this.clickSound,clickAnimation:this.clickAnimation,hoverSound:this.hoverSound,hoverAnimation:this.hoverAnimation,callbackName:this.callbackName,callbackParams:this.callbackParams,frames_normal:this.frames_normal,frames_hover:this.frames_hover,disabledFrames:this.frames_disabled,value:this.value}},e.loadFromJSON=function(t){this.isEnabled=t.isEnabled,this.clickSound=t.clickSound,this.clickAnimation=t.clickAnimation,this.hoverSound=t.hoverSound,this.hoverAnimation=t.hoverAnimation,this.callbackName=t.callbackName,this.callbackParams=t.callbackParams,this.frames_normal=t.frames_normal,this.frames_hover=t.frames_hover,this.frames_disabled=t.disabledFrames,this.value=t.value,this.onCreateInit()},i.prototype.OnMouseEnter=function(){return!0},i.prototype.OnMouseLeave=function(){return!0},i.prototype.IsEnabled=function(){return this.isEnabled},i.prototype.OnClicked=function(){return!0},i.prototype.IsChecked=function(){return this.value},t.cnds=new i,s.prototype.setEnabled=function(t){this.setEnabled(t)},s.prototype.setValue=function(t){this.setValue(t)},t.acts=new s,n.prototype.value=function(t){t.set_int(this.value)},t.exps=new n}(),cr.behaviors.aekiro_dialog=function(t){this.runtime=t},function(){var t=cr.behaviors.aekiro_dialog.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){if(this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,!cr.proui)throw new Error("ProUI Plugin not found. Please add it to the project.");this.tweenFunctions=[TWEEN.Easing.Linear.None,TWEEN.Easing.Quadratic.Out,TWEEN.Easing.Quartic.Out,TWEEN.Easing.Exponential.Out,TWEEN.Easing.Circular.Out,TWEEN.Easing.Back.Out,TWEEN.Easing.Elastic.Out,TWEEN.Easing.Bounce.Out]};var e=t.Instance.prototype;function i(){}function s(){}e.onCreate=function(){this.proui=cr.proui,this.proui.isTypeValid(this.inst,[cr.plugins_.Sprite,cr.plugins_.NinePatch,cr.plugins_.TiledBg],"Pro UI: dialog behavior is only applicable to Sprite, 9-patch or tiled backgrounds objects."),this.openAnimation=this.properties[0],this.openAnimTweenFunction=this.tweenFunctions[this.properties[1]],this.openSound=this.properties[2],this.openAnimDuration=this.properties[3],this.closeAnimation=this.properties[4],this.closeAnimTweenFunction=this.tweenFunctions[this.properties[5]],this.closeSound=this.properties[6],this.closeAnimDuration=this.properties[7],this.overlayUID=this.properties[8],this.pauseOnOpen=this.properties[9],this.closeButtonUID=this.properties[10],this.isModal=this.properties[11],this.isLayerContainer=this.properties[12],this.firstFrame=!0,this.inst.uiType="dialog",this.uiType="dialog",this.inst._proui=this,this.dpos={},this.isInit=!1,this.isOpen=!1,this.outLayerChildren={},this.tween=new TWEEN.Tween,this.tween.onReverseComplete(this.postClose,this),this.tween.onComplete(this.postOpen,this),this.tween_close=new TWEEN.Tween,this.tween_close.onComplete(this.postClose,this),this.tween_opacity=new TWEEN.Tween},e.setCloseButton=function(){if(this.closeButton=this.proui.tags[this.closeButtonUID],this.closeButton){if("button"!=this.closeButton.uiType)return void console.error("ProUI-Dialog uid=%s: the close button needs to have a button behavior !",this.inst.uid);var t=this;this.closeButton._proui.callbacks.push(function(){t.close()})}},e.setOverlay=function(){this.overlay=this.proui.tags[this.overlayUID],this.overlay&&(this.proui.isTypeValid(this.overlay,[cr.plugins_.Sprite,cr.plugins_.NinePatch,cr.plugins_.TiledBg],"ProUI-Dialog: The overlay of a dialog can only be a Sprite, 9-patch Or Tiled Background object."),this.overlay.uiType="overlay",this.tween_overlay=new TWEEN.Tween,this.tween_overlay.easing(TWEEN.Easing.Quartic.Out))},e.showOverlay=function(){this.overlay&&(this.overlay.my_timescale=1,this.overlay.type.plugin.acts.MoveToLayer.call(this.overlay,this.inst.layer),this.overlay.type.plugin.acts.MoveToBottom.call(this.overlay),this.overlay.width=this.inst.layer.viewRight-this.inst.layer.viewLeft,this.overlay.height=this.inst.layer.viewBottom-this.inst.layer.viewTop,this.overlay.set_bbox_changed(),this.overlay.update_bbox(),this.overlay.x=this.inst.layer.viewLeft+(this.overlay.x-this.overlay.bbox.left),this.overlay.y=this.inst.layer.viewTop+(this.overlay.y-this.overlay.bbox.top),this.overlay.set_bbox_changed(),this.overlay.visible=!0,this.overlay.opacity=0,this.tween_overlay.setObject(this.overlay),this.tween_overlay.to({opacity:.3},300),this.tween_overlay.start())},e.setDialogTimeScale=function(){for(var t=0,e=this.inst.layer.instances.length;t<e;t++)this.inst.layer.instances[t].my_timescale=1},e.setOutLayerChildrenVisible=function(t){var e,i=this;Object.keys(this.outLayerChildren).forEach(function(s){for(var n=0,r=(e=i.outLayerChildren[s]).length;n<r;n++)cr.system_object.prototype.acts.SetLayerVisible.call(i.runtime.system,e[n].layer,t)})},e.init=function(){this.isInit||(cr.system_object.prototype.acts.SetLayerVisible.call(this.runtime.system,this.inst.layer,!1),this.setOutLayerChildrenVisible(!1),this.dpos.prev_x=this.inst.x,this.dpos.prev_y=this.inst.y,this.dpos.dx=0,this.dpos.dy=0,this.inst.x=this.inst.layer.viewLeft-this.inst.width-100,this.inst.set_bbox_changed(),this.setOverlay(),this.setCloseButton(),this.isInit=!0)},e.tick=function(){var t;if(this.firstFrame&&(this.firstFrame=!1,this.init()),this.tween.isPlaying)if(t=1e3*this.runtime.getDt(this.inst),this.tween.update(t),5==this.openAnimation||6==this.openAnimation){var e=this;Object.keys(this.outLayerChildren).forEach(function(t){for(var s=0,n=(i=e.outLayerChildren[t]).length;s<n;s++)i[s].layer.scale=e.inst.layer.scale}),this.runtime.redraw=!0}else this.inst.set_bbox_changed();if(this.tween_close.isPlaying)if(t=1e3*this.runtime.getDt(this.inst),this.tween_close.update(t),6==this.closeAnimation||7==this.closeAnimation){e=this;Object.keys(this.outLayerChildren).forEach(function(t){for(var s=0,n=(i=e.outLayerChildren[t]).length;s<n;s++)i[s].layer.scale=e.inst.layer.scale}),this.runtime.redraw=!0}else this.inst.set_bbox_changed();if(this.tween_opacity.isPlaying){t=1e3*this.runtime.getDt(this.inst),this.tween_opacity.update(t);var i;e=this;Object.keys(this.outLayerChildren).forEach(function(t){for(var s=0,n=(i=e.outLayerChildren[t]).length;s<n;s++)i[s].layer.opacity=e.inst.layer.opacity}),this.runtime.redraw=!0}this.tween_overlay&&this.tween_overlay.isPlaying&&(t=1e3*this.runtime.getDt(this.inst),this.tween_overlay.update(t),this.runtime.redraw=!0)},e.updateChildren=function(){var t;if(this.isLayerContainer&&(isNaN(this.dpos.prev_x)&&(this.dpos.prev_x=this.inst.x,this.dpos.prev_y=this.inst.y),this.dpos.dx=this.inst.x-this.dpos.prev_x,this.dpos.dy=this.inst.y-this.dpos.prev_y,this.dpos.prev_x=this.inst.x,this.dpos.prev_y=this.inst.y,0!=this.dpos.dx||0!=this.dpos.dy)){for(var e=0,i=this.inst.layer.instances.length;e<i;e++)"dialog"!=(t=this.inst.layer.instances[e]).uiType&&"overlay"!=t.uiType&&!0!==t.isSubComp&&(t.x+=this.dpos.dx,t.y+=this.dpos.dy,t.set_bbox_changed(),"radiogroup"!=t.uiType&&"discreteProgress"!=t.uiType&&"sliderbar"!=t.uiType||t._proui.updateChildren());var s,n=this;Object.keys(this.outLayerChildren).forEach(function(e,i){for(var r=0,o=(s=n.outLayerChildren[e]).length;r<o;r++)(t=s[r]).x+=n.dpos.dx,t.y+=n.dpos.dy,t.set_bbox_changed()})}},e.tick2=function(){this.updateChildren()},e.setInitialPosition=function(t,e,i){var s,n;0==this.openAnimation||5==this.openAnimation||6==this.openAnimation?(s=t,n=e,i&&(n=(this.inst.layer.viewTop+this.inst.layer.viewBottom)/2,s=(this.inst.layer.viewLeft+this.inst.layer.viewRight)/2)):1==this.openAnimation?(n=this.inst.layer.viewTop-this.inst.height/2-100,s=i?(this.inst.layer.viewLeft+this.inst.layer.viewRight)/2:t):2==this.openAnimation?(n=this.inst.layer.viewBottom+this.inst.height/2+100,s=i?(this.inst.layer.viewLeft+this.inst.layer.viewRight)/2:t):3==this.openAnimation?(s=this.inst.layer.viewRight+this.inst.width/2+100,n=i?(this.inst.layer.viewTop+this.inst.layer.viewBottom)/2:e):4==this.openAnimation&&(s=this.inst.layer.viewLeft-this.inst.width/2-100,n=i?(this.inst.layer.viewTop+this.inst.layer.viewBottom)/2:e),this.inst.x=s,this.inst.y=n,this.inst.set_bbox_changed(),this.updateChildren()},e.open=function(t,e,i){if(this.init(),!this.isOpen&&!this.tween.isPlaying)if(this.proui.isModalDialogOpened())console.log("ProUI-Dialog: Can not open dialog because modal dialog is already opened");else{this.tween_close.isPlaying&&(this.tween_close.isPlaying=!1,this.postClose()),this.proui.addDialog(this),this.isOpen=!0,this.runtime.trigger(cr.behaviors.aekiro_dialog.prototype.cnds.onDialogOpened,this.inst),this.pauseOnOpen&&(this.prevTimescale=this.runtime.timescale,cr.system_object.prototype.acts.SetTimescale.call(this.runtime.system,0)),1!=this.runtime.timescale&&this.setDialogTimeScale(1),this.setInitialPosition(t,e,i),cr.system_object.prototype.acts.SetLayerVisible.call(this.runtime.system,this.inst.layer,!0);var s,n=this;Object.keys(this.outLayerChildren).forEach(function(t){for(var e=0,i=(s=n.outLayerChildren[t]).length;e<i;e++)cr.system_object.prototype.acts.SetLayerVisible.call(n.runtime.system,s[e].layer,!0)});var r=t,o=e;i&&(r=(this.inst.layer.viewLeft+this.inst.layer.viewRight)/2,o=(this.inst.layer.viewTop+this.inst.layer.viewBottom)/2),0==this.openAnimDuration&&(this.openAnimation=0),1==this.openAnimation||2==this.openAnimation?(this.tween.setObject(this.inst),this.tween.easing(this.openAnimTweenFunction),this.tween.to({y:o},this.openAnimDuration)):3==this.openAnimation||4==this.openAnimation?(this.tween.setObject(this.inst),this.tween.easing(this.openAnimTweenFunction),this.tween.to({x:r},this.openAnimDuration)):5!=this.openAnimation&&6!=this.openAnimation||(this.tween.setObject(this.inst.layer),this.tween.easing(this.openAnimTweenFunction),5==this.openAnimation?this.inst.layer.scale=2:this.inst.layer.scale=.2,this.inst.layer.opacity=0,this.runtime.redraw=!0,this.tween.to({scale:1},this.openAnimDuration),this.tween_opacity.setObject(this.inst.layer),this.tween_opacity.to({opacity:1},300),this.tween_opacity.easing(TWEEN.Easing.Quartic.Out)),this.openAnimation>0?(this.tween.start(),5!=this.openAnimation&&6!=this.openAnimation||this.tween_opacity.start()):(this.inst.x=r,this.inst.y=o,this.inst.set_bbox_changed(),this.updateChildren()),this.openSound&&this.proui.playAudio(this.openSound)}},e.postOpen=function(){this.showOverlay()},e.getCloseTargetPosition=function(){var t=this.inst.x,e=this.inst.y;return 2==this.closeAnimation?(e=this.inst.layer.viewBottom+this.inst.height/2+100,t=this.inst.x):3==this.closeAnimation?(e=this.inst.layer.viewTop-this.inst.height/2-100,t=this.inst.x):4==this.closeAnimation?(t=this.inst.layer.viewLeft-this.inst.width/2-100,e=this.inst.y):5==this.closeAnimation&&(t=this.inst.layer.viewRight+this.inst.width/2+100,e=this.inst.y),{x:t,y:e}},e.close=function(){if(this.isOpen&&!this.tween.isPlaying&&!this.tween_close.isPlaying){this.isOpen=!1,this.runtime.trigger(cr.behaviors.aekiro_dialog.prototype.cnds.onDialogClosed,this.inst),this.overlay&&(this.overlay.visible=!1),this.proui.removeDialog(this);var t=this.getCloseTargetPosition(),e=t.x,i=t.y;0==this.closeAnimDuration&&(this.closeAnimation=0),2==this.closeAnimation||3==this.closeAnimation?(this.tween_close.setObject(this.inst),this.tween_close.easing(this.closeAnimTweenFunction),this.tween_close.to({y:i},this.closeAnimDuration)):4==this.closeAnimation||5==this.closeAnimation?(this.tween_close.setObject(this.inst),this.tween_close.easing(this.closeAnimTweenFunction),this.tween_close.to({x:e},this.closeAnimDuration)):6!=this.closeAnimation&&7!=this.closeAnimation||(this.tween_close.setObject(this.inst.layer),this.tween_close.easing(this.closeAnimTweenFunction),6==this.closeAnimation?this.tween_close.to({scale:.2},this.closeAnimDuration):this.tween_close.to({scale:2},this.closeAnimDuration),this.tween_opacity.setObject(this.inst.layer),this.tween_opacity.to({opacity:0},300),this.tween_opacity.easing(TWEEN.Easing.Quartic.Out)),1==this.closeAnimation?(this.tween.reverse(),5!=this.openAnimation&&6!=this.openAnimation||this.tween_opacity.reverse()):0==this.closeAnimation?this.postClose():(this.tween_close.start(),6!=this.closeAnimation&&7!=this.closeAnimation||this.tween_opacity.start()),this.closeSound&&this.proui.playAudio(this.closeSound)}},e.postClose=function(){cr.system_object.prototype.acts.SetLayerVisible.call(this.runtime.system,this.inst.layer,!1);var t,e=this;Object.keys(this.outLayerChildren).forEach(function(i){for(var s=0,n=(t=e.outLayerChildren[i]).length;s<n;s++)cr.system_object.prototype.acts.SetLayerVisible.call(e.runtime.system,t[s].layer,!1)}),this.inst.layer.scale=1,this.inst.layer.opacity=1,this.runtime.redraw=!0;var i=(this.inst.layer.viewLeft+this.inst.layer.viewRight)/2,s=this.inst.layer.viewTop-this.inst.height/2-100;this.inst.x=i,this.inst.y=s,this.inst.set_bbox_changed(),this.updateChildren(),this.pauseOnOpen&&cr.system_object.prototype.acts.SetTimescale.call(this.runtime.system,this.prevTimescale),0!=this.runtime.timescale&&this.setDialogTimeScale(-1)},e.onDestroy=function(){this.proui.removeDialog(this)},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},i.prototype.onDialogOpened=function(){return!0},i.prototype.onDialogClosed=function(){return!0},i.prototype.isOpened=function(){return this.isOpen},t.cnds=new i,s.prototype.Open=function(t,e,i){this.open(t,e,i)},s.prototype.Close=function(){this.close()},t.acts=new s,t.exps=new function(){}}(),cr.behaviors.aekiro_gameobject2=function(t){this.runtime=t},function(){var t=cr.behaviors.aekiro_gameobject2.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){if(this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,!cr.goManager){var i=this.runtime;cr.goManager={gos:{},toBeDestroyed:[],addGO:function(t){if(t){t.aekiro_gameobject2.name||(t.aekiro_gameobject2.name="o"+t.uid);var e=t.aekiro_gameobject2.name;this.gos.hasOwnProperty(e)?console.error("Aekiro Hierarchy: GameObject already exist with name: %s !",e):this.gos[e]=t}},removeGO:function(t){delete this.gos[t]},clearDestroyList:function(){for(var t=this.toBeDestroyed,e=0,s=t.length;e<s;e++)i.DestroyInstance(t[e]);t.length=0},createInst:function(t,e,s,n){var r="number"==typeof e?this.runtime.getLayerByNumber(e):"string"==typeof e?this.runtime.getLayerByName(e):e;return i.createInstance(t,r)},clone:function(t,e,i,s,n){cr.haltNext=!0;var r=this.createInst(t.parent.type,i);cr.haltNext=!1,r.type.plugin.acts.LoadFromJsonString.call(r,t.parent.json),r.x=s,r.y=n,r.set_bbox_changed(),r.update_bbox(),r.aekiro_gameobject2.name="",r.aekiro_gameobject2.onCreateInit(),e&&(r.aekiro_gameobject2.parentName=e.aekiro_gameobject2.name);for(var o=0,a=t.children.length;o<a;o++)this.clone(t.children[o],r,i,r.bbox.left+t.children[o].parent.relX,r.bbox.top+t.children[o].parent.relY);return r.aekiro_gameobject2.init(),r}}}};var e=t.Instance.prototype;function i(){}function s(){}function n(){}e.onCreate=function(){this.goManager=cr.goManager,this.name=this.properties[0],this.parentName=this.properties[1],this.firstFrame=!0,this.inst.aekiro_gameobject2=this,this.isInit=!1,this.areChildrenRegistred=!1,this.children=[],cr.haltNext||this.onCreateInit()},e.onCreateInit=function(){this.goManager.addGO(this.inst),this.local={x:0,y:0,angle:0},this.inst.update_bbox(),this.prev={x:this.inst.x,y:this.inst.y,angle:this.inst.angle,width:this.inst.width,height:this.inst.height};var t=this.inst.set_bbox_changed;this.inst.set_bbox_changed_old=this.inst.set_bbox_changed,this.inst.set_bbox_changed=function(){this.aekiro_gameobject2.local_update(),this.aekiro_gameobject2.children_update(),t.call(this)}},e.local_update=function(){if(this.parent=this.parent_get(),this.parent){var t=this.globalToLocal(this.inst,this.parent);this.local.x=t.x,this.local.y=t.y,this.local.angle=t.angle}},e.local_set=function(t,e,i){if(this.parent=this.parent_get(),this.parent){var s=this.inst;null!=t&&(this.local.x=t),null!=e&&(this.local.y=e),null!=i&&(this.local.angle=i),s.x=this.parent.x+this.local.x*Math.cos(this.parent.angle)-this.local.y*Math.sin(this.parent.angle),s.y=this.parent.y+this.local.x*Math.sin(this.parent.angle)+this.local.y*Math.cos(this.parent.angle),s.angle=this.parent.angle+this.local.angle,this.prev.x=s.x,this.prev.y=s.y,this.prev.angle=s.angle,this.children_update(),this.inst.set_bbox_changed_old()}},e.children_add=function(t){var e,i;if("string"==typeof t)e=t,t=null;else{if(!(i=t.aekiro_gameobject2))return void console.error("Aekiro GameObject: You're adding a child (uid=%s) without a gameobject behavior on it.",t.uid);e=t.aekiro_gameobject2.name}if(t=this.goManager.gos[e])if(e!=this.parentName)if(this.children.indexOf(t)>-1)console.error("Aekiro GameObject: Object %s already have a child named %s !",this.name,e);else{(i=t.aekiro_gameobject2).removeFromParent(),i.parentName=this.name;var s=this.globalToLocal2(t,this.prev.x,this.prev.y,this.prev.angle);i.local.x=s.x,i.local.y=s.y,i.local.angle=s.angle,this.children.push(t)}else console.error("Aekiro GameObject: Cannot add %s as a child of %s, because %s is its parent !",e,this.name,e);else console.error("Aekiro GameObject: Object of name : %s not found !",e)},e.children_remove=function(t){var e=-1;if("string"==typeof t){for(var i=0,s=this.children.length;i<s;i++)if(this.children[i].aekiro_gameobject2.name==t){e=i;break}}else e=this.children.indexOf(t);-1!=e&&(this.children[e].aekiro_gameobject2.parentName="",this.children[e].aekiro_gameobject2.parent=null,this.children.splice(e,1))},e.children_update=function(){if(this.areChildrenRegistred||this.registerChildren(),this.prev.x=this.inst.x,this.prev.y=this.inst.y,this.prev.angle=this.inst.angle,this.children.length){var t=this.inst;t.width=0==t.width?.1:t.width,t.height=0==t.height?.1:t.height;var e=t.width/this.prev.width,i=t.height/this.prev.height;this.prev.width=t.width,this.prev.height=t.height;this.goManager;for(var s,n=0,r=this.children.length;n<r;n++)s=this.children[n],1!=e&&(s.width*=e,s.aekiro_gameobject2.local.x*=e),1!=i&&(s.height*=i,s.aekiro_gameobject2.local.y*=i),s.x=t.x+s.aekiro_gameobject2.local.x*Math.cos(t.angle)-s.aekiro_gameobject2.local.y*Math.sin(t.angle),s.y=t.y+s.aekiro_gameobject2.local.x*Math.sin(t.angle)+s.aekiro_gameobject2.local.y*Math.cos(t.angle),s.angle=t.angle+s.aekiro_gameobject2.local.angle,s.aekiro_gameobject2.prev.x=s.x,s.aekiro_gameobject2.prev.y=s.y,s.aekiro_gameobject2.prev.angle=s.angle,s.set_bbox_changed_old(),s.aekiro_gameobject2.children_update()}},e.scopeToParent=function(t,e){var i={};return i.x=e.x+t.x*Math.cos(e.angle)-t.y*Math.sin(e.angle),i.y=e.y+t.x*Math.sin(e.angle)+t.y*Math.cos(e.angle),i.angle=e.angle+t.angle,i},e.localToGlobal=function(){let t=this.parent_get();var e=this.local,i={};if(!t)return{x:this.inst.x,y:this.inst.y,angle:this.inst.angle};for(;t;)i.x=t.x+e.x*Math.cos(t.angle)-e.y*Math.sin(t.angle),i.y=t.y+e.x*Math.sin(t.angle)+e.y*Math.cos(t.angle),i.angle=t.angle+e.angle,e={x:i.x,y:i.y,angle:i.angle},t=t.aekiro_gameobject2.parent_get();return i},e.globalToLocal=function(t,e){var i={};return i.x=(t.x-e.x)*Math.cos(e.angle)+(t.y-e.y)*Math.sin(e.angle),i.y=-(t.x-e.x)*Math.sin(e.angle)+(t.y-e.y)*Math.cos(e.angle),i.angle=t.angle-e.angle,i},e.globalToLocal2=function(t,e,i,s){var n={};return n.x=(t.x-e)*Math.cos(s)+(t.y-i)*Math.sin(s),n.y=-(t.x-e)*Math.sin(s)+(t.y-i)*Math.cos(s),n.angle=t.angle-s,n},e.registerChildren=function(){if(!this.areChildrenRegistred){var t,e=this.goManager.gos,i=this;this.name&&Object.keys(e).forEach(function(s){(t=e[s]).aekiro_gameobject2.parentName==i.name&&(i.children_add(t),t.aekiro_gameobject2.registerChildren())}),this.areChildrenRegistred=!0,console.log("registerChildren")}},e.init=function(){this.isInit||(this.registerChildren(),this.children_update(),this.isInit=!0,this.setVisible(this.inst.visible))},e.tick=function(){this.firstFrame&&(this.firstFrame=!1,this.init())},e.tick2=function(){},e.setVisible=function(t){this.init(),this.inst.type.plugin.acts.SetVisible.call(this.inst,t);for(var e=this.children,i=0,s=e.length;i<s;i++)e[i].aekiro_gameobject2.setVisible(t)},e.setOpacity=function(t){this.init(),this.inst.type.plugin.acts.SetOpacity.call(this.inst,t);for(var e=this.children,i=0,s=e.length;i<s;i++)e[i].aekiro_gameobject2.setOpacity(t)},e.getTemplate=function(t,e,i){this.init(),t||(t=this.inst),i||(i=[]),e&&e.update_bbox(),i.push({parent:{type:t.type,relX:e?t.x-e.bbox.left:null,relY:e?t.y-e.bbox.top:null,json:JSON.stringify(this.runtime.saveInstanceToJSON(t,!0))},children:[]});for(var s=t.aekiro_gameobject2.children,n=0,r=s.length;n<r;n++)this.getTemplate(s[n],t,i[i.length-1].children);return i[0]},e.parent_get=function(){return!this.parent&&this.parentName&&this.name&&(this.parent=this.goManager.gos[this.parentName]),this.parent},e.removeFromParent=function(){this.parent=this.parent_get(),this.parent&&this.parent.aekiro_gameobject2.children_remove(this.inst)},e.onDestroy=function(){var t=this.goManager;if(!this.runtime.changelayout){for(var e=0,i=this.children.length;e<i;e++)t.toBeDestroyed.push(this.children[e]);setTimeout(function(){t.clearDestroyList()},0)}this.children.length=0,t.removeGO(this.name),this.inst.set_bbox_changed=this.inst.set_bbox_changed_old,this.removeFromParent()},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},i.prototype.IsName=function(t){return t==this.name},i.prototype.IsParent=function(t){return t==this.parentName},i.prototype.OnCloned=function(){return!0},t.cnds=new i,s.prototype.Clone=function(t,e,i){var s;s=this.getTemplate(this.inst);var n=this.goManager.clone(s,null,t,e,i);this.runtime.trigger(cr.behaviors.aekiro_gameobject2.prototype.cnds.OnCloned,n)},s.prototype.SetVisible=function(t){this.setVisible(t)},s.prototype.SetOpacity=function(t){this.setOpacity(t)},s.prototype.AddChildrenFromLayer=function(t){this.init();for(var e="number"==typeof t?this.runtime.getLayerByNumber(t):"string"==typeof t?this.runtime.getLayerByName(t):t,i=0,s=e.instances.length;i<s;i++)this.children_add(e.instances[i])},s.prototype.AddChildrenFromType=function(t){if(t)for(var e=t.getCurrentSol().getObjects(),i=0,s=e.length;i<s;i++)this.children_add(e[i])},s.prototype.AddChildByName=function(t){this.children_add(t)},s.prototype.SetLocalPosition=function(t,e){this.local_set(t,e)},s.prototype.SetLocal=function(t,e){0==t?this.local_set(e):1==t?this.local_set(null,e):2==t&&this.local_set(null,null,e)},s.prototype.RemoveChildByName=function(t){this.children_remove(t)},s.prototype.RemoveChildByType=function(t){if(t)for(var e=t.getCurrentSol().getObjects(),i=0,s=e.length;i<s;i++)this.children_remove(e[i])},s.prototype.RemoveFromParent=function(){this.removeFromParent()},t.acts=new s,n.prototype.name=function(t){t.set_string(this.name)},n.prototype.parent=function(t){t.set_string(this.parentName)},n.prototype.local=function(t,e){this.parent_get()?"x"==e?t.set_float(this.local.x):"y"==e?t.set_float(this.local.y):"angle"==e?t.set_float(this.local.angle):t.set_float(0):t.set_float(0)},n.prototype.global=function(t,e){if(this.parent_get()){let i=this.localToGlobal();"x"===e?t.set_float(i.x):"y"===e?t.set_float(i.y):"angle"===e?t.set_float(i.angle):t.set_float(0)}else"x"===e?t.set_float(this.inst.x):"y"===e?t.set_float(this.inst.y):"angle"===e?t.set_float(this.inst.angle):t.set_float(0)},t.exps=new n}(),cr.behaviors.aekiro_gridView=function(t){this.runtime=t},function(){var t=cr.behaviors.aekiro_gridView.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){if(this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,!cr.proui)throw new Error("ProUI Plugin not found. Please add it to the project.")};var e=t.Instance.prototype;e.onCreate=function(){this.proui=cr.proui,this.proui.isTypeValid(this.inst,[cr.plugins_.Sprite,cr.plugins_.NinePatch,cr.plugins_.TiledBg],"ProUI-GRIDVIEW: GridView behavior is only applicable to Sprite Or 9-patch objects."),this.itemUID=this.properties[0],this.columns=this.properties[1],this.rows=this.properties[2],this.vspace=this.properties[3],this.hspace=this.properties[4],this.VPadding=this.properties[5],this.HPadding=this.properties[6],this.dialogUID=this.properties[7],this.firstFrame=!0,this.inst.uiType="gridView",this.uiType="gridView",this.inst._proui=this,this.dpos={},this.template={},this.isTemplateSet=!1,this.value=[],this.items=[],this.isViewBuilt=!1,this.it_column=0,this.it_row=0,this.firstUpdateView=!1,this.scrollView=null,this.isScrollViewInit=!1,this.triggerRenderTickCt=0,this.triggerRenderTickMax=4},e.updateFromModel=function(){var t=this.inst.proui_model;if(t){var e=t.getFromModel();if(null==e)return;if(!s(e))return void console.error("ProUI-GRIDVIEW: The value at the key %s of the model of uid= %s, is not an array !",t.modelKey,t.modelUID);this.value=e}},e._setValue=function(t,e){if(null==t&&(t=[]),s(t))this.value=t,this.updateView(e);else{var i=this.inst.proui_model;console.error("ProUI-GRIDVIEW: The value at the key %s of the model of uid= %s, is not an array !",i.modelKey,i.modelUID)}},e.setItemTemplate=function(){if(!this.isTemplateSet){this.setTemplateVisible(!0);var t,e,i=this.proui.tags[this.itemUID];if(!i)throw new Error("ProUI-GRIDVIEW: Grid item not found, please check gridItem uid");this.proui.isTypeValid(i,[cr.plugins_.Sprite,cr.plugins_.NinePatch,cr.plugins_.TiledBg],"ProUI-GRIDVIEW: Grid item can only be a Sprite Or 9-patch object."),i.uiType="gridItem",i.update_bbox(),this.template.item={},this.template.item.type=i.type,this.template.item.width=i.width,this.template.item.height=i.height,this.template.item.uiType="gridItem",this.template.item.offsetX=i.x-i.bbox.left,this.template.item.offsetY=i.y-i.bbox.top,this.template.item.json=JSON.stringify(this.runtime.saveInstanceToJSON(i,!0)),this.template.subs=[];for(var s=0,n=this.inst.layer.instances.length;s<n;s++)"discreteProgress"!=(t=this.inst.layer.instances[s]).uiType&&"sliderbar"!=t.uiType&&"progress"!=t.uiType&&"scrollView"!=t.uiType||t._proui.init();for(s=0,n=this.inst.layer.instances.length;s<n;s++)"gridView"!=(t=this.inst.layer.instances[s]).uiType&&"gridItem"!=t.uiType&&"dialog"!=t.uiType&&"scrollView"!=t.uiType&&"radiobutton"!=t.uiType&&"scrollBar"!=t.uiType&&"slider"!=t.uiType&&!0!==t.isSubComp&&(e=null,"radiogroup"!=t.uiType&&"discreteProgress"!=t.uiType&&"sliderbar"!=t.uiType||(e=t._proui.getTemplate()),this.template.subs.push({type:t.type,relX:t.x-i.bbox.left,relY:t.y-i.bbox.top,json:JSON.stringify(this.runtime.saveInstanceToJSON(t,!0)),bindkey:t.proui_bind?t.proui_bind.bind_key:"",template:e}));this.isTemplateSet=!0;for(s=0,n=this.inst.layer.instances.length;s<n;s++)"gridView"!=(t=this.inst.layer.instances[s]).uiType&&"dialog"!=t.uiType&&"scrollView"!=t.uiType&&"radiobutton"!=t.uiType&&"scrollBar"!=t.uiType&&"slider"!=t.uiType&&!0!==t.isSubComp&&this.runtime.DestroyInstance(t)}},e.initScrollView=function(){if(!this.isScrollViewInit)for(var t,e=0,i=this.inst.layer.instances.length;e<i;e++)if("scrollView"==(t=this.inst.layer.instances[e]).uiType)return t._proui.init(),void(this.isScrollViewInit=!0)},e.updateView=function(t){if(this.rows<=0&&this.columns<=0)console.error("ProUI-GRIDVIEW: max rows and max columns can't be both -1 or 0");else{if(this.initScrollView(),this.setItemTemplate(),this.inst.update_bbox(),this.initBboxTop=this.inst.bbox.top,this.initBboxLeft=this.inst.bbox.left,0==this.value.length)this.clear();else if(2==t.op)this.build();else if(1==t.op){if(this.rows>0&&this.columns>0&&this.it_row==this.rows)return;this.add(this.value.length-1),this.nextRowColumn(),this.resize()}else-1==t.op?this.remove(t.idx):3==t.op?this.build():4==t.op&&this.edit(t.key,t.value);this.dpos.prev_x=this.inst.x,this.dpos.prev_y=this.inst.y,this.dpos.dx=0,this.dpos.dy=0,this.scrollView&&this.scrollView.postGridviewUpdate(),this.firstUpdateView&&this.runtime.trigger(cr.behaviors.aekiro_gridView.prototype.cnds.OnRender,this.inst),this.firstUpdateView=!0}},e.edit=function(t,e){var i,s=this.inst.proui_model.modelKey,n=0;if(t.slice(0,s.length+1)==s+"."){var r=t.slice(s.length+1),o=r.split(".");if(o.length>1){n=o[0],i=r.slice(n.length+1);var a=this.items[n];if(!a)return;for(var h=0,c=a.subs.length;h<c;h++){var l=a.subs[h];l.proui_bind&&l.proui_bind.bind_key==i&&l.proui_bind.setValue(e)}}}},e.clear=function(){for(var t=0,e=this.items.length;t<e;t++){this.runtime.DestroyInstance(this.items[t].parent);for(var i=0,s=this.items[t].subs.length;i<s;i++)this.runtime.DestroyInstance(this.items[t].subs[i])}this.items.length=0,this.it_column=0,this.it_row=0,this.inst.width=5,this.inst.height=5,this.inst.set_bbox_changed(),this.inst.update_bbox(),this.inst.x=this.initBboxLeft+(this.inst.x-this.inst.bbox.left),this.inst.y=this.initBboxTop+(this.inst.y-this.inst.bbox.top),this.inst.set_bbox_changed()},e.resize=function(){var t=Math.ceil(this.value.length/this.columns),e=Math.ceil(this.value.length/this.rows);this.rows<0?(e=this.columns,this.value.length<this.columns&&(e=this.value.length)):this.columns<0?(t=this.rows,this.value.length<this.rows&&(t=this.value.length)):(e=this.columns,t=this.rows),this.inst.update_bbox();var i=this.inst.bbox.top,s=this.inst.bbox.left;this.inst.width=this.template.item.width*e+this.vspace*(e-1)+2*this.HPadding,this.inst.height=this.template.item.height*t+this.hspace*(t-1)+2*this.VPadding,this.inst.set_bbox_changed(),this.inst.update_bbox(),this.inst.x=s+(this.inst.x-this.inst.bbox.left),this.inst.y=i+(this.inst.y-this.inst.bbox.top),this.inst.set_bbox_changed(),this.scrollView&&(this.scrollView.contentDpos.prev_x=this.inst.x,this.scrollView.contentDpos.prev_y=this.inst.y)},e.build=function(){if(0!=this.items.length&&this.value.length==this.items.length)for(var t=0;t<this.value.length;t++)this.mapData(t);else{this.clear();for(t=0;t<this.value.length&&(this.add(t),this.nextRowColumn());t++);this.resize()}},e.mapData=function(t){for(var e,s,r=this.items[t],o=0,a=r.subs.length;o<a;o++)if(s=this.template.subs[o],(e=r.subs[o]).proui_bind&&i(this.value[t])){var h=s.bindkey;if(h){var c=n(this.value[t],h);null!=c&&e.proui_bind.setValue(c)}}},e.add=function(t){var e,s,r,o=this.inst.proui_model;this.inst.update_bbox(),this.runtime.extra.notRegister=!0,e=this.runtime.createInstance(this.template.item.type,this.inst.layer),this.template.item.type.plugin.acts.LoadFromJsonString.call(e,this.template.item.json),e.x=this.inst.bbox.left+this.template.item.offsetX+(this.vspace+e.width)*this.it_column+this.HPadding,e.y=this.inst.bbox.top+this.template.item.offsetY+(this.hspace+e.height)*this.it_row+this.VPadding,e.set_bbox_changed(),e.update_bbox(),this.items.push({parent:e,subs:[]}),e.proui_bind&&(e.proui_bind.index=t);for(var a=0,h=this.template.subs.length;a<h;a++){var c,l;r=this.template.subs[a],s=this.runtime.createInstance(r.type,this.inst.layer),r.type.plugin.acts.LoadFromJsonString.call(s,r.json),s.x=e.bbox.left+r.relX,s.y=e.bbox.top+r.relY,s.set_bbox_changed(),s.type.plugin.acts.SetEffect&&s.type.plugin.acts.SetEffect.call(s,9),s.proui_model&&(s.proui_model.modelUID=null,s.proui_model.modelKey=null),s._proui&&(s._proui.isValidModel=!1,null!=s._proui.compParent&&(s._proui.compParent=this)),this.items[t].subs.push(s),"radiogroup"!=s.uiType&&"discreteProgress"!=s.uiType&&"sliderbar"!=s.uiType||s._proui.clone(r.template),s.proui_bind&&i(this.value[t])&&((c=r.bindkey)&&("checkbox"!=s.uiType&&"radiogroup"!=s.uiType&&"sliderbar"!=s.uiType||(s.proui_bind.deepKey=o.modelKey+"."+t+"."+c,s.proui_bind.model=o.model),null!=(l=n(this.value[t],c))&&s.proui_bind.setValue(l)),s.proui_bind.index=t)}this.runtime.extra.notRegister=!1},e.nextRowColumn=function(){if(this.rows<0)this.it_column++,this.it_column==this.columns&&(this.it_column=0,this.it_row++);else if(this.columns<0)this.it_row++,this.it_row==this.rows&&(this.it_row=0,this.it_column++);else if(this.it_column++,this.it_column==this.columns&&(this.it_column=0,this.it_row++),this.it_row==this.rows)return!1;return!0},e.previousRowColumn=function(){if(this.rows<0)this.it_column--,this.it_column<0&&(this.it_column=this.columns-1,this.it_row--);else if(this.columns<0)this.it_row--,this.it_row<0&&(this.it_row=this.rows-1,this.it_column--);else if(this.it_column--,this.it_column<0&&(this.it_column=this.columns-1,this.it_row--),0==this.it_row)return!1;return!0},e.remove=function(t){for(var e,s,n,r,o,a,h,c,l=this.inst.proui_model,u=t,p=this.items.length;u<p;u++)if(c=this.items[u].parent,u==t){e=c.x,s=c.y,this.runtime.DestroyInstance(c);for(var d=0,f=this.items[u].subs.length;d<f;d++)this.runtime.DestroyInstance(this.items[u].subs[d])}else{n=c.x,r=c.y,c.x=e,c.y=s,e=n,s=r,c.set_bbox_changed(),c.update_bbox();for(d=0,f=this.items[u].subs.length;d<f;d++)a=this.template.subs[d],(o=this.items[u].subs[d]).x=c.bbox.left+a.relX,o.y=c.bbox.top+a.relY,o.set_bbox_changed(),o.proui_bind&&i(this.value[t])&&(o.proui_bind.index--,(h=a.bindkey)&&("checkbox"!=o.uiType&&"radiogroup"!=o.uiType&&"sliderbar"!=o.uiType||(o.proui_bind.deepKey=l.modelKey+"."+o.proui_bind.index+"."+h)))}if(this.items.splice(t,1),this.previousRowColumn(),this.resize(),this.rows>0&&this.columns>0){var g=this.rows*this.columns;this.value.length>=g&&(this.add(g-1),this.nextRowColumn(),this.resize())}},e.setTemplateVisible=function(t){if(!this.isTemplateSet)for(var e,i=0,s=this.inst.layer.instances.length;i<s;i++)"discreteProgress"!=(e=this.inst.layer.instances[i]).uiType&&"sliderbar"!=e.uiType&&"progress"!=e.uiType&&"scrollView"!=e.uiType||e._proui.init()},e.tick=function(){if(this.firstFrame){this.firstFrame=!1,this.setTemplateVisible(!1);var t=this.proui.tags[this.dialogUID];t&&"dialog"==t.uiType&&t._proui&&(t._proui.outLayerChildren[this.inst.layer.name]||(t._proui.outLayerChildren[this.inst.layer.name]=[]),t._proui.outLayerChildren[this.inst.layer.name].push(this.inst)),this.dpos.prev_x=this.inst.x,this.dpos.prev_y=this.inst.y,this.dpos.dx=0,this.dpos.dy=0,this.updateFromModel(),this.firstUpdateView||this.updateView({op:2})}},e.updateChildren=function(){var t;if(isNaN(this.dpos.prev_x)&&(this.dpos.prev_x=this.inst.x,this.dpos.prev_y=this.inst.y),this.dpos.dx=this.inst.x-this.dpos.prev_x,this.dpos.dy=this.inst.y-this.dpos.prev_y,this.dpos.prev_x=this.inst.x,this.dpos.prev_y=this.inst.y,0!=this.dpos.dx||0!=this.dpos.dy)for(var e=0,i=this.inst.layer.instances.length;e<i;e++)!0!==(t=this.inst.layer.instances[e]).isSubComp&&"gridView"!=t.uiType&&"dialog"!=t.uiType&&"scrollView"!=t.uiType&&"scrollBar"!=t.uiType&&"slider"!=t.uiType&&(t.x+=this.dpos.dx,t.y+=this.dpos.dy,t.set_bbox_changed())},e.tick2=function(){this.updateChildren()},e.onDestroy=function(){},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){};var i=function(t){return!!t&&t.constructor===Object},s=function(t){return!!t&&t.constructor===Array},n=function(t,e){for(var i=(e=(e=e.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),s=0,n=i.length;s<n;++s){var r=i[s];if(!(r in t))return;t=t[r]}return t};function r(){}r.prototype.OnRender=function(){return!0},t.cnds=new r,t.acts=new function(){},t.exps=new function(){}}(),cr.behaviors.aekiro_modelB=function(t){this.runtime=t},function(){var t=cr.behaviors.aekiro_modelB.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){if(this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,!cr.proui)throw new Error("ProUI Plugin not found. Please add it to the project.")};var e=t.Instance.prototype;function i(){}e.onCreate=function(){this.proui=cr.proui,this.modelUID=this.properties[0],this.modelKey=this.properties[1],this.model=this.proui.tags[this.modelUID],this.model=this.model&&"model"==this.model.uiType?this.model:null,this.firstFrame=!0,this.inst.proui_model=this,this.model&&this.modelKey&&this.model.registerBehavior(this)},e.setModelValue=function(t,e){this.model&&this.modelKey&&cr.plugins_.aekiro_model.prototype.acts.SetValueByKeyString.call(this.model,this.modelKey,t,e)},e.setElementValue=function(t,e){var i=this.inst;i._proui&&i._proui._setValue&&i._proui._setValue(t,e)},e.getFromModel=function(){var t=null;return this.model&&this.modelKey&&(t=this.model.getValue(this.modelKey)),t},e.tick=function(){},e.onDestroy=function(){this.model&&this.model.unregisterBehavior(this),this.modelUID=0,this.modelKey="",this.model=null},e.saveToJSON=function(){},e.loadFromJSON=function(t){},t.cnds=new function(){},i.prototype.Reset=function(){this.model&&this.model.unregisterBehavior(this),this.modelUID="",this.modelKey="",this.model=null},t.acts=new i,t.exps=new function(){}}(),cr.behaviors.aekiro_scrollView=function(t){this.runtime=t},function(){var t=cr.behaviors.aekiro_scrollView.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){if(this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,!cr.proui)throw new Error("ProUI Plugin not found. Please add it to the project.");this.behavior.isHooked||(cr.proui.HookMe(this.behavior,["touch","wheel"]),this.behavior.isHooked=!0)};var e=t.Instance.prototype;function i(){}e.onCreate=function(){this.proui=cr.proui,this.proui.isTypeValid(this.inst,[cr.plugins_.Sprite,cr.plugins_.NinePatch,cr.plugins_.TiledBg],"Pro UI: ScrollView behavior is only applicable to Sprite Or 9-patch objects."),this.scrolling=this.properties[0],this.isSwipeScroll=this.properties[1],this.isMouseScroll=this.properties[2],this.contentUID=this.properties[3],this.vSliderUID=this.properties[4],this.vScrollBarUID=this.properties[5],this.hSliderUID=this.properties[6],this.hScrollBarUID=this.properties[7],this.inertia=this.properties[8],this.movement=this.properties[9],this.dialogUID=this.properties[10],this.inertia||(this.movement=0),this.elasticF=1,this.movement&&(this.elasticF=.4),this.firstFrame=!0,this.uiType="scrollView",this.inst.uiType="scrollView",this.inst._proui=this,this.dpos={},this.proui.scrollViews["l"+this.inst.layer.index]=this,this.onTouchStarted=!1,this.isTouchMoving=!1,this.onSliderTouchStarted=!1,this.onvSliderTouchStarted=!1,this.onhSliderTouchStarted=!1,this.content=null,this.vSlider=null,this.vScrollBar=null,this.hSlider=null,this.hScrollBar=null,this.contentPrevWidth=0,this.contentPrevHeight=0,this.contentDpos={},this.isInit=!1,this.isContentGridView=!1,this.scroll={isEnabled:!1,prevTouchX:0,dx:0,prevTouchY:0,dy:0,scrollRatio:0,vScrolling:0==this.scrolling||2==this.scrolling,hScrolling:1==this.scrolling||2==this.scrolling,isSwipeScroll:this.isSwipeScroll,isMouseScroll:this.isMouseScroll,vSliderDy:0,hSliderDx:0,scrollToTargetY:null,scrollToTargetX:null,scrollToX:!1,scrollToY:!1,scrollToSmooth:.3}},e.scrollTo=function(t,e,i,s){if(this.inst.update_bbox(),this.content.update_bbox(),this.scroll.scrollToSmooth=s,this.scroll.scrollToTargetY=null,this.scroll.scrollToTargetX=null,this.scroll.scrollToX=!1,this.scroll.scrollToY=!1,this.onScrollToStarted=!1,e>=0&&this.scroll.vScrolling){var n=(this.inst.bbox.top+this.inst.bbox.bottom)/2;i?(e=cr.clamp(e,0,1),e=this.content.bbox.top+e*this.content.height):e=this.content.bbox.top+e,this.scroll.scrollToTargetY=this.content.y+(n-e),this.scroll.scrollToY=!0,this.scroll.isEnabled=!0,this.onScrollToStarted=!0}if(t>=0&&this.scroll.hScrolling){var r=(this.inst.bbox.left+this.inst.bbox.right)/2;i?(t=cr.clamp(t,0,1),t=this.content.bbox.left+t*this.content.width):t=this.content.bbox.left+t,this.scroll.scrollToTargetX=this.content.x+(r-t),this.scroll.scrollToX=!0,this.scroll.isEnabled=!0,this.onScrollToStarted=!0}this.content.set_bbox_changed()},e.OnWheel=function(t){this.isInteractible()&&this.scroll.isMouseScroll&&this.scroll.vScrolling&&this.isMouseOver()&&(this.scroll.scrollToX=!1,this.scroll.scrollToY=!1,this.scroll.isEnabled=!0,this.onWheelStarted=!0,t=0==t?-1:1,this.scroll.dy=.026*t*this.content.height)},e.OnAnyTouchStart=function(){this.vSlider&&this.isInTouch(this.vSlider)&&this.scroll.vScrolling&&(this.OnSliderTouchStart(),this.onvSliderTouchStarted=!0),this.hSlider&&this.isInTouch(this.hSlider)&&this.scroll.hScrolling&&(this.OnSliderTouchStart(),this.onhSliderTouchStarted=!0)},e.isInteractible=function(){for(var t=!0,e=0,i=this.proui.currentDialogs.length;e<i;e++)if(this.inst.layer.index<this.proui.currentDialogs[e].inst.layer.index)return t=!1;var s,n=this.runtime.running_layout.layers;for(e=this.inst.layer.index+1,i=n.length;e<i;e++)if((s=this.proui.scrollViews["l"+e])&&(s.inst.update_bbox(),s.inst.contains_pt(this.proui.X(s.inst.layer.index),this.proui.Y(s.inst.layer.index))||s.inst.contains_pt(this.proui.CursorX(s.inst.layer.index),this.proui.CursorY(s.inst.layer.index)))){t=!1;break}return t},e.OnTouchStart=function(){this.isInteractible()&&(this.onTouchStarted=!0,this.scroll.vScrolling&&(this.scroll.prevTouchY=this.proui.Y(this.inst.layer.index),this.scroll.dy=0,this.scroll.isEnabled=!0,this.scroll.scrollToX=!1,this.scroll.scrollToY=!1),this.scroll.hScrolling&&(this.scroll.prevTouchX=this.proui.X(this.inst.layer.index),this.scroll.dx=0,this.scroll.isEnabled=!0,this.scroll.scrollToX=!1,this.scroll.scrollToY=!1))},e.OnTouchMove=function(){this.isTouchMoving=!0},e.OnAnyTouchEnd=function(t,e){this.onTouchStarted&&this.OnTouchEnd(t,e),this.onTouchStarted=!1,this.onSliderTouchStarted=!1,this.onvSliderTouchStarted=!1,this.onhSliderTouchStarted=!1},e.OnTouchEnd=function(t,e){this.isTouchMoving=!1},e.OnSliderTouchStart=function(){this.scroll.prevTouchY=this.proui.Y(this.inst.layer.index),this.scroll.prevTouchX=this.proui.X(this.inst.layer.index),this.scroll.dy=0,this.scroll.dx=0,this.scroll.vSliderDy=0,this.scroll.hSliderDx=0,this.onSliderTouchStarted=!0,this.scroll.isEnabled=!0,this.scroll.scrollToX=!1,this.scroll.scrollToY=!1},e.isMouseOver=function(){var t=this.proui.CursorX(this.inst.layer.index),e=this.proui.CursorY(this.inst.layer.index);return this.inst.update_bbox(),this.inst.contains_pt(t,e)},e.isInTouch=function(t){var e=this.proui.X(this.inst.layer.index),i=this.proui.Y(this.inst.layer.index);return t.update_bbox(),t.contains_pt(e,i)},e.boundSlider=function(t){if("v"==t&&this.vSlider&&this.vScrollBar){this.inst.update_bbox(),this.content.update_bbox(),this.vScrollBar.update_bbox(),this.vSlider.update_bbox();var e=this.vScrollBar.bbox.top+(this.vSlider.y-this.vSlider.bbox.top)+(this.vScrollBar.height-this.vSlider.height)*((this.content.bbox.top-this.inst.bbox.top)/(this.inst.height-this.content.height));this.vSlider.y=cr.clamp(e,this.vScrollBar.bbox.top+(this.vSlider.y-this.vSlider.bbox.top),this.vScrollBar.bbox.bottom-(this.vSlider.bbox.bottom-this.vSlider.y)),this.vSlider.set_bbox_changed()}if("h"==t&&this.hSlider&&this.hScrollBar){this.inst.update_bbox(),this.content.update_bbox(),this.hScrollBar.update_bbox(),this.hSlider.update_bbox();var i=this.hScrollBar.bbox.left+(this.hSlider.x-this.hSlider.bbox.left)+(this.hScrollBar.width-this.hSlider.width)*((this.content.bbox.left-this.inst.bbox.left)/(this.inst.width-this.content.width));this.hSlider.x=cr.clamp(i,this.hScrollBar.bbox.left+(this.hSlider.x-this.hSlider.bbox.left),this.hScrollBar.bbox.right-(this.hSlider.bbox.right-this.hSlider.x)),this.hSlider.set_bbox_changed()}},e.postGridviewUpdate=function(){for(var t=[this.vScrollBar,this.vSlider,this.hScrollBar,this.hSlider],e=0,i=t.length;e<i;e++)t[e]&&t[e].type.plugin.acts.MoveToTop.call(t[e])},e.init=function(){if(!this.isInit){if(this.vSliderUID&&(this.vSlider=this.proui.tags[this.vSliderUID],this.vSlider?(this.proui.isTypeValid(this.vSlider,[cr.plugins_.Sprite,cr.plugins_.NinePatch],"ProUI-ScrollView: The vertical slider can only be a Sprite Or 9-patch object."),this.vSlider.uiType="slider"):console.error("ProUI-ScrollView %d : Vertical slider not found",this.inst.uid)),this.vScrollBarUID&&(this.vScrollBar=this.proui.tags[this.vScrollBarUID],this.vScrollBar?(this.proui.isTypeValid(this.vScrollBar,[cr.plugins_.Sprite,cr.plugins_.NinePatch],"ProUI-ScrollView: The vertical scrollbar can only be a Sprite Or 9-patch object."),this.vScrollBar.uiType="scrollBar"):console.error("ProUI-ScrollView %d : Vertical scrollbar not found",this.inst.uid)),this.hSliderUID&&(this.hSlider=this.proui.tags[this.hSliderUID],this.hSlider?(this.proui.isTypeValid(this.hSlider,[cr.plugins_.Sprite,cr.plugins_.NinePatch],"ProUI-ScrollView: The horizontal slider can only be a Sprite Or 9-patch object."),this.hSlider.uiType="slider"):console.error("ProUI-ScrollView %d : Horizontal slider not found",this.inst.uid)),this.hScrollBarUID&&(this.hScrollBar=this.proui.tags[this.hScrollBarUID],this.hScrollBar?(this.proui.isTypeValid(this.hScrollBar,[cr.plugins_.Sprite,cr.plugins_.NinePatch],"ProUI-ScrollView: The horizontal scrollbar can only be a Sprite Or 9-patch object."),this.hScrollBar.uiType="scrollBar"):console.error("ProUI-ScrollView %d : Horizontal scrollbar not found",this.inst.uid)),this.content=this.proui.tags[this.contentUID],!this.content)throw new Error("ProUI-ScrollView: Content not found, please check the content tag");var t;this.proui.isTypeValid(this.content,[cr.plugins_.Sprite,cr.plugins_.NinePatch,cr.plugins_.TiledBg],"ProUI-ScrollView: The content of the scrollView can only be a Sprite Or 9-patch object."),"gridView"==this.content.uiType&&(this.isContentGridView=!0,this.content._proui.scrollView=this),this.content.height<=this.inst.height&&(this.scroll.vScrolling=!1),this.content.width<=this.inst.width&&(this.scroll.hScrolling=!1),this.contentPrevHeight=this.content.height,this.contentPrevWidth=this.content.width,this.contentDpos.prev_x=this.content.x,this.contentDpos.prev_y=this.content.y,this.contentDpos.dx=0,this.contentDpos.dy=0,this.inst.update_bbox(),this.content.update_bbox(),this.content.x=this.inst.bbox.left+(this.content.x-this.content.bbox.left),this.content.y=this.inst.bbox.top+(this.content.y-this.content.bbox.top),this.content.set_bbox_changed(),this.hSlider&&this.hScrollBar&&(this.hSlider.update_bbox(),this.hScrollBar.update_bbox(),this.hSlider.x=this.hScrollBar.bbox.left+(this.hSlider.x-this.hSlider.bbox.left),this.hSlider.set_bbox_changed(),this.hScrollBar.type.plugin.acts.MoveToTop.call(this.hScrollBar),this.hSlider.type.plugin.acts.MoveToTop.call(this.hSlider)),this.vSlider&&this.vScrollBar&&(this.vSlider.update_bbox(),this.vScrollBar.update_bbox(),this.vSlider.y=this.vScrollBar.bbox.top+(this.vSlider.y-this.vSlider.bbox.top),this.vSlider.set_bbox_changed(),this.vScrollBar.type.plugin.acts.MoveToTop.call(this.vScrollBar),this.vSlider.type.plugin.acts.MoveToTop.call(this.vSlider)),cr.system_object.prototype.acts.SetLayerForceOwnTexture.call(this.runtime.system,this.inst.layer,!0);for(var e=0,i=this.inst.layer.instances.length;e<i;e++)(t=this.inst.layer.instances[e])&&t!=this.inst&&"dialog"!=t.uiType&&"scrollBar"!=t.uiType&&"slider"!=t.uiType&&t.type.plugin.acts.SetEffect&&t.type.plugin.acts.SetEffect.call(t,9);this.isInit=!0;var s=this.proui.tags[this.dialogUID];s&&"dialog"==s.uiType&&s._proui&&(s._proui.outLayerChildren[this.inst.layer.name]||(s._proui.outLayerChildren[this.inst.layer.name]=[]),s._proui.outLayerChildren[this.inst.layer.name].push(this.inst),s._proui.isOpen||cr.system_object.prototype.acts.SetLayerVisible.call(this.runtime.system,this.inst.layer,!1))}},e.tick=function(){if(this.firstFrame&&(this.firstFrame=!1,this.prevSelfLayerVisible=this.inst.layer.visible,this.init(),this.dpos.prev_x=this.inst.x,this.dpos.prev_y=this.inst.y,this.dpos.dx=0,this.dpos.dy=0),this.content){this.contentDpos.dx=this.content.x-this.contentDpos.prev_x,this.contentDpos.dy=this.content.y-this.contentDpos.prev_y,this.contentDpos.prev_x=this.content.x,this.contentDpos.prev_y=this.content.y;var t=this.inst.layer.visible;if(t!=this.prevSelfLayerVisible&&(this.prevSelfLayerVisible=this.inst.layer.visible,cr.system_object.prototype.acts.SetLayerForceOwnTexture.call(this.runtime.system,this.inst.layer,t)),this.contentPrevHeight!=this.content.height&&(this.inst.update_bbox(),this.content.update_bbox(),this.content.height<=this.inst.height?(this.content.y=this.inst.bbox.top+(this.content.y-this.content.bbox.top),this.scroll.vScrolling=!1):(this.content.y=cr.clamp(this.content.y,this.inst.bbox.bottom-(this.content.bbox.bottom-this.content.y),this.inst.bbox.top+(this.content.y-this.content.bbox.top)),0!=this.scrolling&&2!=this.scrolling||(this.scroll.vScrolling=!0)),this.content.set_bbox_changed(),this.boundSlider("v"),this.contentPrevHeight=this.content.height),this.contentPrevWidth!=this.content.width&&(this.inst.update_bbox(),this.content.update_bbox(),this.content.width<=this.inst.width?(this.content.x=this.inst.bbox.left+(this.content.x-this.content.bbox.left),this.scroll.hScrolling=!1):(this.content.x=cr.clamp(this.content.x,this.inst.bbox.right-(this.content.bbox.right-this.content.x),this.inst.bbox.left+(this.content.x-this.content.bbox.left)),1!=this.scrolling&&2!=this.scrolling||(this.scroll.hScrolling=!0)),this.content.set_bbox_changed(),this.boundSlider("h"),this.contentPrevWidth=this.content.width),this.scroll.isEnabled){if(this.onvSliderTouchStarted&&this.scroll.vScrolling){this.scroll.vSliderDy=this.proui.Y(this.inst.layer.index)-this.scroll.prevTouchY,this.scroll.prevTouchY=this.proui.Y(this.inst.layer.index);var e=this.vSlider.y+this.scroll.vSliderDy;this.vSlider.update_bbox(),this.vScrollBar.update_bbox(),this.vSlider.y=cr.clamp(e,this.vScrollBar.bbox.top+(this.vSlider.y-this.vSlider.bbox.top),this.vScrollBar.bbox.bottom-(this.vSlider.bbox.bottom-this.vSlider.y)),this.vSlider.set_bbox_changed(),this.vSlider.update_bbox(),this.inst.update_bbox(),this.content.update_bbox(),this.content.y=this.inst.bbox.top+(this.content.y-this.content.bbox.top)-(this.vSlider.bbox.top-this.vScrollBar.bbox.top)/(this.vScrollBar.height-this.vSlider.height)*(this.content.height-this.inst.height),this.content.set_bbox_changed()}if(this.onhSliderTouchStarted&&this.scroll.hScrolling){this.scroll.hSliderDx=this.proui.X(this.inst.layer.index)-this.scroll.prevTouchX,this.scroll.prevTouchX=this.proui.X(this.inst.layer.index);var i=this.hSlider.x+this.scroll.hSliderDx;this.hSlider.update_bbox(),this.hScrollBar.update_bbox(),this.hSlider.x=cr.clamp(i,this.hScrollBar.bbox.left+(this.hSlider.x-this.hSlider.bbox.left),this.hScrollBar.bbox.right-(this.hSlider.bbox.right-this.hSlider.x)),this.hSlider.set_bbox_changed(),this.hSlider.update_bbox(),this.inst.update_bbox(),this.content.update_bbox(),this.content.x=this.inst.bbox.left+(this.content.x-this.content.bbox.left)-(this.hSlider.bbox.left-this.hScrollBar.bbox.left)/(this.hScrollBar.width-this.hSlider.width)*(this.content.width-this.inst.width),this.content.set_bbox_changed()}if(this.scroll.isSwipeScroll&&this.isInTouch(this.inst)&&!this.onSliderTouchStarted&&this.onTouchStarted&&(this.scroll.vScrolling&&(this.scroll.dy=this.proui.Y(this.inst.layer.index)-this.scroll.prevTouchY+(this.runtime.tickcount%2==1?.2:-.2),this.scroll.prevTouchY=this.proui.Y(this.inst.layer.index)),this.scroll.hScrolling&&(this.scroll.dx=this.proui.X(this.inst.layer.index)-this.scroll.prevTouchX,this.scroll.prevTouchX=this.proui.X(this.inst.layer.index))),this.scroll.vScrolling&&!this.onSliderTouchStarted&&(this.scroll.scrollToY?null!=this.scroll.scrollToTargetY&&(this.content.y=cr.lerp(this.content.y,this.scroll.scrollToTargetY,this.scroll.scrollToSmooth),Math.abs(this.content.y-this.scroll.scrollToTargetY)<5&&(this.content.y=this.scroll.scrollToTargetY,this.scroll.scrollToY=!1)):this.content.y=cr.lerp(this.content.y,this.content.y+this.scroll.dy,.7),this.content.set_bbox_changed(),this.inertia?this.scroll.dy=14/15*this.scroll.dy:this.scroll.dy=0,this.boundSlider("v")),this.scroll.hScrolling&&!this.onSliderTouchStarted&&(this.scroll.scrollToX?null!=this.scroll.scrollToTargetX&&(this.content.x=cr.lerp(this.content.x,this.scroll.scrollToTargetX,this.scroll.scrollToSmooth),Math.abs(this.content.x-this.scroll.scrollToTargetX)<5&&(this.content.x=this.scroll.scrollToTargetX,this.scroll.scrollToX=!1)):this.content.x=cr.lerp(this.content.x,this.content.x+this.scroll.dx,.7),this.content.set_bbox_changed(),this.inertia?this.scroll.dx=14/15*this.scroll.dx:this.scroll.dx=0,this.boundSlider("h")),!this.onSliderTouchStarted){this.inst.update_bbox(),this.content.update_bbox();var s=0,n=0,r=0,o=0;this.scroll.vScrolling&&(s=this.content.bbox.top-this.inst.bbox.top,n=this.inst.bbox.bottom-this.content.bbox.bottom,(s>0||n>0)&&(this.scroll.scrollToY?(this.content.y=cr.clamp(this.content.y,this.content.y+n,this.content.y-s),this.scroll.scrollToTargetY=this.content.y,this.scroll.scrollToY=!1):this.content.y=cr.clamp(this.content.y,cr.lerp(this.content.y,this.content.y+n,this.elasticF),cr.lerp(this.content.y,this.content.y-s,this.elasticF))),this.content.set_bbox_changed()),this.scroll.hScrolling&&(r=this.inst.bbox.right-this.content.bbox.right,o=this.content.bbox.left-this.inst.bbox.left,(r>0||o>0)&&(this.scroll.scrollToX?(this.content.x=cr.clamp(this.content.x,this.content.x+r,this.content.x-o),this.scroll.scrollToTargetX=this.content.x,this.scroll.scrollToX=!1):this.content.x=cr.clamp(this.content.x,cr.lerp(this.content.x,this.content.x+r,this.elasticF),cr.lerp(this.content.x,this.content.x-o,this.elasticF))),this.content.set_bbox_changed()),!this.inertia&&this.onWheelStarted&&(this.scroll.isEnabled=!1,this.onWheelStarted=!1),!this.onScrollToStarted||this.scroll.scrollToX||this.scroll.scrollToY||(this.scroll.isEnabled=!1,this.onScrollToStarted=!1),this.inertia&&Math.abs(this.scroll.dx)<.1&&Math.abs(this.scroll.dy)<.1&&!this.scroll.scrollToX&&!this.scroll.scrollToY&&(this.scroll.isEnabled=!1,console.log("Scroll disabled"))}}}},e.updateContentChildren=function(){var t;if(this.content&&(0!=this.contentDpos.dx||0!=this.contentDpos.dy))for(var e=0,i=this.inst.layer.instances.length;e<i;e++)(t=this.inst.layer.instances[e])&&t!=this.content&&!0!==t.isSubComp&&"dialog"!=t.uiType&&"scrollView"!=t.uiType&&"scrollBar"!=t.uiType&&"slider"!=t.uiType&&(t.x+=this.contentDpos.dx,t.y+=this.contentDpos.dy,t.set_bbox_changed())},e.updateChildren=function(){isNaN(this.dpos.prev_x)&&(this.dpos.prev_x=this.inst.x,this.dpos.prev_y=this.inst.y),this.dpos.dx=this.inst.x-this.dpos.prev_x,this.dpos.dy=this.inst.y-this.dpos.prev_y,this.dpos.prev_x=this.inst.x,this.dpos.prev_y=this.inst.y;var t,e=[this.content,this.vScrollBar,this.vSlider,this.hScrollBar,this.hSlider];if(0!=this.dpos.dx||0!=this.dpos.dy)for(var i=0,s=e.length;i<s;i++)(t=e[i])&&(t.x+=this.dpos.dx,t.y+=this.dpos.dy,t.set_bbox_changed())},e.tick2=function(){this.isContentGridView||this.updateContentChildren(),this.updateChildren()},e.onDestroy=function(){this.proui.scrollViews["l"+this.inst.layer.index]=null},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},t.cnds=new function(){},i.prototype.ScrollTo=function(t,e,i,s){this.scrollTo(t,e,i,s)},t.acts=new i,t.exps=new function(){}}(),cr.behaviors.aekiro_sliderbar=function(t){this.runtime=t},function(){var t=cr.behaviors.aekiro_sliderbar.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){if(this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,!cr.proui)throw new Error("ProUI Plugin not found. Please add it to the project.");this.behavior.isHooked||(cr.proui.HookMe(this.behavior,["touch"]),this.behavior.isHooked=!0)};var e=t.Instance.prototype;e.onCreate=function(){this.proui=cr.proui,this.proui.isTypeValid(this.inst,[cr.plugins_.Sprite,cr.plugins_.NinePatch],"Pro UI: SliderBar behavior is only applicable to Sprite Or 9-patch objects."),this.isEnabled=this.properties[0],this.value=this.properties[1],this.sliderButtonUID=this.properties[2],this.minValue=this.properties[3],this.maxValue=this.properties[4],this.step=this.properties[5],this.firstFrame=!0,this.inst.uiType="sliderbar",this.uiType="sliderbar",this.inst._proui=this,this.firstSetValue=!1,this.compParent=this,this.isInit=!1,this.dpos={},this.onSliderTouchStarted=!1,this.onValueChanged=!1,this.value=this.validateValue(this.value)},e.getTemplate=function(){if(this.sliderButton=this.proui.tags[this.sliderButtonUID],this.sliderButton)return{sliderTag:this.sliderButtonUID,type:this.sliderButton.type,json:JSON.stringify(this.runtime.saveInstanceToJSON(this.sliderButton,!0))};console.error("SLIDERBAR %d : Slider button not found",this.inst.uid)},e.clone=function(t){if(t){var e=this.runtime.createInstance(t.type,this.inst.layer);e.type.plugin.acts.LoadFromJsonString.call(e,t.json);var i=t.sliderTag+this.proui.getIter();e.aekiro_tag.tag=i;var s=this.runtime.extra.notRegister;this.runtime.extra.notRegister=!1,this.proui.addTag(i,e),this.runtime.extra.notRegister=s,this.sliderButtonUID=i,this.init()}},e.setValue=function(t){if(this.firstSetValue=!0,this._setValue(t)){var e=this.inst.proui_model;e&&e.setModelValue(t,{except:this.compParent}),this.inst.proui_bind&&this.inst.proui_bind.updateGridViewModel(t,{except:this.compParent})}},e.validateValue=function(t){return t=this.proui.validateSimpleValue(t,0),t=Math.round(t/this.step)*this.step,t=cr.clamp(t,this.minValue,this.maxValue)},e._setValue=function(t){return null!=t&&(t=this.validateValue(t),this.value=t,this.updateView(),!0)},e.updateFromModel=function(){var t=this.inst.proui_model;if(t){var e=t.getFromModel();if(null==e)return;e=this.validateValue(e),this.value=e}},e.OnAnyTouchStart=function(){this.sliderButton&&this.isInTouch(this.sliderButton)&&this.isEnabled&&(this.OnSliderTouchStart(),this.onSliderTouchStarted=!0,this.onValueChanged=!0)},e.OnTouchStart=function(){this.sliderButton&&this.isInTouch(this.sliderButton)||!this.isEnabled||(this.onX(this.proui.X(this.inst.layer.index)),this.onValueChanged=!0)},e.OnSliderTouchStart=function(){},e.OnAnyTouchEnd=function(t,e){this.onSliderTouchStarted&&this.OnTouchEnd(t,e),this.onSliderTouchStarted=!1,this.onValueChanged=!1},e.OnTouchEnd=function(t,e){this.setValue(this.value)},e.updateView=function(){this.isInit&&(this.inst.update_bbox(),this.sliderButton.x=cr.clamp(this.inst.bbox.left+(this.value-this.minValue)/this.step*this.widthStep,this.inst.bbox.left,this.inst.bbox.right),this.sliderButton.y=(this.inst.bbox.bottom+this.inst.bbox.top)/2,this.sliderButton.set_bbox_changed(),this.lastStop=this.sliderButton.x)},e.setEnabled=function(t){this.isEnabled=t},e.init=function(){this.isInit||(this.sliderButton=this.proui.tags[this.sliderButtonUID],this.sliderButton?(this.sliderButton.uiType="sliderbutton",this.inst.update_bbox(),this.sliderButton.x=this.inst.bbox.left,this.sliderButton.y=(this.inst.bbox.bottom+this.inst.bbox.top)/2,this.sliderButton.set_bbox_changed(),this.sliderButton.isSubComp=!0,this.widthStep=this.step/(this.maxValue-this.minValue)*this.inst.width,this.thres=this.step/(this.maxValue-this.minValue),this.lastStop=this.inst.bbox.left,this.dpos.prev_x=this.inst.x,this.dpos.prev_y=this.inst.y,this.dpos.dx=0,this.dpos.dy=0,this.isInit=!0):console.error("SLIDERBAR %d : Slider button not found",this.inst.uid))},e.onX=function(t){this.inst.update_bbox();var e=t-this.lastStop;if(this.thres>.04){if(this.sign(e)>0&&this.maxValue-this.value<this.step)return;Math.abs(e)>2*this.widthStep/3&&(this.lastStop=this.lastStop+this.sign(e)*this.widthStep,this.sliderButton.x=cr.clamp(this.lastStop,this.inst.bbox.left,this.inst.bbox.right),this.sliderButton.set_bbox_changed(),this.value=this.value+this.sign(e)*this.step,this.value=cr.clamp(this.value,this.minValue,this.maxValue))}else this.sliderButton.x=cr.clamp(t,this.inst.bbox.left,this.inst.bbox.right),this.sliderButton.set_bbox_changed(),this.value=(this.sliderButton.x-this.inst.bbox.left)/this.inst.width*(this.maxValue-this.minValue),this.value=this.minValue+Math.round(this.value/this.step)*this.step,this.value=cr.clamp(this.value,this.minValue,this.maxValue)},e.isInTouch=function(t){var e=this.proui.X(this.inst.layer.index),i=this.proui.Y(this.inst.layer.index);return t.update_bbox(),t.contains_pt(e,i)},e.sign=function(t){return isNaN(parseFloat(t))?NaN:0===t?0:-0===t?-0:t>0?1:-1},e.tick=function(){this.firstFrame&&(this.firstFrame=!1,this.init(),this.firstSetValue||this.updateFromModel(),this.updateView()),this.onSliderTouchStarted&&this.onX(this.proui.X(this.inst.layer.index))},e.updateChildren=function(){if(this.sliderButton){isNaN(this.dpos.prev_x)&&(this.dpos.prev_x=this.inst.x,this.dpos.prev_y=this.inst.y),this.dpos.dx=this.inst.x-this.dpos.prev_x,this.dpos.dy=this.inst.y-this.dpos.prev_y,this.dpos.prev_x=this.inst.x,this.dpos.prev_y=this.inst.y;var t=this.sliderButton;0==this.dpos.dx&&0==this.dpos.dy||(t.x+=this.dpos.dx,t.y+=this.dpos.dy,t.set_bbox_changed())}},e.tick2=function(){this.updateChildren()},e.onDestroy=function(){if(!this.runtime.changelayout){this.proui.toBeDestroyed.push(this.sliderButton);var t=this.proui;setTimeout(function(){t.clearDestroyList()},0)}},e.saveToJSON=function(){return{isEnabled:this.isEnabled,value:this.value,minValue:this.minValue,maxValue:this.maxValue,step:this.step}},e.loadFromJSON=function(t){this.isEnabled=t.isEnabled,this.value=t.value,this.minValue=t.minValue,this.maxValue=t.maxValue,this.step=t.step};function i(){}function s(){}function n(){}t.cnds=new i,i.prototype.IsSliding=function(){return this.onValueChanged},s.prototype.setValue=function(t){this.setValue(t)},t.acts=new s,n.prototype.value=function(t){t.set_float(this.value)},t.exps=new n}(),cr.behaviors.aekiro_tag=function(t){this.runtime=t},function(){var t=cr.behaviors.aekiro_tag.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){if(this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,!cr.proui)throw new Error("ProUI Plugin not found. Please add it to the project.")};var e=t.Instance.prototype;function i(){}function s(){}e.onCreate=function(){this.proui=cr.proui,this.tag=this.properties[0],this.inst.proui_tag=this.tag,this.inst.aekiro_tag=this,this.proui.addTag(this.tag,this.inst)},e.tick=function(){},e.onDestroy=function(){this.proui.removeTag(this.tag)},e.saveToJSON=function(){return{}},e.loadFromJSON=function(t){},i.prototype.IsTag=function(t){return t==this.tag},t.cnds=new i,t.acts=new function(){},s.prototype.tag=function(t){t.set_string(this.tag)},t.exps=new s}(),cr.behaviors.jumpthru=function(t){this.runtime=t},function(){var t=cr.behaviors.jumpthru.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}e.onCreate=function(){this.inst.extra.jumpthruEnabled=0!==this.properties[0]},e.tick=function(){},i.prototype.IsEnabled=function(){return this.inst.extra.jumpthruEnabled},t.cnds=new i,s.prototype.SetEnabled=function(t){this.inst.extra.jumpthruEnabled=!!t},t.acts=new s}();var easeOutBounceArray=[],easeInElasticArray=[],easeOutElasticArray=[],easeInOutElasticArray=[],easeInCircle=[],easeOutCircle=[],easeInOutCircle=[],easeInBack=[],easeOutBack=[],easeInOutBack=[],litetween_precision=1e4,updateLimit=0;function easeOutBouncefunc(t){return(t/=1)<1/2.75?result=7.5625*t*t*1+0:result=t<2/2.75?1*(7.5625*(t-=1.5/2.75)*t+.75)+0:t<2.5/2.75?1*(7.5625*(t-=2.25/2.75)*t+.9375)+0:1*(7.5625*(t-=2.625/2.75)*t+.984375)+0,result}function integerize(t,e){return Math.round(t/e*litetween_precision)}function easeFunc(t,e,i,s,n,r,o){var a=0;switch(t){case 0:a=s*e/n+i;break;case 1:a=s*(e/=n)*e+i;break;case 2:a=-s*(e/=n)*(e-2)+i;break;case 3:a=(e/=n/2)<1?s/2*e*e+i:-s/2*(--e*(e-2)-1)+i;break;case 4:a=s*(e/=n)*e*e+i;break;case 5:a=s*((e=e/n-1)*e*e+1)+i;break;case 6:a=(e/=n/2)<1?s/2*e*e*e+i:s/2*((e-=2)*e*e+2)+i;break;case 7:a=s*(e/=n)*e*e*e+i;break;case 8:a=-s*((e=e/n-1)*e*e*e-1)+i;break;case 9:a=(e/=n/2)<1?s/2*e*e*e*e+i:-s/2*((e-=2)*e*e*e-2)+i;break;case 10:a=s*(e/=n)*e*e*e*e+i;break;case 11:a=s*((e=e/n-1)*e*e*e*e+1)+i;break;case 12:a=(e/=n/2)<1?s/2*e*e*e*e*e+i:s/2*((e-=2)*e*e*e*e+2)+i;break;case 13:a=o.optimized?easeInCircle[integerize(e,n)]:-(Math.sqrt(1-e*e)-1);break;case 14:a=o.optimized?easeOutCircle[integerize(e,n)]:Math.sqrt(1-(e-1)*(e-1));break;case 15:a=o.optimized?easeInOutCircle[integerize(e,n)]:(e/=n/2)<1?-s/2*(Math.sqrt(1-e*e)-1)+i:s/2*(Math.sqrt(1-(e-=2)*e)+1)+i;break;case 16:if(o.optimized)a=easeInBack[integerize(e,n)];else a=s*(e/=n)*e*(((h=o.s)+1)*e-h)+i;break;case 17:if(o.optimized)a=easeOutBack[integerize(e,n)];else a=s*((e=e/n-1)*e*(((h=o.s)+1)*e+h)+1)+i;break;case 18:if(o.optimized)a=easeInOutBack[integerize(e,n)];else{var h=o.s;a=(e/=n/2)<1?s/2*(e*e*((1+(h*=1.525))*e-h))+i:s/2*((e-=2)*e*((1+(h*=1.525))*e+h)+2)+i}break;case 19:if(o.optimized)a=easeInElasticArray[integerize(e,n)];else{var c=o.a;h=0;if(0==e&&(a=i),1==(e/=n)&&(a=i+s),0==(l=o.p)&&(l=.3*n),0==c||c<Math.abs(s))c=s,h=l/4;else h=l/(2*Math.PI)*Math.asin(s/c);a=-c*Math.pow(2,10*(e-=1))*Math.sin((e*n-h)*(2*Math.PI)/l)+i}break;case 20:if(o.optimized)a=easeOutElasticArray[integerize(e,n)];else{c=o.a,h=0;if(0==e&&(a=i),1==(e/=n)&&(a=i+s),0==(l=o.p)&&(l=.3*n),0==c||c<Math.abs(s)){c=s;h=l/4}else h=l/(2*Math.PI)*Math.asin(s/c);a=c*Math.pow(2,-10*e)*Math.sin((e*n-h)*(2*Math.PI)/l)+s+i}break;case 21:if(o.optimized)a=easeInOutElasticArray[integerize(e,n)];else{var l;c=o.a,h=0;if(0==e&&(a=i),2==(e/=n/2)&&(a=i+s),0==(l=o.p)&&(l=n*(.3*1.5)),0==c||c<Math.abs(s)){c=s;h=l/4}else h=l/(2*Math.PI)*Math.asin(s/c);a=e<1?c*Math.pow(2,10*(e-=1))*Math.sin((e*n-h)*(2*Math.PI)/l)*-.5+i:c*Math.pow(2,-10*(e-=1))*Math.sin((e*n-h)*(2*Math.PI)/l)*.5+s+i}break;case 22:a=o.optimized?s-easeOutBounceArray[integerize(n-e,n)]+i:s-easeOutBouncefunc(n-e/n)+i;break;case 23:a=o.optimized?easeOutBounceArray[integerize(e,n)]:easeOutBouncefunc(e/n);break;case 24:a=o.optimized?e<n/2?.5*(s-easeOutBounceArray[integerize(n-2*e,n)]+i)+i:.5*easeOutBounceArray[integerize(2*e-n,n)]+.5*s+i:e<n/2?.5*(s-easeOutBouncefunc(n-2*e)+i)+i:.5*easeOutBouncefunc((2*e-n)/n)+.5*s+i;break;case 25:a=(u=e/n/2)*u*(3-2*u)*2;break;case 26:a=(u=(e/n+1)/2)*u*(3-2*u)*2-1;break;case 27:var u;a=(u=e/n)*u*(3-2*u)}return r?s-i-a:a}!function(){for(var t=0,e=0,i=0,s=0,n=0,r=0;r<=litetween_precision;r++){if(s=r/litetween_precision,t=(s/=1)<1/2.75?7.5625*s*s*1+0:s<2/2.75?1*(7.5625*(s-=1.5/2.75)*s+.75)+0:s<2.5/2.75?1*(7.5625*(s-=2.25/2.75)*s+.9375)+0:1*(7.5625*(s-=2.625/2.75)*s+.984375)+0,easeOutBounceArray[r]=t,0==(s=r/litetween_precision)&&(t=0),1==(s/=1)&&(t=1),0==(i=0)&&(i=.3),0==(e=0)||e<Math.abs(1)){e=1;n=i/4}else n=i/(2*Math.PI)*Math.asin(1/e);if(t=-e*Math.pow(2,10*(s-=1))*Math.sin((1*s-n)*(2*Math.PI)/i)+0,easeInElasticArray[r]=t,0==(s=r/litetween_precision)&&(t=0),1==(s/=1)&&(t=1),0==(i=0)&&(i=.3),0==(e=0)||e<Math.abs(1)){e=1;n=i/4}else n=i/(2*Math.PI)*Math.asin(1/e);if(t=e*Math.pow(2,-10*s)*Math.sin((1*s-n)*(2*Math.PI)/i)+1+0,easeOutElasticArray[r]=t,0==(s=r/litetween_precision)&&(t=0),2==(s/=.5)&&(t=1),0==(i=0)&&(i=.3*1.5*1),0==(e=0)||e<Math.abs(1)){e=1;n=i/4}else n=i/(2*Math.PI)*Math.asin(1/e);t=s<1?e*Math.pow(2,10*(s-=1))*Math.sin((1*s-n)*(2*Math.PI)/i)*-.5+0:e*Math.pow(2,-10*(s-=1))*Math.sin((1*s-n)*(2*Math.PI)/i)*.5+1+0,easeInOutElasticArray[r]=t,s=r/litetween_precision,easeInCircle[r]=-(Math.sqrt(1-s*s)-1),s=r/litetween_precision,easeOutCircle[r]=Math.sqrt(1-(s-1)*(s-1)),s=r/litetween_precision,t=(s/=.5)<1?-.5*(Math.sqrt(1-s*s)-1)+0:.5*(Math.sqrt(1-(s-=2)*s)+1)+0,easeInOutCircle[r]=t,s=r/litetween_precision,0==(n=0)&&(n=1.70158),t=1*(s/=1)*s*((n+1)*s-n)+0,easeInBack[r]=t,0==(n=0)&&(n=1.70158),t=1*((s=(s=r/litetween_precision)/1-1)*s*((n+1)*s+n)+1)+0,easeOutBack[r]=t,s=r/litetween_precision,0==(n=0)&&(n=1.70158),t=(s/=.5)<1?s*s*((1+(n*=1.525))*s-n)*.5+0:.5*((s-=2)*s*((1+(n*=1.525))*s+n)+2)+0,easeInOutBack[r]=t}}();var TweenObject=function(t,e,i,s,n,r,o){this.name=t,this.value=0,this.setInitial(s),this.setTarget(n),this.easefunc=i,this.tweened=e,this.duration=r,this.progress=0,this.state=0,this.onStart=!1,this.onEnd=!1,this.onReverseStart=!1,this.onReverseEnd=!1,this.lastKnownValue=0,this.lastKnownValue2=0,this.enforce=o,this.pingpong=1,this.flipEase=!1,this.easingparam=[],this.lastState=1;for(var a=0;a<28;a++)this.easingparam[a]={},this.easingparam[a].a=0,this.easingparam[a].p=0,this.easingparam[a].t=0,this.easingparam[a].s=0,this.easingparam[a].optimized=!0};function trim(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function trim(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}TweenObject.prototype={},TweenObject.prototype.flipTarget=function(){var t=this.initialparam1,e=this.initialparam2;this.initialparam1=this.targetparam1,this.initialparam2=this.targetparam2,this.targetparam1=t,this.targetparam2=e,this.lastKnownValue=0,this.lastKnownValue2=0},TweenObject.prototype.setInitial=function(t){this.initialparam1=parseFloat(t.split(",")[0]),this.initialparam2=parseFloat(t.split(",")[1]),this.lastKnownValue=0,this.lastKnownValue2=0},TweenObject.prototype.setTarget=function(t){this.targetparam1=parseFloat(t.split(",")[0]),this.targetparam2=parseFloat(t.split(",")[1]),isNaN(this.targetparam2)&&(this.targetparam2=this.targetparam1)},TweenObject.prototype.OnTick=function(t){if(0===this.state)return-1;if(1===this.state&&(this.progress+=t),2===this.state&&(this.progress-=t),3===this.state&&(this.state=0),4!==this.state&&6!==this.state||(this.progress+=t*this.pingpong),5===this.state&&(this.progress+=t*this.pingpong),this.progress<0)return this.progress=0,4===this.state?this.pingpong=1:6===this.state?(this.pingpong=1,this.flipEase=!1):this.state=0,this.onReverseEnd=!0,0;if(this.progress>this.duration)return this.progress=this.duration,4===this.state?this.pingpong=-1:6===this.state?(this.pingpong=-1,this.flipEase=!0):5===this.state?this.progress=0:this.state=0,this.onEnd=!0,1;if(this.flipEase)var e=easeFunc(this.easefunc,this.duration-this.progress,0,1,this.duration,this.flipEase,this.easingparam[this.easefunc]);else e=easeFunc(this.easefunc,this.progress,0,1,this.duration,this.flipEase,this.easingparam[this.easefunc]);return e},cr.behaviors.lunarray_LiteTween=function(t){this.runtime=t},function(){var t=cr.behaviors.lunarray_LiteTween.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,this.i=0};var e=t.Instance.prototype;e.onCreate=function(){this.playmode=this.properties[0],this.active=1==this.playmode||2==this.playmode||3==this.playmode||4==this.playmode,this.tweened=this.properties[1],this.easing=this.properties[2],this.target=this.properties[3],this.targetmode=this.properties[4],this.useCurrent=!1,1===this.targetmode&&(this.target="relative("+this.target+")"),this.duration=this.properties[5],this.enforce=1===this.properties[6],this.value=0,this.tween_list={},this.addToTweenList("default",this.tweened,this.easing,"current",this.target,this.duration,this.enforce),1===this.properties[0]&&this.startTween(0),2===this.properties[0]&&this.startTween(2),3===this.properties[0]&&this.startTween(3),4===this.properties[0]&&this.startTween(4)},e.parseCurrent=function(t,e){void 0===e&&(e="current");var i=trim(e);e=trim(e);var s=this.value;if("current"===e)switch(t){case 0:case 7:case 8:i=this.inst.x+","+this.inst.y;break;case 1:case 2:case 3:i=this.inst.width+","+this.inst.height;break;case 4:i=cr.to_degrees(this.inst.angle)+","+cr.to_degrees(this.inst.angle);break;case 5:i=100*this.inst.opacity+","+100*this.inst.opacity;break;case 6:i=s+","+s;break;case 9:i=void 0!==this.inst.curFrame?this.inst.width/this.inst.curFrame.width+","+this.inst.height/this.inst.curFrame.height:"1,1"}if("relative"===e.substring(0,8)){var n=e.match(/\((.*?)\)/);if(n)var r=parseFloat(n[1].split(",")[0]),o=parseFloat(n[1].split(",")[1]);switch(isNaN(r)&&(r=0),isNaN(o)&&(o=0),t){case 0:i=this.inst.x+r+","+(this.inst.y+o);break;case 1:case 2:case 3:i=this.inst.width+r+","+(this.inst.height+o);break;case 4:i=cr.to_degrees(this.inst.angle)+r+","+(cr.to_degrees(this.inst.angle)+o);break;case 5:i=100*this.inst.opacity+r+","+(100*this.inst.opacity+o);break;case 6:i=s+r+","+s+r;break;case 7:i=this.inst.x+r+","+this.inst.y;break;case 8:i=this.inst.x+","+(this.inst.y+r);break;case 9:i=r+","+o}}return i},e.addToTweenList=function(t,e,i,s,n,r,o){s=this.parseCurrent(e,s),n=this.parseCurrent(e,n),void 0!==this.tween_list[t]&&delete this.tween_list[t],this.tween_list[t]=new TweenObject(t,e,i,s,n,r,o),this.tween_list[t].dt=0},e.saveToJSON=function(){JSON.stringify(this.tween_list.default);return{playmode:this.playmode,active:this.active,tweened:this.tweened,easing:this.easing,target:this.target,targetmode:this.targetmode,useCurrent:this.useCurrent,duration:this.duration,enforce:this.enforce,value:this.value,tweenlist:JSON.stringify(this.tween_list.default)}},TweenObject.Load=function(t,e,i,s,n,r,o,a){var h=new TweenObject(e,i,s,n,r,o,a);for(var c in t)h[c]=t[c];return h},e.loadFromJSON=function(t){var e=JSON.parse(t.tweenlist),i=TweenObject.Load(e,e.name,e.tweened,e.easefunc,e.initialparam1+","+e.initialparam2,e.targetparam1+","+e.targetparam2,e.duration,e.enforce);this.tween_list.default=i,this.playmode=t.playmode,this.active=t.active,this.movement=t.tweened,this.easing=t.easing,this.target=t.target,this.targetmode=t.targetmode,this.useCurrent=t.useCurrent,this.duration=t.duration,this.enforce=t.enforce,this.value=t.value},e.setProgressTo=function(t){for(var e in t>1&&(t=1),t<0&&(t=0),this.tween_list){var i=this.tween_list[e];i.lastKnownValue=0,i.lastKnownValue2=0,i.state=3,i.progress=t*i.duration;var s=i.OnTick(0);this.updateTween(i,s)}},e.startTween=function(t){for(var e in this.tween_list){var i=this.tween_list[e];if(this.useCurrent){var s=this.parseCurrent(i.tweened,"current"),n=this.parseCurrent(i.tweened,this.target);i.setInitial(s),i.setTarget(n)}0===t&&(i.progress=1e-6,i.lastKnownValue=0,i.lastKnownValue2=0,i.onStart=!0,i.state=1),1===t&&(i.state=i.lastState),2!==t&&4!==t||(i.progress=1e-6,i.lastKnownValue=0,i.lastKnownValue2=0,i.onStart=!0,2==t&&(i.state=4),4==t&&(i.state=6)),3===t&&(i.progress=1e-6,i.lastKnownValue=0,i.lastKnownValue2=0,i.onStart=!0,i.state=5)}},e.stopTween=function(t){for(var e in this.tween_list){var i=this.tween_list[e];3!=i.state&&0!=i.state&&(i.lastState=i.state),1===t&&(i.progress=0),2===t&&(i.progress=i.duration),i.state=3;var s=i.OnTick(0);this.updateTween(i,s)}},e.reverseTween=function(t){for(var e in this.tween_list){var i=this.tween_list[e];1===t&&(i.progress=i.duration,i.lastKnownValue=0,i.lastKnownValue2=0,i.onReverseStart=!0),i.state=2}},e.updateTween=function(t,e){if(0===t.tweened)t.enforce?(this.inst.x=t.initialparam1+(t.targetparam1-t.initialparam1)*e,this.inst.y=t.initialparam2+(t.targetparam2-t.initialparam2)*e):(this.inst.x+=(t.targetparam1-t.initialparam1)*e-t.lastKnownValue,this.inst.y+=(t.targetparam2-t.initialparam2)*e-t.lastKnownValue2,t.lastKnownValue=(t.targetparam1-t.initialparam1)*e,t.lastKnownValue2=(t.targetparam2-t.initialparam2)*e);else if(1===t.tweened)t.enforce?(this.inst.width=t.initialparam1+(t.targetparam1-t.initialparam1)*e,this.inst.height=t.initialparam2+(t.targetparam2-t.initialparam2)*e):(this.inst.width+=(t.targetparam1-t.initialparam1)*e-t.lastKnownValue,this.inst.height+=(t.targetparam2-t.initialparam2)*e-t.lastKnownValue2,t.lastKnownValue=(t.targetparam1-t.initialparam1)*e,t.lastKnownValue2=(t.targetparam2-t.initialparam2)*e);else if(2===t.tweened)t.enforce?this.inst.width=t.initialparam1+(t.targetparam1-t.initialparam1)*e:(this.inst.width+=(t.targetparam1-t.initialparam1)*e-t.lastKnownValue,t.lastKnownValue=(t.targetparam1-t.initialparam1)*e);else if(3===t.tweened)t.enforce?this.inst.height=t.initialparam2+(t.targetparam2-t.initialparam2)*e:(this.inst.height+=(t.targetparam2-t.initialparam2)*e-t.lastKnownValue2,t.lastKnownValue2=(t.targetparam2-t.initialparam2)*e);else if(4===t.tweened)if(t.enforce){var i=t.initialparam1+(t.targetparam1-t.initialparam1)*e;this.inst.angle=cr.clamp_angle(cr.to_radians(i))}else{i=(t.targetparam1-t.initialparam1)*e-t.lastKnownValue;this.inst.angle=cr.clamp_angle(this.inst.angle+cr.to_radians(i)),t.lastKnownValue=(t.targetparam1-t.initialparam1)*e}else if(5===t.tweened)t.enforce?this.inst.opacity=(t.initialparam1+(t.targetparam1-t.initialparam1)*e)/100:(this.inst.opacity+=((t.targetparam1-t.initialparam1)*e-t.lastKnownValue)/100,t.lastKnownValue=(t.targetparam1-t.initialparam1)*e);else if(6===t.tweened)t.enforce?this.value=t.initialparam1+(t.targetparam1-t.initialparam1)*e:(this.value+=(t.targetparam1-t.initialparam1)*e-t.lastKnownValue,t.lastKnownValue=(t.targetparam1-t.initialparam1)*e);else if(7===t.tweened)t.enforce?this.inst.x=t.initialparam1+(t.targetparam1-t.initialparam1)*e:(this.inst.x+=(t.targetparam1-t.initialparam1)*e-t.lastKnownValue,t.lastKnownValue=(t.targetparam1-t.initialparam1)*e);else if(8===t.tweened)t.enforce?this.inst.y=t.initialparam2+(t.targetparam2-t.initialparam2)*e:(this.inst.y+=(t.targetparam2-t.initialparam2)*e-t.lastKnownValue2,t.lastKnownValue2=(t.targetparam2-t.initialparam2)*e);else if(9===t.tweened){var s=t.initialparam1+(t.targetparam1-t.initialparam1)*e,n=t.initialparam2+(t.targetparam2-t.initialparam2)*e;this.inst.width<0&&(s=t.initialparam1+(t.targetparam1+t.initialparam1)*-e),this.inst.height<0&&(n=t.initialparam2+(t.targetparam2+t.initialparam2)*-e),t.enforce?(this.inst.width=this.inst.curFrame.width*s,this.inst.height=this.inst.curFrame.height*n):(this.inst.width<0?(this.inst.width=s*(this.inst.width/(-1+t.lastKnownValue)),t.lastKnownValue=s+1):(this.inst.width=s*(this.inst.width/(1+t.lastKnownValue)),t.lastKnownValue=s-1),this.inst.height<0?(this.inst.height=n*(this.inst.height/(-1+t.lastKnownValue2)),t.lastKnownValue2=n+1):(this.inst.height=n*(this.inst.height/(1+t.lastKnownValue2)),t.lastKnownValue2=n-1))}this.inst.set_bbox_changed()},e.tick=function(){var t=this.runtime.getDt(this.inst),e=this.tween_list.default;if(0!==e.state){e.onStart&&(this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnStart,this.inst),e.onStart=!1),e.onReverseStart&&(this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnReverseStart,this.inst),e.onReverseStart=!1),this.active=1==e.state||2==e.state||4==e.state||5==e.state||6==e.state;var i=e.OnTick(t);this.updateTween(e,i),e.onEnd&&(this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnEnd,this.inst),e.onEnd=!1),e.onReverseEnd&&(this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnReverseEnd,this.inst),e.onReverseEnd=!1)}},t.cnds={};var i=t.cnds;i.IsActive=function(){return 0!==this.tween_list.default.state},i.IsReversing=function(){return 2==this.tween_list.default.state},i.CompareProgress=function(t,e){var i=this.tween_list.default;return cr.do_cmp(i.progress/i.duration,t,e)},i.OnThreshold=function(t,e){var i=this.tween_list.default;this.threshold=cr.do_cmp(i.progress/i.duration,t,e);var s=this.oldthreshold!=this.threshold&&this.threshold;return s&&(this.oldthreshold=this.threshold),s},i.OnStart=function(){return void 0!==this.tween_list.default&&this.tween_list.default.onStart},i.OnReverseStart=function(){return void 0!==this.tween_list.default&&this.tween_list.default.onReverseStart},i.OnEnd=function(){return void 0!==this.tween_list.default&&this.tween_list.default.onEnd},i.OnReverseEnd=function(){return void 0!==this.tween_list.default&&this.tween_list.default.onReverseEnd},t.acts={};var s=t.acts;s.Start=function(t,e){this.threshold=!1,this.oldthreshold=!1,this.useCurrent=1==e,this.startTween(t)},s.Stop=function(t){this.stopTween(t)},s.Reverse=function(t){this.threshold=!1,this.oldthreshold=!1,this.reverseTween(t)},s.ProgressTo=function(t){this.setProgressTo(t)},s.SetDuration=function(t){isNaN(t)||t<0||void 0!==this.tween_list.default&&(this.tween_list.default.duration=t)},s.SetEnforce=function(t){void 0!==this.tween_list.default&&(this.tween_list.default.enforce=1===t)},s.SetInitial=function(t){if(void 0!==this.tween_list.default){var e=this.parseCurrent(this.tween_list.default.tweened,t);this.tween_list.default.setInitial(e)}},s.SetTarget=function(t,e,i){if(void 0!==this.tween_list.default&&!isNaN(i)){var s=this.tween_list.default,n=i+"";this.targetmode=e;var r="",o="";if(1===e){switch(this.target="relative("+n+")",t){case 0:r=this.inst.x+i,o=s.targetparam2;break;case 1:r=s.targetparam1,o=this.inst.y+i;break;case 2:o=r=""+cr.to_degrees(this.inst.angle+cr.to_radians(i));break;case 3:o=r=""+100*this.inst.opacity+i;break;case 4:r=this.inst.width+i,o=s.targetparam2;break;case 5:r=s.targetparam1,o=this.inst.height+i;break;case 6:r=i,o=i}n=r+","+o}else{switch(t){case 0:case 4:r=i,o=s.targetparam2;break;case 1:case 5:r=s.targetparam1,o=i;break;case 2:case 3:case 6:r=i,o=i}n=r+","+o,this.target=n}var a=this.parseCurrent(this.tween_list.default.tweened,"current"),h=this.parseCurrent(this.tween_list.default.tweened,n);s.setInitial(a),s.setTarget(h)}},s.SetTweenedProperty=function(t){void 0!==this.tween_list.default&&(this.tween_list.default.tweened=t)},s.SetEasing=function(t){void 0!==this.tween_list.default&&(this.tween_list.default.easefunc=t)},s.SetEasingParam=function(t,e,i,s,n){void 0!==this.tween_list.default&&(this.tween_list.default.easingparam[t].optimized=!1,this.tween_list.default.easingparam[t].a=e,this.tween_list.default.easingparam[t].p=i,this.tween_list.default.easingparam[t].t=s,this.tween_list.default.easingparam[t].s=n)},s.ResetEasingParam=function(){void 0!==this.tween_list.default&&(this.tween_list.default.optimized=!0)},s.SetValue=function(t){var e=this.tween_list.default;this.value=t,6===e.tweened&&e.setInitial(this.parseCurrent(e.tweened,"current"))},s.SetParameter=function(t,e,i,s,n){if(void 0===this.tween_list.default)this.addToTweenList("default",t,e,initial,i,s,n,0);else{var r=this.tween_list.default;r.tweened=t,r.easefunc=e,r.setInitial(this.parseCurrent(t,"current")),r.setTarget(this.parseCurrent(t,i)),r.duration=s,r.enforce=1===n}},t.exps={};var n=t.exps;n.State=function(t){var e="N/A";switch(this.tween_list.default.state){case 0:e="paused";break;case 1:e="playing";break;case 2:e="reversing";break;case 3:e="seeking"}t.set_string(e)},n.Progress=function(t){var e=this.tween_list.default.progress/this.tween_list.default.duration;t.set_float(e)},n.Duration=function(t){t.set_float(this.tween_list.default.duration)},n.Target=function(t){var e=this.tween_list.default,i="N/A";switch(e.tweened){case 0:case 2:case 3:case 4:case 6:i=e.targetparam1;break;case 1:case 5:i=e.targetparam2}t.set_float(i)},n.Value=function(t){var e=this.value;t.set_float(e)},n.Tween=function(t,e,i,s,n){var r=s>1?1:s,o=easeFunc(n,r<0?0:r,0,1,1,!1,!1);t.set_float(e+o*(i-e))}}(),cr.behaviors.lunarray_Tween=function(t){this.runtime=t},function(){var t=cr.behaviors.lunarray_Tween.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime,this.i=0};var e=t.Instance.prototype;function i(t,e,i,s){return(t/=s)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}e.groupUpdateProgress=function(t){t>1&&(t=1),(cr.lunarray_tweenProgress[this.group]=-1)&&(cr.lunarray_tweenProgress[this.group]=t),cr.lunarray_tweenProgress[this.group]>=t&&(cr.lunarray_tweenProgress[this.group]=t)},e.groupSync=function(){""!=this.group&&(void 0===cr.lunarray_tweenGroup&&(cr.lunarray_tweenGroup={},cr.lunarray_tweenProgress={}),void 0===cr.lunarray_tweenGroup[this.group]&&(cr.lunarray_tweenGroup[this.group]=[],cr.lunarray_tweenProgress[this.group]=-1),-1==cr.lunarray_tweenGroup[this.group].indexOf(this)&&cr.lunarray_tweenGroup[this.group].push(this))},e.saveState=function(){this.tweenSaveWidth=this.inst.width,this.tweenSaveHeight=this.inst.height,this.tweenSaveAngle=this.inst.angle,this.tweenSaveOpacity=this.inst.opacity,this.tweenSaveX=this.inst.x,this.tweenSaveY=this.inst.y,this.tweenSaveValue=this.value},e.onCreate=function(){this.active=1===this.properties[0],this.tweened=this.properties[1],this.easing=this.properties[2],this.initial=this.properties[3],this.target=this.properties[4],this.duration=this.properties[5],this.wait=this.properties[6],this.playmode=this.properties[7],this.value=this.properties[8],this.coord_mode=this.properties[9],this.forceInit=1===this.properties[10],this.group=this.properties[11],this.targetObject=null,this.pingpongCounter=0,5==this.playmode&&(this.pingpongCounter=1),this.groupSync(),this.isPaused=!1,this.initialX=this.inst.x,this.initialY=this.inst.y,this.targetX=parseFloat(this.target.split(",")[0]),this.targetY=parseFloat(this.target.split(",")[1]),this.saveState(),this.tweenInitialX=0,this.tweenInitialY=0,this.tweenTargetX=0,this.tweenTargetY=0,this.tweenTargetAngle=0,this.ratio=this.inst.height/this.inst.width,this.reverse=!1,this.rewindMode=!1,this.doTweenX=!0,this.doTweenY=!0,this.loop=!1,this.initiating=0,this.cooldown=0,this.lastPlayMode=this.playmode,this.lastKnownValue=this.tweenInitialX,this.lastKnownX=this.tweenInitialX,this.lastKnownY=this.tweenInitialY,this.forceInit&&this.init(),""==this.initial&&(this.initial="current"),this.onStarted=!1,this.onStartedDone=!1,this.onWaitEnd=!1,this.onWaitEndDone=!1,this.onEnd=!1,this.onEndDone=!1,this.onCooldown=!1,this.onCooldownDone=!1,this.active&&this.init()},e.init=function(){this.onStarted=!1,""===this.initial&&(this.initial="current"),""===this.target&&(this.target="current");var t="current"===this.initial,e="current"===this.target,i="OBJ"===this.target;if("OBJ"===this.target&&null!=this.targetObject&&(0==this.tweened?1==this.coord_mode?this.target=this.targetObject.x-this.inst.x+","+(this.targetObject.y-this.inst.y):this.target=this.targetObject.x+","+this.targetObject.y:1==this.tweened||2==this.tweened||3==this.tweened||7==this.tweened?1==this.coord_mode?this.target=(2==this.tweened?1:this.targetObject.width)+","+(3==this.tweened?1:this.targetObject.height):this.target=(2==this.tweened?1:this.targetObject.width/this.tweenSaveWidth)+","+(3==this.tweened?1:this.targetObject.height/this.tweenSaveHeight):4==this.tweened?1==this.coord_mode?this.target=cr.to_degrees(this.targetObject.angle-this.inst.angle)+"":this.target=cr.to_degrees(this.targetObject.angle)+"":5==this.tweened&&(1==this.coord_mode?this.target=100*(this.targetObject.opacity-this.inst.opacity)+"":this.target=100*this.targetObject.opacity+"")),0==this.tweened)e&&(this.target=this.inst.x+","+this.inst.y),t?1==this.coord_mode?this.initial=this.inst.x+","+this.inst.y:this.initial=this.tweenSaveX+","+this.tweenSaveY:this.reverse||1!=this.playmode&&(this.inst.x=parseFloat(this.initial.split(",")[0]),this.inst.y=parseFloat(this.initial.split(",")[1])),1==this.coord_mode?(this.loop&&(this.inst.x=this.tweenSaveX,this.inst.y=this.tweenSaveY),this.initialX=this.inst.x,this.initialY=this.inst.y,this.reverse?(this.targetX=-parseFloat(this.target.split(",")[0]),this.targetY=-parseFloat(this.target.split(",")[1])):(this.targetX=parseFloat(this.target.split(",")[0]),this.targetY=parseFloat(this.target.split(",")[1])),this.tweenInitialX=this.initialX,this.tweenInitialY=this.initialY,this.tweenTargetX=this.tweenInitialX+this.targetX,this.tweenTargetY=this.tweenInitialY+this.targetY):(this.reverse?(this.inst.x=parseFloat(this.target.split(",")[0]),this.inst.y=parseFloat(this.target.split(",")[1]),this.targetX=this.tweenSaveX,this.targetY=this.tweenSaveY):(this.inst.x=this.tweenSaveX,this.inst.y=this.tweenSaveY,this.targetX=parseFloat(this.target.split(",")[0]),this.targetY=parseFloat(this.target.split(",")[1])),this.initialX=this.inst.x,this.initialY=this.inst.y,this.tweenInitialX=this.initialX,this.tweenInitialY=this.initialY,this.tweenTargetX=this.targetX,this.tweenTargetY=this.targetY,-6==this.playmode&&(this.tweenTargetX=this.tweenSaveX,this.tweenTargetY=this.tweenSaveY));else if(1==this.tweened||2==this.tweened||3==this.tweened){e&&(this.target="1,1"),"current"==this.initial&&(this.initial="1,1"),this.initial=""+this.initial,this.target=""+this.target,2==this.tweened?(-1==this.initial.indexOf(",")&&(this.initial=parseFloat(this.initial)+",1"),-1==this.target.indexOf(",")&&(this.target=parseFloat(this.target)+",1")):3==this.tweened?(-1==this.initial.indexOf(",")&&(this.initial="1,"+parseFloat(this.initial)),-1==this.target.indexOf(",")&&(this.target="1,"+parseFloat(this.target))):(-1==this.initial.indexOf(",")&&(this.initial=parseFloat(this.initial)+","+parseFloat(this.initial)),-1==this.target.indexOf(",")&&(this.target=parseFloat(this.target)+","+parseFloat(this.target)));var s=parseFloat(this.initial.split(",")[0]),n=parseFloat(this.initial.split(",")[1]);this.doTweenX=!0,(0==(r=parseFloat(this.target.split(",")[0]))||isNaN(r))&&(this.doTweenX=!1),3==this.tweened&&(this.doTweenX=!1),this.doTweenY=!0,(0==(o=parseFloat(this.target.split(",")[1]))||isNaN(o))&&(this.doTweenY=!1),2==this.tweened&&(this.doTweenY=!1),1==this.coord_mode?(this.loop&&(this.inst.width=this.tweenSaveWidth,this.inst.height=this.tweenSaveHeight),t||(this.reverse?(this.inst.width=this.inst.width*r,this.inst.height=this.inst.height*o):(this.inst.width=this.inst.width*s,this.inst.height=this.inst.height*n)),this.initialX=this.inst.width,this.initialY=this.inst.height,this.tweenInitialX=this.initialX,this.tweenInitialY=this.initialY,this.reverse?(this.targetX=this.initialX*s/r,this.targetY=this.initialY*n/o):(this.targetX=this.initialX*r,this.targetY=this.initialY*o),this.tweenTargetX=this.targetX,this.tweenTargetY=this.targetY):(t||(this.reverse?(this.inst.width=this.tweenSaveWidth*r,this.inst.height=this.tweenSaveHeight*o):(this.inst.width=this.tweenSaveWidth*s,this.inst.height=this.tweenSaveHeight*n)),this.initialX=this.inst.width,this.initialY=this.inst.height,this.tweenInitialX=this.initialX,this.tweenInitialY=this.initialY,this.reverse?(this.targetX=this.tweenSaveWidth*s,this.targetY=this.tweenSaveHeight*n):(this.targetX=this.tweenSaveWidth*r,this.targetY=this.tweenSaveHeight*o),this.tweenTargetX=this.targetX,this.tweenTargetY=this.targetY),-6==this.playmode&&(this.tweenTargetX=this.tweenSaveWidth*s,this.tweenTargetY=this.tweenSaveHeight*n)}else if(4==this.tweened)e&&(this.target=cr.to_degrees(this.inst.angle)),"current"!=this.initial&&(this.reverse||1!=this.playmode&&(this.inst.angle=cr.to_radians(parseFloat(this.initial.split(",")[0])))),1==this.coord_mode?(this.loop&&(this.inst.angle=this.tweenSaveAngle),this.initialX=this.inst.angle,this.reverse?this.targetX=this.inst.angle-cr.to_radians(parseFloat(this.target.split(",")[0])):this.targetX=this.inst.angle+cr.to_radians(parseFloat(this.target.split(",")[0])),this.tweenInitialX=this.initialX,this.tweenTargetX=cr.to_degrees(this.targetX)):this.reverse?(this.inst.angle=cr.to_radians(parseFloat(this.target.split(",")[0])),this.initialX=this.inst.angle,this.targetX=this.tweenSaveAngle,this.tweenInitialX=this.initialX,this.tweenTargetX=cr.to_degrees(this.targetX)):(this.inst.angle=this.tweenSaveAngle,this.initialX=this.inst.angle,this.targetX=cr.to_radians(parseFloat(this.target.split(",")[0])),this.tweenInitialX=this.initialX,this.tweenTargetX=cr.to_degrees(this.targetX)),-6==this.playmode&&(this.tweenTargetX=cr.to_degrees(this.tweenSaveAngle)),this.tweenTargetAngle=cr.to_radians(this.tweenTargetX);else if(5==this.tweened)"current"==this.initial&&(this.initial=this.inst.opacity),e&&(this.target=""+this.inst.opacity),t||this.reverse||1!=this.playmode&&(this.inst.opacity=parseFloat(this.initial.split(",")[0])/100),1==this.coord_mode?(this.loop&&(this.inst.opacity=this.tweenSaveOpacity),this.initialX=this.inst.opacity,this.tweenInitialX=this.initialX,this.reverse?this.targetX=-parseFloat(this.target.split(",")[0])/100:this.targetX=parseFloat(this.target.split(",")[0])/100,this.tweenTargetX=this.tweenInitialX+this.targetX):(this.initialX=this.inst.opacity,this.reverse?(this.tweenInitialX=parseFloat(this.target.split(",")[0])/100,this.targetX=parseFloat(this.initial.split(",")[0])/100):(this.tweenInitialX=this.initialX,this.targetX=parseFloat(this.target.split(",")[0])/100),this.tweenTargetX=this.targetX),-6==this.playmode&&(this.tweenTargetX=this.tweenSaveOpacity);else if(6==this.tweened)isNaN(this.value)&&(this.value=0),"current"==this.initial&&(this.initial=""+this.value),e&&(this.target=""+this.value),t||this.reverse||1!=this.playmode&&(this.value=parseFloat(this.initial.split(",")[0])),1==this.coord_mode?(this.loop&&(this.value=this.tweenSaveValue),t||(this.reverse?this.value=parseFloat(this.target.split(",")[0]):this.value=parseFloat(this.initial.split(",")[0])),this.initialX=this.value,this.reverse?this.targetX=this.initialX-parseFloat(this.target.split(",")[0]):this.targetX=this.initialX+parseFloat(this.target.split(",")[0]),this.tweenInitialX=this.initialX,this.tweenTargetX=this.targetX):(t||(this.reverse?this.value=parseFloat(this.target.split(",")[0]):this.value=parseFloat(this.initial.split(",")[0])),this.initialX=this.value,this.reverse?this.targetX=parseFloat(this.initial.split(",")[0]):this.targetX=parseFloat(this.target.split(",")[0]),this.tweenInitialX=this.initialX,this.tweenTargetX=this.targetX),-6==this.playmode&&(this.tweenTargetX=this.tweenSaveValue);else if(7==this.tweened){var r,o;e&&(this.target=this.inst.width+","+this.inst.height),"current"!=this.initial&&(this.reverse||1!=this.playmode&&(this.inst.width=parseFloat(this.initial.split(",")[0]),this.inst.height=parseFloat(this.initial.split(",")[1]))),this.doTweenX=!0,((r=parseFloat(this.target.split(",")[0]))<0||isNaN(r))&&(this.doTweenX=!1),this.doTweenY=!0,((o=parseFloat(this.target.split(",")[1]))<0||isNaN(o))&&(this.doTweenY=!1),1==this.coord_mode?(this.loop&&(this.inst.width=this.tweenSaveWidth,this.inst.height=this.tweenSaveHeight),this.initialX=this.inst.width,this.initialY=this.inst.height,this.reverse?(this.targetX=this.initialX-parseFloat(this.target.split(",")[0]),this.targetY=this.initialY-parseFloat(this.target.split(",")[1])):(this.targetX=this.initialX+parseFloat(this.target.split(",")[0]),this.targetY=this.initialY+parseFloat(this.target.split(",")[1])),this.tweenInitialX=this.initialX,this.tweenInitialY=this.initialY,this.tweenTargetX=this.targetX,this.tweenTargetY=this.targetY):(t||(this.reverse?(this.inst.width=parseFloat(this.target.split(",")[0]),this.inst.height=parseFloat(this.target.split(",")[1])):(this.inst.width=this.tweenSaveWidth,this.inst.height=this.tweenSaveHeight)),this.initialX=this.inst.width,this.initialY=this.inst.height,this.reverse?(this.targetX=this.tweenSaveWidth,this.targetY=this.tweenSaveHeight):(this.targetX=parseFloat(this.target.split(",")[0]),this.targetY=parseFloat(this.target.split(",")[1])),this.tweenInitialX=this.initialX,this.tweenInitialY=this.initialY,this.tweenTargetX=this.targetX,this.tweenTargetY=this.targetY),-6==this.playmode&&(this.tweenTargetX=this.tweenSaveWidth,this.tweenTargetY=this.tweenSaveHeight)}this.lastKnownValue=this.tweenInitialX,this.lastKnownX=this.tweenInitialX,this.lastKnownY=this.tweenInitialY,this.initiating=parseFloat(this.wait.split(",")[0]),this.cooldown=parseFloat(this.wait.split(",")[1]),(this.initiating<0||isNaN(this.initiating))&&(this.initiating=0),(this.cooldown<0||isNaN(this.cooldown))&&(this.cooldown=0),t&&(this.initial="current"),e&&(this.target="current"),i&&(this.target="OBJ")},e.easeFunc=function(t,e,s,n){switch(this.easing){case 0:return s*t/n+e;case 1:return s*(t/=n)*t+e;case 2:return-s*(t/=n)*(t-2)+e;case 3:return(t/=n/2)<1?s/2*t*t+e:-s/2*(--t*(t-2)-1)+e;case 4:return s*(t/=n)*t*t+e;case 5:return s*((t=t/n-1)*t*t+1)+e;case 6:return(t/=n/2)<1?s/2*t*t*t+e:s/2*((t-=2)*t*t+2)+e;case 7:return s*(t/=n)*t*t*t+e;case 8:return-s*((t=t/n-1)*t*t*t-1)+e;case 9:return(t/=n/2)<1?s/2*t*t*t*t+e:-s/2*((t-=2)*t*t*t-2)+e;case 10:return s*(t/=n)*t*t*t*t+e;case 11:return s*((t=t/n-1)*t*t*t*t+1)+e;case 12:return(t/=n/2)<1?s/2*t*t*t*t*t+e:s/2*((t-=2)*t*t*t*t+2)+e;case 13:return-s*(Math.sqrt(1-(t/=n)*t)-1)+e;case 14:return s*Math.sqrt(1-(t=t/n-1)*t)+e;case 15:return(t/=n/2)<1?-s/2*(Math.sqrt(1-t*t)-1)+e:s/2*(Math.sqrt(1-(t-=2)*t)+1)+e;case 16:return 0==(r=0)&&(r=1.70158),s*(t/=n)*t*((r+1)*t-r)+e;case 17:return 0==(r=0)&&(r=1.70158),s*((t=t/n-1)*t*((r+1)*t+r)+1)+e;case 18:return 0==(r=0)&&(r=1.70158),(t/=n/2)<1?s/2*(t*t*((1+(r*=1.525))*t-r))+e:s/2*((t-=2)*t*((1+(r*=1.525))*t+r)+2)+e;case 19:if(0==t)return e;if(1==(t/=n))return e+s;if(0==(a=0)&&(a=.3*n),0==(o=0)||o<Math.abs(s)){o=s;var r=a/4}else r=a/(2*Math.PI)*Math.asin(s/o);return-o*Math.pow(2,10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/a)+e;case 20:if(0==t)return e;if(1==(t/=n))return e+s;if(0==(a=0)&&(a=.3*n),0==(o=0)||o<Math.abs(s)){o=s;r=a/4}else r=a/(2*Math.PI)*Math.asin(s/o);return o*Math.pow(2,-10*t)*Math.sin((t*n-r)*(2*Math.PI)/a)+s+e;case 21:var o,a;if(0==t)return e;if(2==(t/=n/2))return e+s;if(0==(a=0)&&(a=n*(.3*1.5)),0==(o=0)||o<Math.abs(s)){o=s;r=a/4}else r=a/(2*Math.PI)*Math.asin(s/o);return t<1?o*Math.pow(2,10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/a)*-.5+e:o*Math.pow(2,-10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/a)*.5+s+e;case 22:return s-i(n-t,0,s,n)+e;case 23:return i(t,e,s,n);case 24:return t<n/2?.5*(s-i(n-2*t,0,s,n)+e)+e:.5*i(2*t-n,0,s,n)+.5*s+e;case 25:return(h=t/n/2)*h*(3-2*h)*2;case 26:return(h=(t/n+1)/2)*h*(3-2*h)*2-1;case 27:var h;return(h=t/n)*h*(3-2*h)}return 0},e.saveToJSON=function(){return{i:this.i,active:this.active,tweened:this.tweened,easing:this.easing,initial:this.initial,target:this.target,duration:this.duration,wait:this.wait,playmode:this.playmode,value:this.value,coord_mode:this.coord_mode,forceInit:this.forceInit,group:this.group,targetObject:this.targetObject,pingpongCounter:this.pingpongCounter,isPaused:this.isPaused,initialX:this.initialX,initialY:this.initialY,targetX:this.targetX,targetY:this.targetY,tweenSaveWidth:this.tweenSaveWidth,tweenSaveHeight:this.tweenSaveHeight,tweenSaveAngle:this.tweenSaveAngle,tweenSaveX:this.tweenSaveX,tweenSaveY:this.tweenSaveY,tweenSaveValue:this.tweenSaveValue,tweenInitialX:this.tweenInitialX,tweenInitialY:this.tweenInitialY,tweenTargetX:this.tweenTargetX,tweenTargetY:this.tweenTargetY,tweenTargetAngle:this.tweenTargetAngle,ratio:this.ratio,reverse:this.reverse,rewindMode:this.rewindMode,doTweenX:this.doTweenX,doTweenY:this.doTweenY,loop:this.loop,initiating:this.initiating,cooldown:this.cooldown,lastPlayMode:this.lastPlayMode,lastKnownValue:this.lastKnownValue,lastKnownX:this.lastKnownX,lastKnownY:this.lastKnownY,onStarted:this.onStarted,onStartedDone:this.onStartedDone,onWaitEnd:this.onWaitEnd,onWaitEndDone:this.onWaitEndDone,onEnd:this.onEnd,onEndDone:this.onEndDone,onCooldown:this.onCooldown,onCooldownDone:this.onCooldownDone}},e.loadFromJSON=function(t){this.i=t.i,this.active=t.active,this.tweened=t.tweened,this.easing=t.easing,this.initial=t.initial,this.target=t.target,this.duration=t.duration,this.wait=t.wait,this.playmode=t.playmode,this.value=t.value,this.coord_mode=t.coord_mode,this.forceInit=t.forceInit,this.group=t.group,this.targetObject=t.targetObject,this.pingpongCounter=t.pingpongCounter,this.isPaused=t.isPaused,this.initialX=t.initialX,this.initialY=t.initialY,this.targetX=t.targetX,this.targetY=t.targetY,this.tweenSaveWidth=t.tweenSaveWidth,this.tweenSaveHeight=t.tweenSaveHeight,this.tweenSaveAngle=t.tweenSaveAngle,this.tweenSaveX=t.tweenSaveX,this.tweenSaveY=t.tweenSaveY,this.tweenSaveValue=t.tweenSaveValue,this.tweenInitialX=t.tweenInitialX,this.tweenInitialY=t.tweenInitialY,this.tweenTargetX=t.tweenTargetX,this.tweenTargetY=t.tweenTargetY,this.tweenTargetAngle=t.tweenTargetAngle,this.ratio=t.ratio,this.reverse=t.reverse,this.rewindMode=t.rewindMode,this.doTweenX=t.doTweenX,this.doTweenY=t.doTweenY,this.loop=t.loop,this.initiating=t.initiating,this.cooldown=t.cooldown,this.lastPlayMode=t.lastPlayMode,this.lastKnownValue=t.lastKnownValue,this.lastKnownX=t.lastKnownX,this.lastKnownY=t.lastKnownY,this.onStarted=t.onStarted,this.onStartedDone=t.onStartedDone,this.onWaitEnd=t.onWaitEnd,this.onWaitEndDone=t.onWaitEndDone,this.onEnd=t.onEnd,this.onEndDone=t.onEndDone,this.onCooldown=t.onCooldown,this.onCooldownDone=t.onCooldownDone,this.groupSync()},e.tick=function(){var t=this.runtime.getDt(this.inst),e=-1==this.i;if(this.active&&0!==t&&(0==this.i&&(this.onStarted||(this.onStarted=!0,this.onStartedDone=!1,this.onWaitEnd=!1,this.onWaitEndDone=!1,this.onEnd=!1,this.onEndDone=!1,this.onCooldown=!1,this.onCooldownDone=!1,this.runtime.trigger(cr.behaviors.lunarray_Tween.prototype.cnds.OnStart,this.inst),this.onStartedDone=!0)),-1==this.i?this.i=this.initiating+this.duration+this.cooldown:this.i+=t,!(this.i<=this.initiating))){if(0==this.onWaitEnd&&(this.onWaitEnd=!0,this.runtime.trigger(cr.behaviors.lunarray_Tween.prototype.cnds.OnWaitEnd,this.inst),this.onWaitEndDone=!0),this.i<=this.duration+this.initiating){var i=this.easeFunc(this.i-this.initiating,0,1,this.duration);if(0==this.tweened)1==this.coord_mode?(this.inst.x!==this.lastKnownX&&(this.tweenInitialX+=this.inst.x-this.lastKnownX,this.tweenTargetX+=this.inst.x-this.lastKnownX),this.inst.y!==this.lastKnownY&&(this.tweenInitialY+=this.inst.y-this.lastKnownY,this.tweenTargetY+=this.inst.y-this.lastKnownY)):(this.inst.x!==this.lastKnownX&&(this.tweenInitialX+=this.inst.x-this.lastKnownX),this.inst.y!==this.lastKnownY&&(this.tweenInitialY+=this.inst.y-this.lastKnownY)),this.inst.x=this.tweenInitialX+(this.tweenTargetX-this.tweenInitialX)*i,this.inst.y=this.tweenInitialY+(this.tweenTargetY-this.tweenInitialY)*i,this.lastKnownX=this.inst.x,this.lastKnownY=this.inst.y;else if(1==this.tweened||2==this.tweened||3==this.tweened)this.inst.width!==this.lastKnownX&&(this.tweenInitialX=this.inst.width),this.inst.height!==this.lastKnownY&&(this.tweenInitialY=this.inst.height),this.doTweenX&&(this.inst.width=this.tweenInitialX+(this.tweenTargetX-this.tweenInitialX)*i),this.doTweenY?this.inst.height=this.tweenInitialY+(this.tweenTargetY-this.tweenInitialY)*i:1==this.tweened&&(this.inst.height=this.inst.width*this.ratio),this.lastKnownX=this.inst.width,this.lastKnownY=this.inst.height;else if(4==this.tweened){var s=this.tweenInitialX+(this.tweenTargetAngle-this.tweenInitialX)*i;this.i>=this.duration+this.initiating&&(s=this.tweenTargetAngle),this.inst.angle=cr.clamp_angle(s)}else 5==this.tweened?(1==this.coord_mode&&this.inst.opacity!==this.lastKnownX&&(this.tweenInitialX=this.inst.opacity),this.inst.opacity=this.tweenInitialX+(this.tweenTargetX-this.tweenInitialX)*i,this.lastKnownX=this.inst.opacity):6==this.tweened?this.value=this.tweenInitialX+(this.tweenTargetX-this.tweenInitialX)*i:7==this.tweened&&(1==this.coord_mode&&(this.inst.width!==this.lastKnownX&&(this.tweenInitialX=this.inst.width),this.inst.height!==this.lastKnownY&&(this.tweenInitialY=this.inst.height)),this.doTweenX&&(this.inst.width=this.tweenInitialX+(this.tweenTargetX-this.tweenInitialX)*i),this.doTweenY&&(this.inst.height=this.tweenInitialY+(this.tweenTargetY-this.tweenInitialY)*i),this.lastKnownX=this.inst.width,this.lastKnownY=this.inst.height);this.inst.set_bbox_changed()}this.i>=this.duration+this.initiating&&(this.doEndFrame(e),this.inst.set_bbox_changed(),0==this.onEnd&&(this.onEnd=!0,this.runtime.trigger(cr.behaviors.lunarray_Tween.prototype.cnds.OnEnd,this.inst),this.onEndDone=!0))}},e.doEndFrame=function(t){switch(this.tweened){case 0:this.inst.x=this.tweenTargetX,this.inst.y=this.tweenTargetY;break;case 1:this.doTweenX&&(this.inst.width=this.tweenTargetX),this.doTweenY?this.inst.height=this.tweenTargetY:this.inst.height=this.inst.width*this.ratio;break;case 2:this.inst.width=this.tweenTargetX;break;case 3:this.inst.height=this.tweenTargetY;break;case 4:var e=this.tweenTargetAngle;this.inst.angle=cr.clamp_angle(e),this.lastKnownValue=this.inst.angle;break;case 5:this.inst.opacity=this.tweenTargetX;break;case 6:this.value=this.tweenTargetX;break;case 7:this.doTweenX&&(this.inst.width=this.tweenTargetX),this.doTweenY&&(this.inst.height=this.tweenTargetY)}this.i>=this.duration+this.initiating+this.cooldown&&(0==this.playmode?(this.active=!1,this.reverse=!1,this.i=this.duration+this.initiating+this.cooldown):1==this.playmode?(this.i=0,this.init(),this.active=!0):2==this.playmode?t?(this.reverse=!1,this.init()):(this.reverse=!this.reverse,this.i=0,this.init(),this.active=!0):3==this.playmode?this.runtime.DestroyInstance(this.inst):4==this.playmode?(this.loop=!0,this.i=0,this.init(),this.active=!0):5==this.playmode?t?(this.reverse=!1,this.init()):this.pingpongCounter<=0?(this.i=this.duration+this.initiating+this.cooldown,this.active=!1):this.reverse?(this.pingpongCounter-=1,this.reverse=!1,this.i=0,this.init(),this.active=!0):(this.pingpongCounter-=1,this.reverse=!0,this.i=0,this.init(),this.active=!0):-6==this.playmode?(this.playmode=this.lastPlayMode,this.reverse=!1,this.i=0,this.active=!1):6==this.playmode&&(this.reverse=!1,this.i=this.duration+this.initiating+this.cooldown,this.active=!1)),0==this.onCooldown&&(this.onCooldown=!0,this.runtime.trigger(cr.behaviors.lunarray_Tween.prototype.cnds.OnCooldownEnd,this.inst),this.onCooldownDone=!0)},t.cnds={};var s=t.cnds;s.IsActive=function(){return this.active},s.CompareGroupProgress=function(t,e){var i=[];return cr.lunarray_tweenGroup[this.group].forEach(function(t){i.push(t.i/(t.duration+t.initiating+t.cooldown))}),cr.do_cmp(Math.min.apply(null,i),t,e)},s.CompareProgress=function(t,e){return cr.do_cmp(this.i/(this.duration+this.initiating+this.cooldown),t,e)},s.OnStart=function(){if(!1===this.onStartedDone)return this.onStarted},s.OnWaitEnd=function(){if(!1===this.onWaitEndDone)return this.onWaitEnd},s.OnEnd=function(t,e,i){if(!1===this.onEndDone)return this.onEnd},s.OnCooldownEnd=function(){if(!1===this.onCooldownDone)return this.onCooldown},t.acts={};var n=t.acts;n.SetActive=function(t){this.active=1===t},n.StartGroup=function(t,e){""===e&&(e=this.group),(1===t||cr.lunarray_tweenGroup[e].every(function(t){return!t.active}))&&cr.lunarray_tweenGroup[e].forEach(function(e){1===t?n.Force.apply(e):n.Start.apply(e)})},n.StopGroup=function(t,e){""===e&&(e=this.group),cr.lunarray_tweenGroup[e].forEach(function(e){n.Stop.apply(e,[t])})},n.ReverseGroup=function(t,e,i){""===i&&(i=this.group),(1===t||cr.lunarray_tweenGroup[i].every(function(t){return!t.active}))&&cr.lunarray_tweenGroup[i].forEach(function(i){1===t?n.ForceReverse.apply(i,[e]):n.Reverse.apply(i,[e])})},n.Force=function(){this.loop=4===this.playmode,5==this.playmode&&(this.pingpongCounter=1),6==this.playmode||-6==this.playmode?this.i<this.duration+this.cooldown+this.initiating&&(this.reverse=!1,this.init(),this.active=!0):(this.reverse=!1,this.i=0,this.init(),this.active=!0)},n.ForceReverse=function(t){this.rewindMode=1==t,this.loop=4===this.playmode,5==this.playmode&&(this.pingpongCounter=1),6==this.playmode||-6==this.playmode?this.i<this.duration+this.cooldown+this.initiating&&(this.reverse=!0,this.init(),this.active=!0):t?1==this.pingpongCounter&&this.i>=this.duration+this.cooldown+this.initiating&&(this.reverse=!0,this.i=0,this.pingpongCounter=2,this.init(),this.active=!0):(this.reverse=!0,this.i=0,this.init(),this.active=!0)},n.Start=function(){this.active||(this.loop=4===this.playmode,5==this.playmode&&(this.pingpongCounter=1),6==this.playmode||-6==this.playmode?this.i<this.duration+this.cooldown+this.initiating&&(this.reverse=!1,this.init(),this.active=!0):(this.pingpongCounter=1,this.reverse=!1,this.i=0,this.init(),this.active=!0))},n.Stop=function(t){this.active&&(2==this.playmode||4==this.playmode?this.reverse?this.i=0:this.i=-1:1==t?this.saveState():this.i=0==t?this.initiating+this.cooldown+this.duration:0,this.tick(),this.active=!1)},n.Pause=function(){this.active&&(this.isPaused=!0,this.active=!1)},n.Resume=function(){this.isPaused?(this.active=!0,this.isPaused=!1):this.active||(this.reverse=!1,this.i=0,this.init(),this.active=!0)},n.Reverse=function(t){this.rewindMode=1==t,this.active||(this.loop=4===this.playmode,5==this.playmode&&(this.pingpongCounter=1),6==this.playmode||-6==this.playmode?this.i<this.duration+this.cooldown+this.initiating&&(this.reverse=!0,this.init(),this.active=!0):t?1==this.pingpongCounter&&this.i>=this.duration+this.cooldown+this.initiating&&(this.reverse=!0,this.i=0,this.pingpongCounter=2,this.init(),this.active=!0):(this.reverse=!0,this.i=0,this.init(),this.active=!0))},n.SetDuration=function(t){this.duration=t},n.SetWait=function(t){this.wait=t,this.initiating=parseFloat(this.wait.split(",")[0]),this.cooldown=parseFloat(this.wait.split(",")[1]),(this.initiating<0||isNaN(this.initiating))&&(this.initiating=0),(this.cooldown<0||isNaN(this.cooldown))&&(this.cooldown=0)},n.SetTarget=function(t){"string"==typeof t?(this.target=t,this.targetX=parseFloat(t.split(",")[0]),this.targetY=parseFloat(t.split(",")[1])):(this.target=t,this.targetX=t),this.active||this.init()},n.SetTargetObject=function(t){if(t){var e=t.getFirstPicked();e&&(this.targetObject=e,this.target="OBJ")}},n.SetTargetX=function(t){if(2==this.tweened||3==this.tweened||4==this.tweened||5==this.tweened||6==this.tweened)this.target="string"==typeof t?parseFloat(t.split(",")[0]):t+","+this.targetY,this.targetX=this.target;else{var e=this.target.split(",")[1];this.target=String(t)+","+e,this.targetX=parseFloat(this.target.split(",")[0]),this.targetY=parseFloat(this.target.split(",")[1])}this.active||(this.saveState(),this.init())},n.SetTargetY=function(t){if(2==this.tweened||3==this.tweened||4==this.tweened||5==this.tweened||6==this.tweened)this.target="string"==typeof t?parseFloat(t)+"":this.targetX+","+t,this.targetX=this.target;else{var e=this.target.split(",")[0];this.target=e+","+String(t),this.targetX=parseFloat(this.target.split(",")[0]),this.targetY=parseFloat(this.target.split(",")[1])}this.active||(this.saveState(),this.init())},n.SetInitial=function(t){"string"==typeof t?(this.initial=t,this.initialX=parseFloat(t.split(",")[0]),this.initialY=parseFloat(t.split(",")[1])):(this.initial=""+t,this.initialX=t),6==this.tweened&&(this.value=this.initialX),this.active||(this.saveState(),this.init())},n.SetInitialX=function(t){if(2==this.tweened||3==this.tweened||4==this.tweened||5==this.tweened||6==this.tweened)this.initial="string"==typeof t?parseFloat(t):t+","+this.initialY,this.initialX=this.initial;else{if(""==this.initial&&(this.initial="current"),"current"==this.initial)var e=this.tweenSaveY;else e=this.initial.split(",")[1];this.initial=String(t)+","+e,this.initialX=parseFloat(this.initial.split(",")[0]),this.initialY=parseFloat(this.initial.split(",")[1])}6==this.tweened&&(this.value=this.initialX),this.active||(this.saveState(),this.init())},n.SetInitialY=function(t){if(2==this.tweened||3==this.tweened||4==this.tweened||5==this.tweened||6==this.tweened)this.initial="string"==typeof t?parseFloat(t):this.initialX+","+t,this.initialX=this.initial;else{if(""==this.initial&&(this.initial="current"),"current"==this.initial)var e=this.tweenSaveX;else e=this.initial.split(",")[0];this.initial=e+","+String(t),this.initialX=parseFloat(this.initial.split(",")[0]),this.initialY=parseFloat(this.initial.split(",")[1])}this.active||(this.saveState(),this.init())},n.SetValue=function(t){this.value=t},n.SetTweenedProperty=function(t){this.tweened=t},n.SetEasing=function(t){this.easing=t},n.SetPlayback=function(t){this.playmode=t},n.SetParameter=function(t,e,i,s,r,o,a,h){this.tweened=t,this.playmode=e,this.easing=i,n.SetInitial.apply(this,[s]),n.SetTarget.apply(this,[r]),n.SetDuration.apply(this,[o]),n.SetWait.apply(this,[a]),this.coord_mode=h,this.saveState()},t.exps={};var r=t.exps;r.Progress=function(t){t.set_float(this.i/(this.duration+this.initiating+this.cooldown))},r.ProgressTime=function(t){t.set_float(this.i)},r.Duration=function(t){t.set_float(this.duration)},r.Initiating=function(t){t.set_float(this.initiating)},r.Cooldown=function(t){t.set_float(this.cooldown)},r.Target=function(t){t.set_string(this.target)},r.Value=function(t){t.set_float(this.value)},r.isPaused=function(t){t.set_int(this.isPaused?1:0)}}(),cr.behaviors.scrollto=function(t){this.runtime=t,this.shakeMag=0,this.shakeStart=0,this.shakeEnd=0,this.shakeMode=0},function(){var t=cr.behaviors.scrollto.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(t){var e,i,s;for(e=0,i=t.behavior_insts.length;e<i;++e)if((s=t.behavior_insts[e]).behavior instanceof cr.behaviors.scrollto)return s;return null}function s(){}e.onCreate=function(){this.enabled=0!==this.properties[0]},e.saveToJSON=function(){return{smg:this.behavior.shakeMag,ss:this.behavior.shakeStart,se:this.behavior.shakeEnd,smd:this.behavior.shakeMode}},e.loadFromJSON=function(t){this.behavior.shakeMag=t.smg,this.behavior.shakeStart=t.ss,this.behavior.shakeEnd=t.se,this.behavior.shakeMode=t.smd},e.tick=function(){},e.tick2=function(){if(this.enabled){var t,e,s,n=this.behavior.my_instances.valuesRef(),r=0,o=0,a=0;for(t=0,e=n.length;t<e;t++)(s=i(n[t]))&&s.enabled&&(r+=n[t].x,o+=n[t].y,++a);var h=this.inst.layer.layout,c=this.runtime.kahanTime.sum,l=0,u=0;if(c>=this.behavior.shakeStart&&c<this.behavior.shakeEnd){var p=this.behavior.shakeMag*Math.min(this.runtime.timescale,1);0===this.behavior.shakeMode&&(p*=1-(c-this.behavior.shakeStart)/(this.behavior.shakeEnd-this.behavior.shakeStart));var d=Math.random()*Math.PI*2,f=Math.random()*p;l=Math.cos(d)*f,u=Math.sin(d)*f}h.scrollToX(r/a+l),h.scrollToY(o/a+u)}},s.prototype.Shake=function(t,e,i){this.behavior.shakeMag=t,this.behavior.shakeStart=this.runtime.kahanTime.sum,this.behavior.shakeEnd=this.behavior.shakeStart+e,this.behavior.shakeMode=i},s.prototype.SetEnabled=function(t){this.enabled=0!==t},t.acts=new s}(),cr.behaviors.shadowcaster=function(t){this.runtime=t,this.myTypes=[]},function(){var t=cr.behaviors.shadowcaster.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime,-1===this.behavior.myTypes.indexOf(e)&&this.behavior.myTypes.push(e)},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}function n(){}e.onCreate=function(){this.inst.extra.shadowcasterEnabled=0!==this.properties[0],this.inst.extra.shadowcasterHeight=this.properties[1],this.inst.extra.shadowcasterTag=this.properties[2]},e.tick=function(){},i.prototype.IsEnabled=function(){return this.inst.extra.shadowcasterEnabled},i.prototype.CompareHeight=function(t,e){var i=this.inst.extra.shadowcasterHeight;return cr.do_cmp(i,t,e)},t.cnds=new i,s.prototype.SetEnabled=function(t){this.inst.extra.shadowcasterEnabled=!!t},s.prototype.SetHeight=function(t){this.inst.extra.shadowcasterHeight!==t&&(this.inst.extra.shadowcasterHeight=t,this.runtime.redraw=!0)},s.prototype.SetTag=function(t){this.inst.extra.shadowcasterTag!==t&&(this.inst.extra.shadowcasterTag=t,this.runtime.redraw=!0)},t.acts=new s,n.prototype.Height=function(t){t.set_float(this.inst.extra.shadowcasterHeight)},n.prototype.Tag=function(t){t.set_string(this.inst.extra.shadowcasterTag)},t.exps=new n}(),cr.behaviors.solid=function(t){this.runtime=t},function(){var t=cr.behaviors.solid.prototype;t.Type=function(t,e){this.behavior=t,this.objtype=e,this.runtime=t.runtime},t.Type.prototype.onCreate=function(){},t.Instance=function(t,e){this.type=t,this.behavior=t.behavior,this.inst=e,this.runtime=t.runtime};var e=t.Instance.prototype;function i(){}function s(){}e.onCreate=function(){this.inst.extra.solidEnabled=0!==this.properties[0]},e.tick=function(){},i.prototype.IsEnabled=function(){return this.inst.extra.solidEnabled},t.cnds=new i,s.prototype.SetEnabled=function(t){this.inst.extra.solidEnabled=!!t},t.acts=new s}(),cr.getObjectRefTable=function(){return[cr.plugins_.NinePatch,cr.plugins_.AJAX,cr.plugins_.Arr,cr.plugins_.Audio,cr.plugins_.Button,cr.plugins_.Browser,cr.plugins_.filechooser,cr.plugins_.gamepad,cr.plugins_.LocalStorage,cr.plugins_.Mouse,cr.plugins_.NodeWebkit,cr.plugins_.Function,cr.plugins_.Keyboard,cr.plugins_.Particles,cr.plugins_.Text,cr.plugins_.TextBox,cr.plugins_.aekiro_model,cr.plugins_.Touch,cr.plugins_.aekiro_proui2,cr.plugins_.Sprite,cr.plugins_.TiledBg,cr.plugins_.c2canvas,cr.plugins_.JSON,cr.plugins_.Globals,cr.plugins_.GameAnalytics,cr.plugins_.hmmg_layoutTransition_v2,cr.plugins_.jcw_trace,cr.plugins_.CSS_import,cr.plugins_.rojoPaster,cr.plugins_.MagiCam,cr.plugins_.HTML_Div_Pode,cr.plugins_.sirg_notifications,cr.plugins_.skymen_minifunctioncallback,cr.plugins_.skymen_siteLock,cr.plugins_.SkymenSFPlusPLus,cr.plugins_.TextModded,cr.plugins_.skymen_skinsCore,cr.plugins_.TR_ClockParser,cr.plugins_.SyncStorage,cr.plugins_.ValerypopoffJSPlugin,cr.plugins_.TR_AdBlockDetector,cr.plugins_.skymenhowlerjs,cr.behaviors.Platform,cr.behaviors.Timer,cr.behaviors.Rex_pushOutSolid,cr.behaviors.LOS,cr.behaviors.jumpthru,cr.behaviors.solid,cr.behaviors.Persist,cr.behaviors.Rex_Zigzag,cr.behaviors.SkymenPolarCoordinates,cr.behaviors.shadowcaster,cr.behaviors.Bullet,cr.behaviors.Turret,cr.behaviors.Fade,cr.behaviors.Anchor,cr.behaviors.aekiro_button,cr.behaviors.aekiro_tag,cr.behaviors.aekiro_gameobject2,cr.behaviors.Sin,cr.behaviors.aekiro_bind,cr.behaviors.aekiro_gridView,cr.behaviors.aekiro_modelB,cr.behaviors.aekiro_scrollView,cr.behaviors.aekiro_dialog,cr.behaviors.aekiro_checkbox,cr.behaviors.aekiro_sliderbar,cr.behaviors.lunarray_Tween,cr.behaviors.scrollto,cr.behaviors.lunarray_LiteTween,cr.behaviors.SkymenSkin,cr.behaviors.SkymenPin,cr.system_object.prototype.cnds.IsGroupActive,cr.plugins_.Sprite.prototype.cnds.CompareInstanceVar,cr.behaviors.solid.prototype.acts.SetEnabled,cr.system_object.prototype.cnds.Else,cr.plugins_.Sprite.prototype.cnds.IsOverlapping,cr.plugins_.Sprite.prototype.cnds.IsBoolInstanceVarSet,cr.plugins_.Sprite.prototype.acts.AddInstanceVar,cr.system_object.prototype.exps.dt,cr.plugins_.Function.prototype.acts.CallFunction,cr.plugins_.Sprite.prototype.acts.Destroy,cr.plugins_.Sprite.prototype.acts.SetInstanceVar,cr.plugins_.Sprite.prototype.cnds.OnCollision,cr.behaviors.Platform.prototype.acts.SetVectorY,cr.behaviors.Platform.prototype.exps.Gravity,cr.system_object.prototype.exps.sin,cr.plugins_.Sprite.prototype.exps.Angle,cr.behaviors.Platform.prototype.acts.SetMaxSpeed,cr.system_object.prototype.exps.max,cr.system_object.prototype.exps.cos,cr.behaviors.Platform.prototype.acts.SetVectorX,cr.behaviors.Platform.prototype.exps.VectorX,cr.plugins_.skymenhowlerjs.prototype.acts.Play,cr.behaviors.Platform.prototype.acts.SetDeceleration,cr.behaviors.Bullet.prototype.acts.SetAngleOfMotion,cr.behaviors.Bullet.prototype.acts.SetSpeed,cr.behaviors.Bullet.prototype.exps.Gravity,cr.system_object.prototype.cnds.OnLayoutStart,cr.system_object.prototype.acts.Wait,cr.system_object.prototype.cnds.CompareVar,cr.system_object.prototype.acts.SetVar,cr.system_object.prototype.cnds.TriggerOnce,cr.plugins_.GameAnalytics.prototype.acts.addProgressionEvent,cr.system_object.prototype.exps.layoutname,cr.system_object.prototype.exps.int,cr.system_object.prototype.exps.tokenat,cr.plugins_.Globals.prototype.cnds.IsBoolInstanceVarSet,cr.plugins_.Globals.prototype.cnds.CompareInstanceVar,cr.system_object.prototype.cnds.IsPreview,cr.system_object.prototype.cnds.IsOnPlatform,cr.plugins_.SyncStorage.prototype.acts.SetData,cr.plugins_.SyncStorage.prototype.exps.Get,cr.plugins_.SyncStorage.prototype.acts.SaveData,cr.plugins_.Sprite.prototype.acts.SetBoolInstanceVar,cr.plugins_.Sprite.prototype.acts.SetAnimFrame,cr.plugins_.Sprite.prototype.cnds.IsVisible,cr.system_object.prototype.cnds.ForEach,cr.behaviors.SkymenPin.prototype.acts.Pin,cr.behaviors.Rex_Zigzag.prototype.acts.Start,cr.plugins_.Sprite.prototype.acts.SetPos,cr.plugins_.Sprite.prototype.exps.X,cr.plugins_.Sprite.prototype.exps.Y,cr.plugins_.Sprite.prototype.acts.SetAngle,cr.plugins_.Sprite.prototype.exps.UID,cr.system_object.prototype.cnds.PickAll,cr.plugins_.Sprite.prototype.cnds.PickByUID,cr.system_object.prototype.cnds.Compare,cr.behaviors.Rex_Zigzag.prototype.acts.SetAbsolute,cr.behaviors.SkymenPolarCoordinates.prototype.acts.SetEnabled,cr.plugins_.Sprite.prototype.cnds.PickInstVarHiLow,cr.behaviors.SkymenPolarCoordinates.prototype.acts.SetOriginPos,cr.system_object.prototype.exps.distance,cr.system_object.prototype.exps.angle,cr.behaviors.SkymenPolarCoordinates.prototype.acts.SetDeltaPos,cr.behaviors.Rex_Zigzag.prototype.exps.OffX,cr.behaviors.Rex_Zigzag.prototype.exps.OffY,cr.behaviors.Rex_Zigzag.prototype.exps.OffAngle,cr.behaviors.jumpthru.prototype.acts.SetEnabled,cr.behaviors.Turret.prototype.acts.AddTarget,cr.behaviors.Turret.prototype.cnds.OnShoot,cr.plugins_.Sprite.prototype.acts.Spawn,cr.plugins_.Sprite.prototype.exps.LayerName,cr.behaviors.Bullet.prototype.exps.Speed,cr.behaviors.LOS.prototype.cnds.HasLOSToObject,cr.behaviors.Turret.prototype.acts.SetEnabled,cr.system_object.prototype.cnds.EveryTick,cr.plugins_.Sprite.prototype.acts.RotateTowardPosition,cr.plugins_.Sprite.prototype.cnds.OnDestroyed,cr.plugins_.SyncStorage.prototype.cnds.HasData,cr.plugins_.Sprite.prototype.acts.SetOpacity,cr.behaviors.Bullet.prototype.cnds.CompareTravelled,cr.behaviors.Bullet.prototype.acts.SetEnabled,cr.behaviors.Fade.prototype.acts.StartFade,cr.system_object.prototype.cnds.PickByComparison,cr.plugins_.SkymenSFPlusPLus.prototype.acts.SetText,cr.plugins_.Sprite.prototype.acts.SetMirrored,cr.plugins_.Sprite.prototype.cnds.IsOverlappingOffset,cr.behaviors.Platform.prototype.exps.VectorY,cr.plugins_.Sprite.prototype.cnds.PickDistance,cr.plugins_.Function.prototype.exps.Call,cr.plugins_.Sprite.prototype.acts.SetCollisions,cr.behaviors.Platform.prototype.exps.Speed,cr.behaviors.Platform.prototype.exps.MovingAngle,cr.plugins_.Sprite.prototype.exps.ImagePointX,cr.plugins_.Sprite.prototype.exps.ImagePointY,cr.plugins_.Sprite.prototype.acts.SetY,cr.behaviors.Bullet.prototype.exps.AngleOfMotion,cr.plugins_.Sprite.prototype.cnds.IsCollisionEnabled,cr.plugins_.Function.prototype.cnds.OnFunction,cr.plugins_.Function.prototype.exps.Param,cr.plugins_.Function.prototype.acts.SetReturnValue,cr.behaviors.Timer.prototype.cnds.OnTimer,cr.behaviors.Platform.prototype.exps.GravityAngle,cr.behaviors.Platform.prototype.acts.SetGravityAngle,cr.plugins_.TiledBg.prototype.exps.Angle,cr.system_object.prototype.exps.anglediff,cr.behaviors.Timer.prototype.acts.StartTimer,cr.plugins_.Sprite.prototype.acts.SetSize,cr.plugins_.Sprite.prototype.acts.SetTowardPosition,cr.system_object.prototype.exps.lerp,cr.plugins_.Sprite.prototype.exps.Opacity,cr.system_object.prototype.cnds.ForEachOrdered,cr.plugins_.Sprite.prototype.acts.ZMoveToObject,cr.behaviors.SkymenSkin.prototype.acts.UseDefault,cr.behaviors.SkymenSkin.prototype.acts.SetSkin,cr.behaviors.SkymenSkin.prototype.acts.HideDefault,cr.plugins_.Sprite.prototype.exps.Width,cr.plugins_.Sprite.prototype.exps.ImageWidth,cr.plugins_.Sprite.prototype.exps.Height,cr.plugins_.Sprite.prototype.exps.ImageHeight,cr.system_object.prototype.exps.find,cr.plugins_.MagiCam.prototype.acts.CreateLocalCamera,cr.plugins_.MagiCam.prototype.acts.FollowObject,cr.plugins_.MagiCam.prototype.acts.EnableFollowing,cr.plugins_.MagiCam.prototype.acts.SetFollowLag,cr.system_object.prototype.acts.Scroll,cr.system_object.prototype.exps.windowwidth,cr.system_object.prototype.exps.windowheight,cr.plugins_.Globals.prototype.acts.SetBoolInstanceVar,cr.plugins_.Sprite.prototype.cnds.IsOutsideLayout,cr.behaviors.Bullet.prototype.acts.SetAcceleration,cr.behaviors.Fade.prototype.exps.FadeOutTime,cr.behaviors.Platform.prototype.acts.SetEnabled,cr.system_object.prototype.acts.RestartLayout,cr.behaviors.Platform.prototype.cnds.IsFalling,cr.behaviors.Platform.prototype.cnds.IsByWall,cr.behaviors.Platform.prototype.cnds.OnJump,cr.behaviors.Platform.prototype.exps.MaxSpeed,cr.behaviors.Platform.prototype.exps.JumpStrength,cr.behaviors.Platform.prototype.cnds.IsOnFloor,cr.behaviors.Platform.prototype.acts.SetIgnoreInput,cr.system_object.prototype.exps.time,cr.behaviors.Platform.prototype.cnds.IsMoving,cr.system_object.prototype.acts.AddVar,cr.behaviors.Platform.prototype.cnds.IsJumping,cr.behaviors.solid.prototype.cnds.IsEnabled,cr.behaviors.Rex_pushOutSolid.prototype.acts.SetEnabled,cr.behaviors.Rex_pushOutSolid.prototype.acts.PushOutNearest,cr.plugins_.jcw_trace.prototype.acts.TraceLine,cr.plugins_.jcw_trace.prototype.cnds.Hit,cr.plugins_.jcw_trace.prototype.exps.NormalAngle,cr.system_object.prototype.cnds.CompareBetween,cr.plugins_.Text.prototype.acts.SetText,cr.behaviors.Platform.prototype.cnds.CompareSpeed,cr.system_object.prototype.exps.abs,cr.system_object.prototype.exps.anglelerp,cr.system_object.prototype.exps.timescale,cr.plugins_.Keyboard.prototype.cnds.OnKeyCode,cr.plugins_.Touch.prototype.cnds.OnTouchObject,cr.plugins_.gamepad.prototype.cnds.OnButtonDown,cr.system_object.prototype.cnds.IsMobile,cr.plugins_.Browser.prototype.acts.Vibrate,cr.plugins_.Touch.prototype.cnds.IsTouchingObject,cr.plugins_.gamepad.prototype.cnds.CompareAxis,cr.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,cr.plugins_.gamepad.prototype.cnds.OnButtonUp,cr.plugins_.Arr.prototype.cnds.CompareSize,cr.system_object.prototype.cnds.Repeat,cr.plugins_.Arr.prototype.acts.Push,cr.plugins_.Arr.prototype.acts.SetSize,cr.behaviors.Platform.prototype.acts.SimulateControl,cr.system_object.prototype.cnds.Every,cr.plugins_.Arr.prototype.exps.At,cr.plugins_.Arr.prototype.acts.Pop,cr.system_object.prototype.acts.CreateObject,cr.plugins_.Sprite.prototype.exps.BBoxLeft,cr.plugins_.Sprite.prototype.exps.BBoxTop,cr.plugins_.c2canvas.prototype.acts.SetSize,cr.plugins_.Sprite.prototype.exps.BBoxRight,cr.plugins_.Sprite.prototype.exps.BBoxBottom,cr.behaviors.SkymenSkin.prototype.cnds.IsDefault,cr.plugins_.c2canvas.prototype.acts.PasteObject,cr.plugins_.c2canvas.prototype.acts.SetOpacity,cr.plugins_.c2canvas.prototype.acts.ZMoveToObject,cr.behaviors.Sin.prototype.acts.SetPhase,cr.behaviors.Timer.prototype.acts.StopTimer,cr.plugins_.Sprite.prototype.acts.SetAnim,cr.plugins_.Sprite.prototype.cnds.IsAnimPlaying,cr.behaviors.Platform.prototype.acts.SetMaxFallSpeed,cr.plugins_.MagiCam.prototype.acts.ShakeCamera,cr.plugins_.Sprite.prototype.cnds.IsBetweenAngles,cr.behaviors.Platform.prototype.cnds.OnLand,cr.plugins_.Arr.prototype.exps.Width,cr.system_object.prototype.cnds.While,cr.system_object.prototype.acts.SubVar,cr.plugins_.Sprite.prototype.cnds.CompareX,cr.plugins_.Sprite.prototype.cnds.CompareY,cr.plugins_.Sprite.prototype.cnds.OnCreated,cr.plugins_.Arr.prototype.acts.JSONLoad,cr.plugins_.Arr.prototype.cnds.CompareXY,cr.plugins_.Sprite.prototype.acts.SetPosToObject,cr.plugins_.Sprite.prototype.acts.SetHeight,cr.plugins_.SkymenSFPlusPLus.prototype.acts.MoveToBottom,cr.plugins_.SkymenSFPlusPLus.prototype.acts.SetOpacity,cr.behaviors.Platform.prototype.acts.SetDoubleJumpEnabled,cr.plugins_.SkymenSFPlusPLus.prototype.exps.Count,cr.plugins_.SkymenSFPlusPLus.prototype.exps.LayerName,cr.plugins_.SkymenSFPlusPLus.prototype.exps.X,cr.plugins_.SkymenSFPlusPLus.prototype.exps.BBoxBottom,cr.plugins_.SkymenSFPlusPLus.prototype.acts.SetSize,cr.plugins_.SkymenSFPlusPLus.prototype.exps.Width,cr.plugins_.SkymenSFPlusPLus.prototype.acts.SetPos,cr.plugins_.SkymenSFPlusPLus.prototype.acts.MoveToLayer,cr.system_object.prototype.acts.SetGroupActive,cr.plugins_.TiledBg.prototype.acts.SetSize,cr.system_object.prototype.exps.layoutwidth,cr.plugins_.TiledBg.prototype.acts.MoveToBottom,cr.plugins_.TiledBg.prototype.acts.SetOpacity,cr.system_object.prototype.exps.layoutheight,cr.plugins_.TiledBg.prototype.acts.SetAngle,cr.plugins_.Browser.prototype.acts.ExecJs,cr.plugins_.Keyboard.prototype.cnds.OnKey,cr.plugins_.Browser.prototype.acts.ConsoleLog,cr.plugins_.SkymenSFPlusPLus.prototype.cnds.OnCreated,cr.plugins_.Browser.prototype.cnds.OnPageHidden,cr.plugins_.ValerypopoffJSPlugin.prototype.acts.ExecuteJSWithParams,cr.plugins_.Browser.prototype.cnds.OnPageVisible,cr.plugins_.skymenhowlerjs.prototype.cnds.IsPlaying,cr.plugins_.skymenhowlerjs.prototype.acts.PlayByName,cr.plugins_.skymenhowlerjs.prototype.acts.Mute,cr.plugins_.SyncStorage.prototype.cnds.IsLoaded,cr.plugins_.skymenhowlerjs.prototype.acts.LinearVolume,cr.plugins_.SyncStorage.prototype.cnds.CompareData,cr.plugins_.skymenhowlerjs.prototype.acts.Unmute,cr.system_object.prototype.exps.choose,cr.system_object.prototype.exps.str,cr.system_object.prototype.exps.floor,cr.system_object.prototype.exps.random,cr.plugins_.skymenhowlerjs.prototype.acts.Stop,cr.plugins_.Sprite.prototype.cnds.AngleWithin,cr.plugins_.JSON.prototype.cnds.IsEmpty,cr.plugins_.AJAX.prototype.acts.RequestFile,cr.plugins_.AJAX.prototype.cnds.OnComplete,cr.plugins_.JSON.prototype.acts.LoadJSON,cr.plugins_.AJAX.prototype.exps.LastData,cr.plugins_.aekiro_model.prototype.acts.SetJSONByKeyString,cr.plugins_.skymen_minifunctioncallback.prototype.acts.Callback,cr.plugins_.JSON.prototype.exps.Value,cr.plugins_.ValerypopoffJSPlugin.prototype.acts.Call,cr.plugins_.ValerypopoffJSPlugin.prototype.exps.StoredReturnValue,cr.plugins_.SyncStorage.prototype.acts.LoadData,cr.system_object.prototype.acts.WaitForSignal,cr.plugins_.Globals.prototype.acts.SetInstanceVar,cr.plugins_.ValerypopoffJSPlugin.prototype.exps.JSCodeValue,cr.plugins_.Globals.prototype.exps.GetVariablesAsJSON,cr.plugins_.ValerypopoffJSPlugin.prototype.acts.SetValue,cr.plugins_.AJAX.prototype.cnds.OnError,cr.plugins_.Browser.prototype.acts.Alert,cr.plugins_.SyncStorage.prototype.cnds.OnDataMissing,cr.plugins_.SyncStorage.prototype.cnds.OnLoaded,cr.plugins_.Globals.prototype.acts.LoadVariables,cr.plugins_.skymenhowlerjs.prototype.acts.Volume,cr.plugins_.skymenhowlerjs.prototype.exps.LinearVolume,cr.plugins_.Browser.prototype.acts.RequestFullScreen,cr.plugins_.SyncStorage.prototype.cnds.OnLoadError,cr.plugins_.SyncStorage.prototype.exps.ErrorMsg,cr.system_object.prototype.cnds.OnLayoutEnd,cr.plugins_.SyncStorage.prototype.acts.ClearData,cr.system_object.prototype.cnds.For,cr.plugins_.SyncStorage.prototype.acts.RemoveData,cr.system_object.prototype.exps.loopindex,cr.plugins_.SyncStorage.prototype.acts.AddValue,cr.plugins_.Browser.prototype.cnds.OnOfflineReady,cr.plugins_.Browser.prototype.cnds.OnUpdateFound,cr.plugins_.Browser.prototype.cnds.OnUpdateReady,cr.plugins_.sirg_notifications.prototype.cnds.OnNotificationClicked,cr.plugins_.Browser.prototype.acts.Reload,cr.plugins_.Browser.prototype.acts.GoToURLWindow,cr.plugins_.hmmg_layoutTransition_v2.prototype.cnds.didTransitionStart,cr.plugins_.sirg_notifications.prototype.acts.AddSimpleNotification,cr.plugins_.sirg_notifications.prototype.acts.AddNotification,cr.plugins_.sirg_notifications.prototype.acts.AddNotificationClickable,cr.plugins_.sirg_notifications.prototype.acts.DeleteAllNotifications,cr.plugins_.skymen_skinsCore.prototype.acts.AddSkin,cr.plugins_.skymen_skinsCore.prototype.acts.Init,cr.system_object.prototype.exps.clamp,cr.plugins_.Keyboard.prototype.cnds.OnAnyKey,cr.plugins_.Keyboard.prototype.exps.LastKeyCode,cr.plugins_.Sprite.prototype.exps.Count,cr.plugins_.NodeWebkit.prototype.acts.SetWindowTitle,cr.plugins_.Arr.prototype.acts.SetXY,cr.plugins_.Sprite.prototype.exps.AnimationFrame,cr.plugins_.NodeWebkit.prototype.acts.SetClipboardText,cr.plugins_.Arr.prototype.exps.AsJSON,cr.plugins_.Sprite.prototype.acts.SetVisible,cr.plugins_.skymen_skinsCore.prototype.exps.RandomSkin,cr.plugins_.Globals.prototype.acts.ToggleBoolInstanceVar,cr.plugins_.SyncStorage.prototype.exps.AsString,cr.plugins_.TextModded.prototype.cnds.OnCreated,cr.plugins_.TextModded.prototype.acts.SetInstanceVar,cr.plugins_.TextModded.prototype.exps.FaceSize,cr.plugins_.TextModded.prototype.exps.Width,cr.plugins_.TextModded.prototype.exps.Height,cr.plugins_.SkymenSFPlusPLus.prototype.acts.SetInstanceVar,cr.plugins_.SkymenSFPlusPLus.prototype.exps.CharacterScale,cr.plugins_.TextModded.prototype.acts.SetWebFont,cr.plugins_.SkymenSFPlusPLus.prototype.cnds.IsBoolInstanceVarSet,cr.plugins_.SkymenSFPlusPLus.prototype.cnds.IsVisible,cr.plugins_.SkymenSFPlusPLus.prototype.acts.SetVisible,cr.plugins_.ValerypopoffJSPlugin.prototype.cnds.CompareStoredReturnValue,cr.plugins_.SkymenSFPlusPLus.prototype.exps.Text,cr.plugins_.SkymenSFPlusPLus.prototype.exps.LayerNumber,cr.behaviors.aekiro_gameobject2.prototype.exps.global,cr.plugins_.TextModded.prototype.acts.SetSize,cr.plugins_.SkymenSFPlusPLus.prototype.exps.Height,cr.plugins_.TextModded.prototype.acts.SetText,cr.plugins_.TextModded.prototype.acts.SetFontSize,cr.plugins_.TextModded.prototype.acts.SetHorAl,cr.plugins_.TextModded.prototype.acts.SetVerAl,cr.plugins_.TextModded.prototype.acts.SetHeight,cr.plugins_.TextModded.prototype.acts.SetY,cr.plugins_.TextModded.prototype.exps.Y,cr.plugins_.TextModded.prototype.acts.SetWidth,cr.plugins_.TextModded.prototype.acts.SetX,cr.plugins_.TextModded.prototype.exps.X,cr.plugins_.TextModded.prototype.acts.SetAngle,cr.plugins_.SkymenSFPlusPLus.prototype.exps.Angle,cr.plugins_.TextModded.prototype.acts.SetOpacity,cr.plugins_.SkymenSFPlusPLus.prototype.exps.Opacity,cr.plugins_.TextModded.prototype.acts.ZMoveToObject,cr.plugins_.SkymenSFPlusPLus.prototype.cnds.CompareInstanceVar,cr.plugins_.TextModded.prototype.acts.SetFontColor,cr.system_object.prototype.exps.rgb,cr.plugins_.TextModded.prototype.acts.SetBoolInstanceVar,cr.plugins_.SkymenSFPlusPLus.prototype.exps.UID,cr.plugins_.SkymenSFPlusPLus.prototype.acts.Destroy,cr.system_object.prototype.acts.Signal,cr.system_object.prototype.exps.lowercase,cr.plugins_.Sprite.prototype.exps.AnimationName,cr.plugins_.Sprite.prototype.exps.LayerNumber,cr.plugins_.TextModded.prototype.acts.SetPos,cr.plugins_.TextModded.prototype.exps.UID,cr.behaviors.aekiro_gameobject2.prototype.acts.AddChildrenFromType,cr.plugins_.TextModded.prototype.cnds.IsBoolInstanceVarSet,cr.plugins_.SkymenSFPlusPLus.prototype.acts.SetScale,cr.plugins_.SkymenSFPlusPLus.prototype.cnds.PickByUID,cr.plugins_.TextModded.prototype.cnds.PickByUID,cr.plugins_.aekiro_model.prototype.acts.StringToHashTable,cr.plugins_.TR_ClockParser.prototype.exps.MMSS,cr.system_object.prototype.exps.round,cr.system_object.prototype.exps.zeropad,cr.behaviors.aekiro_button.prototype.acts.setEnabled,cr.plugins_.aekiro_model.prototype.cnds.IsEmpty,cr.plugins_.Browser.prototype.exps.Domain,cr.plugins_.Sprite.prototype.acts.SetX,cr.plugins_.Sprite.prototype.acts.SetWidth,cr.behaviors.aekiro_gameobject2.prototype.exps.parent,cr.system_object.prototype.exps.replace,cr.plugins_.AJAX.prototype.acts.Request,cr.plugins_.Text.prototype.cnds.OnCreated,cr.plugins_.Text.prototype.acts.SetWebFont,cr.behaviors.aekiro_dialog.prototype.cnds.onDialogOpened,cr.system_object.prototype.acts.SetObjectTimescale,cr.behaviors.aekiro_dialog.prototype.acts.Close,cr.behaviors.aekiro_button.prototype.cnds.OnClicked,cr.behaviors.aekiro_bind.prototype.exps.index,cr.behaviors.aekiro_dialog.prototype.acts.Open,cr.plugins_.TR_AdBlockDetector.prototype.cnds.IsBlocking,cr.plugins_.GameAnalytics.prototype.acts.addDesignEvent,cr.plugins_.Function.prototype.exps.ParamCount,cr.system_object.prototype.acts.GoToLayoutByName,cr.system_object.prototype.acts.SetTimescale,cr.plugins_.hmmg_layoutTransition_v2.prototype.acts.prepareTransition,cr.plugins_.hmmg_layoutTransition_v2.prototype.cnds.isTransitionReady,cr.plugins_.hmmg_layoutTransition_v2.prototype.acts.startTransition,cr.system_object.prototype.acts.SetLayerVisible,cr.behaviors.lunarray_LiteTween.prototype.cnds.OnEnd,cr.behaviors.aekiro_button.prototype.cnds.IsEnabled,cr.plugins_.Sprite.prototype.cnds.CompareFrame,cr.plugins_.Sprite.prototype.cnds.CompareWidth,cr.plugins_.JSON.prototype.exps.Size,cr.behaviors.lunarray_LiteTween.prototype.acts.SetParameter,cr.behaviors.lunarray_LiteTween.prototype.acts.Start,cr.plugins_.SkymenSFPlusPLus.prototype.acts.SetPosToObject,cr.system_object.prototype.exps.viewportright,cr.system_object.prototype.exps.viewportleft,cr.system_object.prototype.exps.viewportbottom,cr.system_object.prototype.exps.viewporttop,cr.system_object.prototype.acts.SetLayerOpacity,cr.system_object.prototype.exps.unlerp,cr.plugins_.Particles.prototype.acts.SetRate,cr.system_object.prototype.exps.canvastolayerx,cr.plugins_.Touch.prototype.exps.AbsoluteX,cr.plugins_.Touch.prototype.exps.AbsoluteY,cr.system_object.prototype.exps.canvastolayery,cr.plugins_.Mouse.prototype.cnds.OnObjectClicked,cr.plugins_.Mouse.prototype.exps.AbsoluteX,cr.plugins_.Mouse.prototype.exps.AbsoluteY,cr.plugins_.Mouse.prototype.cnds.IsOverObject,cr.behaviors.Sin.prototype.acts.SetMagnitude,cr.behaviors.Sin.prototype.exps.Magnitude,cr.behaviors.Sin.prototype.acts.SetPeriod,cr.behaviors.Sin.prototype.exps.Period,cr.behaviors.aekiro_dialog.prototype.cnds.onDialogClosed,cr.plugins_.TextModded.prototype.cnds.CompareInstanceVar,cr.plugins_.Keyboard.prototype.exps.StringFromKeyCode,cr.behaviors.aekiro_sliderbar.prototype.acts.setValue,cr.behaviors.aekiro_checkbox.prototype.acts.setValue,cr.plugins_.Browser.prototype.cnds.IsFullscreen,cr.behaviors.aekiro_checkbox.prototype.cnds.OnClicked,cr.behaviors.aekiro_checkbox.prototype.cnds.IsChecked,cr.plugins_.Browser.prototype.acts.CancelFullScreen,cr.behaviors.aekiro_sliderbar.prototype.cnds.IsSliding,cr.behaviors.aekiro_sliderbar.prototype.exps.value,cr.plugins_.rojoPaster.prototype.cnds.OnCreated,cr.plugins_.rojoPaster.prototype.acts.LoadImage,cr.plugins_.SkymenSFPlusPLus.prototype.exps.Y,cr.plugins_.TextModded.prototype.acts.Destroy,cr.plugins_.SkymenSFPlusPLus.prototype.acts.SetBoolInstanceVar,cr.plugins_.SyncStorage.prototype.acts.SubtractValue,cr.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject,cr.plugins_.Arr.prototype.acts.SetXYZ,cr.plugins_.Keyboard.prototype.cnds.IsKeyDown,cr.system_object.prototype.acts.GoToLayout,cr.system_object.prototype.acts.ResetPersisted,cr.behaviors.aekiro_dialog.prototype.cnds.isOpened,cr.plugins_.Function.prototype.cnds.CompareParam,cr.plugins_.HTML_Div_Pode.prototype.acts.MoveToLayer,cr.plugins_.Browser.prototype.cnds.IsPortraitLandscape,cr.plugins_.HTML_Div_Pode.prototype.acts.SetPos,cr.system_object.prototype.exps.originalwindowwidth,cr.plugins_.HTML_Div_Pode.prototype.acts.SetWidth,cr.plugins_.HTML_Div_Pode.prototype.acts.SetVisible,cr.plugins_.filechooser.prototype.acts.ReleaseFile,cr.plugins_.filechooser.prototype.exps.FileURLAt,cr.plugins_.Browser.prototype.acts.InvokeDownloadString,cr.plugins_.filechooser.prototype.cnds.OnChanged,cr.plugins_.TextBox.prototype.cnds.OnClicked,cr.plugins_.TextBox.prototype.acts.SetBlur,cr.plugins_.Button.prototype.cnds.OnClicked,cr.plugins_.Button.prototype.cnds.CompareInstanceVar,cr.plugins_.TextBox.prototype.cnds.CompareInstanceVar,cr.plugins_.TextBox.prototype.exps.Text,cr.plugins_.Button.prototype.cnds.IsChecked,cr.plugins_.SyncStorage.prototype.acts.AppendValue,cr.behaviors.Fade.prototype.acts.RestartFade,cr.plugins_.hmmg_layoutTransition_v2.prototype.cnds.didTransitionFinish,cr.behaviors.lunarray_Tween.prototype.cnds.OnEnd,cr.behaviors.lunarray_Tween.prototype.acts.SetParameter,cr.behaviors.lunarray_Tween.prototype.acts.Start,cr.behaviors.lunarray_Tween.prototype.exps.isPaused,cr.behaviors.lunarray_Tween.prototype.exps.Target,cr.behaviors.lunarray_Tween.prototype.exps.Value,cr.plugins_.SkymenSFPlusPLus.prototype.acts.SetCharPos,cr.plugins_.SkymenSFPlusPLus.prototype.acts.Redraw,cr.system_object.prototype.exps.loadingprogress,cr.plugins_.TiledBg.prototype.exps.Opacity,cr.plugins_.HTML_Div_Pode.prototype.acts.Destroy,cr.plugins_.sirg_notifications.prototype.acts.SetPosition,cr.plugins_.GameAnalytics.prototype.acts.initialize,cr.plugins_.skymen_siteLock.prototype.cnds.SiteLock,cr.plugins_.Browser.prototype.acts.GoToURL]};